<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[useEffect å®Œæ•´æŒ‡å—]]></title>
    <url>%2Farchives%2F1f7a.html</url>
    <content type="text"><![CDATA[æœ¬æ–‡ç”± ç®€æ‚¦ SimpRead è½¬ç ï¼Œ åŽŸæ–‡åœ°å€ https://overreacted.io/zh-hans/a-complete-guide-to-useeffect/ä½ ç”¨ Hooks å†™äº†ä¸€äº›ç»„ä»¶ï¼Œç”šæˆ–å†™äº†ä¸€ä¸ªå°åž‹åº”ç”¨ã€‚ä½ å¯èƒ½å¾ˆæ»¡æ„ï¼Œä½¿ç”¨å®ƒçš„ API å¾ˆèˆ’æœå¹¶ä¸”åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­èŽ·å¾—äº†ä¸€äº›å°æŠ€å·§ã€‚ä½ ç”šè‡³å¯èƒ½å†™äº†ä¸€äº› custom Hooks åŽ»æŠ½ç¦»é‡å¤çš„é€»è¾‘ï¼ˆç²¾ç®€æŽ‰äº† 300 è¡Œä»£ç ï¼‰ï¼Œå¹¶ä¸”å¾—æ„åœ°å±•ç¤ºç»™ä½ çš„åŒäº‹çœ‹ï¼Œâ€œå¹²å¾—æ¼‚äº®â€ï¼Œä»–ä»¬å¦‚æ˜¯è¯´ã€‚ä½†æœ‰æ—¶å€™å½“ä½ ä½¿ç”¨useEffectä½ æ€»è§‰å¾—å“ªå„¿æœ‰ç‚¹ä¸å¯¹åŠ²ã€‚ä½ ä¼šå˜€å’•ä½ å¯èƒ½é—æ¼äº†ä»€ä¹ˆã€‚å®ƒçœ‹èµ·æ¥åƒ class çš„ç”Ÿå‘½å‘¨æœŸâ€¦ ä½†çœŸçš„æ˜¯è¿™æ ·å—ï¼Ÿä½ å‘è§‰è‡ªå·±åœ¨é—®ç±»ä¼¼ä¸‹é¢çš„è¿™äº›é—®é¢˜ï¼šðŸ¤” å¦‚ä½•ç”¨useEffectæ¨¡æ‹ŸcomponentDidMountç”Ÿå‘½å‘¨æœŸï¼ŸðŸ¤” å¦‚ä½•æ­£ç¡®åœ°åœ¨useEffecté‡Œè¯·æ±‚æ•°æ®ï¼Ÿ[]åˆæ˜¯ä»€ä¹ˆï¼ŸðŸ¤” æˆ‘åº”è¯¥æŠŠå‡½æ•°å½“åš effect çš„ä¾èµ–å—ï¼ŸðŸ¤” ä¸ºä»€ä¹ˆæœ‰æ—¶å€™ä¼šå‡ºçŽ°æ— é™é‡å¤è¯·æ±‚çš„é—®é¢˜ï¼ŸðŸ¤” ä¸ºä»€ä¹ˆæœ‰æ—¶å€™åœ¨ effect é‡Œæ‹¿åˆ°çš„æ˜¯æ—§çš„ state æˆ– propï¼Ÿå½“æˆ‘åˆšå¼€å§‹ä½¿ç”¨ Hooks çš„æ—¶å€™ï¼Œæˆ‘ä¹ŸåŒæ ·è¢«ä¸Šé¢è¿™äº›é—®é¢˜æ‰€å›°æ‰°ã€‚ç”šè‡³å½“æˆ‘å†™æœ€åˆçš„æ–‡æ¡£æ—¶ï¼Œæˆ‘ä¹Ÿå¹¶æ²¡æœ‰æ‰Žå®žåœ°æŽŒæ¡æŸäº›ç»†èŠ‚ã€‚æˆ‘ç»åŽ†äº†ä¸€äº› â€œå•Šå“ˆâ€ çš„å¼€çªæ—¶åˆ»ï¼Œæˆ‘æƒ³æŠŠè¿™äº›åˆ†äº«ç»™ä½ ã€‚è¿™ç¯‡æ–‡ç« ä¼šæ·±å…¥è®²è§£å¸®ä½ æ˜Žç™½ä¸Šé¢é—®é¢˜çš„ç­”æ¡ˆã€‚åœ¨çœ‹ç­”æ¡ˆä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆå¾€åŽé€€ä¸€æ­¥ã€‚è¿™ç¯‡æ–‡ç« çš„ç›®çš„ä¸æ˜¯ç»™ä½ ä¸€ä¸ªè¦ç‚¹æ¸…å•ï¼Œè€Œæ˜¯æƒ³å¸®ä½ çœŸæ­£åœ°é¢†ä¼šuseEffectã€‚å…¶å®žæˆ‘ä»¬å¹¶æ²¡æœ‰å¤ªå¤šéœ€è¦å­¦ä¹ çš„ï¼Œäº‹å®žä¸Šï¼Œæˆ‘ä»¬ä¼šèŠ±å¾ˆå¤šæ—¶é—´è¯•å›¾å¿˜è®°æŸäº›å·²ç»ä¹ å¾—çš„æ¦‚å¿µï¼ˆunlearningï¼‰ã€‚å½“æˆ‘ä¸å†é€è¿‡ç†Ÿæ‚‰çš„ class ç”Ÿå‘½å‘¨æœŸæ–¹æ³•åŽ»çª¥è§†useEffect è¿™ä¸ª Hook çš„æ—¶å€™ï¼Œæˆ‘æ‰å¾—ä»¥èžä¼šè´¯é€šã€‚â€œå¿˜è®°ä½ å·²ç»å­¦åˆ°çš„ã€‚â€ â€” Yodaè¿™ç¯‡æ–‡ç« ä¼šå‡è®¾ä½ å¯¹ useEffect API æœ‰ä¸€å®šç¨‹åº¦çš„äº†è§£ã€‚è¿™ç¯‡æ–‡ç« çœŸçš„å¾ˆé•¿ã€‚å®ƒæ›´åƒä¸€æœ¬ mini ä¹¦ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘æ›´å–œæ¬¢çš„å½¢å¼ã€‚å¦‚æžœä½ å¾ˆåŒ†å¿™æˆ–è€…å¹¶ä¸æ˜¯å¤ªå…³å¿ƒæœ¬æ–‡ä¸»é¢˜çš„è¯ï¼Œä½ ä¹Ÿå¯ä»¥ç›´æŽ¥çœ‹ä¸‹é¢çš„æ‘˜è¦ã€‚å¦‚æžœä½ å¯¹äºŽæ·±å…¥ç ”ç©¶æ„Ÿè§‰ä¸æ˜¯å¾ˆé€‚åº”çš„è¯ï¼Œä½ æˆ–è®¸å¯ä»¥ç­‰ä¸‹é¢è¿™äº›è§£é‡Šå‡ºçŽ°åœ¨å…¶ä»–æ–‡ç« ä¸­å†åŽ»äº†è§£ä¹Ÿè¡Œã€‚å°±åƒ 2013 å¹´ React åˆšå‡ºä¸–çš„æ—¶å€™ï¼Œå¤§å®¶éœ€è¦æ—¶é—´åŽ»ç†è§£æ¶ˆåŒ–ä¸€ç§ä¸åŒçš„å¿ƒæ™ºæ¨¡åž‹ã€‚çŸ¥è¯†ä¹Ÿéœ€è¦æ—¶é—´åŽ»æ™®åŠã€‚æ‘˜è¦å¦‚æžœä½ ä¸æƒ³é˜…è¯»æ•´ç¯‡æ–‡ç« ï¼Œå¯ä»¥å¿«é€Ÿæµè§ˆè¿™ä»½æ‘˜è¦ã€‚è¦æ˜¯æŸäº›éƒ¨åˆ†ä¸å®¹æ˜“ç†è§£ï¼Œä½ å¯ä»¥å¾€ä¸‹æ»šåŠ¨å¯»æ‰¾ç›¸å…³çš„å†…å®¹åŽ»é˜…è¯»ã€‚å¦‚æžœä½ æ‰“ç®—é˜…è¯»æ•´ç¯‡æ–‡ç« ï¼Œä½ å®Œå…¨å¯ä»¥è·³è¿‡è¿™éƒ¨åˆ†ã€‚æˆ‘ä¼šåœ¨æ–‡ç« æœ«å°¾å¸¦ä¸Šæ‘˜è¦çš„é“¾æŽ¥ã€‚ðŸ¤” Question: å¦‚ä½•ç”¨useEffectæ¨¡æ‹ŸcomponentDidMountç”Ÿå‘½å‘¨æœŸï¼Ÿè™½ç„¶å¯ä»¥ä½¿ç”¨useEffect(fn, [])ï¼Œä½†å®ƒä»¬å¹¶ä¸å®Œå…¨ç›¸ç­‰ã€‚å’ŒcomponentDidMountä¸ä¸€æ ·ï¼ŒuseEffectä¼š_æ•èŽ·_ props å’Œ stateã€‚æ‰€ä»¥å³ä¾¿åœ¨å›žè°ƒå‡½æ•°é‡Œï¼Œä½ æ‹¿åˆ°çš„è¿˜æ˜¯åˆå§‹çš„ props å’Œ stateã€‚å¦‚æžœä½ æƒ³å¾—åˆ° â€œæœ€æ–°â€ çš„å€¼ï¼Œä½ å¯ä»¥ä½¿ç”¨ refã€‚ä¸è¿‡ï¼Œé€šå¸¸ä¼šæœ‰æ›´ç®€å•çš„å®žçŽ°æ–¹å¼ï¼Œæ‰€ä»¥ä½ å¹¶ä¸ä¸€å®šè¦ç”¨ refã€‚è®°ä½ï¼Œeffects çš„å¿ƒæ™ºæ¨¡åž‹å’ŒcomponentDidMountä»¥åŠå…¶ä»–ç”Ÿå‘½å‘¨æœŸæ˜¯ä¸åŒçš„ï¼Œè¯•å›¾æ‰¾åˆ°å®ƒä»¬ä¹‹é—´å®Œå…¨ä¸€è‡´çš„è¡¨è¾¾åè€Œæ›´å®¹æ˜“ä½¿ä½ æ··æ·†ã€‚æƒ³è¦æ›´æœ‰æ•ˆï¼Œä½ éœ€è¦ â€œthink in effectsâ€ï¼Œå®ƒçš„å¿ƒæ™ºæ¨¡åž‹æ›´æŽ¥è¿‘äºŽå®žçŽ°çŠ¶æ€åŒæ­¥ï¼Œè€Œä¸æ˜¯å“åº”ç”Ÿå‘½å‘¨æœŸäº‹ä»¶ã€‚ðŸ¤” Question: å¦‚ä½•æ­£ç¡®åœ°åœ¨useEffecté‡Œè¯·æ±‚æ•°æ®ï¼Ÿ[]åˆæ˜¯ä»€ä¹ˆï¼Ÿè¿™ç¯‡æ–‡ç«  æ˜¯å¾ˆå¥½çš„å…¥é—¨ï¼Œä»‹ç»äº†å¦‚ä½•åœ¨useEffecté‡Œåšæ•°æ®è¯·æ±‚ã€‚è¯·åŠ¡å¿…è¯»å®Œå®ƒï¼å®ƒæ²¡æœ‰æˆ‘çš„è¿™ç¯‡è¿™ä¹ˆé•¿ã€‚[]è¡¨ç¤º effect æ²¡æœ‰ä½¿ç”¨ä»»ä½• React æ•°æ®æµé‡Œçš„å€¼ï¼Œå› æ­¤è¯¥ effect ä»…è¢«è°ƒç”¨ä¸€æ¬¡æ˜¯å®‰å…¨çš„ã€‚[]åŒæ ·ä¹Ÿæ˜¯ä¸€ç±»å¸¸è§é—®é¢˜çš„æ¥æºï¼Œä¹Ÿå³ä½ ä»¥ä¸ºæ²¡ä½¿ç”¨æ•°æ®æµé‡Œçš„å€¼ä½†å…¶å®žä½¿ç”¨äº†ã€‚ä½ éœ€è¦å­¦ä¹ ä¸€äº›ç­–ç•¥ï¼ˆä¸»è¦æ˜¯useReducer å’Œ useCallbackï¼‰æ¥ç§»é™¤è¿™äº› effect ä¾èµ–ï¼Œè€Œä¸æ˜¯é”™è¯¯åœ°å¿½ç•¥å®ƒä»¬ã€‚ðŸ¤” Question: æˆ‘åº”è¯¥æŠŠå‡½æ•°å½“åš effect çš„ä¾èµ–å—ï¼Ÿä¸€èˆ¬å»ºè®®æŠŠä¸ä¾èµ– props å’Œ state çš„å‡½æ•°æåˆ°ä½ çš„ç»„ä»¶å¤–é¢ï¼Œå¹¶ä¸”æŠŠé‚£äº›ä»…è¢« effect ä½¿ç”¨çš„å‡½æ•°æ”¾åˆ° effect é‡Œé¢ã€‚å¦‚æžœè¿™æ ·åšäº†ä»¥åŽï¼Œä½ çš„ effect è¿˜æ˜¯éœ€è¦ç”¨åˆ°ç»„ä»¶å†…çš„å‡½æ•°ï¼ˆåŒ…æ‹¬é€šè¿‡ props ä¼ è¿›æ¥çš„å‡½æ•°ï¼‰ï¼Œå¯ä»¥åœ¨å®šä¹‰å®ƒä»¬çš„åœ°æ–¹ç”¨useCallbackåŒ…ä¸€å±‚ã€‚ä¸ºä»€ä¹ˆè¦è¿™æ ·åšå‘¢ï¼Ÿå› ä¸ºè¿™äº›å‡½æ•°å¯ä»¥è®¿é—®åˆ° props å’Œ stateï¼Œå› æ­¤å®ƒä»¬ä¼šå‚ä¸Žåˆ°æ•°æ®æµä¸­ã€‚æˆ‘ä»¬å®˜ç½‘çš„ FAQ æœ‰æ›´è¯¦ç»†çš„ç­”æ¡ˆã€‚ðŸ¤” Question: ä¸ºä»€ä¹ˆæœ‰æ—¶å€™ä¼šå‡ºçŽ°æ— é™é‡å¤è¯·æ±‚çš„é—®é¢˜ï¼Ÿè¿™ä¸ªé€šå¸¸å‘ç”ŸäºŽä½ åœ¨ effect é‡Œåšæ•°æ®è¯·æ±‚å¹¶ä¸”æ²¡æœ‰è®¾ç½® effect ä¾èµ–å‚æ•°çš„æƒ…å†µã€‚æ²¡æœ‰è®¾ç½®ä¾èµ–ï¼Œeffect ä¼šåœ¨æ¯æ¬¡æ¸²æŸ“åŽæ‰§è¡Œä¸€æ¬¡ï¼Œç„¶åŽåœ¨ effect ä¸­æ›´æ–°äº†çŠ¶æ€å¼•èµ·æ¸²æŸ“å¹¶å†æ¬¡è§¦å‘ effectã€‚æ— é™å¾ªçŽ¯çš„å‘ç”Ÿä¹Ÿå¯èƒ½æ˜¯å› ä¸ºä½ è®¾ç½®çš„ä¾èµ–æ€»æ˜¯ä¼šæ”¹å˜ã€‚ä½ å¯ä»¥é€šè¿‡ä¸€ä¸ªä¸€ä¸ªç§»é™¤çš„æ–¹å¼æŽ’æŸ¥å‡ºå“ªä¸ªä¾èµ–å¯¼è‡´äº†é—®é¢˜ã€‚ä½†æ˜¯ï¼Œç§»é™¤ä½ ä½¿ç”¨çš„ä¾èµ–ï¼ˆæˆ–è€…ç›²ç›®åœ°ä½¿ç”¨[]ï¼‰é€šå¸¸æ˜¯ä¸€ç§é”™è¯¯çš„è§£å†³æ–¹å¼ã€‚ä½ åº”è¯¥åšçš„æ˜¯è§£å†³é—®é¢˜çš„æ ¹æºã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå‡½æ•°å¯èƒ½ä¼šå¯¼è‡´è¿™ä¸ªé—®é¢˜ï¼Œä½ å¯ä»¥æŠŠå®ƒä»¬æ”¾åˆ° effect é‡Œï¼Œæˆ–è€…æåˆ°ç»„ä»¶å¤–é¢ï¼Œæˆ–è€…ç”¨useCallbackåŒ…ä¸€å±‚ã€‚useMemo å¯ä»¥åšç±»ä¼¼çš„äº‹æƒ…ä»¥é¿å…é‡å¤ç”Ÿæˆå¯¹è±¡ã€‚ðŸ¤” ä¸ºä»€ä¹ˆæœ‰æ—¶å€™åœ¨ effect é‡Œæ‹¿åˆ°çš„æ˜¯æ—§çš„ state æˆ– prop å‘¢ï¼ŸEffect æ‹¿åˆ°çš„æ€»æ˜¯å®šä¹‰å®ƒçš„é‚£æ¬¡æ¸²æŸ“ä¸­çš„ props å’Œ stateã€‚è¿™èƒ½å¤Ÿé¿å…ä¸€äº› bugsï¼Œä½†åœ¨ä¸€äº›åœºæ™¯ä¸­åˆä¼šæœ‰äº›è®¨äººå«Œã€‚å¯¹äºŽè¿™äº›åœºæ™¯ï¼Œä½ å¯ä»¥æ˜Žç¡®åœ°ä½¿ç”¨å¯å˜çš„ ref ä¿å­˜ä¸€äº›å€¼ï¼ˆä¸Šé¢æ–‡ç« çš„æœ«å°¾è§£é‡Šäº†è¿™ä¸€ç‚¹ï¼‰ã€‚å¦‚æžœä½ è§‰å¾—åœ¨æ¸²æŸ“ä¸­æ‹¿åˆ°äº†ä¸€äº›æ—§çš„ props å’Œ stateï¼Œä¸”ä¸æ˜¯ä½ æƒ³è¦çš„ï¼Œä½ å¾ˆå¯èƒ½é—æ¼äº†ä¸€äº›ä¾èµ–ã€‚å¯ä»¥å°è¯•ä½¿ç”¨è¿™ä¸ª lint è§„åˆ™æ¥è®­ç»ƒä½ å‘çŽ°è¿™äº›ä¾èµ–ã€‚å¯èƒ½æ²¡è¿‡å‡ å¤©ï¼Œè¿™ç§èƒ½åŠ›ä¼šå˜å¾—åƒæ˜¯ä½ çš„ç¬¬äºŒå¤©æ€§ã€‚åŒæ ·å¯ä»¥çœ‹æˆ‘ä»¬å®˜ç½‘ FAQ ä¸­çš„è¿™ä¸ªå›žç­”ã€‚æˆ‘å¸Œæœ›è¿™ä¸ªæ‘˜è¦å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼è¦ä¸ï¼Œæˆ‘ä»¬å¼€å§‹æ­£æ–‡ã€‚æ¯ä¸€æ¬¡æ¸²æŸ“éƒ½æœ‰å®ƒè‡ªå·±çš„ Props and Stateåœ¨æˆ‘ä»¬è®¨è®º effects ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆè®¨è®ºä¸€ä¸‹æ¸²æŸ“ï¼ˆrenderingï¼‰ã€‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªè®¡æ•°å™¨ç»„ä»¶ Counterï¼Œæ³¨æ„é«˜äº®çš„é‚£ä¸€è¡Œï¼š1234567891011function Counter() &#123; const [count, setCount] = useState(0); return ( &lt;div&gt; &lt;p&gt;You clicked &#123;count&#125; times&lt;/p&gt; &lt;button onClick=&#123;() =&gt; setCount(count + 1)&#125;&gt; Click me &lt;/button&gt; &lt;/div&gt; );&#125;é«˜äº®çš„ä»£ç ç©¶ç«Ÿæ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿcount ä¼š â€œç›‘å¬â€ çŠ¶æ€çš„å˜åŒ–å¹¶è‡ªåŠ¨æ›´æ–°å—ï¼Ÿè¿™ä¹ˆæƒ³å¯èƒ½æ˜¯å­¦ä¹  React çš„æ—¶å€™æœ‰ç”¨çš„ç¬¬ä¸€ç›´è§‰ï¼Œä½†å®ƒå¹¶ä¸æ˜¯ç²¾ç¡®çš„å¿ƒæ™ºæ¨¡åž‹ã€‚ä¸Šé¢ä¾‹å­ä¸­ï¼Œcountä»…æ˜¯ä¸€ä¸ªæ•°å­—è€Œå·²ã€‚å®ƒä¸æ˜¯ç¥žå¥‡çš„ â€œdata bindingâ€, â€œwatcherâ€, â€œproxyâ€ï¼Œæˆ–è€…å…¶ä»–ä»»ä½•ä¸œè¥¿ã€‚å®ƒå°±æ˜¯ä¸€ä¸ªæ™®é€šçš„æ•°å­—åƒä¸‹é¢è¿™ä¸ªä¸€æ ·ï¼š123const count = 42;&lt;p&gt;You clicked &#123;count&#125; times&lt;/p&gt;æˆ‘ä»¬çš„ç»„ä»¶ç¬¬ä¸€æ¬¡æ¸²æŸ“çš„æ—¶å€™ï¼Œä»ŽuseState()æ‹¿åˆ°countçš„åˆå§‹å€¼0ã€‚å½“æˆ‘ä»¬è°ƒç”¨setCount(1)ï¼ŒReact ä¼šå†æ¬¡æ¸²æŸ“ç»„ä»¶ï¼Œè¿™ä¸€æ¬¡countæ˜¯1ã€‚å¦‚æ­¤ç­‰ç­‰ï¼š12345678910111213141516171819function Counter() &#123; const count = 0; &lt;p&gt;You clicked &#123;count&#125; times&lt;/p&gt; &#125;function Counter() &#123; const count = 1; &lt;p&gt;You clicked &#123;count&#125; times&lt;/p&gt; &#125;function Counter() &#123; const count = 2; &lt;p&gt;You clicked &#123;count&#125; times&lt;/p&gt; &#125;å½“æˆ‘ä»¬æ›´æ–°çŠ¶æ€çš„æ—¶å€™ï¼ŒReact ä¼šé‡æ–°æ¸²æŸ“ç»„ä»¶ã€‚æ¯ä¸€æ¬¡æ¸²æŸ“éƒ½èƒ½æ‹¿åˆ°ç‹¬ç«‹çš„count çŠ¶æ€ï¼Œè¿™ä¸ªçŠ¶æ€å€¼æ˜¯å‡½æ•°ä¸­çš„ä¸€ä¸ªå¸¸é‡ã€‚æ‰€ä»¥ä¸‹é¢çš„è¿™è¡Œä»£ç æ²¡æœ‰åšä»»ä½•ç‰¹æ®Šçš„æ•°æ®ç»‘å®šï¼š1&lt;p&gt;You clicked &#123;count&#125; times&lt;/p&gt;å®ƒä»…ä»…åªæ˜¯åœ¨æ¸²æŸ“è¾“å‡ºä¸­æ’å…¥äº† count è¿™ä¸ªæ•°å­—ã€‚è¿™ä¸ªæ•°å­—ç”± React æä¾›ã€‚å½“setCountçš„æ—¶å€™ï¼ŒReact ä¼šå¸¦ç€ä¸€ä¸ªä¸åŒçš„countå€¼å†æ¬¡è°ƒç”¨ç»„ä»¶ã€‚ç„¶åŽï¼ŒReact ä¼šæ›´æ–° DOM ä»¥ä¿æŒå’Œæ¸²æŸ“è¾“å‡ºä¸€è‡´ã€‚è¿™é‡Œå…³é”®çš„ç‚¹åœ¨äºŽä»»æ„ä¸€æ¬¡æ¸²æŸ“ä¸­çš„countå¸¸é‡éƒ½ä¸ä¼šéšç€æ—¶é—´æ”¹å˜ã€‚æ¸²æŸ“è¾“å‡ºä¼šå˜æ˜¯å› ä¸ºæˆ‘ä»¬çš„ç»„ä»¶è¢«ä¸€æ¬¡æ¬¡è°ƒç”¨ï¼Œè€Œæ¯ä¸€æ¬¡è°ƒç”¨å¼•èµ·çš„æ¸²æŸ“ä¸­ï¼Œå®ƒåŒ…å«çš„countå€¼ç‹¬ç«‹äºŽå…¶ä»–æ¸²æŸ“ã€‚ï¼ˆå…³äºŽè¿™ä¸ªè¿‡ç¨‹æ›´æ·±å…¥çš„æŽ¢è®¨å¯ä»¥æŸ¥çœ‹æˆ‘çš„å¦ä¸€ç¯‡æ–‡ç«  React as a UI Runtimeã€‚ï¼‰æ¯ä¸€æ¬¡æ¸²æŸ“éƒ½æœ‰å®ƒè‡ªå·±çš„äº‹ä»¶å¤„ç†å‡½æ•°åˆ°ç›®å‰ä¸ºæ­¢ä¸€åˆ‡éƒ½è¿˜å¥½ã€‚é‚£ä¹ˆäº‹ä»¶å¤„ç†å‡½æ•°å‘¢ï¼Ÿçœ‹ä¸‹é¢çš„è¿™ä¸ªä¾‹å­ã€‚å®ƒåœ¨ä¸‰ç§’åŽä¼š alert ç‚¹å‡»æ¬¡æ•°countï¼š12345678910111213function Counter() &#123; const [count, setCount] = useState(0); function handleAlertClick() &#123; setTimeout(() =&gt; &#123; alert(&apos;You clicked on: &apos; + count); &#125;, 3000); &#125; return ( &lt;div&gt; &lt;p&gt;You clicked &#123;count&#125; times&lt;/p&gt; &lt;button onClick=&#123;() =&gt; setCount(count + 1)&#125;&gt; Click me &lt;/button&gt; &lt;button onClick=&#123;handleAlertClick&#125;&gt; Show alert &lt;/button&gt; &lt;/div&gt; );&#125;å¦‚æžœæˆ‘æŒ‰ç…§ä¸‹é¢çš„æ­¥éª¤åŽ»æ“ä½œï¼šç‚¹å‡»å¢žåŠ  counter åˆ° 3ç‚¹å‡»ä¸€ä¸‹ â€œShow alertâ€ç‚¹å‡»å¢žåŠ  counter åˆ° 5 å¹¶ä¸”åœ¨å®šæ—¶å™¨å›žè°ƒè§¦å‘å‰å®Œæˆä½ çŒœ alert ä¼šå¼¹å‡ºä»€ä¹ˆå‘¢ï¼Ÿä¼šæ˜¯ 5 å—ï¼Ÿâ€” è¿™ä¸ªå€¼æ˜¯ alert çš„æ—¶å€™ counter çš„å®žæ—¶çŠ¶æ€ã€‚æˆ–è€…ä¼šæ˜¯ 3 å—ï¼Ÿâ€” è¿™ä¸ªå€¼æ˜¯æˆ‘ç‚¹å‡»æ—¶å€™çš„çŠ¶æ€ã€‚å‰§é€é¢„è­¦æ¥è‡ªå·± è¯•è¯•å§ï¼å¦‚æžœç»“æžœå’Œä½ é¢„æ–™ä¸ä¸€æ ·ï¼Œä½ å¯ä»¥æƒ³è±¡ä¸€ä¸ªæ›´å®žé™…çš„ä¾‹å­ï¼šä¸€ä¸ªèŠå¤©åº”ç”¨åœ¨ state ä¸­ä¿å­˜äº†å½“å‰æŽ¥æ”¶è€…çš„ IDï¼Œä»¥åŠä¸€ä¸ªå‘é€æŒ‰é’®ã€‚ è¿™ç¯‡æ–‡ç« æ·±å…¥æŽ¢ç´¢äº†ä¸ªä¸­ç¼˜ç”±ã€‚æ­£ç¡®çš„ç­”æ¡ˆå°±æ˜¯ 3ã€‚alert ä¼š â€œæ•èŽ·â€ æˆ‘ç‚¹å‡»æŒ‰é’®æ—¶å€™çš„çŠ¶æ€ã€‚ï¼ˆè™½ç„¶æœ‰å…¶ä»–åŠžæ³•å¯ä»¥å®žçŽ°ä¸åŒçš„è¡Œä¸ºï¼Œä½†çŽ°åœ¨æˆ‘ä¼šä¸“æ³¨äºŽè¿™ä¸ªé»˜è®¤çš„åœºæ™¯ã€‚å½“æˆ‘ä»¬åœ¨æž„å»ºä¸€ç§å¿ƒæ™ºæ¨¡åž‹çš„æ—¶å€™ï¼Œåœ¨å¯é€‰çš„ç­–ç•¥ä¸­åˆ†è¾¨å‡º â€œæœ€å°é˜»åŠ›è·¯å¾„â€ æ˜¯éžå¸¸é‡è¦çš„ã€‚ï¼‰ä½†å®ƒç©¶ç«Ÿæ˜¯å¦‚ä½•å·¥ä½œçš„å‘¢ï¼Ÿæˆ‘ä»¬å‘çŽ°countåœ¨æ¯ä¸€æ¬¡å‡½æ•°è°ƒç”¨ä¸­éƒ½æ˜¯ä¸€ä¸ªå¸¸é‡å€¼ã€‚å€¼å¾—å¼ºè°ƒçš„æ˜¯ â€” æˆ‘ä»¬çš„ç»„ä»¶å‡½æ•°æ¯æ¬¡æ¸²æŸ“éƒ½ä¼šè¢«è°ƒç”¨ï¼Œä½†æ˜¯æ¯ä¸€æ¬¡è°ƒç”¨ä¸­countå€¼éƒ½æ˜¯å¸¸é‡ï¼Œå¹¶ä¸”å®ƒè¢«èµ‹äºˆäº†å½“å‰æ¸²æŸ“ä¸­çš„çŠ¶æ€å€¼ã€‚è¿™å¹¶ä¸æ˜¯ React ç‰¹æœ‰çš„ï¼Œæ™®é€šçš„å‡½æ•°ä¹Ÿæœ‰ç±»ä¼¼çš„è¡Œä¸ºï¼š1234567891011121314function sayHi(person) &#123; const name = person.name; setTimeout(() =&gt; &#123; alert(&apos;Hello, &apos; + name); &#125;, 3000);&#125;let someone = &#123;name: &apos;Dan&apos;&#125;;sayHi(someone);someone = &#123;name: &apos;Yuzhi&apos;&#125;;sayHi(someone);someone = &#123;name: &apos;Dominic&apos;&#125;;sayHi(someone);åœ¨ è¿™ä¸ªä¾‹å­ä¸­, å¤–å±‚çš„someoneä¼šè¢«èµ‹å€¼å¾ˆå¤šæ¬¡ï¼ˆå°±åƒåœ¨ React ä¸­ï¼Œ_å½“å‰_çš„ç»„ä»¶çŠ¶æ€ä¼šæ”¹å˜ä¸€æ ·ï¼‰ã€‚ç„¶åŽï¼Œåœ¨sayHiå‡½æ•°ä¸­ï¼Œå±€éƒ¨å¸¸é‡nameä¼šå’ŒæŸæ¬¡è°ƒç”¨ä¸­çš„personå…³è”ã€‚å› ä¸ºè¿™ä¸ªå¸¸é‡æ˜¯å±€éƒ¨çš„ï¼Œæ‰€ä»¥æ¯ä¸€æ¬¡è°ƒç”¨éƒ½æ˜¯ç›¸äº’ç‹¬ç«‹çš„ã€‚ç»“æžœå°±æ˜¯ï¼Œå½“å®šæ—¶å™¨å›žè°ƒè§¦å‘çš„æ—¶å€™ï¼Œæ¯ä¸€ä¸ª alert éƒ½ä¼šå¼¹å‡ºå®ƒæ‹¥æœ‰çš„nameã€‚è¿™å°±è§£é‡Šäº†æˆ‘ä»¬çš„äº‹ä»¶å¤„ç†å‡½æ•°å¦‚ä½•æ•èŽ·äº†ç‚¹å‡»æ—¶å€™çš„countå€¼ã€‚å¦‚æžœæˆ‘ä»¬åº”ç”¨ç›¸åŒçš„æ›¿æ¢åŽŸç†ï¼Œæ¯ä¸€æ¬¡æ¸²æŸ“ â€œçœ‹åˆ°â€ çš„æ˜¯å®ƒè‡ªå·±çš„countï¼š12345678910111213141516171819202122232425262728293031function Counter() &#123; const count = 0; function handleAlertClick() &#123; setTimeout(() =&gt; &#123; alert(&apos;You clicked on: &apos; + count); &#125;, 3000); &#125; &#125;function Counter() &#123; const count = 1; function handleAlertClick() &#123; setTimeout(() =&gt; &#123; alert(&apos;You clicked on: &apos; + count); &#125;, 3000); &#125; &#125;function Counter() &#123; const count = 2; function handleAlertClick() &#123; setTimeout(() =&gt; &#123; alert(&apos;You clicked on: &apos; + count); &#125;, 3000); &#125; &#125;æ‰€ä»¥å®žé™…ä¸Šï¼Œæ¯ä¸€æ¬¡æ¸²æŸ“éƒ½æœ‰ä¸€ä¸ª â€œæ–°ç‰ˆæœ¬â€ çš„handleAlertClickã€‚æ¯ä¸€ä¸ªç‰ˆæœ¬çš„handleAlertClickâ€œè®°ä½â€ äº†å®ƒè‡ªå·±çš„ countï¼š12345678910111213141516171819202122232425262728293031function Counter() &#123; function handleAlertClick() &#123; setTimeout(() =&gt; &#123; alert(&apos;You clicked on: &apos; + 0); &#125;, 3000); &#125; &lt;button onClick=&#123;handleAlertClick&#125; /&gt; &#125;function Counter() &#123; function handleAlertClick() &#123; setTimeout(() =&gt; &#123; alert(&apos;You clicked on: &apos; + 1); &#125;, 3000); &#125; &lt;button onClick=&#123;handleAlertClick&#125; /&gt; &#125;function Counter() &#123; function handleAlertClick() &#123; setTimeout(() =&gt; &#123; alert(&apos;You clicked on: &apos; + 2); &#125;, 3000); &#125; &lt;button onClick=&#123;handleAlertClick&#125; /&gt; &#125;è¿™å°±æ˜¯ä¸ºä»€ä¹ˆåœ¨è¿™ä¸ª demo ä¸­ä¸­ï¼Œäº‹ä»¶å¤„ç†å‡½æ•° â€œå±žäºŽâ€ æŸä¸€æ¬¡ç‰¹å®šçš„æ¸²æŸ“ï¼Œå½“ä½ ç‚¹å‡»çš„æ—¶å€™ï¼Œå®ƒä¼šä½¿ç”¨é‚£æ¬¡æ¸²æŸ“ä¸­counterçš„çŠ¶æ€å€¼ã€‚åœ¨ä»»æ„ä¸€æ¬¡æ¸²æŸ“ä¸­ï¼Œprops å’Œ state æ˜¯å§‹ç»ˆä¿æŒä¸å˜çš„ã€‚å¦‚æžœ props å’Œ state åœ¨ä¸åŒçš„æ¸²æŸ“ä¸­æ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œé‚£ä¹ˆä½¿ç”¨åˆ°å®ƒä»¬çš„ä»»ä½•å€¼ä¹Ÿæ˜¯ç‹¬ç«‹çš„ï¼ˆåŒ…æ‹¬äº‹ä»¶å¤„ç†å‡½æ•°ï¼‰ã€‚å®ƒä»¬éƒ½ â€œå±žäºŽâ€ ä¸€æ¬¡ç‰¹å®šçš„æ¸²æŸ“ã€‚å³ä¾¿æ˜¯äº‹ä»¶å¤„ç†ä¸­çš„å¼‚æ­¥å‡½æ•°è°ƒç”¨ â€œçœ‹åˆ°â€ çš„ä¹Ÿæ˜¯è¿™æ¬¡æ¸²æŸ“ä¸­çš„countå€¼ã€‚å¤‡æ³¨ï¼šä¸Šé¢æˆ‘å°†å…·ä½“çš„countå€¼ç›´æŽ¥å†…è”åˆ°äº†handleAlertClickå‡½æ•°ä¸­ã€‚è¿™ç§å¿ƒæ™ºä¸Šçš„æ›¿æ¢æ˜¯å®‰å…¨çš„å› ä¸ºcount å€¼åœ¨æŸæ¬¡ç‰¹å®šæ¸²æŸ“ä¸­ä¸å¯èƒ½è¢«æ”¹å˜ã€‚å®ƒè¢«å£°æ˜Žæˆäº†ä¸€ä¸ªå¸¸é‡å¹¶ä¸”æ˜¯ä¸€ä¸ªæ•°å­—ã€‚è¿™æ ·åŽ»æ€è€ƒå…¶ä»–ç±»åž‹çš„å€¼æ¯”å¦‚å¯¹è±¡ä¹ŸåŒæ ·æ˜¯å®‰å…¨çš„ï¼Œå½“ç„¶éœ€è¦åœ¨æˆ‘ä»¬éƒ½åŒæ„åº”è¯¥é¿å…ç›´æŽ¥ä¿®æ”¹ state è¿™ä¸ªå‰æä¸‹ã€‚é€šè¿‡è°ƒç”¨setSomething(newObj)çš„æ–¹å¼åŽ»ç”Ÿæˆä¸€ä¸ªæ–°çš„å¯¹è±¡è€Œä¸æ˜¯ç›´æŽ¥ä¿®æ”¹å®ƒæ˜¯æ›´å¥½çš„é€‰æ‹©ï¼Œå› ä¸ºè¿™æ ·èƒ½ä¿è¯ä¹‹å‰æ¸²æŸ“ä¸­çš„ state ä¸ä¼šè¢«æ±¡æŸ“ã€‚æ¯æ¬¡æ¸²æŸ“éƒ½æœ‰å®ƒè‡ªå·±çš„ Effectsè¿™ç¯‡æ–‡ç« æ˜¯å…³äºŽ effects çš„ï¼Œä½†ç›®å‰æˆ‘ä»¬å±…ç„¶è¿˜æ²¡æœ‰è®¨è®º effectsï¼ è¨€å½’æ­£ä¼ ï¼Œç”±ä¸Šé¢çš„åˆ†æžå¾—å‡ºä¸€ä¸ªç»“æžœï¼Œeffects å…¶å®žå¹¶æ²¡æœ‰ä»€ä¹ˆä¸¤æ ·ã€‚è®©æˆ‘ä»¬å›žåˆ°å®˜ç½‘æ–‡æ¡£ä¸­çš„è¿™ä¸ªä¾‹å­ï¼š12345678910111213function Counter() &#123; const [count, setCount] = useState(0); useEffect(() =&gt; &#123; document.title = `You clicked $&#123;count&#125; times`; &#125;); return ( &lt;div&gt; &lt;p&gt;You clicked &#123;count&#125; times&lt;/p&gt; &lt;button onClick=&#123;() =&gt; setCount(count + 1)&#125;&gt; Click me &lt;/button&gt; &lt;/div&gt; );&#125;æŠ›ä¸€ä¸ªé—®é¢˜ç»™ä½ ï¼šeffect æ˜¯å¦‚ä½•è¯»å–åˆ°æœ€æ–°çš„count çŠ¶æ€å€¼çš„å‘¢ï¼Ÿä¹Ÿè®¸ï¼Œæ˜¯æŸç§ â€œdata bindingâ€ æˆ–â€œwatchingâ€æœºåˆ¶ä½¿å¾—countèƒ½å¤Ÿåœ¨ effect å‡½æ•°å†…æ›´æ–°ï¼Ÿä¹Ÿæˆ–è®¸countæ˜¯ä¸€ä¸ªå¯å˜çš„å€¼ï¼ŒReact ä¼šåœ¨æˆ‘ä»¬ç»„ä»¶å†…éƒ¨ä¿®æ”¹å®ƒä»¥ä½¿æˆ‘ä»¬çš„ effect å‡½æ•°æ€»èƒ½æ‹¿åˆ°æœ€æ–°çš„å€¼ï¼Ÿéƒ½ä¸æ˜¯ã€‚æˆ‘ä»¬å·²ç»çŸ¥é“countæ˜¯æŸä¸ªç‰¹å®šæ¸²æŸ“ä¸­çš„å¸¸é‡ã€‚äº‹ä»¶å¤„ç†å‡½æ•° â€œçœ‹åˆ°â€ çš„æ˜¯å±žäºŽå®ƒé‚£æ¬¡ç‰¹å®šæ¸²æŸ“ä¸­çš„countçŠ¶æ€å€¼ã€‚å¯¹äºŽ effects ä¹ŸåŒæ ·å¦‚æ­¤ï¼šå¹¶ä¸æ˜¯countçš„å€¼åœ¨ â€œä¸å˜â€ çš„ effect ä¸­å‘ç”Ÿäº†æ”¹å˜ï¼Œè€Œæ˜¯ effect å‡½æ•°æœ¬èº«åœ¨æ¯ä¸€æ¬¡æ¸²æŸ“ä¸­éƒ½ä¸ç›¸åŒã€‚æ¯ä¸€ä¸ª effect ç‰ˆæœ¬ â€œçœ‹åˆ°â€ çš„countå€¼éƒ½æ¥è‡ªäºŽå®ƒå±žäºŽçš„é‚£æ¬¡æ¸²æŸ“ï¼š12345678910111213141516171819202122function Counter() &#123; useEffect( () =&gt; &#123; document.title = `You clicked $&#123;0&#125; times`; &#125; ); &#125;function Counter() &#123; useEffect( () =&gt; &#123; document.title = `You clicked $&#123;1&#125; times`; &#125; ); &#125;function Counter() &#123; useEffect( () =&gt; &#123; document.title = `You clicked $&#123;2&#125; times`; &#125; ); &#125;React ä¼šè®°ä½ä½ æä¾›çš„ effect å‡½æ•°ï¼Œå¹¶ä¸”ä¼šåœ¨æ¯æ¬¡æ›´æ”¹ä½œç”¨äºŽ DOM å¹¶è®©æµè§ˆå™¨ç»˜åˆ¶å±å¹•åŽåŽ»è°ƒç”¨å®ƒã€‚æ‰€ä»¥è™½ç„¶æˆ‘ä»¬è¯´çš„æ˜¯ä¸€ä¸ª effectï¼ˆè¿™é‡ŒæŒ‡æ›´æ–° document çš„ titleï¼‰ï¼Œä½†å…¶å®žæ¯æ¬¡æ¸²æŸ“éƒ½æ˜¯ä¸€ä¸ªä¸åŒçš„å‡½æ•° â€” å¹¶ä¸”æ¯ä¸ª effect å‡½æ•° â€œçœ‹åˆ°â€ çš„ props å’Œ state éƒ½æ¥è‡ªäºŽå®ƒå±žäºŽçš„é‚£æ¬¡ç‰¹å®šæ¸²æŸ“ã€‚æ¦‚å¿µä¸Šï¼Œä½ å¯ä»¥æƒ³è±¡ effects æ˜¯æ¸²æŸ“ç»“æžœçš„ä¸€éƒ¨åˆ†ã€‚ä¸¥æ ¼åœ°è¯´ï¼Œå®ƒä»¬å¹¶ä¸æ˜¯ï¼ˆä¸ºäº†å…è®¸ Hook çš„ç»„åˆå¹¶ä¸”ä¸å¼•å…¥ç¬¨æ‹™çš„è¯­æ³•æˆ–è€…è¿è¡Œæ—¶ï¼‰ã€‚ä½†æ˜¯åœ¨æˆ‘ä»¬æž„å»ºçš„å¿ƒæ™ºæ¨¡åž‹ä¸Šï¼Œeffect å‡½æ•°_å±žäºŽ_æŸä¸ªç‰¹å®šçš„æ¸²æŸ“ï¼Œå°±åƒäº‹ä»¶å¤„ç†å‡½æ•°ä¸€æ ·ã€‚ä¸ºäº†ç¡®ä¿æˆ‘ä»¬å·²ç»æœ‰äº†æ‰Žå®žçš„ç†è§£ï¼Œæˆ‘ä»¬å†å›žé¡¾ä¸€ä¸‹ç¬¬ä¸€æ¬¡çš„æ¸²æŸ“è¿‡ç¨‹ï¼šReact: ç»™æˆ‘çŠ¶æ€ä¸º 0æ—¶å€™çš„ UIã€‚ä½ çš„ç»„ä»¶:ç»™ä½ éœ€è¦æ¸²æŸ“çš„å†…å®¹: &lt;p&gt;You clicked 0 times&lt;/p&gt;ã€‚è®°å¾—åœ¨æ¸²æŸ“å®Œäº†ä¹‹åŽè°ƒç”¨è¿™ä¸ª effect: () =&gt; { document.title = &#39;You clicked 0 times&#39; }ã€‚React: æ²¡é—®é¢˜ã€‚å¼€å§‹æ›´æ–° UIï¼Œå–‚æµè§ˆå™¨ï¼Œæˆ‘è¦ç»™ DOM æ·»åŠ ä¸€äº›ä¸œè¥¿ã€‚æµè§ˆå™¨: é…·ï¼Œæˆ‘å·²ç»æŠŠå®ƒç»˜åˆ¶åˆ°å±å¹•ä¸Šäº†ã€‚React: å¥½çš„ï¼Œ æˆ‘çŽ°åœ¨å¼€å§‹è¿è¡Œç»™æˆ‘çš„ effectè¿è¡Œ () =&gt; { document.title = &#39;You clicked 0 times&#39; }ã€‚çŽ°åœ¨æˆ‘ä»¬å›žé¡¾ä¸€ä¸‹æˆ‘ä»¬ç‚¹å‡»ä¹‹åŽå‘ç”Ÿäº†ä»€ä¹ˆï¼šä½ çš„ç»„ä»¶: å–‚ React, æŠŠæˆ‘çš„çŠ¶æ€è®¾ç½®ä¸º1ã€‚React: ç»™æˆ‘çŠ¶æ€ä¸º 1æ—¶å€™çš„ UIã€‚ä½ çš„ç»„ä»¶:ç»™ä½ éœ€è¦æ¸²æŸ“çš„å†…å®¹: &lt;p&gt;You clicked 1 times&lt;/p&gt;ã€‚è®°å¾—åœ¨æ¸²æŸ“å®Œäº†ä¹‹åŽè°ƒç”¨è¿™ä¸ª effectï¼š () =&gt; { document.title = &#39;You clicked 1 times&#39; }ã€‚React: æ²¡é—®é¢˜ã€‚å¼€å§‹æ›´æ–° UIï¼Œå–‚æµè§ˆå™¨ï¼Œæˆ‘ä¿®æ”¹äº† DOMã€‚Browser: é…·ï¼Œæˆ‘å·²ç»å°†æ›´æ”¹ç»˜åˆ¶åˆ°å±å¹•ä¸Šäº†ã€‚React: å¥½çš„ï¼Œ æˆ‘çŽ°åœ¨å¼€å§‹è¿è¡Œå±žäºŽè¿™æ¬¡æ¸²æŸ“çš„ effectè¿è¡Œ () =&gt; { document.title = &#39;You clicked 1 times&#39; }ã€‚æ¯ä¸€æ¬¡æ¸²æŸ“éƒ½æœ‰å®ƒè‡ªå·±çš„â€¦ æ‰€æœ‰æˆ‘ä»¬çŽ°åœ¨çŸ¥é“ effects ä¼šåœ¨æ¯æ¬¡æ¸²æŸ“åŽè¿è¡Œï¼Œå¹¶ä¸”æ¦‚å¿µä¸Šå®ƒæ˜¯ç»„ä»¶è¾“å‡ºçš„ä¸€éƒ¨åˆ†ï¼Œå¯ä»¥ â€œçœ‹åˆ°â€ å±žäºŽæŸæ¬¡ç‰¹å®šæ¸²æŸ“çš„ props å’Œ stateã€‚æˆ‘ä»¬æ¥åšä¸€ä¸ªæ€æƒ³å®žéªŒï¼Œæ€è€ƒä¸‹é¢çš„ä»£ç ï¼š12345678910111213function Counter() &#123; const [count, setCount] = useState(0); useEffect(() =&gt; &#123; setTimeout(() =&gt; &#123; console.log(`You clicked $&#123;count&#125; times`); &#125;, 3000); &#125;); return ( &lt;div&gt; &lt;p&gt;You clicked &#123;count&#125; times&lt;/p&gt; &lt;button onClick=&#123;() =&gt; setCount(count + 1)&#125;&gt; Click me &lt;/button&gt; &lt;/div&gt; );&#125;å¦‚æžœæˆ‘ç‚¹å‡»äº†å¾ˆå¤šæ¬¡å¹¶ä¸”åœ¨ effect é‡Œè®¾ç½®äº†å»¶æ—¶ï¼Œæ‰“å°å‡ºæ¥çš„ç»“æžœä¼šæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿå‰§é€é¢„è­¦ä½ å¯èƒ½ä¼šè®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªå¾ˆç»•çš„é¢˜å¹¶ä¸”ç»“æžœæ˜¯åç›´è§‰çš„ã€‚å®Œå…¨é”™äº†ï¼æˆ‘ä»¬çœ‹åˆ°çš„å°±æ˜¯é¡ºåºçš„æ‰“å°è¾“å‡º â€” æ¯ä¸€ä¸ªéƒ½å±žäºŽæŸæ¬¡ç‰¹å®šçš„æ¸²æŸ“ï¼Œå› æ­¤æœ‰å®ƒè¯¥æœ‰çš„countå€¼ã€‚ä½ å¯ä»¥è‡ªå·±è¯•ä¸€è¯•ï¼šä½ å¯èƒ½ä¼šæƒ³ï¼šâ€œå®ƒå½“ç„¶åº”è¯¥æ˜¯è¿™æ ·çš„ã€‚å¦åˆ™è¿˜ä¼šæ€Žä¹ˆæ ·å‘¢ï¼Ÿâ€ä¸è¿‡ï¼Œclass ä¸­çš„this.stateå¹¶ä¸æ˜¯è¿™æ ·è¿ä½œçš„ã€‚ä½ å¯èƒ½ä¼šæƒ³å½“ç„¶ä»¥ä¸ºä¸‹é¢çš„ class å®žçŽ°å’Œä¸Šé¢æ˜¯ç›¸ç­‰çš„ï¼š12345componentDidUpdate() &#123; setTimeout(() =&gt; &#123; console.log(`You clicked $&#123;this.state.count&#125; times`); &#125;, 3000);&#125;ç„¶è€Œï¼Œthis.state.countæ€»æ˜¯æŒ‡å‘_æœ€æ–°_çš„ count å€¼ï¼Œè€Œä¸æ˜¯å±žäºŽæŸæ¬¡ç‰¹å®šæ¸²æŸ“çš„å€¼ã€‚æ‰€ä»¥ä½ ä¼šçœ‹åˆ°æ¯æ¬¡æ‰“å°è¾“å‡ºéƒ½æ˜¯5ï¼šæˆ‘è§‰å¾— Hooks è¿™ä¹ˆä¾èµ– Javascript é—­åŒ…æ˜¯æŒºè®½åˆºçš„ä¸€ä»¶äº‹ã€‚æœ‰æ—¶å€™ç»„ä»¶çš„ class å®žçŽ°æ–¹å¼ä¼šå—é—­åŒ…ç›¸å…³çš„è‹¦ï¼ˆthe canonical wrong-value-in-a-timeout confusionï¼‰ï¼Œä½†å…¶å®žè¿™ä¸ªä¾‹å­ä¸­çœŸæ­£çš„æ··ä¹±æ¥æºæ˜¯å¯å˜æ•°æ®ï¼ˆReact ä¿®æ”¹äº† class ä¸­çš„this.stateä½¿å…¶æŒ‡å‘æœ€æ–°çŠ¶æ€ï¼‰ï¼Œå¹¶ä¸æ˜¯é—­åŒ…æœ¬èº«çš„é”™ã€‚å½“å°é—­çš„å€¼å§‹ç»ˆä¸ä¼šå˜çš„æƒ…å†µä¸‹é—­åŒ…æ˜¯éžå¸¸æ£’çš„ã€‚è¿™ä½¿å®ƒä»¬éžå¸¸å®¹æ˜“æ€è€ƒå› ä¸ºä½ æœ¬è´¨ä¸Šåœ¨å¼•ç”¨å¸¸é‡ã€‚æ­£å¦‚æˆ‘ä»¬æ‰€è®¨è®ºçš„ï¼Œprops å’Œ state åœ¨æŸä¸ªç‰¹å®šæ¸²æŸ“ä¸­æ˜¯ä¸ä¼šæ”¹å˜çš„ã€‚é¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨é—­åŒ…ä¿®å¤ä¸Šé¢çš„ class ç‰ˆæœ¬â€¦é€†æ½®è€ŒåŠ¨åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å¯ä»¥æ˜Žç¡®åœ°å–Šå‡ºä¸‹é¢é‡è¦çš„äº‹å®žï¼šæ¯ä¸€ä¸ªç»„ä»¶å†…çš„å‡½æ•°ï¼ˆåŒ…æ‹¬äº‹ä»¶å¤„ç†å‡½æ•°ï¼Œeffectsï¼Œå®šæ—¶å™¨æˆ–è€… API è°ƒç”¨ç­‰ç­‰ï¼‰ä¼šæ•èŽ·æŸæ¬¡æ¸²æŸ“ä¸­å®šä¹‰çš„ props å’Œ stateã€‚æ‰€ä»¥ä¸‹é¢çš„ä¸¤ä¸ªä¾‹å­æ˜¯ç›¸ç­‰çš„ï¼š1234567function Example(props) &#123; useEffect(() =&gt; &#123; setTimeout(() =&gt; &#123; console.log(props.counter); &#125;, 1000); &#125;); &#125;1234567function Example(props) &#123; const counter = props.counter; useEffect(() =&gt; &#123; setTimeout(() =&gt; &#123; console.log(counter); &#125;, 1000); &#125;); &#125;åœ¨ç»„ä»¶å†…ä»€ä¹ˆæ—¶å€™åŽ»è¯»å– props æˆ–è€… state æ˜¯æ— å…³ç´§è¦çš„ã€‚å› ä¸ºå®ƒä»¬ä¸ä¼šæ”¹å˜ã€‚åœ¨å•æ¬¡æ¸²æŸ“çš„èŒƒå›´å†…ï¼Œprops å’Œ state å§‹ç»ˆä¿æŒä¸å˜ã€‚ï¼ˆè§£æž„èµ‹å€¼çš„ props ä½¿å¾—è¿™ä¸€ç‚¹æ›´æ˜Žæ˜¾ã€‚ï¼‰å½“ç„¶ï¼Œæœ‰æ—¶å€™ä½ å¯èƒ½_æƒ³_åœ¨ effect çš„å›žè°ƒå‡½æ•°é‡Œè¯»å–æœ€æ–°çš„å€¼è€Œä¸æ˜¯æ•èŽ·çš„å€¼ã€‚æœ€ç®€å•çš„å®žçŽ°æ–¹æ³•æ˜¯ä½¿ç”¨ refsï¼Œè¿™ç¯‡æ–‡ç« çš„æœ€åŽä¸€éƒ¨åˆ†ä»‹ç»äº†ç›¸å…³å†…å®¹ã€‚éœ€è¦æ³¨æ„çš„æ˜¯å½“ä½ æƒ³è¦ä»Ž_è¿‡åŽ»æ¸²æŸ“ä¸­çš„å‡½æ•°é‡Œè¯»å–æœªæ¥çš„ props å’Œ stateï¼Œä½ æ˜¯åœ¨é€†æ½®è€ŒåŠ¨ã€‚è™½ç„¶å®ƒå¹¶æ²¡æœ‰é”™_ï¼ˆæœ‰æ—¶å€™å¯èƒ½ä¹Ÿéœ€è¦è¿™æ ·åšï¼‰ï¼Œä½†å®ƒå› ä¸ºæ‰“ç ´äº†é»˜è®¤èŒƒå¼ä¼šä½¿ä»£ç æ˜¾å¾—ä¸å¤Ÿ â€œå¹²å‡€â€ã€‚è¿™æ˜¯æˆ‘ä»¬æœ‰æ„ä¸ºä¹‹çš„ï¼Œå› ä¸ºå®ƒèƒ½å¸®åŠ©çªå‡ºå“ªäº›ä»£ç æ˜¯è„†å¼±çš„ï¼Œæ˜¯éœ€è¦ä¾èµ–æ—¶é—´æ¬¡åºçš„ã€‚åœ¨ class ä¸­ï¼Œå¦‚æžœå‘ç”Ÿè¿™ç§æƒ…å†µå°±æ²¡é‚£ä¹ˆæ˜¾è€Œæ˜“è§äº†ã€‚ä¸‹é¢è¿™ä¸ªè®¡æ•°å™¨ç‰ˆæœ¬ æ¨¡æ‹Ÿäº† class ä¸­çš„è¡Œä¸ºï¼š1234567function Example() &#123; const [count, setCount] = useState(0); const latestCount = useRef(count); useEffect(() =&gt; &#123; latestCount.current = count; setTimeout(() =&gt; &#123; console.log(`You clicked $&#123;latestCount.current&#125; times`); &#125;, 3000); &#125;);åœ¨ React ä¸­åŽ»ç›´æŽ¥ä¿®æ”¹å€¼çœ‹ä¸ŠåŽ»æœ‰ç‚¹æ€ªå¼‚ã€‚ç„¶è€Œï¼Œåœ¨ class ç»„ä»¶ä¸­ React æ­£æ˜¯è¿™æ ·åŽ»ä¿®æ”¹this.stateçš„ã€‚ä¸åƒæ•èŽ·çš„ props å’Œ stateï¼Œä½ æ²¡æ³•ä¿è¯åœ¨ä»»æ„ä¸€ä¸ªå›žè°ƒå‡½æ•°ä¸­è¯»å–çš„latestCount.currentæ˜¯ä¸å˜çš„ã€‚æ ¹æ®å®šä¹‰ï¼Œä½ å¯ä»¥éšæ—¶ä¿®æ”¹å®ƒã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå®ƒä¸æ˜¯é»˜è®¤è¡Œä¸ºï¼Œè€Œæ˜¯éœ€è¦ä½ ä¸»åŠ¨é€‰æ‹©è¿™æ ·åšã€‚é‚£ Effect ä¸­çš„æ¸…ç†åˆæ˜¯æ€Žæ ·çš„å‘¢ï¼Ÿåƒ æ–‡æ¡£ä¸­è§£é‡Šçš„, æœ‰äº› effects å¯èƒ½éœ€è¦æœ‰ä¸€ä¸ªæ¸…ç†æ­¥éª¤ã€‚æœ¬è´¨ä¸Šï¼Œå®ƒçš„ç›®çš„æ˜¯æ¶ˆé™¤å‰¯ä½œç”¨ï¼ˆeffect)ï¼Œæ¯”å¦‚å–æ¶ˆè®¢é˜…ã€‚æ€è€ƒä¸‹é¢çš„ä»£ç :123456useEffect(() =&gt; &#123; ChatAPI.subscribeToFriendStatus(props.id, handleStatusChange); return () =&gt; &#123; ChatAPI.unsubscribeFromFriendStatus(props.id, handleStatusChange); &#125;;&#125;);å‡è®¾ç¬¬ä¸€æ¬¡æ¸²æŸ“çš„æ—¶å€™propsæ˜¯{id: 10}ï¼Œç¬¬äºŒæ¬¡æ¸²æŸ“çš„æ—¶å€™æ˜¯{id: 20}ã€‚ä½ _å¯èƒ½_ä¼šè®¤ä¸ºå‘ç”Ÿäº†ä¸‹é¢çš„è¿™äº›äº‹ï¼šReact æ¸…é™¤äº† {id: 10}çš„ effectã€‚React æ¸²æŸ“{id: 20}çš„ UIã€‚React è¿è¡Œ{id: 20}çš„ effectã€‚(äº‹å®žå¹¶ä¸æ˜¯è¿™æ ·ã€‚)å¦‚æžœä¾èµ–è¿™ç§å¿ƒæ™ºæ¨¡åž‹ï¼Œä½ å¯èƒ½ä¼šè®¤ä¸ºæ¸…é™¤è¿‡ç¨‹ â€œçœ‹åˆ°â€ çš„æ˜¯æ—§çš„ props å› ä¸ºå®ƒæ˜¯åœ¨é‡æ–°æ¸²æŸ“ä¹‹å‰è¿è¡Œçš„ï¼Œæ–°çš„ effectâ€œçœ‹åˆ°â€çš„æ˜¯æ–°çš„ props å› ä¸ºå®ƒæ˜¯åœ¨é‡æ–°æ¸²æŸ“ä¹‹åŽè¿è¡Œçš„ã€‚è¿™ç§å¿ƒæ™ºæ¨¡åž‹ç›´æŽ¥æ¥æºäºŽ class ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸã€‚ä¸è¿‡å®ƒå¹¶ä¸ç²¾ç¡®ã€‚è®©æˆ‘ä»¬æ¥ä¸€æŽ¢ç©¶ç«Ÿã€‚React åªä¼šåœ¨æµè§ˆå™¨ç»˜åˆ¶åŽè¿è¡Œ effectsã€‚è¿™ä½¿å¾—ä½ çš„åº”ç”¨æ›´æµç•…å› ä¸ºå¤§å¤šæ•° effects å¹¶ä¸ä¼šé˜»å¡žå±å¹•çš„æ›´æ–°ã€‚Effect çš„æ¸…é™¤åŒæ ·è¢«å»¶è¿Ÿäº†ã€‚ä¸Šä¸€æ¬¡çš„ effect ä¼šåœ¨é‡æ–°æ¸²æŸ“åŽè¢«æ¸…é™¤ï¼šReact æ¸²æŸ“{id: 20}çš„ UIã€‚æµè§ˆå™¨ç»˜åˆ¶ã€‚æˆ‘ä»¬åœ¨å±å¹•ä¸Šçœ‹åˆ°{id: 20}çš„ UIã€‚React æ¸…é™¤{id: 10}çš„ effectã€‚React è¿è¡Œ{id: 20}çš„ effectã€‚ä½ å¯èƒ½ä¼šå¥½å¥‡ï¼šå¦‚æžœæ¸…é™¤ä¸Šä¸€æ¬¡çš„ effect å‘ç”Ÿåœ¨ props å˜æˆ{id: 20}ä¹‹åŽï¼Œé‚£å®ƒä¸ºä»€ä¹ˆè¿˜èƒ½ â€œçœ‹åˆ°â€ æ—§çš„{id: 10}ï¼Ÿä½ æ›¾ç»æ¥è¿‡è¿™é‡Œâ€¦ ðŸ¤”å¼•ç”¨ä¸ŠåŠéƒ¨åˆ†å¾—åˆ°çš„ç»“è®º:ç»„ä»¶å†…çš„æ¯ä¸€ä¸ªå‡½æ•°ï¼ˆåŒ…æ‹¬äº‹ä»¶å¤„ç†å‡½æ•°ï¼Œeffectsï¼Œå®šæ—¶å™¨æˆ–è€… API è°ƒç”¨ç­‰ç­‰ï¼‰ä¼šæ•èŽ·å®šä¹‰å®ƒä»¬çš„é‚£æ¬¡æ¸²æŸ“ä¸­çš„ props å’Œ stateã€‚çŽ°åœ¨ç­”æ¡ˆæ˜¾è€Œæ˜“è§ã€‚effect çš„æ¸…é™¤å¹¶ä¸ä¼šè¯»å– â€œæœ€æ–°â€ çš„ propsã€‚å®ƒåªèƒ½è¯»å–åˆ°å®šä¹‰å®ƒçš„é‚£æ¬¡æ¸²æŸ“ä¸­çš„ props å€¼ï¼š1234567891011121314151617181920212223242526function Example() &#123; useEffect( () =&gt; &#123; ChatAPI.subscribeToFriendStatus(10, handleStatusChange); return () =&gt; &#123; ChatAPI.unsubscribeFromFriendStatus(10, handleStatusChange); &#125;; &#125; ); &#125;function Example() &#123; useEffect( () =&gt; &#123; ChatAPI.subscribeToFriendStatus(20, handleStatusChange); return () =&gt; &#123; ChatAPI.unsubscribeFromFriendStatus(20, handleStatusChange); &#125;; &#125; ); &#125;çŽ‹å›½ä¼šå´›èµ·è½¬è€Œå¤å½’å°˜åœŸï¼Œå¤ªé˜³ä¼šè„±è½å¤–å±‚å˜ä¸ºç™½çŸ®æ˜Ÿï¼Œæœ€åŽçš„æ–‡æ˜Žä¹Ÿè¿Ÿæ—©ä¼šç»“æŸã€‚ä½†æ˜¯ç¬¬ä¸€æ¬¡æ¸²æŸ“ä¸­ effect çš„æ¸…é™¤å‡½æ•°åªèƒ½çœ‹åˆ°{id: 10}è¿™ä¸ª propsã€‚è¿™æ­£æ˜¯ä¸ºä»€ä¹ˆ React èƒ½åšåˆ°åœ¨ç»˜åˆ¶åŽç«‹å³å¤„ç† effects â€” å¹¶ä¸”é»˜è®¤æƒ…å†µä¸‹ä½¿ä½ çš„åº”ç”¨è¿è¡Œæ›´æµç•…ã€‚å¦‚æžœä½ çš„ä»£ç éœ€è¦ä¾ç„¶å¯ä»¥è®¿é—®åˆ°è€çš„ propsã€‚åŒæ­¥ï¼Œ è€Œéžç”Ÿå‘½å‘¨æœŸæˆ‘æœ€å–œæ¬¢ React çš„ä¸€ç‚¹æ˜¯å®ƒç»Ÿä¸€æè¿°äº†åˆå§‹æ¸²æŸ“å’Œä¹‹åŽçš„æ›´æ–°ã€‚è¿™é™ä½Žäº†ä½ ç¨‹åºçš„ç†µã€‚æ¯”å¦‚æˆ‘æœ‰ä¸ªç»„ä»¶åƒä¸‹é¢è¿™æ ·ï¼š1234567function Greeting(&#123; name &#125;) &#123; return ( &lt;h1 class&gt; Hello, &#123;name&#125; &lt;/h1&gt; );&#125;æˆ‘å…ˆæ¸²æŸ“&lt;Greeting /&gt;ç„¶åŽæ¸²æŸ“&lt;Greeting /&gt;ï¼Œå’Œæˆ‘ç›´æŽ¥æ¸²æŸ“&lt;Greeting /&gt;å¹¶æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚åœ¨è¿™ä¸¤ç§æƒ…å†µä¸­ï¼Œæˆ‘æœ€åŽçœ‹åˆ°çš„éƒ½æ˜¯ â€œHello, Yuzhiâ€ã€‚äººä»¬æ€»æ˜¯è¯´ï¼šâ€œé‡è¦çš„æ˜¯æ—…è¡Œè¿‡ç¨‹ï¼Œè€Œä¸æ˜¯ç›®çš„åœ°â€ã€‚åœ¨ React ä¸–ç•Œä¸­ï¼Œæ°å¥½ç›¸åã€‚é‡è¦çš„æ˜¯ç›®çš„ï¼Œè€Œä¸æ˜¯è¿‡ç¨‹ã€‚è¿™å°±æ˜¯ JQuery ä»£ç ä¸­ $.addClass æˆ– $.removeClassè¿™æ ·çš„è°ƒç”¨ï¼ˆè¿‡ç¨‹ï¼‰å’Œ React ä»£ç ä¸­å£°æ˜Ž CSS ç±»ååº”è¯¥æ˜¯ä»€ä¹ˆï¼ˆç›®çš„ï¼‰ä¹‹é—´çš„åŒºåˆ«ã€‚React ä¼šæ ¹æ®æˆ‘ä»¬å½“å‰çš„ props å’Œ state åŒæ­¥åˆ° DOMã€‚â€œmountâ€å’Œ â€œupdateâ€ ä¹‹äºŽæ¸²æŸ“å¹¶æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚ä½ åº”è¯¥ä»¥ç›¸åŒçš„æ–¹å¼åŽ»æ€è€ƒ effectsã€‚useEffectä½¿ä½ èƒ½å¤Ÿæ ¹æ® props å’Œ state _åŒæ­¥_ React tree ä¹‹å¤–çš„ä¸œè¥¿ã€‚1234567function Greeting(&#123; name &#125;) &#123; useEffect(() =&gt; &#123; document.title = &apos;Hello, &apos; + name; &#125;); return ( &lt;h1 class&gt; Hello, &#123;name&#125; &lt;/h1&gt; );&#125;è¿™å°±æ˜¯å’Œå¤§å®¶ç†ŸçŸ¥çš„ mount/update/unmount å¿ƒæ™ºæ¨¡åž‹ä¹‹é—´ç»†å¾®çš„åŒºåˆ«ã€‚ç†è§£å’Œå†…åŒ–è¿™ç§åŒºåˆ«æ˜¯éžå¸¸é‡è¦çš„ã€‚å¦‚æžœä½ è¯•å›¾å†™ä¸€ä¸ª effect ä¼šæ ¹æ®æ˜¯å¦ç¬¬ä¸€æ¬¡æ¸²æŸ“è€Œè¡¨çŽ°ä¸ä¸€è‡´ï¼Œä½ æ­£åœ¨é€†æ½®è€ŒåŠ¨ã€‚å¦‚æžœæˆ‘ä»¬çš„ç»“æžœä¾èµ–äºŽè¿‡ç¨‹è€Œä¸æ˜¯ç›®çš„ï¼Œæˆ‘ä»¬ä¼šåœ¨åŒæ­¥ä¸­çŠ¯é”™ã€‚å…ˆæ¸²æŸ“å±žæ€§ Aï¼ŒB å†æ¸²æŸ“ Cï¼Œå’Œç«‹å³æ¸²æŸ“ C å¹¶æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚è™½ç„¶ä»–ä»¬å¯èƒ½çŸ­æš‚åœ°ä¼šæœ‰ç‚¹ä¸åŒï¼ˆæ¯”å¦‚è¯·æ±‚æ•°æ®æ—¶ï¼‰ï¼Œä½†æœ€ç»ˆçš„ç»“æžœæ˜¯ä¸€æ ·çš„ã€‚ä¸è¿‡è¯è¯´å›žæ¥ï¼Œåœ¨æ¯ä¸€æ¬¡æ¸²æŸ“åŽéƒ½åŽ»è¿è¡Œæ‰€æœ‰çš„ effects å¯èƒ½å¹¶ä¸é«˜æ•ˆã€‚ï¼ˆå¹¶ä¸”åœ¨æŸäº›åœºæ™¯ä¸‹ï¼Œå®ƒå¯èƒ½ä¼šå¯¼è‡´æ— é™å¾ªçŽ¯ã€‚ï¼‰æ‰€ä»¥æˆ‘ä»¬è¯¥æ€Žä¹ˆè§£å†³è¿™ä¸ªé—®é¢˜ï¼Ÿå‘Šè¯‰ React åŽ»æ¯”å¯¹ä½ çš„ Effectså…¶å®žæˆ‘ä»¬å·²ç»ä»Ž React å¤„ç† DOM çš„æ–¹å¼ä¸­å­¦ä¹ åˆ°äº†è§£å†³åŠžæ³•ã€‚React åªä¼šæ›´æ–° DOM çœŸæ­£å‘ç”Ÿæ”¹å˜çš„éƒ¨åˆ†ï¼Œè€Œä¸æ˜¯æ¯æ¬¡æ¸²æŸ“éƒ½å¤§åŠ¨å¹²æˆˆã€‚å½“ä½ æŠŠ123&lt;h1 class&gt; Hello, Dan&lt;/h1&gt;æ›´æ–°åˆ°123&lt;h1 class&gt; Hello, Yuzhi&lt;/h1&gt;React èƒ½å¤Ÿçœ‹åˆ°ä¸¤ä¸ªå¯¹è±¡:12const oldProps = &#123;className: &apos;Greeting&apos;, children: &apos;Hello, Dan&apos;&#125;;const newProps = &#123;className: &apos;Greeting&apos;, children: &apos;Hello, Yuzhi&apos;&#125;;å®ƒä¼šæ£€æµ‹æ¯ä¸€ä¸ª propsï¼Œå¹¶ä¸”å‘çŽ°childrenå‘ç”Ÿæ”¹å˜éœ€è¦æ›´æ–° DOMï¼Œä½†classNameå¹¶æ²¡æœ‰ã€‚æ‰€ä»¥å®ƒåªéœ€è¦è¿™æ ·åšï¼š1domNode.innerText = &apos;Hello, Yuzhi&apos;;æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨ç±»ä¼¼çš„æ–¹å¼å¤„ç† effects å—ï¼Ÿå¦‚æžœèƒ½å¤Ÿåœ¨ä¸éœ€è¦çš„æ—¶å€™é¿å…è°ƒç”¨ effect å°±å¤ªå¥½äº†ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬çš„ç»„ä»¶å¯èƒ½å› ä¸ºçŠ¶æ€å˜æ›´è€Œé‡æ–°æ¸²æŸ“ï¼š12345678910111213function Greeting(&#123; name &#125;) &#123; const [counter, setCounter] = useState(0); useEffect(() =&gt; &#123; document.title = &apos;Hello, &apos; + name; &#125;); return ( &lt;h1 class&gt; Hello, &#123;name&#125; &lt;button onClick=&#123;() =&gt; setCounter(counter + 1)&#125;&gt; Increment &lt;/button&gt; &lt;/h1&gt; );&#125;ä½†æ˜¯æˆ‘ä»¬çš„ effect å¹¶æ²¡æœ‰ä½¿ç”¨counterè¿™ä¸ªçŠ¶æ€ã€‚æˆ‘ä»¬çš„ effect åªä¼šåŒæ­¥nameå±žæ€§ç»™document.titleï¼Œä½†nameå¹¶æ²¡æœ‰å˜ã€‚åœ¨æ¯ä¸€æ¬¡ counter æ”¹å˜åŽé‡æ–°ç»™document.titleèµ‹å€¼å¹¶ä¸æ˜¯ç†æƒ³çš„åšæ³•ã€‚å¥½äº†ï¼Œé‚£ React å¯ä»¥â€¦ åŒºåˆ† effects çš„ä¸åŒå—ï¼Ÿ12let oldEffect = () =&gt; &#123; document.title = &apos;Hello, Dan&apos;; &#125;;let newEffect = () =&gt; &#123; document.title = &apos;Hello, Dan&apos;; &#125;;å¹¶ä¸èƒ½ã€‚React å¹¶ä¸èƒ½çŒœæµ‹åˆ°å‡½æ•°åšäº†ä»€ä¹ˆå¦‚æžœä¸å…ˆè°ƒç”¨çš„è¯ã€‚ï¼ˆæºç ä¸­å¹¶æ²¡æœ‰åŒ…å«ç‰¹æ®Šçš„å€¼ï¼Œå®ƒä»…ä»…æ˜¯å¼•ç”¨äº†nameå±žæ€§ã€‚ï¼‰è¿™æ˜¯ä¸ºä»€ä¹ˆä½ å¦‚æžœæƒ³è¦é¿å… effects ä¸å¿…è¦çš„é‡å¤è°ƒç”¨ï¼Œä½ å¯ä»¥æä¾›ç»™useEffectä¸€ä¸ªä¾èµ–æ•°ç»„å‚æ•° (deps)ï¼š123useEffect(() =&gt; &#123; document.title = &apos;Hello, &apos; + name;&#125;, [name]);è¿™å¥½æ¯”ä½ å‘Šè¯‰ Reactï¼šâ€œHeyï¼Œæˆ‘çŸ¥é“ä½ çœ‹ä¸åˆ°è¿™ä¸ªå‡½æ•°é‡Œçš„ä¸œè¥¿ï¼Œä½†æˆ‘å¯ä»¥ä¿è¯åªä½¿ç”¨äº†æ¸²æŸ“ä¸­çš„nameï¼Œåˆ«æ— å…¶ä»–ã€‚â€å¦‚æžœå½“å‰æ¸²æŸ“ä¸­çš„è¿™äº›ä¾èµ–é¡¹å’Œä¸Šä¸€æ¬¡è¿è¡Œè¿™ä¸ª effect çš„æ—¶å€™å€¼ä¸€æ ·ï¼Œå› ä¸ºæ²¡æœ‰ä»€ä¹ˆéœ€è¦åŒæ­¥ React ä¼šè‡ªåŠ¨è·³è¿‡è¿™æ¬¡ effectï¼š12345const oldEffect = () =&gt; &#123; document.title = &apos;Hello, Dan&apos;; &#125;;const oldDeps = [&apos;Dan&apos;];const newEffect = () =&gt; &#123; document.title = &apos;Hello, Dan&apos;; &#125;;const newDeps = [&apos;Dan&apos;];å³ä½¿ä¾èµ–æ•°ç»„ä¸­åªæœ‰ä¸€ä¸ªå€¼åœ¨ä¸¤æ¬¡æ¸²æŸ“ä¸­ä¸ä¸€æ ·ï¼Œæˆ‘ä»¬ä¹Ÿä¸èƒ½è·³è¿‡ effect çš„è¿è¡Œã€‚è¦åŒæ­¥æ‰€æœ‰ï¼å…³äºŽä¾èµ–é¡¹ä¸è¦å¯¹ React æ’’è°Žå…³äºŽä¾èµ–é¡¹å¯¹ React æ’’è°Žä¼šæœ‰ä¸å¥½çš„ç»“æžœã€‚ç›´è§‰ä¸Šï¼Œè¿™å¾ˆå¥½ç†è§£ï¼Œä½†æˆ‘æ›¾çœ‹åˆ°å‡ ä¹Žæ‰€æœ‰ä¾èµ– class å¿ƒæ™ºæ¨¡åž‹ä½¿ç”¨useEffectçš„äººéƒ½è¯•å›¾è¿åè¿™ä¸ªè§„åˆ™ã€‚ï¼ˆæˆ‘åˆšå¼€å§‹ä¹Ÿè¿™ä¹ˆå¹²äº†ï¼ï¼‰1234567891011function SearchResults() &#123; async function fetchData() &#123; &#125; useEffect(() =&gt; &#123; fetchData(); &#125;, []); &#125;(å®˜ç½‘çš„ Hooks FAQ è§£é‡Šäº†åº”è¯¥æ€Žä¹ˆåšã€‚ æˆ‘ä»¬åœ¨ä¸‹é¢ä¼šé‡æ–°å›žé¡¾è¿™ä¸ªä¾‹å­ã€‚)â€œä½†æˆ‘åªæ˜¯æƒ³åœ¨æŒ‚è½½çš„æ—¶å€™è¿è¡Œå®ƒï¼â€ï¼Œä½ å¯èƒ½ä¼šè¯´ã€‚çŽ°åœ¨åªéœ€è¦è®°ä½ï¼šå¦‚æžœä½ è®¾ç½®äº†ä¾èµ–é¡¹ï¼Œeffect ä¸­ç”¨åˆ°çš„æ‰€æœ‰ç»„ä»¶å†…çš„å€¼éƒ½è¦åŒ…å«åœ¨ä¾èµ–ä¸­ã€‚è¿™åŒ…æ‹¬ propsï¼Œstateï¼Œå‡½æ•° â€” ç»„ä»¶å†…çš„ä»»ä½•ä¸œè¥¿ã€‚æœ‰æ—¶å€™ä½ æ˜¯è¿™æ ·åšäº†ï¼Œä½†å¯èƒ½ä¼šå¼•èµ·ä¸€ä¸ªé—®é¢˜ã€‚æ¯”å¦‚ï¼Œä½ å¯èƒ½ä¼šé‡åˆ°æ— é™è¯·æ±‚çš„é—®é¢˜ï¼Œæˆ–è€… socket è¢«é¢‘ç¹åˆ›å»ºçš„é—®é¢˜ã€‚è§£å†³é—®é¢˜çš„æ–¹æ³•ä¸æ˜¯ç§»é™¤ä¾èµ–é¡¹ã€‚æˆ‘ä»¬ä¼šå¾ˆå¿«äº†è§£å…·ä½“çš„è§£å†³æ–¹æ¡ˆã€‚ä¸è¿‡åœ¨æˆ‘ä»¬æ·±å…¥è§£å†³æ–¹æ¡ˆä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆå°è¯•æ›´å¥½åœ°ç†è§£é—®é¢˜ã€‚å¦‚æžœè®¾ç½®äº†é”™è¯¯çš„ä¾èµ–ä¼šæ€Žä¹ˆæ ·å‘¢ï¼Ÿå¦‚æžœä¾èµ–é¡¹åŒ…å«äº†æ‰€æœ‰ effect ä¸­ä½¿ç”¨åˆ°çš„å€¼ï¼ŒReact å°±èƒ½çŸ¥é“ä½•æ—¶éœ€è¦è¿è¡Œå®ƒï¼š123useEffect(() =&gt; &#123; document.title = &apos;Hello, &apos; + name;&#125;, [name]);(ä¾èµ–å‘ç”Ÿäº†å˜æ›´ï¼Œæ‰€ä»¥ä¼šé‡æ–°è¿è¡Œ effectã€‚)ä½†æ˜¯å¦‚æžœæˆ‘ä»¬å°†[]è®¾ä¸º effect çš„ä¾èµ–ï¼Œæ–°çš„ effect å‡½æ•°ä¸ä¼šè¿è¡Œï¼š123useEffect(() =&gt; &#123; document.title = &apos;Hello, &apos; + name;&#125;, []);(ä¾èµ–æ²¡æœ‰å˜ï¼Œæ‰€ä»¥ä¸ä¼šå†æ¬¡è¿è¡Œ effectã€‚)åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œé—®é¢˜çœ‹èµ·æ¥æ˜¾è€Œæ˜“è§ã€‚ä½†åœ¨æŸäº›æƒ…å†µä¸‹å¦‚æžœä½ è„‘å­é‡Œ â€œè·³å‡ºâ€class ç»„ä»¶çš„è§£å†³åŠžæ³•ï¼Œä½ çš„ç›´è§‰å¾ˆå¯èƒ½ä¼šæ¬ºéª—ä½ ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬æ¥å†™ä¸€ä¸ªæ¯ç§’é€’å¢žçš„è®¡æ•°å™¨ã€‚åœ¨ Class ç»„ä»¶ä¸­ï¼Œæˆ‘ä»¬çš„ç›´è§‰æ˜¯ï¼šâ€œå¼€å¯ä¸€æ¬¡å®šæ—¶å™¨ï¼Œæ¸…é™¤ä¹Ÿæ˜¯ä¸€æ¬¡â€ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªä¾‹å­è¯´æ˜Žæ€Žä¹ˆå®žçŽ°å®ƒã€‚å½“æˆ‘ä»¬ç†æ‰€å½“ç„¶åœ°æŠŠå®ƒç”¨useEffectçš„æ–¹å¼ç¿»è¯‘ï¼Œç›´è§‰ä¸Šæˆ‘ä»¬ä¼šè®¾ç½®ä¾èµ–ä¸º[]ã€‚â€œæˆ‘åªæƒ³è¿è¡Œä¸€æ¬¡ effectâ€ï¼Œå¯¹å—ï¼Ÿ1234567891011function Counter() &#123; const [count, setCount] = useState(0); useEffect(() =&gt; &#123; const id = setInterval(() =&gt; &#123; setCount(count + 1); &#125;, 1000); return () =&gt; clearInterval(id); &#125;, []); return &lt;h1&gt;&#123;count&#125;&lt;/h1&gt;;&#125;ç„¶è€Œï¼Œè¿™ä¸ªä¾‹å­åªä¼šé€’å¢žä¸€æ¬¡ã€‚å¤©äº†å™œã€‚å¦‚æžœä½ çš„å¿ƒæ™ºæ¨¡åž‹æ˜¯ â€œåªæœ‰å½“æˆ‘æƒ³é‡æ–°è§¦å‘ effect çš„æ—¶å€™æ‰éœ€è¦åŽ»è®¾ç½®ä¾èµ–â€ï¼Œè¿™ä¸ªä¾‹å­å¯èƒ½ä¼šè®©ä½ äº§ç”Ÿå­˜åœ¨å±æœºã€‚ä½ æƒ³è¦è§¦å‘ä¸€æ¬¡å› ä¸ºå®ƒæ˜¯å®šæ—¶å™¨ â€” ä½†ä¸ºä»€ä¹ˆä¼šæœ‰é—®é¢˜ï¼Ÿå¦‚æžœä½ çŸ¥é“ä¾èµ–æ˜¯æˆ‘ä»¬ç»™ React çš„æš—ç¤ºï¼Œå‘Šè¯‰å®ƒ effect æ‰€æœ‰éœ€è¦ä½¿ç”¨çš„æ¸²æŸ“ä¸­çš„å€¼ï¼Œä½ å°±ä¸ä¼šåƒæƒŠäº†ã€‚effect ä¸­ä½¿ç”¨äº†countä½†æˆ‘ä»¬æ’’è°Žè¯´å®ƒæ²¡æœ‰ä¾èµ–ã€‚å¦‚æžœæˆ‘ä»¬è¿™æ ·åšè¿Ÿæ—©ä¼šå‡ºå¹ºè›¾å­ã€‚åœ¨ç¬¬ä¸€æ¬¡æ¸²æŸ“ä¸­ï¼Œcountæ˜¯0ã€‚å› æ­¤ï¼ŒsetCount(count + 1)åœ¨ç¬¬ä¸€æ¬¡æ¸²æŸ“ä¸­ç­‰ä»·äºŽsetCount(0 + 1)ã€‚æ—¢ç„¶æˆ‘ä»¬è®¾ç½®äº†[]ä¾èµ–ï¼Œeffect ä¸ä¼šå†é‡æ–°è¿è¡Œï¼Œå®ƒåŽé¢æ¯ä¸€ç§’éƒ½ä¼šè°ƒç”¨setCount(0 + 1) ï¼š123456789101112131415161718192021222324252627function Counter() &#123; useEffect( () =&gt; &#123; const id = setInterval(() =&gt; &#123; setCount(0 + 1); &#125;, 1000); return () =&gt; clearInterval(id); &#125;, [] ); &#125;function Counter() &#123; useEffect( () =&gt; &#123; const id = setInterval(() =&gt; &#123; setCount(1 + 1); &#125;, 1000); return () =&gt; clearInterval(id); &#125;, [] ); &#125;æˆ‘ä»¬å¯¹ React æ’’è°Žè¯´æˆ‘ä»¬çš„ effect ä¸ä¾èµ–ç»„ä»¶å†…çš„ä»»ä½•å€¼ï¼Œå¯å®žé™…ä¸Šæˆ‘ä»¬çš„ effect æœ‰ä¾èµ–ï¼æˆ‘ä»¬çš„ effect ä¾èµ–count - å®ƒæ˜¯ç»„ä»¶å†…çš„å€¼ï¼ˆä¸è¿‡åœ¨ effect å¤–é¢å®šä¹‰ï¼‰ï¼š123456const count = useEffect(() =&gt; &#123; const id = setInterval(() =&gt; &#123; setCount(count + 1); &#125;, 1000); return () =&gt; clearInterval(id);&#125;, []);å› æ­¤ï¼Œè®¾ç½®[]ä¸ºä¾èµ–ä¼šå¼•å…¥ä¸€ä¸ª bugã€‚React ä¼šå¯¹æ¯”ä¾èµ–ï¼Œå¹¶ä¸”è·³è¿‡åŽé¢çš„ effectï¼š(ä¾èµ–æ²¡æœ‰å˜ï¼Œæ‰€ä»¥ä¸ä¼šå†æ¬¡è¿è¡Œ effectã€‚)ç±»ä¼¼äºŽè¿™æ ·çš„é—®é¢˜æ˜¯å¾ˆéš¾è¢«æƒ³åˆ°çš„ã€‚å› æ­¤ï¼Œæˆ‘é¼“åŠ±ä½ å°†è¯šå®žåœ°å‘ŠçŸ¥ effect ä¾èµ–ä½œä¸ºä¸€æ¡ç¡¬æ€§è§„åˆ™ï¼Œå¹¶ä¸”è¦åˆ—å‡ºæ‰€ä»¥ä¾èµ–ã€‚ï¼ˆæˆ‘ä»¬æä¾›äº†ä¸€ä¸ª lint è§„åˆ™å¦‚æžœä½ æƒ³åœ¨ä½ çš„å›¢é˜Ÿå†…åšç¡¬æ€§è§„å®šã€‚ï¼‰ä¸¤ç§è¯šå®žå‘ŠçŸ¥ä¾èµ–çš„æ–¹æ³•æœ‰ä¸¤ç§è¯šå®žå‘ŠçŸ¥ä¾èµ–çš„ç­–ç•¥ã€‚ä½ åº”è¯¥ä»Žç¬¬ä¸€ç§å¼€å§‹ï¼Œç„¶åŽåœ¨éœ€è¦çš„æ—¶å€™åº”ç”¨ç¬¬äºŒç§ã€‚ç¬¬ä¸€ç§ç­–ç•¥æ˜¯åœ¨ä¾èµ–ä¸­åŒ…å«æ‰€æœ‰ effect ä¸­ç”¨åˆ°çš„ç»„ä»¶å†…çš„å€¼ã€‚è®©æˆ‘ä»¬åœ¨ä¾èµ–ä¸­åŒ…å«countï¼š12345useEffect(() =&gt; &#123; const id = setInterval(() =&gt; &#123; setCount(count + 1); &#125;, 1000); return () =&gt; clearInterval(id);&#125;, [count]);çŽ°åœ¨ä¾èµ–æ•°ç»„æ­£ç¡®äº†ã€‚è™½ç„¶å®ƒå¯èƒ½ä¸æ˜¯å¤ªç†æƒ³ä½†ç¡®å®žè§£å†³äº†ä¸Šé¢çš„é—®é¢˜ã€‚çŽ°åœ¨ï¼Œæ¯æ¬¡countä¿®æ”¹éƒ½ä¼šé‡æ–°è¿è¡Œ effectï¼Œå¹¶ä¸”å®šæ—¶å™¨ä¸­çš„setCount(count + 1)ä¼šæ­£ç¡®å¼•ç”¨æŸæ¬¡æ¸²æŸ“ä¸­çš„ countå€¼ï¼š1234567891011121314151617181920212223242526function Counter() &#123; useEffect( () =&gt; &#123; const id = setInterval(() =&gt; &#123; setCount(0 + 1); &#125;, 1000); return () =&gt; clearInterval(id); &#125;, [0] ); &#125;function Counter() &#123; useEffect( () =&gt; &#123; const id = setInterval(() =&gt; &#123; setCount(1 + 1); &#125;, 1000); return () =&gt; clearInterval(id); &#125;, [1] ); &#125;è¿™èƒ½è§£å†³é—®é¢˜ä½†æ˜¯æˆ‘ä»¬çš„å®šæ—¶å™¨ä¼šåœ¨æ¯ä¸€æ¬¡countæ”¹å˜åŽæ¸…é™¤å’Œé‡æ–°è®¾å®šã€‚è¿™åº”è¯¥ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ç»“æžœï¼š(ä¾èµ–å‘ç”Ÿäº†å˜æ›´ï¼Œæ‰€ä»¥ä¼šé‡æ–°è¿è¡Œ effectã€‚)ç¬¬äºŒç§ç­–ç•¥æ˜¯ä¿®æ”¹ effect å†…éƒ¨çš„ä»£ç ä»¥ç¡®ä¿å®ƒåŒ…å«çš„å€¼åªä¼šåœ¨éœ€è¦çš„æ—¶å€™å‘ç”Ÿå˜æ›´ã€‚æˆ‘ä»¬ä¸æƒ³å‘ŠçŸ¥é”™è¯¯çš„ä¾èµ– - æˆ‘ä»¬åªæ˜¯ä¿®æ”¹ effect ä½¿å¾—ä¾èµ–æ›´å°‘ã€‚è®©æˆ‘ä»¬æ¥çœ‹ä¸€äº›ç§»é™¤ä¾èµ–çš„å¸¸ç”¨æŠ€å·§ã€‚è®© Effects è‡ªç»™è‡ªè¶³æˆ‘ä»¬æƒ³åŽ»æŽ‰ effect çš„countä¾èµ–ã€‚12345useEffect(() =&gt; &#123; const id = setInterval(() =&gt; &#123; setCount(count + 1); &#125;, 1000); return () =&gt; clearInterval(id);&#125;, [count]);ä¸ºäº†å®žçŽ°è¿™ä¸ªç›®çš„ï¼Œæˆ‘ä»¬éœ€è¦é—®è‡ªå·±ä¸€ä¸ªé—®é¢˜ï¼šæˆ‘ä»¬ä¸ºä»€ä¹ˆè¦ç”¨countï¼Ÿå¯ä»¥çœ‹åˆ°æˆ‘ä»¬åªåœ¨setCountè°ƒç”¨ä¸­ç”¨åˆ°äº†countã€‚åœ¨è¿™ä¸ªåœºæ™¯ä¸­ï¼Œæˆ‘ä»¬å…¶å®žå¹¶ä¸éœ€è¦åœ¨ effect ä¸­ä½¿ç”¨countã€‚å½“æˆ‘ä»¬æƒ³è¦æ ¹æ®å‰ä¸€ä¸ªçŠ¶æ€æ›´æ–°çŠ¶æ€çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨setStateçš„å‡½æ•°å½¢å¼ï¼š12345useEffect(() =&gt; &#123; const id = setInterval(() =&gt; &#123; setCount(c =&gt; c + 1); &#125;, 1000); return () =&gt; clearInterval(id);&#125;, []);æˆ‘å–œæ¬¢æŠŠç±»ä¼¼è¿™ç§æƒ…å†µç§°ä¸º â€œé”™è¯¯çš„ä¾èµ–â€ã€‚æ˜¯çš„ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨ effect ä¸­å†™äº†setCount(count + 1)æ‰€ä»¥countæ˜¯ä¸€ä¸ªå¿…éœ€çš„ä¾èµ–ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬çœŸæ­£æƒ³è¦çš„æ˜¯æŠŠcountè½¬æ¢ä¸ºcount+1ï¼Œç„¶åŽè¿”å›žç»™ Reactã€‚å¯æ˜¯ React å…¶å®žå·²ç»çŸ¥é“å½“å‰çš„countã€‚æˆ‘ä»¬éœ€è¦å‘ŠçŸ¥ React çš„ä»…ä»…æ˜¯åŽ»é€’å¢žçŠ¶æ€ - ä¸ç®¡å®ƒçŽ°åœ¨å…·ä½“æ˜¯ä»€ä¹ˆå€¼ã€‚è¿™æ­£æ˜¯setCount(c =&gt; c + 1)åšçš„äº‹æƒ…ã€‚ä½ å¯ä»¥è®¤ä¸ºå®ƒæ˜¯åœ¨ç»™ Reactâ€œå‘é€æŒ‡ä»¤â€å‘ŠçŸ¥å¦‚ä½•æ›´æ–°çŠ¶æ€ã€‚è¿™ç§ â€œæ›´æ–°å½¢å¼â€ åœ¨å…¶ä»–æƒ…å†µä¸‹ä¹Ÿæœ‰å¸®åŠ©ï¼Œæ¯”å¦‚ä½ éœ€è¦æ‰¹é‡æ›´æ–°ã€‚æ³¨æ„æˆ‘ä»¬åšåˆ°äº†ç§»é™¤ä¾èµ–ï¼Œå¹¶ä¸”æ²¡æœ‰æ’’è°Žã€‚æˆ‘ä»¬çš„ effect ä¸å†è¯»å–æ¸²æŸ“ä¸­çš„countå€¼ã€‚(ä¾èµ–æ²¡æœ‰å˜ï¼Œæ‰€ä»¥ä¸ä¼šå†æ¬¡è¿è¡Œ effectã€‚)ä½ å¯ä»¥è‡ªå·± è¯•è¯•ã€‚å°½ç®¡ effect åªè¿è¡Œäº†ä¸€æ¬¡ï¼Œç¬¬ä¸€æ¬¡æ¸²æŸ“ä¸­çš„å®šæ—¶å™¨å›žè°ƒå‡½æ•°å¯ä»¥å®Œç¾Žåœ°åœ¨æ¯æ¬¡è§¦å‘çš„æ—¶å€™ç»™ React å‘é€c =&gt; c + 1æ›´æ–°æŒ‡ä»¤ã€‚å®ƒä¸å†éœ€è¦çŸ¥é“å½“å‰çš„countå€¼ã€‚å› ä¸º React å·²ç»çŸ¥é“äº†ã€‚å‡½æ•°å¼æ›´æ–° å’Œ Google Docsè¿˜è®°å¾—æˆ‘ä»¬è¯´è¿‡åŒæ­¥æ‰æ˜¯ç†è§£ effects çš„å¿ƒæ™ºæ¨¡åž‹å—ï¼ŸåŒæ­¥çš„ä¸€ä¸ªæœ‰è¶£åœ°æ–¹åœ¨äºŽä½ é€šå¸¸æƒ³è¦æŠŠåŒæ­¥çš„ â€œä¿¡æ¯â€ å’ŒçŠ¶æ€è§£è€¦ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå½“ä½ åœ¨ Google Docs ç¼–è¾‘æ–‡æ¡£çš„æ—¶å€™ï¼ŒGoogle å¹¶ä¸ä¼šæŠŠæ•´ç¯‡æ–‡ç« å‘é€ç»™æœåŠ¡å™¨ã€‚é‚£æ ·åšä¼šéžå¸¸ä½Žæ•ˆã€‚ç›¸åçš„ï¼Œå®ƒåªæ˜¯æŠŠä½ çš„ä¿®æ”¹ä»¥ä¸€ç§å½¢å¼å‘é€ç»™æœåŠ¡ç«¯ã€‚è™½ç„¶æˆ‘ä»¬ effect çš„æƒ…å†µä¸å°½ç›¸åŒï¼Œä½†å¯ä»¥åº”ç”¨ç±»ä¼¼çš„æ€æƒ³ã€‚åªåœ¨ effects ä¸­ä¼ é€’æœ€å°çš„ä¿¡æ¯ä¼šå¾ˆæœ‰å¸®åŠ©ã€‚ç±»ä¼¼äºŽsetCount(c =&gt; c + 1)è¿™æ ·çš„æ›´æ–°å½¢å¼æ¯”setCount(count + 1)ä¼ é€’äº†æ›´å°‘çš„ä¿¡æ¯ï¼Œå› ä¸ºå®ƒä¸å†è¢«å½“å‰çš„ count å€¼ â€œæ±¡æŸ“â€ã€‚å®ƒåªæ˜¯è¡¨è¾¾äº†ä¸€ç§è¡Œä¸ºï¼ˆâ€œé€’å¢žâ€ï¼‰ã€‚â€œThinking in Reactâ€ ä¹Ÿè®¨è®ºäº†å¦‚ä½•æ‰¾åˆ°æœ€å°çŠ¶æ€ã€‚åŽŸåˆ™æ˜¯ç±»ä¼¼çš„ï¼Œåªä¸è¿‡çŽ°åœ¨å…³æ³¨çš„æ˜¯å¦‚ä½•æ›´æ–°ã€‚è¡¨è¾¾_æ„å›¾_ï¼ˆè€Œä¸æ˜¯ç»“æžœï¼‰å’Œ Google Docs å¦‚ä½•å¤„ç†å…±åŒç¼–è¾‘å¼‚æ›²åŒå·¥ã€‚è™½ç„¶è¿™ä¸ªç±»æ¯”ç•¥å¾®å»¶ä¼¸äº†ä¸€ç‚¹ï¼Œå‡½æ•°å¼æ›´æ–°åœ¨ React ä¸­æ‰®æ¼”äº†ç±»ä¼¼çš„è§’è‰²ã€‚å®ƒä»¬ç¡®ä¿èƒ½ä»¥æ‰¹é‡åœ°å’Œå¯é¢„æµ‹çš„æ–¹å¼æ¥å¤„ç†å„ç§æºå¤´ï¼ˆäº‹ä»¶å¤„ç†å‡½æ•°ï¼Œeffect ä¸­çš„è®¢é˜…ï¼Œç­‰ç­‰ï¼‰çš„çŠ¶æ€æ›´æ–°ã€‚ç„¶è€Œï¼Œå³ä½¿æ˜¯setCount(c =&gt; c + 1)ä¹Ÿå¹¶ä¸å®Œç¾Žã€‚å®ƒçœ‹èµ·æ¥æœ‰ç‚¹æ€ªï¼Œå¹¶ä¸”éžå¸¸å—é™äºŽå®ƒèƒ½åšçš„äº‹ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æžœæˆ‘ä»¬æœ‰ä¸¤ä¸ªäº’ç›¸ä¾èµ–çš„çŠ¶æ€ï¼Œæˆ–è€…æˆ‘ä»¬æƒ³åŸºäºŽä¸€ä¸ª prop æ¥è®¡ç®—ä¸‹ä¸€æ¬¡çš„ stateï¼Œå®ƒå¹¶ä¸èƒ½åšåˆ°ã€‚å¹¸è¿çš„æ˜¯ï¼Œ setCount(c =&gt; c + 1)æœ‰ä¸€ä¸ªæ›´å¼ºå¤§çš„å§å¦¹æ¨¡å¼ï¼Œå®ƒçš„åå­—å«useReducerã€‚è§£è€¦æ¥è‡ª Actions çš„æ›´æ–°æˆ‘ä»¬æ¥ä¿®æ”¹ä¸Šé¢çš„ä¾‹å­è®©å®ƒåŒ…å«ä¸¤ä¸ªçŠ¶æ€ï¼šcount å’Œ stepã€‚æˆ‘ä»¬çš„å®šæ—¶å™¨ä¼šæ¯æ¬¡åœ¨ count ä¸Šå¢žåŠ ä¸€ä¸ªstepå€¼ï¼š12345678910111213141516function Counter() &#123; const [count, setCount] = useState(0); const [step, setStep] = useState(1); useEffect(() =&gt; &#123; const id = setInterval(() =&gt; &#123; setCount(c =&gt; c + step); &#125;, 1000); return () =&gt; clearInterval(id); &#125;, [step]); return ( &lt;&gt; &lt;h1&gt;&#123;count&#125;&lt;/h1&gt; &lt;input value=&#123;step&#125; onChange=&#123;e =&gt; setStep(Number(e.target.value))&#125; /&gt; &lt;/&gt; );&#125;(è¿™é‡Œæ˜¯ demo.)æ³¨æ„æˆ‘ä»¬æ²¡æœ‰æ’’è°Žã€‚æ—¢ç„¶æˆ‘ä»¬åœ¨ effect é‡Œä½¿ç”¨äº†stepï¼Œæˆ‘ä»¬å°±æŠŠå®ƒåŠ åˆ°ä¾èµ–é‡Œã€‚æ‰€ä»¥è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä»£ç èƒ½è¿è¡Œæ­£ç¡®ã€‚è¿™ä¸ªä¾‹å­ç›®å‰çš„è¡Œä¸ºæ˜¯ä¿®æ”¹stepä¼šé‡å¯å®šæ—¶å™¨ - å› ä¸ºå®ƒæ˜¯ä¾èµ–é¡¹ä¹‹ä¸€ã€‚åœ¨å¤§å¤šæ•°åœºæ™¯ä¸‹ï¼Œè¿™æ­£æ˜¯ä½ æ‰€éœ€è¦çš„ã€‚æ¸…é™¤ä¸Šä¸€æ¬¡çš„ effect ç„¶åŽé‡æ–°è¿è¡Œæ–°çš„ effect å¹¶æ²¡æœ‰ä»»ä½•é”™ã€‚é™¤éžæˆ‘ä»¬æœ‰å¾ˆå¥½çš„ç†ç”±ï¼Œæˆ‘ä»¬ä¸åº”è¯¥æ”¹å˜è¿™ä¸ªé»˜è®¤è¡Œä¸ºã€‚ä¸è¿‡ï¼Œå‡å¦‚æˆ‘ä»¬ä¸æƒ³åœ¨stepæ”¹å˜åŽé‡å¯å®šæ—¶å™¨ï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•ä»Ž effect ä¸­ç§»é™¤å¯¹stepçš„ä¾èµ–å‘¢ï¼Ÿå½“ä½ æƒ³æ›´æ–°ä¸€ä¸ªçŠ¶æ€ï¼Œå¹¶ä¸”è¿™ä¸ªçŠ¶æ€æ›´æ–°ä¾èµ–äºŽå¦ä¸€ä¸ªçŠ¶æ€çš„å€¼æ—¶ï¼Œä½ å¯èƒ½éœ€è¦ç”¨useReduceråŽ»æ›¿æ¢å®ƒä»¬ã€‚å½“ä½ å†™ç±»ä¼¼setSomething(something =&gt; ...)è¿™ç§ä»£ç çš„æ—¶å€™ï¼Œä¹Ÿè®¸å°±æ˜¯è€ƒè™‘ä½¿ç”¨ reducer çš„å¥‘æœºã€‚reducer å¯ä»¥è®©ä½ æŠŠç»„ä»¶å†…å‘ç”Ÿäº†ä»€ä¹ˆ (actions) å’ŒçŠ¶æ€å¦‚ä½•å“åº”å¹¶æ›´æ–°åˆ†å¼€è¡¨è¿°ã€‚æˆ‘ä»¬ç”¨ä¸€ä¸ªdispatchä¾èµ–åŽ»æ›¿æ¢ effect çš„stepä¾èµ–ï¼š1234567const [state, dispatch] = useReducer(reducer, initialState);const &#123; count, step &#125; = state;useEffect(() =&gt; &#123; const id = setInterval(() =&gt; &#123; dispatch(&#123; type: &apos;tick&apos; &#125;); &#125;, 1000); return () =&gt; clearInterval(id);&#125;, [dispatch]);(æŸ¥çœ‹ demoã€‚)ä½ å¯èƒ½ä¼šé—®ï¼šâ€œè¿™æ€Žä¹ˆå°±æ›´å¥½äº†ï¼Ÿâ€ ç­”æ¡ˆæ˜¯ React ä¼šä¿è¯dispatchåœ¨ç»„ä»¶çš„å£°æ˜Žå‘¨æœŸå†…ä¿æŒä¸å˜ã€‚æ‰€ä»¥ä¸Šé¢ä¾‹å­ä¸­ä¸å†éœ€è¦é‡æ–°è®¢é˜…å®šæ—¶å™¨ã€‚æˆ‘ä»¬è§£å†³äº†é—®é¢˜!ï¼ˆä½ å¯ä»¥ä»Žä¾èµ–ä¸­åŽ»é™¤dispatch, setState, å’ŒuseRefåŒ…è£¹çš„å€¼å› ä¸º React ä¼šç¡®ä¿å®ƒä»¬æ˜¯é™æ€çš„ã€‚ä¸è¿‡ä½ è®¾ç½®äº†å®ƒä»¬ä½œä¸ºä¾èµ–ä¹Ÿæ²¡ä»€ä¹ˆé—®é¢˜ã€‚ï¼‰ç›¸æ¯”äºŽç›´æŽ¥åœ¨ effect é‡Œé¢è¯»å–çŠ¶æ€ï¼Œå®ƒ dispatch äº†ä¸€ä¸ª action æ¥æè¿°å‘ç”Ÿäº†ä»€ä¹ˆã€‚è¿™ä½¿å¾—æˆ‘ä»¬çš„ effect å’ŒstepçŠ¶æ€è§£è€¦ã€‚æˆ‘ä»¬çš„ effect ä¸å†å…³å¿ƒæ€Žä¹ˆæ›´æ–°çŠ¶æ€ï¼Œå®ƒåªè´Ÿè´£å‘Šè¯‰æˆ‘ä»¬å‘ç”Ÿäº†ä»€ä¹ˆã€‚æ›´æ–°çš„é€»è¾‘å…¨éƒ½äº¤ç”± reducer åŽ»ç»Ÿä¸€å¤„ç†:12345678910111213const initialState = &#123; count: 0, step: 1,&#125;;function reducer(state, action) &#123; const &#123; count, step &#125; = state; if (action.type === &apos;tick&apos;) &#123; return &#123; count: count + step, step &#125;; &#125; else if (action.type === &apos;step&apos;) &#123; return &#123; count, step: action.step &#125;; &#125; else &#123; throw new Error(); &#125;&#125;(è¿™é‡Œæ˜¯ demo å¦‚æžœä½ ä¹‹å‰é”™è¿‡äº†ã€‚)ä¸ºä»€ä¹ˆ useReducer æ˜¯ Hooks çš„ä½œå¼Šæ¨¡å¼æˆ‘ä»¬å·²ç»å­¦ä¹ åˆ°å¦‚ä½•ç§»é™¤ effect çš„ä¾èµ–ï¼Œä¸ç®¡çŠ¶æ€æ›´æ–°æ˜¯ä¾èµ–ä¸Šä¸€ä¸ªçŠ¶æ€è¿˜æ˜¯ä¾èµ–å¦ä¸€ä¸ªçŠ¶æ€ã€‚ä½†å‡å¦‚æˆ‘ä»¬éœ€è¦ä¾èµ– props åŽ»è®¡ç®—ä¸‹ä¸€ä¸ªçŠ¶æ€å‘¢ï¼Ÿä¸¾ä¸ªä¾‹å­ï¼Œä¹Ÿè®¸æˆ‘ä»¬çš„ API æ˜¯&lt;Counter step={1} /&gt;ã€‚ç¡®å®šçš„æ˜¯ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ²¡æ³•é¿å…ä¾èµ–props.step ã€‚æ˜¯å—ï¼Ÿå®žé™…ä¸Šï¼Œ æˆ‘ä»¬å¯ä»¥é¿å…ï¼æˆ‘ä»¬å¯ä»¥æŠŠ reducer å‡½æ•°æ”¾åˆ°ç»„ä»¶å†…åŽ»è¯»å– propsï¼š123456789101112131415161718function Counter(&#123; step &#125;) &#123; const [count, dispatch] = useReducer(reducer, 0); function reducer(state, action) &#123; if (action.type === &apos;tick&apos;) &#123; return state + step; &#125; else &#123; throw new Error(); &#125; &#125; useEffect(() =&gt; &#123; const id = setInterval(() =&gt; &#123; dispatch(&#123; type: &apos;tick&apos; &#125;); &#125;, 1000); return () =&gt; clearInterval(id); &#125;, [dispatch]); return &lt;h1&gt;&#123;count&#125;&lt;/h1&gt;;&#125;è¿™ç§æ¨¡å¼ä¼šä½¿ä¸€äº›ä¼˜åŒ–å¤±æ•ˆï¼Œæ‰€ä»¥ä½ åº”è¯¥é¿å…æ»¥ç”¨å®ƒï¼Œä¸è¿‡å¦‚æžœä½ éœ€è¦ä½ å®Œå…¨å¯ä»¥åœ¨ reducer é‡Œé¢è®¿é—® propsã€‚ï¼ˆè¿™é‡Œæ˜¯ demoã€‚ï¼‰å³ä½¿æ˜¯åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒReact ä¹Ÿä¿è¯dispatchåœ¨æ¯æ¬¡æ¸²æŸ“ä¸­éƒ½æ˜¯ä¸€æ ·çš„ã€‚ æ‰€ä»¥ä½ å¯ä»¥åœ¨ä¾èµ–ä¸­åŽ»æŽ‰å®ƒã€‚å®ƒä¸ä¼šå¼•èµ· effect ä¸å¿…è¦çš„é‡å¤æ‰§è¡Œã€‚ä½ å¯èƒ½ä¼šç–‘æƒ‘ï¼šè¿™æ€Žä¹ˆå¯èƒ½ï¼Ÿåœ¨ä¹‹å‰æ¸²æŸ“ä¸­è°ƒç”¨çš„ reducer æ€Žä¹ˆ â€œçŸ¥é“â€ æ–°çš„ propsï¼Ÿç­”æ¡ˆæ˜¯å½“ä½ dispatchçš„æ—¶å€™ï¼ŒReact åªæ˜¯è®°ä½äº† action - å®ƒä¼šåœ¨ä¸‹ä¸€æ¬¡æ¸²æŸ“ä¸­å†æ¬¡è°ƒç”¨ reducerã€‚åœ¨é‚£ä¸ªæ—¶å€™ï¼Œæ–°çš„ props å°±å¯ä»¥è¢«è®¿é—®åˆ°ï¼Œè€Œä¸” reducer è°ƒç”¨ä¹Ÿä¸æ˜¯åœ¨ effect é‡Œã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘å€¾å‘è®¤ä¸ºuseReduceræ˜¯ Hooks çš„ â€œä½œå¼Šæ¨¡å¼â€ã€‚å®ƒå¯ä»¥æŠŠæ›´æ–°é€»è¾‘å’Œæè¿°å‘ç”Ÿäº†ä»€ä¹ˆåˆ†å¼€ã€‚ç»“æžœæ˜¯ï¼Œè¿™å¯ä»¥å¸®åŠ©æˆ‘ç§»é™¤ä¸å¿…éœ€çš„ä¾èµ–ï¼Œé¿å…ä¸å¿…è¦çš„ effect è°ƒç”¨ã€‚æŠŠå‡½æ•°ç§»åˆ° Effects é‡Œä¸€ä¸ªå…¸åž‹çš„è¯¯è§£æ˜¯è®¤ä¸ºå‡½æ•°ä¸åº”è¯¥æˆä¸ºä¾èµ–ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œä¸‹é¢çš„ä»£ç çœ‹ä¸ŠåŽ»å¯ä»¥è¿è¡Œæ­£å¸¸ï¼š12345678910111213function SearchResults() &#123; const [data, setData] = useState(&#123; hits: [] &#125;); async function fetchData() &#123; const result = await axios( &apos;https://hn.algolia.com/api/v1/search?query=react&apos;, ); setData(result.data); &#125; useEffect(() =&gt; &#123; fetchData(); &#125;, []);(è¿™ä¸ªä¾‹å­ æ”¹ç¼–è‡ª Robin Wieruch è¿™ç¯‡å¾ˆæ£’çš„æ–‡ç«  â€” ç‚¹å‡»æŸ¥çœ‹ï¼)éœ€è¦æ˜Žç¡®çš„æ˜¯ï¼Œä¸Šé¢çš„ä»£ç å¯ä»¥æ­£å¸¸å·¥ä½œã€‚ä½†è¿™æ ·åšåœ¨ç»„ä»¶æ—¥æ¸å¤æ‚çš„è¿­ä»£è¿‡ç¨‹ä¸­æˆ‘ä»¬å¾ˆéš¾ç¡®ä¿å®ƒåœ¨å„ç§æƒ…å†µä¸‹è¿˜èƒ½æ­£å¸¸è¿è¡Œã€‚æƒ³è±¡ä¸€ä¸‹æˆ‘ä»¬çš„ä»£ç åšä¸‹é¢è¿™æ ·çš„åˆ†ç¦»ï¼Œå¹¶ä¸”æ¯ä¸€ä¸ªå‡½æ•°çš„ä½“é‡æ˜¯çŽ°åœ¨çš„äº”å€ï¼š123456789101112131415161718function SearchResults() &#123; function getFetchUrl() &#123; return &apos;https://hn.algolia.com/api/v1/search?query=react&apos;; &#125; async function fetchData() &#123; const result = await axios(getFetchUrl()); setData(result.data); &#125; useEffect(() =&gt; &#123; fetchData(); &#125;, []); &#125;ç„¶åŽæˆ‘ä»¬åœ¨æŸäº›å‡½æ•°å†…ä½¿ç”¨äº†æŸäº› state æˆ–è€… propï¼š12345678910111213141516171819function SearchResults() &#123; const [query, setQuery] = useState(&apos;react&apos;); function getFetchUrl() &#123; return &apos;https://hn.algolia.com/api/v1/search?query=&apos; + query; &#125; async function fetchData() &#123; const result = await axios(getFetchUrl()); setData(result.data); &#125; useEffect(() =&gt; &#123; fetchData(); &#125;, []); &#125;å¦‚æžœæˆ‘ä»¬å¿˜è®°åŽ»æ›´æ–°ä½¿ç”¨è¿™äº›å‡½æ•°ï¼ˆå¾ˆå¯èƒ½é€šè¿‡å…¶ä»–å‡½æ•°è°ƒç”¨ï¼‰çš„ effects çš„ä¾èµ–ï¼Œæˆ‘ä»¬çš„ effects å°±ä¸ä¼šåŒæ­¥ props å’Œ state å¸¦æ¥çš„å˜æ›´ã€‚è¿™å½“ç„¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚å¹¸è¿çš„æ˜¯ï¼Œå¯¹äºŽè¿™ä¸ªé—®é¢˜æœ‰ä¸€ä¸ªç®€å•çš„è§£å†³æ–¹æ¡ˆã€‚å¦‚æžœæŸäº›å‡½æ•°ä»…åœ¨ effect ä¸­è°ƒç”¨ï¼Œä½ å¯ä»¥æŠŠå®ƒä»¬çš„å®šä¹‰ç§»åˆ° effect ä¸­ï¼š12345678function SearchResults() &#123; useEffect(() =&gt; &#123; function getFetchUrl() &#123; return &apos;https://hn.algolia.com/api/v1/search?query=react&apos;; &#125; async function fetchData() &#123; const result = await axios(getFetchUrl()); setData(result.data); &#125; fetchData(); &#125;, []); &#125;(è¿™é‡Œæ˜¯ demo.)è¿™ä¹ˆåšæœ‰ä»€ä¹ˆå¥½å¤„å‘¢ï¼Ÿæˆ‘ä»¬ä¸å†éœ€è¦åŽ»è€ƒè™‘è¿™äº› â€œé—´æŽ¥ä¾èµ–â€ã€‚æˆ‘ä»¬çš„ä¾èµ–æ•°ç»„ä¹Ÿä¸å†æ’’è°Žï¼šåœ¨æˆ‘ä»¬çš„ effect ä¸­ç¡®å®žæ²¡æœ‰å†ä½¿ç”¨ç»„ä»¶èŒƒå›´å†…çš„ä»»ä½•ä¸œè¥¿ã€‚å¦‚æžœæˆ‘ä»¬åŽé¢ä¿®æ”¹ getFetchUrlåŽ»ä½¿ç”¨queryçŠ¶æ€ï¼Œæˆ‘ä»¬æ›´å¯èƒ½ä¼šæ„è¯†åˆ°æˆ‘ä»¬æ­£åœ¨ effect é‡Œé¢ç¼–è¾‘å®ƒ - å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦æŠŠqueryæ·»åŠ åˆ° effect çš„ä¾èµ–é‡Œï¼š12345678910111213141516function SearchResults() &#123; const [query, setQuery] = useState(&apos;react&apos;); useEffect(() =&gt; &#123; function getFetchUrl() &#123; return &apos;https://hn.algolia.com/api/v1/search?query=&apos; + query; &#125; async function fetchData() &#123; const result = await axios(getFetchUrl()); setData(result.data); &#125; fetchData(); &#125;, [query]); &#125;(è¿™é‡Œæ˜¯ demo.)æ·»åŠ è¿™ä¸ªä¾èµ–ï¼Œæˆ‘ä»¬ä¸ä»…ä»…æ˜¯åœ¨ â€œå–æ‚¦ Reactâ€ã€‚åœ¨ query æ”¹å˜åŽåŽ»é‡æ–°è¯·æ±‚æ•°æ®æ˜¯åˆç†çš„ã€‚useEffectçš„è®¾è®¡æ„å›¾å°±æ˜¯è¦å¼ºè¿«ä½ å…³æ³¨æ•°æ®æµçš„æ”¹å˜ï¼Œç„¶åŽå†³å®šæˆ‘ä»¬çš„ effects è¯¥å¦‚ä½•å’Œå®ƒåŒæ­¥ - è€Œä¸æ˜¯å¿½è§†å®ƒç›´åˆ°æˆ‘ä»¬çš„ç”¨æˆ·é‡åˆ°äº† bugã€‚æ„Ÿè°¢eslint-plugin-react-hooks æ’ä»¶çš„exhaustive-depslint è§„åˆ™ï¼Œå®ƒä¼šåœ¨ä½ ç¼–ç çš„æ—¶å€™å°±åˆ†æž effects å¹¶ä¸”æä¾›å¯èƒ½é—æ¼ä¾èµ–çš„å»ºè®®ã€‚æ¢å¥è¯è¯´ï¼Œæœºå™¨ä¼šå‘Šè¯‰ä½ ç»„ä»¶ä¸­å“ªäº›æ•°æ®æµå˜æ›´æ²¡æœ‰è¢«æ­£ç¡®åœ°å¤„ç†ã€‚éžå¸¸æ£’ã€‚ä½†æˆ‘ä¸èƒ½æŠŠè¿™ä¸ªå‡½æ•°æ”¾åˆ° Effect é‡Œæœ‰æ—¶å€™ä½ å¯èƒ½ä¸æƒ³æŠŠå‡½æ•°ç§»å…¥ effect é‡Œã€‚æ¯”å¦‚ï¼Œç»„ä»¶å†…æœ‰å‡ ä¸ª effect ä½¿ç”¨äº†ç›¸åŒçš„å‡½æ•°ï¼Œä½ ä¸æƒ³åœ¨æ¯ä¸ª effect é‡Œå¤åˆ¶é»è´´ä¸€éè¿™ä¸ªé€»è¾‘ã€‚ä¹Ÿæˆ–è®¸è¿™ä¸ªå‡½æ•°æ˜¯ä¸€ä¸ª propã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ä½ åº”è¯¥å¿½ç•¥å¯¹å‡½æ•°çš„ä¾èµ–å—ï¼Ÿæˆ‘ä¸è¿™ä¹ˆè®¤ä¸ºã€‚å†æ¬¡å¼ºè°ƒï¼Œefffects ä¸åº”è¯¥å¯¹å®ƒçš„ä¾èµ–æ’’è°Žã€‚é€šå¸¸æˆ‘ä»¬è¿˜æœ‰æ›´å¥½çš„è§£å†³åŠžæ³•ã€‚ä¸€ä¸ªå¸¸è§çš„è¯¯è§£æ˜¯ï¼Œâ€œå‡½æ•°ä»Žæ¥ä¸ä¼šæ”¹å˜â€ã€‚ä½†æ˜¯è¿™ç¯‡æ–‡ç« ä½ è¯»åˆ°çŽ°åœ¨ï¼Œä½ çŸ¥é“è¿™æ˜¾ç„¶ä¸æ˜¯äº‹å®žã€‚å®žé™…ä¸Šï¼Œåœ¨ç»„ä»¶å†…å®šä¹‰çš„å‡½æ•°æ¯ä¸€æ¬¡æ¸²æŸ“éƒ½åœ¨å˜ã€‚å‡½æ•°æ¯æ¬¡æ¸²æŸ“éƒ½ä¼šæ”¹å˜è¿™ä¸ªäº‹å®žæœ¬èº«å°±æ˜¯ä¸ªé—®é¢˜ã€‚ æ¯”å¦‚æœ‰ä¸¤ä¸ª effects ä¼šè°ƒç”¨ getFetchUrl:1234567891011121314151617function SearchResults() &#123; function getFetchUrl(query) &#123; return &apos;https://hn.algolia.com/api/v1/search?query=&apos; + query; &#125; useEffect(() =&gt; &#123; const url = getFetchUrl(&apos;react&apos;); &#125;, []); useEffect(() =&gt; &#123; const url = getFetchUrl(&apos;redux&apos;); &#125;, []); &#125;åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œä½ å¯èƒ½ä¸æƒ³æŠŠgetFetchUrl ç§»åˆ° effects ä¸­ï¼Œå› ä¸ºä½ æƒ³å¤ç”¨é€»è¾‘ã€‚å¦ä¸€æ–¹é¢ï¼Œå¦‚æžœä½ å¯¹ä¾èµ–å¾ˆ â€œè¯šå®žâ€ï¼Œä½ å¯èƒ½ä¼šæŽ‰åˆ°é™·é˜±é‡Œã€‚æˆ‘ä»¬çš„ä¸¤ä¸ª effects éƒ½ä¾èµ–getFetchUrlï¼Œè€Œå®ƒæ¯æ¬¡æ¸²æŸ“éƒ½ä¸åŒï¼Œæ‰€ä»¥æˆ‘ä»¬çš„ä¾èµ–æ•°ç»„ä¼šå˜å¾—æ— ç”¨ï¼š1234567891011121314function SearchResults() &#123; function getFetchUrl(query) &#123; return &apos;https://hn.algolia.com/api/v1/search?query=&apos; + query; &#125; useEffect(() =&gt; &#123; const url = getFetchUrl(&apos;react&apos;); &#125;, [getFetchUrl]); useEffect(() =&gt; &#123; const url = getFetchUrl(&apos;redux&apos;); &#125;, [getFetchUrl]); &#125;ä¸€ä¸ªå¯èƒ½çš„è§£å†³åŠžæ³•æ˜¯æŠŠgetFetchUrlä»Žä¾èµ–ä¸­åŽ»æŽ‰ã€‚ä½†æ˜¯ï¼Œæˆ‘ä¸è®¤ä¸ºè¿™æ˜¯å¥½çš„è§£å†³æ–¹å¼ã€‚è¿™ä¼šä½¿æˆ‘ä»¬åŽé¢å¯¹æ•°æ®æµçš„æ”¹å˜å¾ˆéš¾è¢«å‘çŽ°ä»Žè€Œå¿˜è®°åŽ»å¤„ç†ã€‚è¿™ä¼šå¯¼è‡´ç±»ä¼¼äºŽä¸Šé¢ â€œå®šæ—¶å™¨ä¸æ›´æ–°å€¼â€ çš„é—®é¢˜ã€‚ç›¸åçš„ï¼Œæˆ‘ä»¬æœ‰ä¸¤ä¸ªæ›´ç®€å•çš„è§£å†³åŠžæ³•ã€‚ç¬¬ä¸€ä¸ªï¼Œ å¦‚æžœä¸€ä¸ªå‡½æ•°æ²¡æœ‰ä½¿ç”¨ç»„ä»¶å†…çš„ä»»ä½•å€¼ï¼Œä½ åº”è¯¥æŠŠå®ƒæåˆ°ç»„ä»¶å¤–é¢åŽ»å®šä¹‰ï¼Œç„¶åŽå°±å¯ä»¥è‡ªç”±åœ°åœ¨ effects ä¸­ä½¿ç”¨ï¼š1234567891011121314function getFetchUrl(query) &#123; return &apos;https://hn.algolia.com/api/v1/search?query=&apos; + query;&#125;function SearchResults() &#123; useEffect(() =&gt; &#123; const url = getFetchUrl(&apos;react&apos;); &#125;, []); useEffect(() =&gt; &#123; const url = getFetchUrl(&apos;redux&apos;); &#125;, []); &#125;ä½ ä¸å†éœ€è¦æŠŠå®ƒè®¾ä¸ºä¾èµ–ï¼Œå› ä¸ºå®ƒä»¬ä¸åœ¨æ¸²æŸ“èŒƒå›´å†…ï¼Œå› æ­¤ä¸ä¼šè¢«æ•°æ®æµå½±å“ã€‚å®ƒä¸å¯èƒ½çªç„¶æ„å¤–åœ°ä¾èµ–äºŽ props æˆ– stateã€‚æˆ–è€…ï¼Œ ä½ ä¹Ÿå¯ä»¥æŠŠå®ƒåŒ…è£…æˆ useCallback Hook:1234567891011121314function SearchResults() &#123; const getFetchUrl = useCallback((query) =&gt; &#123; return &apos;https://hn.algolia.com/api/v1/search?query=&apos; + query; &#125;, []); useEffect(() =&gt; &#123; const url = getFetchUrl(&apos;react&apos;); &#125;, [getFetchUrl]); useEffect(() =&gt; &#123; const url = getFetchUrl(&apos;redux&apos;); &#125;, [getFetchUrl]); &#125;useCallbackæœ¬è´¨ä¸Šæ˜¯æ·»åŠ äº†ä¸€å±‚ä¾èµ–æ£€æŸ¥ã€‚å®ƒä»¥å¦ä¸€ç§æ–¹å¼è§£å†³äº†é—®é¢˜ - æˆ‘ä»¬ä½¿å‡½æ•°æœ¬èº«åªåœ¨éœ€è¦çš„æ—¶å€™æ‰æ”¹å˜ï¼Œè€Œä¸æ˜¯åŽ»æŽ‰å¯¹å‡½æ•°çš„ä¾èµ–ã€‚æˆ‘ä»¬æ¥çœ‹çœ‹ä¸ºä»€ä¹ˆè¿™ç§æ–¹å¼æ˜¯æœ‰ç”¨çš„ã€‚ä¹‹å‰ï¼Œæˆ‘ä»¬çš„ä¾‹å­ä¸­å±•ç¤ºäº†ä¸¤ç§æœç´¢ç»“æžœï¼ˆæŸ¥è¯¢æ¡ä»¶åˆ†åˆ«ä¸º&#39;react&#39;å’Œ&#39;redux&#39;ï¼‰ã€‚ä½†å¦‚æžœæˆ‘ä»¬æƒ³æ·»åŠ ä¸€ä¸ªè¾“å…¥æ¡†å…è®¸ä½ è¾“å…¥ä»»æ„çš„æŸ¥è¯¢æ¡ä»¶ (query)ã€‚ä¸åŒäºŽä¼ é€’queryå‚æ•°çš„æ–¹å¼ï¼ŒçŽ°åœ¨getFetchUrlä¼šä»ŽçŠ¶æ€ä¸­è¯»å–ã€‚æˆ‘ä»¬å¾ˆå¿«å‘çŽ°å®ƒé—æ¼äº†queryä¾èµ–ï¼šå¦‚æžœæˆ‘æŠŠqueryæ·»åŠ åˆ°useCallback çš„ä¾èµ–ä¸­ï¼Œä»»ä½•è°ƒç”¨äº†getFetchUrlçš„ effect åœ¨queryæ”¹å˜åŽéƒ½ä¼šé‡æ–°è¿è¡Œï¼š1234567891011function SearchResults() &#123; const [query, setQuery] = useState(&apos;react&apos;); const getFetchUrl = useCallback(() =&gt; &#123; return &apos;https://hn.algolia.com/api/v1/search?query=&apos; + query; &#125;, [query]); useEffect(() =&gt; &#123; const url = getFetchUrl(); &#125;, [getFetchUrl]); &#125;æˆ‘ä»¬è¦æ„Ÿè°¢useCallbackï¼Œå› ä¸ºå¦‚æžœquery ä¿æŒä¸å˜ï¼ŒgetFetchUrlä¹Ÿä¼šä¿æŒä¸å˜ï¼Œæˆ‘ä»¬çš„ effect ä¹Ÿä¸ä¼šé‡æ–°è¿è¡Œã€‚ä½†æ˜¯å¦‚æžœqueryä¿®æ”¹äº†ï¼ŒgetFetchUrlä¹Ÿä¼šéšä¹‹æ”¹å˜ï¼Œå› æ­¤ä¼šé‡æ–°è¯·æ±‚æ•°æ®ã€‚è¿™å°±åƒä½ åœ¨ Excel é‡Œä¿®æ”¹äº†ä¸€ä¸ªå•å…ƒæ ¼çš„å€¼ï¼Œå¦ä¸€ä¸ªä½¿ç”¨å®ƒçš„å•å…ƒæ ¼ä¼šè‡ªåŠ¨é‡æ–°è®¡ç®—ä¸€æ ·ã€‚è¿™æ­£æ˜¯æ‹¥æŠ±æ•°æ®æµå’ŒåŒæ­¥æ€ç»´çš„ç»“æžœã€‚å¯¹äºŽé€šè¿‡å±žæ€§ä»Žçˆ¶ç»„ä»¶ä¼ å…¥çš„å‡½æ•°è¿™ä¸ªæ–¹æ³•ä¹Ÿé€‚ç”¨ï¼š12345678910111213141516function Parent() &#123; const [query, setQuery] = useState(&apos;react&apos;); const fetchData = useCallback(() =&gt; &#123; const url = &apos;https://hn.algolia.com/api/v1/search?query=&apos; + query; &#125;, [query]); return &lt;Child fetchData=&#123;fetchData&#125; /&gt;&#125;function Child(&#123; fetchData &#125;) &#123; let [data, setData] = useState(null); useEffect(() =&gt; &#123; fetchData().then(setData); &#125;, [fetchData]); &#125;å› ä¸ºfetchDataåªæœ‰åœ¨Parentçš„queryçŠ¶æ€å˜æ›´æ—¶æ‰ä¼šæ”¹å˜ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„Childåªä¼šåœ¨éœ€è¦çš„æ—¶å€™æ‰åŽ»é‡æ–°è¯·æ±‚æ•°æ®ã€‚å‡½æ•°æ˜¯æ•°æ®æµçš„ä¸€éƒ¨åˆ†å—ï¼Ÿæœ‰è¶£çš„æ˜¯ï¼Œè¿™ç§æ¨¡å¼åœ¨ class ç»„ä»¶ä¸­è¡Œä¸é€šï¼Œå¹¶ä¸”è¿™ç§è¡Œä¸é€šæ°åˆ°å¥½å¤„åœ°æ­ç¤ºäº† effect å’Œç”Ÿå‘½å‘¨æœŸèŒƒå¼ä¹‹é—´çš„åŒºåˆ«ã€‚è€ƒè™‘ä¸‹é¢çš„è½¬æ¢ï¼š1234567891011121314151617class Parent extends Component &#123; state = &#123; query: &apos;react&apos; &#125;; fetchData = () =&gt; &#123; const url = &apos;https://hn.algolia.com/api/v1/search?query=&apos; + this.state.query; &#125;; render() &#123; return &lt;Child fetchData=&#123;this.fetchData&#125; /&gt;; &#125;&#125;class Child extends Component &#123; state = &#123; data: null &#125;; componentDidMount() &#123; this.props.fetchData(); &#125; render() &#123; &#125;&#125;ä½ å¯èƒ½ä¼šæƒ³ï¼šâ€œå°‘æ¥äº† Danï¼Œæˆ‘ä»¬éƒ½çŸ¥é“useEffect å°±åƒcomponentDidMount å’Œ componentDidUpdateçš„ç»“åˆï¼Œä½ ä¸èƒ½è€æ˜¯ç ´åè¿™ä¸€æ¡ï¼â€ å¥½å§ï¼Œå°±ç®—åŠ äº†componentDidUpdateç…§æ ·æ— ç”¨ï¼š1234567891011class Child extends Component &#123; state = &#123; data: null &#125;; componentDidMount() &#123; this.props.fetchData(); &#125; componentDidUpdate(prevProps) &#123; if (this.props.fetchData !== prevProps.fetchData) &#123; this.props.fetchData(); &#125; &#125; render() &#123; &#125;&#125;å½“ç„¶å¦‚æ­¤ï¼ŒfetchDataæ˜¯ä¸€ä¸ª class æ–¹æ³•ï¼ï¼ˆæˆ–è€…ä½ ä¹Ÿå¯ä»¥è¯´æ˜¯ class å±žæ€§ - ä½†è¿™ä¸èƒ½æ”¹å˜ä»€ä¹ˆã€‚ï¼‰å®ƒä¸ä¼šå› ä¸ºçŠ¶æ€çš„æ”¹å˜è€Œä¸åŒï¼Œæ‰€ä»¥this.props.fetchDataå’Œ prevProps.fetchDataå§‹ç»ˆç›¸ç­‰ï¼Œå› æ­¤ä¸ä¼šé‡æ–°è¯·æ±‚ã€‚é‚£æˆ‘ä»¬åˆ æŽ‰æ¡ä»¶åˆ¤æ–­æ€Žä¹ˆæ ·ï¼Ÿ123componentDidUpdate(prevProps) &#123; this.props.fetchData();&#125;ç­‰ç­‰ï¼Œè¿™æ ·ä¼šåœ¨æ¯æ¬¡æ¸²æŸ“åŽéƒ½åŽ»è¯·æ±‚ã€‚(æ·»åŠ ä¸€ä¸ªåŠ è½½åŠ¨ç”»å¯èƒ½æ˜¯ä¸€ç§æœ‰è¶£çš„å‘çŽ°è¿™ç§æƒ…å†µçš„æ–¹å¼ã€‚) ä¹Ÿè®¸æˆ‘ä»¬å¯ä»¥ç»‘å®šä¸€ä¸ªç‰¹å®šçš„ query?123render() &#123; return &lt;Child fetchData=&#123;this.fetchData.bind(this, this.state.query)&#125; /&gt;;&#125;ä½†è¿™æ ·ä¸€æ¥ï¼Œthis.props.fetchData !== prevProps.fetchData è¡¨è¾¾å¼æ°¸è¿œæ˜¯trueï¼Œå³ä½¿queryå¹¶æœªæ”¹å˜ã€‚è¿™ä¼šå¯¼è‡´æˆ‘ä»¬æ€»æ˜¯åŽ»è¯·æ±‚ã€‚æƒ³è¦è§£å†³è¿™ä¸ª class ç»„ä»¶ä¸­çš„éš¾é¢˜ï¼Œå”¯ä¸€çŽ°å®žå¯è¡Œçš„åŠžæ³•æ˜¯ç¡¬ç€å¤´çš®æŠŠqueryæœ¬èº«ä¼ å…¥ Child ç»„ä»¶ã€‚ Child è™½ç„¶å®žé™…å¹¶æ²¡æœ‰ç›´æŽ¥_ä½¿ç”¨_è¿™ä¸ªqueryçš„å€¼ï¼Œä½†èƒ½åœ¨å®ƒæ”¹å˜çš„æ—¶å€™è§¦å‘ä¸€æ¬¡é‡æ–°è¯·æ±‚ï¼š12345678910111213141516171819202122232425class Parent extends Component &#123; state = &#123; query: &apos;react&apos; &#125;; fetchData = () =&gt; &#123; const url = &apos;https://hn.algolia.com/api/v1/search?query=&apos; + this.state.query; &#125;; render() &#123; return &lt;Child fetchData=&#123;this.fetchData&#125; query=&#123;this.state.query&#125; /&gt;; &#125;&#125;class Child extends Component &#123; state = &#123; data: null &#125;; componentDidMount() &#123; this.props.fetchData(); &#125; componentDidUpdate(prevProps) &#123; if (this.props.query !== prevProps.query) &#123; this.props.fetchData(); &#125; &#125; render() &#123; &#125;&#125;åœ¨ä½¿ç”¨ React çš„ class ç»„ä»¶è¿™ä¹ˆå¤šå¹´åŽï¼Œæˆ‘å·²ç»å¦‚æ­¤ä¹ æƒ¯äºŽæŠŠä¸å¿…è¦çš„ props ä¼ é€’ä¸‹åŽ»å¹¶ä¸”ç ´åçˆ¶ç»„ä»¶çš„å°è£…ä»¥è‡³äºŽæˆ‘åœ¨ä¸€å‘¨ä¹‹å‰æ‰æ„è¯†åˆ°æˆ‘ä¸ºä»€ä¹ˆä¸€å®šè¦è¿™æ ·åšã€‚åœ¨ class ç»„ä»¶ä¸­ï¼Œå‡½æ•°å±žæ€§æœ¬èº«å¹¶ä¸æ˜¯æ•°æ®æµçš„ä¸€éƒ¨åˆ†ã€‚ç»„ä»¶çš„æ–¹æ³•ä¸­åŒ…å«äº†å¯å˜çš„thiså˜é‡å¯¼è‡´æˆ‘ä»¬ä¸èƒ½ç¡®å®šæ— ç–‘åœ°è®¤ä¸ºå®ƒæ˜¯ä¸å˜çš„ã€‚å› æ­¤ï¼Œå³ä½¿æˆ‘ä»¬åªéœ€è¦ä¸€ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬ä¹Ÿå¿…é¡»æŠŠä¸€å †æ•°æ®ä¼ é€’ä¸‹åŽ»ä»…ä»…æ˜¯ä¸ºäº†åš â€œdiffâ€ã€‚æˆ‘ä»¬æ— æ³•çŸ¥é“ä¼ å…¥çš„this.props.fetchData æ˜¯å¦ä¾èµ–çŠ¶æ€ï¼Œå¹¶ä¸”ä¸çŸ¥é“å®ƒä¾èµ–çš„çŠ¶æ€æ˜¯å¦æ”¹å˜äº†ã€‚ä½¿ç”¨useCallbackï¼Œå‡½æ•°å®Œå…¨å¯ä»¥å‚ä¸Žåˆ°æ•°æ®æµä¸­ã€‚æˆ‘ä»¬å¯ä»¥è¯´å¦‚æžœä¸€ä¸ªå‡½æ•°çš„è¾“å…¥æ”¹å˜äº†ï¼Œè¿™ä¸ªå‡½æ•°å°±æ”¹å˜äº†ã€‚å¦‚æžœæ²¡æœ‰ï¼Œå‡½æ•°ä¹Ÿä¸ä¼šæ”¹å˜ã€‚æ„Ÿè°¢å‘¨åˆ°çš„useCallbackï¼Œå±žæ€§æ¯”å¦‚props.fetchDataçš„æ”¹å˜ä¹Ÿä¼šè‡ªåŠ¨ä¼ é€’ä¸‹åŽ»ã€‚ç±»ä¼¼çš„ï¼ŒuseMemoå¯ä»¥è®©æˆ‘ä»¬å¯¹å¤æ‚å¯¹è±¡åšç±»ä¼¼çš„äº‹æƒ…ã€‚1234567function ColorPicker() &#123; const [color, setColor] = useState(&apos;pink&apos;); const style = useMemo(() =&gt; (&#123; color &#125;), [color]); return &lt;Child style=&#123;style&#125; /&gt;;&#125;æˆ‘æƒ³å¼ºè°ƒçš„æ˜¯ï¼Œåˆ°å¤„ä½¿ç”¨useCallbackæ˜¯ä»¶æŒºç¬¨æ‹™çš„äº‹ã€‚å½“æˆ‘ä»¬éœ€è¦å°†å‡½æ•°ä¼ é€’ä¸‹åŽ»å¹¶ä¸”å‡½æ•°ä¼šåœ¨å­ç»„ä»¶çš„ effect ä¸­è¢«è°ƒç”¨çš„æ—¶å€™ï¼ŒuseCallback æ˜¯å¾ˆå¥½çš„æŠ€å·§ä¸”éžå¸¸æœ‰ç”¨ã€‚æˆ–è€…ä½ æƒ³è¯•å›¾å‡å°‘å¯¹å­ç»„ä»¶çš„è®°å¿†è´Ÿæ‹…ï¼Œä¹Ÿä¸å¦¨ä¸€è¯•ã€‚ä½†æ€»çš„æ¥è¯´ Hooks æœ¬èº«èƒ½æ›´å¥½åœ°é¿å…ä¼ é€’å›žè°ƒå‡½æ•°ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘æ›´å€¾å‘äºŽæŠŠfetchDataæ”¾åœ¨æˆ‘çš„ effect é‡Œï¼ˆå®ƒå¯ä»¥æŠ½ç¦»æˆä¸€ä¸ªè‡ªå®šä¹‰ Hookï¼‰æˆ–è€…æ˜¯ä»Žé¡¶å±‚å¼•å…¥ã€‚æˆ‘æƒ³è®© effects ä¿æŒç®€å•ï¼Œè€Œåœ¨é‡Œé¢è°ƒç”¨å›žè°ƒä¼šè®©äº‹æƒ…å˜å¾—å¤æ‚ã€‚ï¼ˆâ€œå¦‚æžœæŸä¸ªprops.onCompleteå›žè°ƒæ”¹å˜äº†è€Œè¯·æ±‚è¿˜åœ¨è¿›è¡Œä¸­ä¼šæ€Žä¹ˆæ ·ï¼Ÿâ€ï¼‰ä½ å¯ä»¥æ¨¡æ‹Ÿ class çš„è¡Œä¸ºä½†é‚£æ ·å¹¶ä¸èƒ½è§£å†³ç«žæ€çš„é—®é¢˜ã€‚è¯´è¯´ç«žæ€ä¸‹é¢æ˜¯ä¸€ä¸ªå…¸åž‹çš„åœ¨ class ç»„ä»¶é‡Œå‘è¯·æ±‚çš„ä¾‹å­ï¼š12345678910111213class Article extends Component &#123; state = &#123; article: null &#125;; componentDidMount() &#123; this.fetchData(this.props.id); &#125; async fetchData(id) &#123; const article = await API.fetchArticle(id); this.setState(&#123; article &#125;); &#125; &#125;ä½ å¾ˆå¯èƒ½å·²ç»çŸ¥é“ï¼Œä¸Šé¢çš„ä»£ç åŸ‹ä¼äº†ä¸€äº›é—®é¢˜ã€‚å®ƒå¹¶æ²¡æœ‰å¤„ç†æ›´æ–°çš„æƒ…å†µã€‚æ‰€ä»¥ç¬¬äºŒä¸ªä½ èƒ½å¤Ÿåœ¨ç½‘ä¸Šæ‰¾åˆ°çš„ç»å…¸ä¾‹å­æ˜¯ä¸‹é¢è¿™æ ·çš„ï¼š12345678910111213class Article extends Component &#123; state = &#123; article: null &#125;; componentDidMount() &#123; this.fetchData(this.props.id); &#125; componentDidUpdate(prevProps) &#123; if (prevProps.id !== this.props.id) &#123; this.fetchData(this.props.id); &#125; &#125; async fetchData(id) &#123; const article = await API.fetchArticle(id); this.setState(&#123; article &#125;); &#125; &#125;è¿™æ˜¾ç„¶å¥½å¤šäº†ï¼ä½†ä¾æ—§æœ‰é—®é¢˜ã€‚æœ‰é—®é¢˜çš„åŽŸå› æ˜¯è¯·æ±‚ç»“æžœè¿”å›žçš„é¡ºåºä¸èƒ½ä¿è¯ä¸€è‡´ã€‚æ¯”å¦‚æˆ‘å…ˆè¯·æ±‚ {id: 10}ï¼Œç„¶åŽæ›´æ–°åˆ°{id: 20}ï¼Œä½†{id: 20}çš„è¯·æ±‚æ›´å…ˆè¿”å›žã€‚è¯·æ±‚æ›´æ—©ä½†è¿”å›žæ›´æ™šçš„æƒ…å†µä¼šé”™è¯¯åœ°è¦†ç›–çŠ¶æ€å€¼ã€‚è¿™è¢«å«åšç«žæ€ï¼Œè¿™åœ¨æ··åˆäº†async / awaitï¼ˆå‡è®¾åœ¨ç­‰å¾…ç»“æžœè¿”å›žï¼‰å’Œè‡ªé¡¶å‘ä¸‹æ•°æ®æµçš„ä»£ç ä¸­éžå¸¸å…¸åž‹ï¼ˆprops å’Œ state å¯èƒ½ä¼šåœ¨ async å‡½æ•°è°ƒç”¨è¿‡ç¨‹ä¸­å‘ç”Ÿæ”¹å˜ï¼‰ã€‚Effects å¹¶æ²¡æœ‰ç¥žå¥‡åœ°è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå°½ç®¡å®ƒä¼šè­¦å‘Šä½ å¦‚æžœä½ ç›´æŽ¥ä¼ äº†ä¸€ä¸ªasync å‡½æ•°ç»™ effectã€‚ï¼ˆæˆ‘ä»¬ä¼šæ”¹å–„è¿™ä¸ªè­¦å‘Šæ¥æ›´å¥½åœ°è§£é‡Šä½ å¯èƒ½ä¼šé‡åˆ°çš„è¿™äº›é—®é¢˜ã€‚ï¼‰å¦‚æžœä½ ä½¿ç”¨çš„å¼‚æ­¥æ–¹å¼æ”¯æŒå–æ¶ˆï¼Œé‚£å¤ªæ£’äº†ã€‚ä½ å¯ä»¥ç›´æŽ¥åœ¨æ¸…é™¤å‡½æ•°ä¸­å–æ¶ˆå¼‚æ­¥è¯·æ±‚ã€‚æˆ–è€…ï¼Œæœ€ç®€å•çš„æƒå®œä¹‹è®¡æ˜¯ç”¨ä¸€ä¸ªå¸ƒå°”å€¼æ¥è·Ÿè¸ªå®ƒï¼š1234567891011121314151617function Article(&#123; id &#125;) &#123; const [article, setArticle] = useState(null); useEffect(() =&gt; &#123; let didCancel = false; async function fetchData() &#123; const article = await API.fetchArticle(id); if (!didCancel) &#123; setArticle(article); &#125; &#125; fetchData(); return () =&gt; &#123; didCancel = true; &#125;; &#125;, [id]); &#125;è¿™ç¯‡æ–‡ç« è®¨è®ºäº†æ›´å¤šå…³äºŽå¦‚ä½•å¤„ç†é”™è¯¯å’ŒåŠ è½½çŠ¶æ€ï¼Œä»¥åŠæŠ½ç¦»é€»è¾‘åˆ°è‡ªå®šä¹‰çš„ Hookã€‚æˆ‘æŽ¨èä½ è®¤çœŸé˜…è¯»ä¸€ä¸‹å¦‚æžœä½ æƒ³å­¦ä¹ æ›´å¤šå…³äºŽå¦‚ä½•åœ¨ Hooks é‡Œè¯·æ±‚æ•°æ®çš„å†…å®¹ã€‚æé«˜æ°´å‡†åœ¨ class ç»„ä»¶ç”Ÿå‘½å‘¨æœŸçš„æ€ç»´æ¨¡åž‹ä¸­ï¼Œå‰¯ä½œç”¨çš„è¡Œä¸ºå’Œæ¸²æŸ“è¾“å‡ºæ˜¯ä¸åŒçš„ã€‚UI æ¸²æŸ“æ˜¯è¢« props å’Œ state é©±åŠ¨çš„ï¼Œå¹¶ä¸”èƒ½ç¡®ä¿æ­¥è°ƒä¸€è‡´ï¼Œä½†å‰¯ä½œç”¨å¹¶ä¸æ˜¯è¿™æ ·ã€‚è¿™æ˜¯ä¸€ç±»å¸¸è§é—®é¢˜çš„æ¥æºã€‚è€Œåœ¨useEffectçš„æ€ç»´æ¨¡åž‹ä¸­ï¼Œé»˜è®¤éƒ½æ˜¯åŒæ­¥çš„ã€‚å‰¯ä½œç”¨å˜æˆäº† React æ•°æ®æµçš„ä¸€éƒ¨åˆ†ã€‚å¯¹äºŽæ¯ä¸€ä¸ªuseEffectè°ƒç”¨ï¼Œä¸€æ—¦ä½ å¤„ç†æ­£ç¡®ï¼Œä½ çš„ç»„ä»¶èƒ½å¤Ÿæ›´å¥½åœ°å¤„ç†è¾¹ç¼˜æƒ…å†µã€‚ç„¶è€Œï¼Œç”¨å¥½useEffectçš„å‰æœŸå­¦ä¹ æˆæœ¬æ›´é«˜ã€‚è¿™å¯èƒ½è®©äººæ°”æ¼ã€‚ç”¨åŒæ­¥çš„ä»£ç åŽ»å¤„ç†è¾¹ç¼˜æƒ…å†µå¤©ç„¶å°±æ¯”è§¦å‘ä¸€æ¬¡ä¸ç”¨å’Œæ¸²æŸ“ç»“æžœæ­¥è°ƒä¸€è‡´çš„å‰¯ä½œç”¨æ›´éš¾ã€‚è¿™éš¾å…è®©äººæ‹…å¿§å¦‚æžœuseEffectæ˜¯ä½ çŽ°åœ¨ä½¿ç”¨æœ€å¤šçš„å·¥å…·ã€‚ä¸è¿‡ï¼Œç›®å‰å¤§æŠµè¿˜å¤„ç†ä½Žæ°´å¹³ä½¿ç”¨é˜¶æ®µã€‚å› ä¸º Hooks å¤ªæ–°äº†æ‰€ä»¥å¤§å®¶éƒ½è¿˜åœ¨ä½Žæ°´å¹³åœ°ä½¿ç”¨å®ƒï¼Œå°¤å…¶æ˜¯åœ¨ä¸€äº›æ•™ç¨‹ç¤ºä¾‹ä¸­ã€‚ä½†åœ¨å®žè·µä¸­ï¼Œç¤¾åŒºå¾ˆå¯èƒ½å³å°†å¼€å§‹é«˜æ°´å¹³åœ°ä½¿ç”¨ Hooksï¼Œå› ä¸ºå¥½çš„ API ä¼šæœ‰æ›´å¥½çš„åŠ¨é‡å’Œå†²åŠ²ã€‚æˆ‘çœ‹åˆ°ä¸åŒçš„åº”ç”¨åœ¨åˆ›é€ ä»–ä»¬è‡ªå·±çš„ Hooksï¼Œæ¯”å¦‚å°è£…äº†åº”ç”¨é‰´æƒé€»è¾‘çš„useFetchæˆ–è€…ä½¿ç”¨ theme context çš„useTheme ã€‚ä½ ä¸€æ—¦æœ‰äº†åŒ…å«è¿™äº›çš„å·¥å…·ç®±ï¼Œä½ å°±ä¸ä¼šé‚£ä¹ˆé¢‘ç¹åœ°ç›´æŽ¥ä½¿ç”¨useEffectã€‚ä½†æ¯ä¸€ä¸ªåŸºäºŽå®ƒçš„ Hook éƒ½èƒ½ä»Žå®ƒçš„é€‚åº”èƒ½åŠ›ä¸­å¾—åˆ°ç›Šå¤„ã€‚ç›®å‰ä¸ºæ­¢ï¼ŒuseEffectä¸»è¦ç”¨äºŽæ•°æ®è¯·æ±‚ã€‚ä½†æ˜¯æ•°æ®è¯·æ±‚å‡†ç¡®è¯´å¹¶ä¸æ˜¯ä¸€ä¸ªåŒæ­¥é—®é¢˜ã€‚å› ä¸ºæˆ‘ä»¬çš„ä¾èµ–ç»å¸¸æ˜¯[]æ‰€ä»¥è¿™ä¸€ç‚¹å°¤å…¶æ˜Žæ˜¾ã€‚é‚£æˆ‘ä»¬ç©¶ç«Ÿåœ¨åŒæ­¥ä»€ä¹ˆï¼Ÿé•¿è¿œæ¥çœ‹ï¼Œ Suspense ç”¨äºŽæ•°æ®è¯·æ±‚ ä¼šå…è®¸ç¬¬ä¸‰æ–¹åº“é€šè¿‡ç¬¬ä¸€ç­‰çš„é€”å¾„å‘Šè¯‰ React æš‚åœæ¸²æŸ“ç›´åˆ°æŸäº›å¼‚æ­¥äº‹ç‰©ï¼ˆä»»ä½•ä¸œè¥¿ï¼šä»£ç ï¼Œæ•°æ®ï¼Œå›¾ç‰‡ï¼‰å·²ç»å‡†å¤‡å°±ç»ªã€‚å½“ Suspense é€æ¸åœ°è¦†ç›–åˆ°æ›´å¤šçš„æ•°æ®è¯·æ±‚ä½¿ç”¨åœºæ™¯ï¼Œæˆ‘é¢„æ–™useEffect ä¼šé€€å±…å¹•åŽä½œä¸ºä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œç”¨äºŽåŒæ­¥ props å’Œ state åˆ°æŸäº›å‰¯ä½œç”¨ã€‚ä¸åƒæ•°æ®è¯·æ±‚ï¼Œå®ƒå¯ä»¥å¾ˆå¥½åœ°å¤„ç†è¿™äº›åœºæ™¯å› ä¸ºå®ƒå°±æ˜¯ä¸ºæ­¤è€Œè®¾è®¡çš„ã€‚ä¸è¿‡åœ¨é‚£ä¹‹å‰ï¼Œè‡ªå®šä¹‰çš„ Hooks æ¯”å¦‚è¿™å„¿æåˆ°çš„æ˜¯å¤ç”¨æ•°æ®è¯·æ±‚é€»è¾‘å¾ˆå¥½çš„æ–¹å¼ã€‚åœ¨ç»“æŸå‰çŽ°åœ¨ä½ å·®ä¸å¤šçŸ¥é“äº†æˆ‘å…³äºŽå¦‚ä½•ä½¿ç”¨ effects çš„æ‰€æœ‰çŸ¥è¯†ï¼Œå¯ä»¥æ£€æŸ¥ä¸€ä¸‹å¼€å¤´çš„ TLDRã€‚ä½ çŽ°åœ¨è§‰å¾—å®ƒè¯´å¾—æœ‰é“ç†å—ï¼Ÿæˆ‘æœ‰é—æ¼ä»€ä¹ˆå—ï¼Ÿï¼ˆæˆ‘çš„çº¸è¿˜æ²¡æœ‰å†™å®Œï¼ï¼‰æˆ‘å¾ˆæƒ³åœ¨ Twitter ä¸Šå¬å¬ä½ çš„æƒ³æ³•ã€‚è°¢è°¢é˜…è¯»ã€‚æœ¬æ–‡ä½œè€…ï¼š Andyæœ¬æ–‡åœ°å€ï¼š https://andyxw.com/archives/1f7a.htmlç‰ˆæƒå£°æ˜Žï¼š è½¬è½½è¯·æ³¨æ˜Žå‡ºå¤„ï¼]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>React</tag>
        <tag>å‰ç«¯</tag>
        <tag>React Hooks</tag>
        <tag>useEffect</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[What are React Hooks]]></title>
    <url>%2Farchives%2Fef81.html</url>
    <content type="text"><![CDATA[æœ¬æ–‡ç”± ç®€æ‚¦ SimpRead è½¬ç ï¼Œ åŽŸæ–‡åœ°å€ https://www.robinwieruch.de/react-hooks/October 29, 2018 - Edit this Post on GitHubReact Hooks were introduced at React Conf October 2018 as a way to use state and side-effects in React function components. Whereas function components have been called functional stateless components (FSC) before, they are finally able to use state with React Hooks. Therefore, many people refer to them as function components now.In this walkthrough, I want to explain the motivation behind hooks, what will change in React and why we shouldnâ€™t panic, and how React hooks can be used in function components by showcasing common React Hooks such as the state and effect hooks by example.React Hooks were invented by the React team to introduce state management and side-effects in function components. Itâ€™s their way of making it more effortless to use only React function components without the need to refactor a React function component to a React class component for using lifecycle methods, in order to use have side-effects, or local state. React Hooks enable us to write React applications with only function components.Unnecessary Component Refactorings: Previously, only React class components were used for local state management and lifecycle methods. The latter have been essential for introducing side-effects, such as listeners or data fetching, in React class components.12345678910111213141516171819202122232425262728import React from &apos;react&apos;;class Counter extends React.Component &#123; constructor(props) &#123; super(props); this.state = &#123; count: 0, &#125;; &#125; render() &#123; return ( &lt;div&gt; &lt;p&gt;You clicked &#123;this.state.count&#125; times&lt;/p&gt; &lt;button onClick=&#123;() =&gt; this.setState(&#123; count: this.state.count + 1 &#125;) &#125; &gt; Click me &lt;/button&gt; &lt;/div&gt; ); &#125;&#125;export default Counter;Only if you didnâ€™t need state or lifecycle methods, React functional stateless components could be used. And because React function components are more lightweight (and elegant), people already used plenty of function components. This came with the drawback of refactoring components from React function components to React class components every time state or lifecycle methods were needed (and vice versa).1234567891011121314151617import React, &#123; useState &#125; from &apos;react&apos;;// how to use the state hook in a React function componentfunction Counter() &#123; const [count, setCount] = useState(0); return ( &lt;div&gt; &lt;p&gt;You clicked &#123;count&#125; times&lt;/p&gt; &lt;button onClick=&#123;() =&gt; setCount(count + 1)&#125;&gt; Click me &lt;/button&gt; &lt;/div&gt; );&#125;export default Counter;With Hooks there is no need for this refactoring. Side-effects and state are finally available in React function components. Thatâ€™s why a rebranding from functional stateless components to function components would be reasonable.Side-effect Logic: In React class components, side-effects were mostly introduced in lifecycle methods (e.g. componentDidMount, componentDidUpdate, componentWillUnmount). A side-effect could be fetching data in React or interacting with the Browser API. Usually these side-effects came with a setup and clean up phase. For instance, if you would miss to remove your listener, you could run into React performance issues.12345678910111213141516171819202122232425262728293031// side-effects in a React class componentclass MyComponent extends Component &#123; // setup phase componentDidMount() &#123; // add listener for feature 1 // add listener for feature 2 &#125; // clean up phase componentWillUnmount() &#123; // remove listener for feature 1 // remove listener for feature 2 &#125; ...&#125;// side-effects in React function component with React Hooksfunction MyComponent() &#123; useEffect(() =&gt; &#123; // add listener for feature 1 (setup) // return function to remove listener for feature 1 (clean up) &#125;); useEffect(() =&gt; &#123; // add listener for feature 2 (setup) // return function to remove listener for feature 2 (clean up) &#125;); ...&#125;Now, if you would introduce more than one of these side-effects in a React class componentâ€™s lifecycle methods, all side-effects would be grouped by lifecycle method but not by side-effect. Thatâ€™s what React Hooks are going to change by encapsulating a side-effect in one hook whereas every hook has its own side-effect with a setup and clean up phase. You will see later in a tutorial how this works for real by adding and removing listeners in a React Hook.Reactâ€™s Abstraction Hell: Abstraction and thus reusability were introduced with Higher-Order Components and Render Prop Components in React. There is also Reactâ€™s Context with its Provider and Consumer Components that introduce another level of abstraction. All of these advanced patterns in React are using so called wrapping components. The implementation of the following components shouldnâ€™t be foreign to developers who are creating larger React applications.12345678910111213141516171819import &#123; compose &#125; from &apos;recompose&apos;;import &#123; withRouter &#125; from &apos;react-router-dom&apos;;function App(&#123; history, state, dispatch &#125;) &#123; return ( &lt;ThemeContext.Consumer&gt; &#123;theme =&gt; &lt;Content theme=&#123;theme&#125;&gt; ... &lt;/Content&gt; &#125; &lt;/ThemeContext.Consumer&gt; );&#125;export default compose( withRouter, withReducer(reducer, initialState))(App);Sophie Alpert coined it â€œthe wrapper hellâ€ in React. You are not only seeing it in the implementation, but also when inspecting your components in the browser. There are dozens of wrapped components due to Render Prop Components (including Consumer components from Reactâ€™s Context) and Higher-Order Components. It becomes an unreadable component tree, because all the abstracted logic is covered up in other React components. The actual visible components are hard to track down in the browserâ€™s DOM. So what if these additional components were not needed because the logic is only encapsulated in functions as side-effects instead? Then you would remove all these wrapping components and flatten your component treeâ€™s structure:12345678910111213function App() &#123; const theme = useTheme(); const history = useRouter(); const [state, dispatch] = useReducer(reducer, initialState); return ( &lt;Content theme=&#123;theme&#125;&gt; ... &lt;/Content&gt; );&#125;export default App;Thatâ€™s what React Hooks are bringing on the table. All side-effects are sitting directly in the component without introducing other components as container for business logic. The container disappears and the logic just sits in React Hooks that are only functions. Andrew Clark already left a statement in favor of React Hooks in his popular Higher-Order Component library called recompose.JavaScript Class Confusion: JavaScript mixes two worlds pretty well: Object-oriented programming (OOP) and functional programming. React introduces many developers to both worlds. On the one side, React (and Redux) introduced people to functional programming (FP) with function compositions, general programming concepts with functions (e.g. higher-order functions, JavaScript built-in methods like map, reduce, filter) and other terms such as immutability and side-effects. React itself didnâ€™t really introduce these things, because they are features of the language or the programming paradigm itself, but they are heavily used in React whereas every React developer becomes automatically a better JavaScript developer.On the other side, React uses JavaScript classes as one way to define React components. A class is only the declaration whereas the actual usage of the component is the instantiation of it. It creates a class instance whereas the this object of the class instance is used to interact with class methods (e.g. setState, forceUpdate, other custom class methods). However, classes come with a steeper learning curve for React beginners who are not coming from an OOP background. Thatâ€™s why class bindings, the this object and inheritance can be confusing. I have a few chapters in my React book focusing only on this aspect of React which is always the most confusing thing about React for beginners.123456789101112131415161718192021222324252627282930313233343536373839404142// I THOUGHT WE ARE USING A CLASS. WHY IS IT EXTENDING FROM SOMETHING?class Counter extends Component &#123; // WAIT ... THIS WORKS??? state = &#123; value: 0 &#125;; // I THOUGH IT&apos;S THIS WAY, BUT WHY DO I NEED PROPS HERE? // constructor(props) &#123; // SUPER??? // super(props); // // this.state = &#123; // value: 0, // &#125;; // &#125; // WHY DO I HAVE TO USE AN ARROW FUNCTION??? onIncrement = () =&gt; &#123; this.setState(state =&gt; (&#123; value: state.value + 1 &#125;)); &#125;; // SHOULDN&apos;T IT BE this.onDecrement = this.onDecrement.bind(this); in the constructor??? // WHAT&apos;S this.onDecrement = this.onDecrement.bind(this); DOING ANYWAY? onDecrement = () =&gt; &#123; this.setState(state =&gt; (&#123; value: state.value - 1 &#125;)); &#125;; render() &#123; return ( &lt;div&gt; &#123;this.state.value&#125; &#123;/* WHY IS EVERYTHING AVAILABLE ON &quot;THIS&quot;??? */&#125; &lt;button onClick=&#123;this.onIncrement&#125;&gt;+&lt;/button&gt; &lt;button onClick=&#123;this.onDecrement&#125;&gt;-&lt;/button&gt; &lt;/div&gt; ) &#125;&#125;Now, many people argue React shouldnâ€™t take JavaScript classes away because people donâ€™t understand them. After all, they belong to the language. However, one of the hypotheses of introducing the Hooks API is a smoother learning curve for React beginners when writing their React components without JavaScript classes in the first place.Every time a new feature is introduced, people are concerned about it. There is one side of the group that is ecstatic about the change, and the other side that fears the change. I heard the most common concerns for React Hooks are:Everything changes! Subtle panic mode â€¦React is becoming bloated like Angular!Itâ€™s useless, classes worked fine.Itâ€™s magic!Let me address these concerns here:Everything changes: React Hooks will change how we write React applications in the future. However, at the moment, nothing changes. You can still write class components with local state and lifecycle methods and deploy advanced patterns such as Higher-Order Components or Render Prop Components. Nobody takes these learnings away from you. See how I upgraded all my open source projects from older versions to React 16.6. and none of of these projects had problems. They are using HOCs, Render Props and I believe even the old context API (correct me if am wrong). Everything I have learned all these years still works. The React team makes sure that React stays backward compatible. It will be the same with React 16.7.React is becoming bloated like Angular: React was always seen as a library with a slim API. Thatâ€™s true and shall be true in the future. However, in order to adjust things that were the status quo of building component-based applications a few years ago, and not to be overtaken by other libraries who adapt to the new status quo, React introduces changes in favor of older APIs. If React would start out fresh this year, maybe there would be only function components and hooks. But React was released a couple of years ago and needs to adapt to keep up with the status quo or to invent a status quo. Maybe there will follow deprecations of React class components and lifecycle methods in a few years in favor of React function components and hooks, but at the moment, the React team keeps React class components in their repertoire of tools. After all, the React team utilizes hooks as an invention to run a marathon with React an not to win a sprint. Obviously, React Hooks add yet another API to React, but it is in favor to simplify Reactâ€™s API in the future. I like this transition more than having a React 2 where everything is different.Itâ€™s useless, classes worked fine: Imagine you would start from zero to learn React and you would be introduced to React with Hooks. Maybe create-react-app wouldnâ€™t start out with a React class component but with a React function component. Everything you need to learn for your components would be React Hooks. They manage state and side-effects, so you would only need to know about the state and the effect hook. Itâ€™s everything a React class component did for you before. It will be simpler for React beginners to learn React without all the other overhead that comes with JavaScript classes (inheritance, this, bindings, super, â€¦). Imagine React Hooks as a new way of how to write React components - Itâ€™s a new mindset. I am a skeptical person myself, but once I wrote a couple of simpler scenarios with React Hooks, I was convinced that this is the simplest way to write but also to learn React. As someone who is doing lots of React workshops, I argue that it takes away all the frustration classes bring on the table for React beginners.Itâ€™s magic: React is known to be down to earth with JavaScript. Writing React applications makes you a better JavaScript developer - thatâ€™s one of the best things about React when someone asks me: â€œWhy should I learn React?â€. Whether there comes another library in the future or not, everyone is prepared by honing their JavaScript skills and general programming skills when using React. Itâ€™s one of the things that made Redux, often used in React, popular: There is no magic, it is plain JavaScript. Now these React Hooks come along the way, introduce something stateful in a previously often pure function component, a couple of not easily to accept rules, and many donâ€™t understand whatâ€™s going on under the hood. But think about it this way: A function component in React is not a mere function. You still have to import React as library to your source code file. It does something with your function, because the function becomes a function component in React land. This function component comes with hidden implementations that were there all the time. How else would it have been possible to use functions as function components as we did it before React Hooks were introduced? And people accepted it too, even though itâ€™s kinda magic. Now, the only thing changed (and maybe it has already been this way before) is that these function components come with an extra hidden object that keeps track of hooks. To quote Dan Abramov from his article about hooks: â€œPerhaps youâ€™re wondering where React keeps the state for Hooks. The answer is itâ€™s kept in the exact same place where React keeps state for classes. React has an internal update queue which is the source of truth for any state, no matter how you define your components.â€.Finally, think about it this way: Component-based solutions such as Angular, Vue, and React are pushing the boundaries of web development with every release. They build up on top of technologies that were invented more than two decades ago. They adapt them to make web development effortless in 2018 and not 1998. They optimize them like crazy to meet the needs in the here and now. We are building web applications with components and not with HTML templates anymore. We are not there yet, but I imagine a future where we sit together and invent a component-based standard for the browser. Angular, Vue and React are only the spearhead of this movement.In the following, I want to dive into a few popular React Hooks by example to get you up to speed. All examples can be found in this GitHub repository.You have seen the useState Hook before in a code snippet for a typical counter example. It is used to manage local state in function components. Letâ€™s use the hook in a more elaborate example where we are going to manage an array of items. In another article of mine, you can learn more about managing arrays as state in React, but this time we are doing it with React hooks. Letâ€™s get started:12345678910111213141516171819202122232425262728293031import React, &#123; useState &#125; from &apos;react&apos;;const INITIAL_LIST = [ &#123; id: &apos;0&apos;, title: &apos;React with RxJS for State Management Tutorial&apos;, url: &apos;https://www.robinwieruch.de/react-rxjs-state-management-tutorial/&apos;, &#125;, &#123; id: &apos;1&apos;, title: &apos;A complete React with Apollo and GraphQL Tutorial&apos;, url: &apos;https://www.robinwieruch.de/react-graphql-apollo-tutorial&apos;, &#125;,];function App() &#123; const [list, setList] = useState(INITIAL_LIST); return ( &lt;ul&gt; &#123;list.map(item =&gt; ( &lt;li key=&#123;item.id&#125;&gt; &lt;a href=&#123;item.url&#125;&gt;&#123;item.title&#125;&lt;/a&gt; &lt;/li&gt; ))&#125; &lt;/ul&gt; );&#125;export default App;The useState hook accepts an initial state as argument and returns, by using array destructuring, two variables that can be named however you want to name them. Whereas the first variable is the actual state, the second variable is a function to update the state by providing a new state.The goal of this scenario is to remove an item from the list. In order to accomplish it, every item in the rendered list has a button with a click handler. The click handler can be inlined in the function component, because it will make use of list and setList later. Hence you donâ€™t need to pass these variables to the handler, because they are already available from the outer scope of the component.123456789101112131415161718192021function App() &#123; const [list, setList] = useState(INITIAL_LIST); function onRemoveItem() &#123; // remove item from &quot;list&quot; // set the new list in state with &quot;setList&quot; &#125; return ( &lt;ul&gt; &#123;list.map(item =&gt; ( &lt;li key=&#123;item.id&#125;&gt; &lt;a href=&#123;item.url&#125;&gt;&#123;item.title&#125;&lt;/a&gt; &lt;button type=&quot;button&quot; onClick=&#123;onRemoveItem&#125;&gt; Remove &lt;/button&gt; &lt;/li&gt; ))&#125; &lt;/ul&gt; );&#125;Somehow we need to know about the item that should be removed from the list. Using a higher-order function, we can pass the identifier of the item to the handler function. Otherwise we wouldnâ€™t be able to identify the item that should be removed from the list.123456789101112131415161718192021function App() &#123; const [list, setList] = useState(INITIAL_LIST); function onRemoveItem(id) &#123; // remove item from &quot;list&quot; // set the new list in state with &quot;setList&quot; &#125; return ( &lt;ul&gt; &#123;list.map(item =&gt; ( &lt;li key=&#123;item.id&#125;&gt; &lt;a href=&#123;item.url&#125;&gt;&#123;item.title&#125;&lt;/a&gt; &lt;button type=&quot;button&quot; onClick=&#123;() =&gt; onRemoveItem(item.id)&#125;&gt; Remove &lt;/button&gt; &lt;/li&gt; ))&#125; &lt;/ul&gt; );&#125;Finally, use the identifier to filter the list with a built-in array method. It returns a new list which is used to set the new state of the list.123456789101112131415161718192021function App() &#123; const [list, setList] = useState(INITIAL_LIST); function onRemoveItem(id) &#123; const newList = list.filter(item =&gt; item.id !== id); setList(newList); &#125; return ( &lt;ul&gt; &#123;list.map(item =&gt; ( &lt;li key=&#123;item.id&#125;&gt; &lt;a href=&#123;item.url&#125;&gt;&#123;item.title&#125;&lt;/a&gt; &lt;button type=&quot;button&quot; onClick=&#123;() =&gt; onRemoveItem(item.id)&#125;&gt; Remove &lt;/button&gt; &lt;/li&gt; ))&#125; &lt;/ul&gt; );&#125;That should do the job. You are able to remove an item from the list based on the identifier you pass to the handler. The handler then filters the list and sets the new state of the list with the setList function.The useState hook gives you everything you need to manage state in a function component: initial state, the latest state, and a state update function. Everything else is JavaScript again. Furthermore, you donâ€™t need to bother about the state object with its shallow merge as before in a class component. Instead, you encapsulate one domain (e.g. list) with useState, but if you would need another state (e.g. counter), then just encapsulate this domain with another useState. You can read more about the useState hook in Reactâ€™s documentation.Letâ€™s head over to the next hook called useEffect. As mentioned before, function components should be able to manage state and side-effects with hooks. Managing state was showcased with the useState hook. Now comes the useEffect hook into play for side-effects which are usually used for interactions with the Browser/DOM API or external API like data fetching. Letâ€™s see how the useEffect hook can be used for interaction with the Browser API by implementing a simple stopwatch. You can see how it is done in a React class component in this GitHub repository.1234567891011121314151617181920212223import React, &#123; useState &#125; from &apos;react&apos;;function App() &#123; const [isOn, setIsOn] = useState(false); return ( &lt;div&gt; &#123;!isOn &amp;&amp; ( &lt;button type=&quot;button&quot; onClick=&#123;() =&gt; setIsOn(true)&#125;&gt; Start &lt;/button&gt; )&#125; &#123;isOn &amp;&amp; ( &lt;button type=&quot;button&quot; onClick=&#123;() =&gt; setIsOn(false)&#125;&gt; Stop &lt;/button&gt; )&#125; &lt;/div&gt; );&#125;export default App;There is no stopwatch yet. But at least there are is a conditional rendering to show either a â€œStartâ€ or â€œStopâ€ button. The state for the boolean flag is managed by the useState hook.Letâ€™s introduce our side-effect with useEffect that registers an interval. The function used for the interval emits a console logging every second to your developer tools of your browser.123456789101112131415161718192021222324252627import React, &#123; useState, useEffect &#125; from &apos;react&apos;;function App() &#123; const [isOn, setIsOn] = useState(false); useEffect(() =&gt; &#123; setInterval(() =&gt; console.log(&apos;tick&apos;), 1000); &#125;); return ( &lt;div&gt; &#123;!isOn &amp;&amp; ( &lt;button type=&quot;button&quot; onClick=&#123;() =&gt; setIsOn(true)&#125;&gt; Start &lt;/button&gt; )&#125; &#123;isOn &amp;&amp; ( &lt;button type=&quot;button&quot; onClick=&#123;() =&gt; setIsOn(false)&#125;&gt; Stop &lt;/button&gt; )&#125; &lt;/div&gt; );&#125;export default App;In order to remove the interval when the component unmounts (but also after every other render update), you can return a function in useEffect for anything to be called for the clean up. For instance, there shouldnâ€™t be any memory leak left behind when the component isnâ€™t there anymore.123456789101112131415import React, &#123; useState, useEffect &#125; from &apos;react&apos;;function App() &#123; const [isOn, setIsOn] = useState(false); useEffect(() =&gt; &#123; const interval = setInterval(() =&gt; console.log(&apos;tick&apos;), 1000); return () =&gt; clearInterval(interval); &#125;); ...&#125;export default App;Now, you want to setup the side-effect when mounting the component and the clean up the side-effect when unmounting the component. If you would log how many times the function within the effect is called, you would see that it sets a new interval every time the state of the component changes (e.g. click on â€œStartâ€/â€œStopâ€ button).12345678910111213141516import React, &#123; useState, useEffect &#125; from &apos;react&apos;;function App() &#123; const [isOn, setIsOn] = useState(false); useEffect(() =&gt; &#123; console.log(&apos;effect runs&apos;); const interval = setInterval(() =&gt; console.log(&apos;tick&apos;), 1000); return () =&gt; clearInterval(interval); &#125;); ...&#125;export default App;In order to only run the effect on mount and unmount of the component, you can pass it an empty array as second argument.123456789101112131415import React, &#123; useState, useEffect &#125; from &apos;react&apos;;function App() &#123; const [isOn, setIsOn] = useState(false); useEffect(() =&gt; &#123; const interval = setInterval(() =&gt; console.log(&apos;tick&apos;), 1000); return () =&gt; clearInterval(interval); &#125;, []); ...&#125;export default App;However, since the interval is cleaned up after every render too, we need to set the interval in our update cycle too. But we can tell the effect to run only when the isOn variable changes. Only when one of the variables in the array changes, the effect will run during the update cycle. If you keep the array empty, the effect will only run on mount and unmount, because there is no variable to be checked for running the side-effect again.123456789101112131415import React, &#123; useState, useEffect &#125; from &apos;react&apos;;function App() &#123; const [isOn, setIsOn] = useState(false); useEffect(() =&gt; &#123; const interval = setInterval(() =&gt; console.log(&apos;tick&apos;), 1000); return () =&gt; clearInterval(interval); &#125;, [isOn]); ...&#125;export default App;The interval is running whether the isOn boolean is true or false. It would be great to only run it when the stopwatch is activated.12345678910111213141516171819import React, &#123; useState, useEffect &#125; from &apos;react&apos;;function App() &#123; const [isOn, setIsOn] = useState(false); useEffect(() =&gt; &#123; let interval; if (isOn) &#123; interval = setInterval(() =&gt; console.log(&apos;tick&apos;), 1000); &#125; return () =&gt; clearInterval(interval); &#125;, [isOn]); ...&#125;export default App;Now introduce another state in your function component to keep track of the timer of the stopwatch. It is used to update the timer, but only when the stopwatch is activated.123456789101112131415161718192021222324252627282930313233343536373839import React, &#123; useState, useEffect &#125; from &apos;react&apos;;function App() &#123; const [isOn, setIsOn] = useState(false); const [timer, setTimer] = useState(0); useEffect(() =&gt; &#123; let interval; if (isOn) &#123; interval = setInterval( () =&gt; setTimer(timer + 1), 1000, ); &#125; return () =&gt; clearInterval(interval); &#125;, [isOn]); return ( &lt;div&gt; &#123;timer&#125; &#123;!isOn &amp;&amp; ( &lt;button type=&quot;button&quot; onClick=&#123;() =&gt; setIsOn(true)&#125;&gt; Start &lt;/button&gt; )&#125; &#123;isOn &amp;&amp; ( &lt;button type=&quot;button&quot; onClick=&#123;() =&gt; setIsOn(false)&#125;&gt; Stop &lt;/button&gt; )&#125; &lt;/div&gt; );&#125;export default App;There is still one mistake in the code. When the interval is running, it updates the timer every second by increasing it by one. However, it always relies on a stale state for the timer. Only when the inOn boolean flag changes the state is fine. In order to receive always the latest state for the timer when the interval is running, you can use a function instead for the state update function which always has the latest state.1234567891011121314151617181920212223import React, &#123; useState, useEffect &#125; from &apos;react&apos;;function App() &#123; const [isOn, setIsOn] = useState(false); const [timer, setTimer] = useState(0); useEffect(() =&gt; &#123; let interval; if (isOn) &#123; interval = setInterval( () =&gt; setTimer(timer =&gt; timer + 1), 1000, ); &#125; return () =&gt; clearInterval(interval); &#125;, [isOn]); ...&#125;export default App;An alternative would have been to run the effect also when the timer changes. Then the effect would receive the latest timer state.1234567891011121314151617181920212223import React, &#123; useState, useEffect &#125; from &apos;react&apos;;function App() &#123; const [isOn, setIsOn] = useState(false); const [timer, setTimer] = useState(0); useEffect(() =&gt; &#123; let interval; if (isOn) &#123; interval = setInterval( () =&gt; setTimer(timer + 1), 1000, ); &#125; return () =&gt; clearInterval(interval); &#125;, [isOn, timer]); ...&#125;export default App;Thatâ€™s the implementation for the stopwatch that uses the Browser API If you want to continue, you can extend the example by providing a â€œResetâ€ button too.123456789101112131415161718192021222324252627282930313233343536373839404142434445464748import React, &#123; useState, useEffect &#125; from &apos;react&apos;;function App() &#123; const [isOn, setIsOn] = useState(false); const [timer, setTimer] = useState(0); useEffect(() =&gt; &#123; let interval; if (isOn) &#123; interval = setInterval( () =&gt; setTimer(timer =&gt; timer + 1), 1000, ); &#125; return () =&gt; clearInterval(interval); &#125;, [isOn]); const onReset = () =&gt; &#123; setIsOn(false); setTimer(0); &#125;; return ( &lt;div&gt; &#123;timer&#125; &#123;!isOn &amp;&amp; ( &lt;button type=&quot;button&quot; onClick=&#123;() =&gt; setIsOn(true)&#125;&gt; Start &lt;/button&gt; )&#125; &#123;isOn &amp;&amp; ( &lt;button type=&quot;button&quot; onClick=&#123;() =&gt; setIsOn(false)&#125;&gt; Stop &lt;/button&gt; )&#125; &lt;button type=&quot;button&quot; disabled=&#123;timer === 0&#125; onClick=&#123;onReset&#125;&gt; Reset &lt;/button&gt; &lt;/div&gt; );&#125;export default App;Thatâ€™s it. The useEffect hook is used for side-effects in React function components that are used for interacting with the Browser/DOM API or other third-party APIs (e.g. data fetching). You can read more about the useEffect hook in Reactâ€™s documentation.Last but not least, after you have learned about the two most popular hooks that introduce state and side-effects in function components, there is one last thing I want to show you: custom hooks. Thatâ€™s right, you can implement your own custom React Hooks that can be reused in your application or by others. Letâ€™s see how they work with an example application which is able to detect whether your device is online or offline.12345678910111213import React, &#123; useState &#125; from &apos;react&apos;;function App() &#123; const [isOffline, setIsOffline] = useState(false); if (isOffline) &#123; return &lt;div&gt;Sorry, you are offline ...&lt;/div&gt;; &#125; return &lt;div&gt;You are online!&lt;/div&gt;;&#125;export default App;Again, introduce the useEffect hook for the side-effect. In this case, the effect adds and removes listeners that check if the device is online or offline. Both listeners are setup only once on mount and cleaned up once on unmount (empty array as second argument). Whenever one of the listeners is called, it sets the state for the isOffline boolean.12345678910111213141516171819202122232425262728293031import React, &#123; useState, useEffect &#125; from &apos;react&apos;;function App() &#123; const [isOffline, setIsOffline] = useState(false); function onOffline() &#123; setIsOffline(true); &#125; function onOnline() &#123; setIsOffline(false); &#125; useEffect(() =&gt; &#123; window.addEventListener(&apos;offline&apos;, onOffline); window.addEventListener(&apos;online&apos;, onOnline); return () =&gt; &#123; window.removeEventListener(&apos;offline&apos;, onOffline); window.removeEventListener(&apos;online&apos;, onOnline); &#125;; &#125;, []); if (isOffline) &#123; return &lt;div&gt;Sorry, you are offline ...&lt;/div&gt;; &#125; return &lt;div&gt;You are online!&lt;/div&gt;;&#125;export default App;Everything is nicely encapsulated in one effect now. Itâ€™s a great functionality which should be reuse somewhere else too. Thatâ€™s why we can extract the functionality as its a custom hook which follows the same naming convention as the other hooks.12345678910111213141516171819202122232425262728293031323334353637import React, &#123; useState, useEffect &#125; from &apos;react&apos;;function useOffline() &#123; const [isOffline, setIsOffline] = useState(false); function onOffline() &#123; setIsOffline(true); &#125; function onOnline() &#123; setIsOffline(false); &#125; useEffect(() =&gt; &#123; window.addEventListener(&apos;offline&apos;, onOffline); window.addEventListener(&apos;online&apos;, onOnline); return () =&gt; &#123; window.removeEventListener(&apos;offline&apos;, onOffline); window.removeEventListener(&apos;online&apos;, onOnline); &#125;; &#125;, []); return isOffline;&#125;function App() &#123; const isOffline = useOffline(); if (isOffline) &#123; return &lt;div&gt;Sorry, you are offline ...&lt;/div&gt;; &#125; return &lt;div&gt;You are online!&lt;/div&gt;;&#125;export default App;Extracting the custom hook as function was not the only thing. You also have to return the isOffline state from the custom hook in order to use it in your application to show a message to users who are offline. Otherwise, it should render the normal application. Thatâ€™s it for the custom hook that detects whether you are online or offline. You can read more about custom hooks in Reactâ€™s documentation.React Hooks being reusable is the best thing about them, because there is the potential to grow an ecosystem of custom React Hooks that can be installed from npm for any React application. And not only for React applications. Evan You, creator of Vue, is hooked (!) by them as well. Maybe we will see a bridge between both ecosystems where it is possible to share hooks between Vue and React.If you want to dive deeper into the state and effect hooks, you can check out the following React hook tutorials:How to useReducer Hook?Migration from Class Components to HooksComparison useState vs useReducerModern State Management with HooksHow to fetch data with React HooksCheckout the official FAQ and Rules for hooks in Reactâ€™s documentation to learn more about their fine-grained behaviour. In addition, you can checkout all officially available React Hooks too.For everyone who is still concerned about React Hooks: Give them a shot yourself. Implement a couple of React function components with state and side-effects. I had to do it myself to understand how they work and to feel comfortable with them. And I must say it feels pretty great to use them.The Road to learn ReactBuild a Hacker News App along the way. No setup configuration. No tooling. No Redux. Plain React in 200+ pages of learning material. Learn React like 50.000+ readers.Get the Book for freeNever miss an article about web development, JavaScript and self-growth.Take PartJoin 30.000+ DevelopersLearn Web Development with JavaScriptTips and TricksAccess Tutorials, eBooks and CoursesPersonal Development as a Software Engineeræœ¬æ–‡ä½œè€…ï¼š Andyæœ¬æ–‡åœ°å€ï¼š https://andyxw.com/archives/ef81.htmlç‰ˆæƒå£°æ˜Žï¼š è½¬è½½è¯·æ³¨æ˜Žå‡ºå¤„ï¼]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>React</tag>
        <tag>å‰ç«¯</tag>
        <tag>React Hooks</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å‰ç«¯ç›¸å…³æ–‡ç« æ”¶è—]]></title>
    <url>%2Farchives%2Ff37d.html</url>
    <content type="text"><![CDATA[å‰ç«¯æž¶æž„æ”¯ä»˜å®å‰ç«¯åº”ç”¨æž¶æž„çš„å‘å±•å’Œé€‰æ‹©æœ¬æ–‡ä½œè€…ï¼š Andyæœ¬æ–‡åœ°å€ï¼š https://andyxw.com/archives/f37d.htmlç‰ˆæƒå£°æ˜Žï¼š è½¬è½½è¯·æ³¨æ˜Žå‡ºå¤„ï¼]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>å‰ç«¯</tag>
        <tag>é“¾æŽ¥</tag>
        <tag>æ”¶è—</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æœåŠ¡å™¨é‡ç½®å¯†ç ]]></title>
    <url>%2Farchives%2Ffe92.html</url>
    <content type="text"><![CDATA[æœ‰æ—¶å€™ä¼šå¿˜è®°æœåŠ¡å™¨å¯†ç ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡å®˜ç½‘é¢æ¿ç­‰æ–¹å¼è¿žä¸Šæ—¶ï¼Œå¯ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ä¿®æ”¹rootå¯†ç ï¼šæ•´æ®µèµ‹å€¼ä¸‹é¢çš„å‘½ä»¤ï¼ˆâ€æ–°å¯†ç â€å¤„ æ›¿æ¢ä¸ºè¦ä¿®æ”¹çš„å¯†ç ï¼‰ï¼š1234echo root:æ–°å¯†ç  |sudo chpasswd rootsudo sed -i &apos;s/^.*PermitRootLogin.*/PermitRootLogin yes/g&apos; /etc/ssh/sshd_config;sudo sed -i &apos;s/^.*PasswordAuthentication.*/PasswordAuthentication yes/g&apos; /etc/ssh/sshd_config;sudo rebooté‡å¯åŽç”¨rootè´¦æˆ·ç™»å½•å³å¯ã€‚æœ¬æ–‡ä½œè€…ï¼š Andyæœ¬æ–‡åœ°å€ï¼š https://andyxw.com/archives/fe92.htmlç‰ˆæƒå£°æ˜Žï¼š è½¬è½½è¯·æ³¨æ˜Žå‡ºå¤„ï¼]]></content>
      <categories>
        <category>æœåŠ¡å™¨</category>
      </categories>
      <tags>
        <tag>æœåŠ¡å™¨</tag>
        <tag>Linux</tag>
        <tag>é‡ç½®å¯†ç </tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è§£å¯†ä¼ ç»Ÿç»„ä»¶é—´é€šä¿¡ä¸ŽReactç»„ä»¶é—´é€šä¿¡]]></title>
    <url>%2Farchives%2Fac71.html</url>
    <content type="text"><![CDATA[åœ¨Reactä¸­æœ€å°çš„é€»è¾‘å•å…ƒæ˜¯ç»„ä»¶ï¼Œç»„ä»¶ä¹‹é—´å¦‚æžœæœ‰è€¦åˆå…³ç³»å°±ä¼šè¿›è¡Œé€šä¿¡ï¼Œæœ¬æ–‡å°†ä¼šä»‹ç»Reactä¸­çš„ç»„ä»¶é€šä¿¡çš„ä¸åŒæ–¹å¼é€šè¿‡å½’çº³èŒƒï¼Œå¯ä»¥å°†ä»»æ„ç»„ä»¶é—´çš„é€šä¿¡å½’ç±»ä¸ºå››ç§ç±»åž‹çš„ç»„ä»¶é—´é€šä¿¡ï¼Œåˆ†åˆ«æ˜¯çˆ¶å­ç»„ä»¶ï¼Œçˆ·å­™ç»„ä»¶ï¼Œå…„å¼Ÿç»„ä»¶å’Œä»»æ„ç»„ä»¶ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯å‰ä¸‰ä¸ªä¹Ÿå¯ä»¥ç®—ä½œä»»æ„ç»„ä»¶çš„èŒƒç•´ï¼Œæ‰€ä»¥æœ€åŽä¸€ä¸ªæ˜¯ä¸‡èƒ½æ–¹æ³•çˆ¶å­ç»„ä»¶çˆ¶å­ç»„ä»¶é—´çš„é€šä¿¡åˆ†ä¸ºçˆ¶ç»„ä»¶å‘å­ç»„ä»¶é€šä¿¡å’Œå­ç»„ä»¶å‘çˆ¶ç»„ä»¶é€šä¿¡ä¸¤ç§æƒ…å†µï¼Œä¸‹é¢å…ˆæ¥ä»‹ç»çˆ¶ç»„ä»¶å‘å­ç»„ä»¶é€šä¿¡ï¼Œä¼ ç»Ÿåšæ³•åˆ†ä¸ºä¸¤ç§æƒ…å†µï¼Œåˆ†åˆ«æ˜¯åˆå§‹åŒ–æ—¶çš„å‚æ•°ä¼ é€’å’Œå®žä¾‹é˜¶æ®µçš„æ–¹æ³•è°ƒç”¨ï¼Œä¾‹å­å¦‚ä¸‹12345678910111213141516171819202122232425262728class Child &#123; constructor(name) &#123; // èŽ·å–domå¼•ç”¨ this.$div = document.querySelector('#wp'); // åˆå§‹åŒ–æ—¶ä¼ å…¥name this.updateName(name); &#125; updateName(name) &#123; // å¯¹å¤–æä¾›æ›´æ–°çš„api this.name = name; // æ›´æ–°dom this.$div.innerHTML = name; &#125;&#125;class Parent &#123; constructor() &#123; // åˆå§‹åŒ–é˜¶æ®µ this.child = new Child('yan'); setTimeout(() =&gt; &#123; // å®žä¾‹åŒ–é˜¶æ®µ this.child.updateName('hou'); &#125;, 2000); &#125;&#125;åœ¨Reactä¸­å°†ä¸¤ä¸ªæƒ…å†µç»Ÿä¸€å¤„ç†ï¼Œå…¨éƒ¨é€šè¿‡å±žæ€§æ¥å®Œæˆï¼Œä¹‹æ‰€ä»¥èƒ½å¤Ÿè¿™æ ·æ˜¯å› ä¸ºReactåœ¨å±žæ€§æ›´æ–°æ—¶ä¼šè‡ªåŠ¨é‡æ–°æ¸²æŸ“å­ç»„ä»¶ï¼Œä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œ2ç§’åŽå­ç»„ä»¶ä¼šè‡ªåŠ¨é‡æ–°æ¸²æŸ“ï¼Œå¹¶èŽ·å–æ–°çš„å±žæ€§å€¼1234567891011121314151617181920class Child extends Component &#123; render() &#123; return &lt;div&gt;&#123;this.props.name&#125;&lt;/div&gt; &#125;&#125;class Parent extends Component &#123; constructor() &#123; // åˆå§‹åŒ–é˜¶æ®µ this.state = &#123;name: 'yan'&#125;; setTimeout(() =&gt; &#123; // å®žä¾‹åŒ–é˜¶æ®µ this.setState(&#123;name: 'hou'&#125;) &#125;, 2000); &#125; render() &#123; return &lt;Child name=&#123;this.state.name&#125; /&gt; &#125;&#125;ä¸‹é¢æ¥çœ‹ä¸€ä¸‹å­ç»„ä»¶å¦‚ä½•å‘çˆ¶ç»„ä»¶é€šä¿¡ï¼Œä¼ ç»Ÿåšæ³•æœ‰ä¸¤ç§ï¼Œä¸€ç§æ˜¯å›žè°ƒå‡½æ•°ï¼Œå¦ä¸€ç§æ˜¯ä¸ºå­ç»„ä»¶éƒ¨ç½²æ¶ˆæ¯æŽ¥å£å…ˆæ¥çœ‹å›žè°ƒå‡½æ•°çš„ä¾‹å­ï¼Œå›žè°ƒå‡½æ•°çš„ä¼˜ç‚¹æ˜¯éžå¸¸ç®€å•ï¼Œç¼ºç‚¹å°±æ˜¯å¿…é¡»åœ¨åˆå§‹åŒ–çš„æ—¶å€™ä¼ å…¥ï¼Œå¹¶ä¸”ä¸å¯æ’¤å›žï¼Œå¹¶ä¸”åªèƒ½ä¼ å…¥ä¸€ä¸ªå‡½æ•°123456789101112131415class Child &#123; constructor(cb) &#123; // è°ƒç”¨çˆ¶ç»„ä»¶ä¼ å…¥çš„å›žè°ƒå‡½æ•°ï¼Œå‘é€æ¶ˆæ¯ setTimeout(() =&gt; &#123; cb() &#125;, 2000); &#125;&#125;class Parent &#123; constructor() &#123; // åˆå§‹åŒ–é˜¶æ®µï¼Œä¼ å…¥å›žè°ƒå‡½æ•° this.child = new Child(function () &#123; console.log('child update') &#125;); &#125;&#125;ä¸‹é¢æ¥çœ‹çœ‹æ¶ˆæ¯æŽ¥å£æ–¹æ³•ï¼Œé¦–å…ˆéœ€è¦ä¸€ä¸ªå¯ä»¥å‘å¸ƒå’Œè®¢é˜…æ¶ˆæ¯çš„åŸºç±»ï¼Œæ¯”å¦‚ä¸‹é¢å®žçŽ°äº†ä¸€ä¸ªç®€å•çš„EventEimtterï¼Œå®žé™…ç”Ÿäº§ä¸­å¯ä»¥ç›´æŽ¥ä½¿ç”¨åˆ«äººå†™å¥½çš„ç±»åº“ï¼Œæ¯”å¦‚@jsmini/eventï¼Œå­ç»„ä»¶ç»§æ‰¿æ¶ˆæ¯åŸºç±»ï¼Œå°±æœ‰äº†å‘å¸ƒæ¶ˆæ¯çš„èƒ½åŠ›ï¼Œç„¶åŽçˆ¶ç»„ä»¶è®¢é˜…å­ç»„ä»¶çš„æ¶ˆæ¯ï¼Œå³å¯å®žçŽ°å­ç»„ä»¶å‘çˆ¶ç»„ä»¶é€šä¿¡çš„åŠŸèƒ½æ¶ˆæ¯æŽ¥å£çš„ä¼˜ç‚¹å°±æ˜¯å¯ä»¥éšå¤„è®¢é˜…ï¼Œå¹¶ä¸”å¯ä»¥å¤šæ¬¡è®¢é˜…ï¼Œè¿˜å¯ä»¥å–æ¶ˆè®¢é˜…ï¼Œç¼ºç‚¹æ˜¯ç•¥æ˜¾éº»çƒ¦ï¼Œéœ€è¦å¼•å…¥æ¶ˆæ¯åŸºç±»123456789101112131415161718192021222324252627282930313233// æ¶ˆæ¯æŽ¥å£ï¼Œè®¢é˜…å‘å¸ƒæ¨¡å¼ï¼Œç±»ä¼¼ç»‘å®šäº‹ä»¶ï¼Œè§¦å‘äº‹ä»¶class EventEimtter &#123; constructor() &#123; this.eventMap = &#123;&#125;; &#125; sub(name, cb) &#123; const eventList = this.eventMap[name] = this.eventMap[name] || &#123;&#125;; eventList.push(cb); &#125; pub(name, ...data) &#123; (this.eventMap[name] || []).forEach(cb =&gt; cb(...data)); &#125;&#125;class Child extends EventEimtter &#123; constructor() &#123; super(); // é€šè¿‡æ¶ˆæ¯æŽ¥å£å‘å¸ƒæ¶ˆæ¯ setTimeout(() =&gt; &#123; this.pub('update') &#125;, 2000); &#125;&#125;class Parent &#123; constructor() &#123; // åˆå§‹åŒ–é˜¶æ®µï¼Œä¼ å…¥å›žè°ƒå‡½æ•° this.child = new Child(); // è®¢é˜…å­ç»„ä»¶çš„æ¶ˆæ¯ this.child.sub('update', function () &#123; console.log('child update') &#125;); &#125;&#125;Backbone.jså°±åŒæ—¶æ”¯æŒå›žè°ƒå‡½æ•°å’Œæ¶ˆæ¯æŽ¥å£æ–¹å¼ï¼Œä½†Reactä¸­é€‰æ‹©äº†æ¯”è¾ƒç®€å•çš„å›žè°ƒå‡½æ•°æ¨¡å¼ï¼Œä¸‹é¢æ¥çœ‹ä¸€ä¸‹Reactçš„ä¾‹å­1234567891011121314class Child extends Component &#123; constructor(props) &#123; setTimeout(() =&gt; &#123; this.props.cb() &#125;, 2000); &#125; render() &#123; return &lt;div&gt;&lt;/div&gt; &#125;&#125;class Parent extends Component &#123; render() &#123; return &lt;Child cb=&#123;() =&gt; &#123;console.log('update')&#125;&#125; /&gt; &#125;&#125;çˆ·å­™ç»„ä»¶çˆ¶å­ç»„ä»¶å…¶å®žå¯ä»¥ç®—æ˜¯çˆ·å­™ç»„ä»¶çš„ä¸€ç§ç‰¹ä¾‹ï¼Œè¿™é‡Œçš„çˆ·å­™ç»„ä»¶ä¸å…‰æŒ‡çˆ·çˆ·å’Œå­™å­ï¼Œè€Œæ˜¯æ³›æŒ‡ç¥–å…ˆä¸ŽåŽä»£ç»„ä»¶é€šä¿¡ï¼Œå¯èƒ½éš”ç€å¾ˆå¤šå±‚çº§ï¼Œæˆ‘ä»¬å·²ç»è§£å†³äº†çˆ¶å­ç»„ä»¶é€šä¿¡çš„é—®é¢˜ï¼Œæ ¹æ®åŒ–å½’æ³•ï¼Œå¾ˆå®¹æ˜“å¾—å‡ºçˆ·å­™ç»„ä»¶çš„ç­”æ¡ˆï¼Œé‚£å°±æ˜¯å±‚å±‚ä¼ é€’å±žæ€§ä¹ˆï¼ŒæŠŠçˆ·å­™ç»„ä»¶é€šä¿¡åˆ†è§£ä¸ºå¤šä¸ªçˆ¶å­ç»„ä»¶é€šä¿¡çš„é—®é¢˜å±‚å±‚ä¼ é€’çš„ä¼˜ç‚¹æ˜¯éžå¸¸ç®€å•ï¼Œç”¨å·²æœ‰çŸ¥è¯†å°±èƒ½è§£å†³ï¼Œé—®é¢˜æ˜¯ä¼šæµªè´¹å¾ˆå¤šä»£ç ï¼Œéžå¸¸ç¹çï¼Œä¸­é—´ä½œä¸ºæ¡¥æ¢çš„ç»„ä»¶ä¼šå¼•å…¥å¾ˆå¤šä¸å±žäºŽè‡ªå·±çš„å±žæ€§åœ¨Reactä¸­ï¼Œé€šè¿‡contextå¯ä»¥è®©ç¥–å…ˆç»„ä»¶ç›´æŽ¥æŠŠå±žæ€§ä¼ é€’åˆ°åŽä»£ç»„ä»¶ï¼Œæœ‰ç‚¹ç±»ä¼¼æ˜Ÿé™…æ—…è¡Œä¸­çš„è™«æ´žä¸€æ ·ï¼Œé€šè¿‡contextè¿™ä¸ªç‰¹æ®Šçš„æ¡¥æ¢ï¼Œå¯ä»¥è·¨è¶Šä»»æ„å±‚æ¬¡å‘åŽä»£ç»„ä»¶ä¼ é€’æ¶ˆæ¯æ€Žä¹ˆåœ¨éœ€è¦é€šä¿¡çš„ç»„ä»¶ä¹‹é—´å¼€å¯è¿™ä¸ªè™«æ´žå‘¢ï¼Ÿéœ€è¦åŒå‘å£°æ˜Žï¼Œä¹Ÿå°±æ˜¯åœ¨ç¥–å…ˆç»„ä»¶å£°æ˜Žå±žæ€§ï¼Œå¹¶åœ¨åŽä»£ç»„ä»¶ä¸Šå†æ¬¡å£°æ˜Žå±žæ€§ï¼Œç„¶åŽåœ¨ç¥–å…ˆç»„ä»¶ä¸Šæ”¾ä¸Šå±žæ€§å°±å¯ä»¥äº†ï¼Œå°±å¯ä»¥åœ¨åŽä»£ç»„ä»¶è¯»å–å±žæ€§äº†ï¼Œä¸‹é¢çœ‹ä¸€ä¸ªä¾‹å­123456789101112131415161718192021222324import PropTypes from 'prop-types';class Child extends Component &#123; // åŽä»£ç»„ä»¶å£°æ˜Žéœ€è¦è¯»å–contextä¸Šçš„æ•°æ® static contextTypes = &#123; text: PropTypes.string &#125; render() &#123; // é€šè¿‡this.context è¯»å–contextä¸Šçš„æ•°æ® return &lt;div&gt;&#123;this.context.text&#125;&lt;/div&gt; &#125;&#125;class Ancestor extends Component &#123; // ç¥–å…ˆç»„ä»¶å£°æ˜Žéœ€è¦æ”¾å…¥contextä¸Šçš„æ•°æ® static childContextTypes = &#123; text: PropTypes.string &#125; // ç¥–å…ˆç»„ä»¶å¾€contextæ”¾å…¥æ•°æ® getChildContext() &#123; return &#123;text: 'yanhaijing'&#125; &#125;&#125;contextçš„ä¼˜ç‚¹æ˜¯å¯ä»¥çœåŽ»å±‚å±‚ä¼ é€’çš„éº»çƒ¦ï¼Œå¹¶ä¸”é€šè¿‡åŒå‘å£°æ˜ŽæŽ§åˆ¶äº†æ•°æ®çš„å¯è§æ€§ï¼Œå¯¹äºŽå±‚æ•°å¾ˆå¤šæ—¶ï¼Œä¸å¤±ä¸ºä¸€ç§æ–¹æ¡ˆï¼›ä½†ç¼ºç‚¹ä¹Ÿå¾ˆæ˜Žæ˜¾ï¼Œå°±åƒå…¨å±€å˜é‡ä¸€æ ·ï¼Œå¦‚æžœä¸åŠ èŠ‚åˆ¶å¾ˆå®¹æ˜“é€ æˆæ··ä¹±ï¼Œè€Œä¸”ä¹Ÿå®¹æ˜“å‡ºçŽ°é‡åè¦†ç›–çš„é—®é¢˜ä¸ªäººçš„å»ºè®®æ˜¯å¯¹ä¸€äº›æ‰€æœ‰ç»„ä»¶å…±äº«çš„åªè¯»ä¿¡æ¯å¯ä»¥é‡‡ç”¨contextæ¥ä¼ é€’ï¼Œæ¯”å¦‚ç™»å½•çš„ç”¨æˆ·ä¿¡æ¯ç­‰å°è´´å£«ï¼šReact Routerè·¯ç”±å°±æ˜¯é€šè¿‡contextæ¥ä¼ é€’è·¯ç”±å±žæ€§çš„å…„å¼Ÿç»„ä»¶å¦‚æžœä¸¤ä¸ªç»„ä»¶æ˜¯å…„å¼Ÿå…³ç³»ï¼Œå¯ä»¥é€šè¿‡çˆ¶ç»„ä»¶ä½œä¸ºæ¡¥æ¢ï¼Œæ¥è®©ä¸¤ä¸ªç»„ä»¶ä¹‹é—´é€šä¿¡ï¼Œè¿™å…¶å®žå°±æ˜¯ä¸»æ¨¡å—æ¨¡å¼ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œä¸¤ä¸ªå­ç»„ä»¶é€šè¿‡çˆ¶ç»„ä»¶æ¥å®žçŽ°æ˜¾ç¤ºæ•°å­—åŒæ­¥çš„åŠŸèƒ½123456789101112131415class Parent extends Component &#123; constructor() &#123; this.onChange = function (num) &#123; this.setState(&#123;num&#125;) &#125;.bind(this); &#125; render() &#123; return ( &lt;div&gt; &lt;Child1 num=&#123;this.state.num&#125; onChange=&#123;this.onChange&#125;&gt; &lt;Child2 num=&#123;this.state.num&#125; onChange=&#123;this.onChange&#125;&gt; &lt;/div&gt; ); &#125;&#125;ä¸»æ¨¡å—æ¨¡å¼çš„ä¼˜ç‚¹å°±æ˜¯è§£è€¦ï¼ŒæŠŠä¸¤ä¸ªå­ç»„ä»¶ä¹‹é—´çš„è€¦åˆå…³ç³»ï¼Œè§£è€¦æˆå­ç»„ä»¶å’Œçˆ¶ç»„ä»¶ä¹‹é—´çš„è€¦åˆï¼ŒæŠŠåˆ†æ•£çš„ä¸œè¥¿æ”¶é›†åœ¨ä¸€èµ·å¥½å¤„éžå¸¸æ˜Žæ˜¾ï¼Œèƒ½å¸¦æ¥æ›´å¥½çš„å¯ç»´æŠ¤æ€§å’Œå¯æ‰©å±•æ€§ä»»æ„ç»„ä»¶ä»»æ„ç»„ä»¶åŒ…æ‹¬ä¸Šé¢çš„ä¸‰ç§å…³ç³»ç»„ä»¶ï¼Œä¸Šé¢ä¸‰ç§å…³ç³»åº”è¯¥ä¼˜å…ˆä½¿ç”¨ä¸Šé¢ä»‹ç»çš„æ–¹æ³•ï¼Œå¯¹äºŽä»»æ„çš„ä¸¤ä¸ªç»„ä»¶é—´é€šä¿¡ï¼Œæ€»å…±æœ‰ä¸‰ç§åŠžæ³•ï¼Œåˆ†åˆ«æ˜¯å…±åŒç¥–å…ˆæ³•ï¼Œæ¶ˆæ¯ä¸­é—´ä»¶å’ŒçŠ¶æ€ç®¡ç†åŸºäºŽæˆ‘ä»¬ä¸Šé¢ä»‹ç»çš„çˆ·å­™ç»„ä»¶å’Œå…„å¼Ÿç»„ä»¶ï¼Œåªè¦æ‰¾åˆ°ä¸¤ä¸ªç»„ä»¶çš„å…±åŒç¥–å…ˆï¼Œå°±å¯ä»¥å°†ä»»æ„ç»„ä»¶ä¹‹é—´çš„é€šä¿¡ï¼Œè½¬åŒ–ä¸ºä»»æ„ç»„ä»¶å’Œå…±åŒç¥–å…ˆä¹‹é—´çš„é€šä¿¡ï¼Œè¿™ä¸ªæ–¹æ³•çš„å¥½å¤„å°±æ˜¯éžå¸¸ç®€å•ï¼Œå·²çŸ¥çŸ¥è¯†å°±èƒ½æžå®šï¼Œç¼ºç‚¹å°±æ˜¯ä¸Šé¢ä¸¤ç§æ¨¡å¼ç¼ºç‚¹çš„å åŠ ï¼Œé™¤äº†ä¸´æ—¶æ–¹æ¡ˆï¼Œä¸å»ºè®®ä½¿ç”¨è¿™ç§æ–¹æ³•å¦ä¸€ç§æ¯”è¾ƒå¸¸ç”¨çš„æ–¹æ³•æ˜¯æ¶ˆæ¯ä¸­é—´ä»¶ï¼Œå°±æ˜¯å¼•å…¥ä¸€ä¸ªå…¨å±€æ¶ˆæ¯å·¥å…·ï¼Œä¸¤ä¸ªç»„ä»¶é€šè¿‡è¿™ä¸ªå…¨å±€å·¥å…·è¿›è¡Œé€šä¿¡ï¼Œè¿™æ ·ä¸¤ä¸ªç»„ä»¶é—´çš„é€šä¿¡ï¼Œå°±é€šè¿‡å…¨å±€æ¶ˆæ¯åª’ä»‹å®Œæˆäº†è¿˜è®°å¾—ä¸Šé¢ä»‹ç»çš„æ¶ˆæ¯åŸºç±»å—ï¼Ÿä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œç»„ä»¶1å’Œç»„ä»¶2é€šè¿‡å…¨å±€eventè¿›è¡Œé€šä¿¡12345678910111213141516171819202122232425262728293031class EventEimtter &#123; constructor() &#123; this.eventMap = &#123;&#125;; &#125; sub(name, cb) &#123; const eventList = this.eventMap[name] = this.eventMap[name] || &#123;&#125;; eventList.push(cb); &#125; pub(name, ...data) &#123; (this.eventMap[name] || []).forEach(cb =&gt; cb(...data)); &#125;&#125;// å…¨å±€æ¶ˆæ¯å·¥å…·const event = new EventEimtter;// ä¸€ä¸ªç»„ä»¶class Element1 extends Component &#123; constructor() &#123; // è®¢é˜…æ¶ˆæ¯ event.sub('element2update', () =&gt; &#123;console.log('element2 update')&#125;); &#125;&#125;// å¦ä¸€ä¸ªç»„ä»¶ã€‚class Element2 extends Component &#123; constructor() &#123; // å‘å¸ƒæ¶ˆæ¯ setTimeout(function () &#123; event.pub('element2update') &#125;, 2000) &#125;&#125;æ¶ˆæ¯ä¸­é—´ä»¶çš„æ¨¡å¼éžå¸¸ç®€å•ï¼Œåˆ©ç”¨äº†è§‚å¯Ÿè€…æ¨¡å¼ï¼Œå°†ä¸¤ä¸ªç»„ä»¶ä¹‹é—´çš„è€¦åˆè§£è€¦æˆäº†ç»„ä»¶å’Œæ¶ˆæ¯ä¸­å¿ƒ+æ¶ˆæ¯åç§°çš„è€¦åˆï¼Œä½†ä¸ºäº†è§£è€¦å´å¼•å…¥å…¨å±€æ¶ˆæ¯ä¸­å¿ƒå’Œæ¶ˆæ¯åç§°ï¼Œæ¶ˆæ¯ä¸­å¿ƒå¯¹ç»„ä»¶çš„ä¾µå…¥æ€§å¾ˆå¼ºï¼Œå’Œç¬¬ä¸‰æ–¹ç»„ä»¶é€šä¿¡ä¸èƒ½ä½¿ç”¨è¿™ç§æ–¹å¼å°åž‹é¡¹ç›®æ¯”è¾ƒé€‚åˆä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œä½†éšç€é¡¹ç›®è§„æ¨¡çš„æ‰©å¤§ï¼Œè¾¾åˆ°ä¸­ç­‰é¡¹ç›®ä»¥åŽï¼Œæ¶ˆæ¯åå­—çˆ†ç‚¸å¼å¢žé•¿ï¼Œæ¶ˆæ¯åå­—çš„ç»´æŠ¤æˆäº†æ£˜æ‰‹çš„é—®é¢˜ï¼Œé‡åæ¦‚çŽ‡æžå¤§ï¼Œæ²¡æœ‰äººæ•¢éšä¾¿åˆ é™¤æ¶ˆæ¯ä¿¡æ¯ï¼Œæ¶ˆæ¯çš„å‘å¸ƒè€…æ‰¾ä¸åˆ°æ¶ˆæ¯è®¢é˜…è€…çš„ä¿¡æ¯ç­‰å…¶å®žä¸Šé¢çš„é—®é¢˜ä¹Ÿä¸æ˜¯æ²¡æœ‰è§£å†³åŠžæ³•ï¼Œé‡åçš„é—®é¢˜å¯ä»¥é€šè¿‡åˆ¶å®šè§„èŒƒï¼Œæ¶ˆæ¯å‘½åç©ºé—´ç­‰æ–¹å¼æ¥æžå¤§é™ä½Žå†²çªï¼Œå…¶ä»–é—®é¢˜å¯ä»¥é€šè¿‡æŠŠæ¶ˆæ¯åå­—ç»Ÿä¸€ç»´æŠ¤åˆ°ä¸€ä¸ªæ–‡ä»¶ï¼Œé€šè¿‡å¯¹æ¶ˆæ¯çš„ä¸­å¿ƒåŒ–ç®¡ç†ï¼Œå¯ä»¥è®©å¾ˆå¤šé—®é¢˜éƒ½å¾ˆå®¹æ˜“è§£å†³å¦‚æžœä½ çš„é¡¹ç›®éžå¸¸å¤§ï¼Œä¸Šé¢ä¸¤ç§æ–¹æ¡ˆéƒ½ä¸åˆé€‚ï¼Œé‚£ä½ å¯èƒ½éœ€è¦ä¸€ä¸ªçŠ¶æ€ç®¡ç†å·¥å…·ï¼Œé€šè¿‡çŠ¶æ€ç®¡ç†å·¥å…·æŠŠç»„ä»¶ä¹‹é—´çš„å…³ç³»ï¼Œå’Œå…³ç³»çš„å¤„ç†é€»è¾‘ä»Žç»„å»ºä¸­æŠ½è±¡å‡ºæ¥ï¼Œå¹¶é›†ä¸­åŒ–åˆ°ç»Ÿä¸€çš„åœ°æ–¹æ¥å¤„ç†ï¼ŒReduxå°±æ˜¯ä¸€ä¸ªéžå¸¸ä¸é”™çš„çŠ¶æ€ç®¡ç†å·¥å…·é™¤äº†Reduxï¼Œè¿˜æœ‰Mobxï¼ŒRematchï¼Œreselectç­‰å·¥å…·ï¼Œæœ¬æ–‡ä¸å±•å¼€ä»‹ç»ï¼Œæœ‰æœºä¼šåŽé¢å•ç‹¬æˆæ–‡ï¼Œè¿™äº›éƒ½æ˜¯ç”¨æ¥è§£å†³ä¸åŒé—®é¢˜çš„ï¼Œåªè¦æ ¹æ®è‡ªå·±çš„åœºæ™¯é€‰æ‹©åˆé€‚çš„å·¥å…·å°±å¥½äº†æ€»ç»“ç»„ä»¶é—´çš„å…³ç³»åƒå˜ä¸‡åŒ–ï¼Œéƒ½å¯ä»¥ç”¨ä¸Šé¢ä»‹ç»çš„æ–¹æ³•è§£å†³ï¼Œå¯¹äºŽä¸åŒè§„æ¨¡çš„é¡¹ç›®ï¼Œåº”è¯¥é€‰æ‹©é€‚åˆè‡ªå·±çš„æŠ€æœ¯æ–¹æ¡ˆï¼Œä¸Šé¢ä»‹ç»çš„ä¸åŒæ–¹å¼è§£è€¦çš„ç¨‹åº¦æ˜¯ä¸ä¸€æ ·çš„ï¼Œå…³äºŽä¸åŒè€¦åˆå…³ç³»çš„å¥½åï¼Œå¯ä»¥çœ‹æˆ‘ä¹‹å‰çš„æ–‡ç« ã€Šå›¾è§£7ç§è€¦åˆå…³ç³»ã€‹æœ¬æ–‡ä½œè€…ï¼š Andyæœ¬æ–‡åœ°å€ï¼š https://andyxw.com/archives/ac71.htmlç‰ˆæƒå£°æ˜Žï¼š è½¬è½½è¯·æ³¨æ˜Žå‡ºå¤„ï¼]]></content>
      <categories>
        <category>React</category>
      </categories>
      <tags>
        <tag>React</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å›¾è§£7ç§è€¦åˆå…³ç³»]]></title>
    <url>%2Farchives%2F7e29.html</url>
    <content type="text"><![CDATA[æ·±å…¥è®²è®²æ¨¡å—ä¹‹é—´çš„è€¦åˆå…³ç³»è¿™ä¸ªäº‹æƒ…ã€‚æœ¬æ–‡å°†ç”¨å›¾æ–‡è¯¦ç»†è®²è§£ä¸ƒç§è€¦åˆçš„ä¸åŒä¹‹å¤„ã€‚é«˜å†…èšä¸Žä½Žè€¦åˆé«˜å†…èšä¸Žä½Žè€¦åˆæ˜¯æ¯ä¸ªè½¯ä»¶å¼€å‘è€…è¿½æ±‚çš„ç›®æ ‡ï¼Œé‚£ä¹ˆå†…èšå’Œè€¦åˆåˆ†åˆ«æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿå†…èšæ˜¯ä»ŽåŠŸèƒ½è§’åº¦æ¥åº¦é‡æ¨¡å—å†…çš„è”ç³»ï¼Œä¸€ä¸ªå¥½çš„å†…èšæ¨¡å—åº”å½“æ°å¥½åšä¸€ä»¶äº‹ã€‚å®ƒæè¿°çš„æ˜¯æ¨¡å—å†…çš„åŠŸèƒ½è”ç³»ã€‚è€¦åˆæ˜¯è½¯ä»¶ç»“æž„ä¸­å„æ¨¡å—ä¹‹é—´ç›¸äº’è¿žæŽ¥çš„ä¸€ç§åº¦é‡ï¼Œè€¦åˆå¼ºå¼±å–å†³äºŽæ¨¡å—é—´æŽ¥å£çš„å¤æ‚ç¨‹åº¦ã€è¿›å…¥æˆ–è®¿é—®ä¸€ä¸ªæ¨¡å—çš„ç‚¹ä»¥åŠé€šè¿‡æŽ¥å£çš„æ•°æ®ã€‚è€¦åˆä¸åŒæ¨¡å—ä¹‹é—´çš„å…³ç³»å°±æ˜¯è€¦åˆï¼Œæ ¹æ®è€¦åˆç¨‹åº¦å¯ä»¥åˆ†ä¸º7ç§ï¼Œè€¦åˆåº¦ä¾æ¬¡å˜ä½Žã€‚å†…å®¹è€¦åˆå…¬å…±è€¦åˆå¤–éƒ¨è€¦åˆæŽ§åˆ¶è€¦åˆæ ‡è®°è€¦åˆæ•°æ®è€¦åˆéžç›´æŽ¥è€¦åˆä¸‹é¢æˆ‘ä»¬æ¥è¯´è¯´æ¯ç§è€¦åˆæ˜¯ä»€ä¹ˆï¼Œå¼€å§‹ä¹‹å‰å…ˆæ¥è¯´ä¸‹è¦å®žçŽ°çš„åŠŸèƒ½ã€‚m1å’Œm2æ˜¯ä¸¤ä¸ªç‹¬ç«‹çš„æ¨¡å—ï¼Œå…¶ä¸­m2ç§ä¼šæ˜¾ç¤ºm1çš„è¾“å…¥ï¼Œm1ä¼šæ˜¾ç¤ºm2çš„è¾“å…¥ã€‚å¾ˆæ˜¾ç„¶ï¼Œm1å’Œm2ä¸¤ä¸ªæ¨¡å—ä¹‹é—´ä¼šæœ‰ä¸€äº›è”ç³»ï¼ˆè€¦åˆï¼‰ï¼Œä½ ä¹Ÿå¯ä»¥æƒ³æƒ³å¦‚ä½•å®žçŽ°è¿™ä¸ªåŠŸèƒ½ï¼Œä¸‹é¢ç”¨7ç§ä¸åŒçš„æ–¹å¼æ¥å®žçŽ°è¿™ä¸ªåŠŸèƒ½ã€‚æ³¨ï¼šé¡¹ç›®çš„ä»£ç æˆ‘æ”¾åˆ°äº†githubï¼Œé¡¹ç›®çš„demoï¼Œå¯ä»¥åœ¨è¿™é‡ŒæŸ¥çœ‹ã€‚å†…å®¹è€¦åˆå†…å®¹è€¦åˆæ˜¯æœ€ç´§çš„è€¦åˆç¨‹åº¦ï¼Œä¸€ä¸ªæ¨¡å—ç›´æŽ¥è®¿é—®å¦ä¸€æ¨¡å—çš„å†…å®¹ï¼Œåˆ™ç§°è¿™ä¸¤ä¸ªæ¨¡å—ä¸ºå†…å®¹è€¦åˆã€‚ä¸ºäº†å®žçŽ°åŠŸèƒ½ï¼Œæˆ‘ä»¬å°†m1çš„è¾“å…¥æ”¾åˆ°m2.m1inputä¸Šï¼Œå°†m2çš„è¾“å…¥æ”¾åˆ°m1.m2inputä¸Šã€‚// m1.js root.m2.m1input = this.value; m2.update(); // m2.js root.m1.m2input = this.value; m1.update(); PS:ä¸çŸ¥é“è°ä¼šè¿™ä¹ˆå†™ä»£ç ï¼Œé™¤äº†æˆ‘ä¸ºäº†åšæ¼”ç¤ºä¹‹å¤–ã€‚ã€‚ã€‚æŸ¥çœ‹å®Œæ•´ä»£ç å’Œdemoã€‚å…¬å…±è€¦åˆä¸€ç»„æ¨¡å—éƒ½è®¿é—®åŒä¸€ä¸ªå…¨å±€æ•°æ®ç»“æž„ï¼Œåˆ™ç§°ä¹‹ä¸ºå…¬å…±è€¦åˆã€‚åœ¨è¿™ç§caseä¸­ï¼Œm1å’Œm2å°†è‡ªå·±çš„è¾“å…¥æ”¾åˆ°å…¨å±€çš„dataä¸Šã€‚// m1.js root.data.m1input = this.value; m2.update(); // m2.js root.data.m2input = this.value; m1.update(); æŸ¥çœ‹å®Œæ•´ä»£ç å’Œdemoã€‚å¤–éƒ¨è€¦åˆä¸€ç»„æ¨¡å—éƒ½è®¿é—®åŒä¸€å…¨å±€ç®€å•å˜é‡ï¼Œè€Œä¸”ä¸é€šè¿‡å‚æ•°è¡¨ä¼ é€’è¯¥å…¨å±€å˜é‡çš„ä¿¡æ¯ï¼Œåˆ™ç§°ä¹‹ä¸ºå¤–éƒ¨è€¦åˆã€‚å¤–éƒ¨è€¦åˆå’Œå…¬å…±è€¦åˆå¾ˆåƒï¼ŒåŒºåˆ«å°±æ˜¯ä¸€ä¸ªæ˜¯ç®€å•å˜é‡ï¼Œä¸€ä¸ªæ˜¯å¤æ‚æ•°æ®ç»“æž„ã€‚åœ¨è¿™ç§caseä¸­ï¼Œm1å’Œm2éƒ½å°†è‡ªå·±çš„è¾“å…¥æ”¾åˆ°å…¨å±€ä¸Šã€‚// m1.js root.m1input = this.value; m2.update(); // m2.js root.m2input = this.value; m1.update(); æŸ¥çœ‹å®Œæ•´ä»£ç å’Œdemoã€‚æŽ§åˆ¶è€¦åˆæ¨¡å—ä¹‹é—´ä¼ é€’çš„ä¸æ˜¯æ•°æ®ä¿¡æ¯ï¼Œè€Œæ˜¯æŽ§åˆ¶ä¿¡æ¯ä¾‹å¦‚æ ‡å¿—ã€å¼€å…³é‡ç­‰ï¼Œä¸€ä¸ªæ¨¡å—æŽ§åˆ¶äº†å¦ä¸€ä¸ªæ¨¡å—çš„åŠŸèƒ½ã€‚ä»ŽæŽ§åˆ¶è€¦åˆå¼€å§‹ï¼Œæ¨¡å—çš„æ•°æ®å°±æ”¾åœ¨è‡ªå·±å†…éƒ¨äº†ï¼Œä¸åŒæ¨¡å—ä¹‹é—´é€šè¿‡æŽ¥å£äº’ç›¸è°ƒç”¨ã€‚åœ¨è¿™ä¸ªcaseä¸­ï¼Œå¾—å¢žåŠ ä¸€ä¸ªéœ€æ±‚ï¼Œå°±æ˜¯å½“m1çš„è¾“å…¥ä¸ºç©ºæ—¶ï¼Œéšè—m2çš„æ˜¾ç¤ºä¿¡æ¯ã€‚// m1.js root.m1input = this.value; m2.update(); m2.toggle(!!this.value); // ä¼ é€’flag ä¸Šé¢çš„ä»£ç ä¸­m1ç›´æŽ¥æŽ§åˆ¶äº†m2çš„æ˜¾ç¤ºå’Œéšè—ã€‚æŸ¥çœ‹å®Œæ•´ä»£ç å’Œdemoã€‚æ ‡è®°è€¦åˆè°ƒç”¨æ¨¡å—å’Œè¢«è°ƒç”¨æ¨¡å—ä¹‹é—´ä¼ é€’æ•°æ®ç»“æž„è€Œä¸æ˜¯ç®€å•æ•°æ®ï¼ŒåŒæ—¶ä¹Ÿç§°ä½œç‰¹å¾è€¦åˆã€‚åœ¨è¿™ä¸ªcaseä¸­ï¼Œm1ä¼ ç»™m2çš„æ˜¯ä¸€ä¸ªå¯¹è±¡ã€‚// m1.js me.m1input = this.value; m2.update(me); // ä¼ é€’å¼•ç”¨ // m2.js me.m2input = this.value; m1.update(me); æŸ¥çœ‹å®Œæ•´ä»£ç å’Œdemoã€‚æ•°æ®è€¦åˆè°ƒç”¨æ¨¡å—å’Œè¢«è°ƒç”¨æ¨¡å—ä¹‹é—´åªä¼ é€’ç®€å•çš„æ•°æ®é¡¹å‚æ•°ã€‚ç›¸å½“äºŽé«˜çº§è¯­è¨€ä¸­çš„å€¼ä¼ é€’ã€‚åœ¨è¿™ä¸ªcaseä¸­ï¼Œm1ä¼ ç»™m2çš„æ˜¯ä¸€ä¸ªç®€å•æ•°æ®ç»“æž„ã€‚// m1.js me.m1input = this.value; m2.update(me.m1input); // ä¼ é€’å€¼ // m2.js me.m2input = this.value; m1.update(me.m2input); æŸ¥çœ‹å®Œæ•´ä»£ç å’Œdemoã€‚éžç›´æŽ¥è€¦åˆä¸¤ä¸ªæ¨¡å—ä¹‹é—´æ²¡æœ‰ç›´æŽ¥å…³ç³»ï¼Œå®ƒä»¬ä¹‹é—´çš„è”ç³»å®Œå…¨æ˜¯é€šè¿‡ä¸»æ¨¡å—çš„æŽ§åˆ¶å’Œè°ƒç”¨æ¥å®žçŽ°çš„ã€‚è€¦åˆåº¦æœ€å¼±ï¼Œæ¨¡å—ç‹¬ç«‹æ€§æœ€å¼ºã€‚å­æ¨¡å—æ— éœ€çŸ¥é“å¯¹æ–¹çš„å­˜åœ¨ï¼Œå­æ¨¡å—ä¹‹é—´çš„è”ç³»ï¼Œå…¨éƒ¨å˜æˆå­æ¨¡å—å’Œä¸»æ¨¡å—ä¹‹é—´çš„è”ç³»ã€‚åœ¨è¿™ä¸ªcaseç§ï¼Œå¢žåŠ ä¸€ä¸ªindex.jsä½œä¸ºä¸»æ¨¡å—ã€‚// index.js var m1 = root.m1; var m2 = root.m2; m1.init(function (str) { m2.update(str); }); m2.init(function (str) { m1.update(str); }); // m1.js me.m1input = this.value; inputcb(me.m1input); // inputcbæ˜¯å›žè°ƒå‡½æ•° // m2.js me.m2input = this.value; inputcb(me.m2input); æŸ¥çœ‹å®Œæ•´ä»£ç å’Œdemoã€‚å†…èšå…¶å®žå…³äºŽå†…èšä¹Ÿåˆ†ä¸ºå¾ˆå¤šç§ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼Œå¦‚æžœä½ æ„Ÿå…´è¶£å¯ä»¥è‡ªå·±ç ”ç©¶ç ”ç©¶ï¼Œæˆ‘ä»¬ä¸‹æ¬¡å†æ¥åˆ†äº«å†…èšçš„é—®é¢˜ã€‚å¶ç„¶å†…èšé€»è¾‘å†…èšæ—¶é—´å†…èšé€šä¿¡å†…èšé¡ºåºå†…èšåŠŸèƒ½å†…èšæ€»ç»“å¸Œæœ›ä½ çœ‹å®Œä¸Šé¢çš„æ–‡ç« ï¼Œæžæ‡‚äº†è€¦åˆçš„ç§ç±»ï¼Œä¹Ÿå¸Œæœ›ä½ ä»¥åŽèƒ½ä½¿ç”¨éžç›´æŽ¥è€¦åˆè¿™ç§æ–¹å¼æ¥å†™ä»£ç ï¼Œç¥å¥½ã€‚æœ¬æ–‡ä½œè€…ï¼š Andyæœ¬æ–‡åœ°å€ï¼š https://andyxw.com/archives/7e29.htmlç‰ˆæƒå£°æ˜Žï¼š è½¬è½½è¯·æ³¨æ˜Žå‡ºå¤„ï¼]]></content>
      <categories>
        <category>æ¨¡å—åŒ–</category>
      </categories>
      <tags>
        <tag>æ¨¡å—åŒ–</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[é¸¡æ±¤]]></title>
    <url>%2Farchives%2F201.html</url>
    <content type="text"><![CDATA[è¿™æ˜¯ç¯‡æœ‰å¯†ç çš„åšå®¢ Incorrect Password! No content to display! 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]]></content>
      <categories>
        <category>å…¶ä»–</category>
      </categories>
      <tags>
        <tag>å…¶ä»–</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[React æŠ€æœ¯æ ˆ]]></title>
    <url>%2Farchives%2F4a9b.html</url>
    <content type="text"><![CDATA[React æŠ€æœ¯æ ˆReact æ˜¯ç›®å‰æœ€çƒ­é—¨çš„å‰ç«¯æ¡†æž¶ã€‚Facebook å…¬å¸2013å¹´æŽ¨å‡ºçŽ°åœ¨æœ€å¥½çš„ç¤¾åŒºæ”¯æŒå’Œç”Ÿæ€åœˆå¤§é‡çš„ç¬¬ä¸‰æ–¹å·¥å…·React çš„ä¼˜ç‚¹ç»„ä»¶æ¨¡å¼ï¼šä»£ç å¤ç”¨å’Œå›¢é˜Ÿåˆ†å·¥è™šæ‹Ÿ DOMï¼šæ€§èƒ½ä¼˜åŠ¿ç§»åŠ¨ç«¯æ”¯æŒï¼šè·¨ç»ˆç«¯React çš„ç¼ºç‚¹å­¦ä¹ æ›²çº¿è¾ƒé™¡å³­å…¨æ–°çš„ä¸€å¥—æ¦‚å¿µï¼Œä¸Žå…¶ä»–æ‰€æœ‰æ¡†æž¶æˆªç„¶ä¸åŒåªæœ‰é‡‡ç”¨å®ƒçš„æ•´ä¸ªæŠ€æœ¯æ ˆï¼Œæ‰èƒ½å‘æŒ¥æœ€å¤§å¨åŠ›æ€»ç»“ï¼šReact éžå¸¸å…ˆè¿›å’Œå¼ºå¤§ï¼Œä½†æ˜¯å­¦ä¹ å’Œå®žçŽ°æˆæœ¬éƒ½ä¸ä½ŽJSX è¯­æ³•React ä½¿ç”¨ JSX è¯­æ³•ï¼ŒJavaScript ä»£ç ä¸­å¯ä»¥å†™ HTML ä»£ç ã€‚1let myTitle = &lt;h1&gt;Hello, world!&lt;/h1&gt;;JSX è¯­æ³•è§£é‡Šï¼ˆ1ï¼‰JSX è¯­æ³•çš„æœ€å¤–å±‚ï¼Œåªèƒ½æœ‰ä¸€ä¸ªèŠ‚ç‚¹ã€‚12// é”™è¯¯let myTitle = &lt;p&gt;Hello&lt;/p&gt;&lt;p&gt;World&lt;/p&gt;;ï¼ˆ2ï¼‰JSX è¯­æ³•ä¸­å¯ä»¥æ’å…¥ JavaScript ä»£ç ï¼Œä½¿ç”¨å¤§æ‹¬å·ã€‚1let myTitle = &lt;p&gt;&#123;'Hello ' + 'World'&#125;&lt;/p&gt;Babel è½¬ç å™¨JavaScript å¼•æ“Žï¼ˆåŒ…æ‹¬æµè§ˆå™¨å’Œ Nodeï¼‰éƒ½ä¸è®¤è¯† JSXï¼Œéœ€è¦é¦–å…ˆä½¿ç”¨ Babel è½¬ç ï¼Œç„¶åŽæ‰èƒ½è¿è¡Œã€‚123456&lt;script src="react.js"&gt;&lt;/script&gt;&lt;script src="react-dom.js"&gt;&lt;/script&gt;&lt;script src="babel.min.js"&gt;&lt;/script&gt;&lt;script type="text/babel"&gt; // ** Our code goes here! **&lt;/script&gt;React éœ€è¦åŠ è½½ä¸¤ä¸ªåº“ï¼šReact å’Œ React-DOMï¼Œå‰è€…æ˜¯ React çš„æ ¸å¿ƒåº“ï¼ŒåŽè€…æ˜¯ React çš„ DOM é€‚é…åº“ã€‚Babel ç”¨æ¥åœ¨æµè§ˆå™¨è½¬æ¢ JSX è¯­æ³•ï¼Œå¦‚æžœæœåŠ¡å™¨å·²ç»è½¬å¥½äº†ï¼Œæµè§ˆå™¨å°±ä¸éœ€è¦åŠ è½½è¿™ä¸ªåº“ã€‚è¯¾å ‚ç»ƒä¹ ï¼šJSX è¯­æ³•æµè§ˆå™¨æ‰“å¼€demos/jsx-demo/index.htmlï¼ŒæŒ‰ç…§ã€Šæ“ä½œè¯´æ˜Žã€‹ï¼Œå®Œæˆç»ƒä¹ ã€‚1234ReactDOM.render( &lt;span&gt;Hello World!&lt;/span&gt;, document.getElementById('example'));ç¤ºä¾‹ï¼šReact ç»„ä»¶React å…è®¸ç”¨æˆ·å®šä¹‰è‡ªå·±çš„ç»„ä»¶ï¼Œæ’å…¥ç½‘é¡µã€‚æµè§ˆå™¨æ‰“å¼€demos/react-component-demo/index1.htmlï¼ŒæŒ‰ç…§ã€Šæ“ä½œè¯´æ˜Žã€‹ï¼Œä»”ç»†æŸ¥çœ‹æºç ã€‚12345678910class MyTitle extends React.Component &#123; render() &#123; return &lt;h1&gt;Hello World&lt;/h1&gt;; &#125;&#125;;ReactDOM.render( &lt;MyTitle/&gt;, document.getElementById('example'));è¯¾å ‚ç»ƒä¹ ï¼šç»„ä»¶çš„å‚æ•°ç»„ä»¶å¯ä»¥ä»Žå¤–éƒ¨ä¼ å…¥å‚æ•°ï¼Œå†…éƒ¨ä½¿ç”¨this.propsèŽ·å–å‚æ•°ã€‚æ‰“å¼€demos/react-component-demo/index2.htmlï¼ŒæŒ‰ç…§ã€Šæ“ä½œè¯´æ˜Žã€‹ï¼Œå®Œæˆç»ƒä¹ ã€‚123456789class MyTitle extends React.Component &#123; render() &#123; return &lt;h1 style=&#123;&#123;color: this.props.color&#125;&#125; &gt;Hello World&lt;/h1&gt;; &#125;&#125;;&lt;MyTitle color="red" /&gt;,ç¤ºä¾‹ï¼šç»„ä»¶çš„çŠ¶æ€ç»„ä»¶å¾€å¾€ä¼šæœ‰å†…éƒ¨çŠ¶æ€ï¼Œä½¿ç”¨this.stateè¡¨ç¤ºã€‚æµè§ˆå™¨æ‰“å¼€demos/react-component-demo/index3.htmlï¼ŒæŒ‰ç…§ã€Šæ“ä½œè¯´æ˜Žã€‹ï¼Œä»”ç»†æŸ¥çœ‹æºç ã€‚è¯¾å ‚ç»ƒä¹ ï¼šReact ç»„ä»¶å®žæˆ˜æµè§ˆå™¨æ‰“å¼€demos/react-component-demo/index4.htmlï¼ŒæŒ‰ç…§ã€Šæ“ä½œè¯´æ˜Žã€‹ï¼Œå®Œæˆç»ƒä¹ ã€‚ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸReact ä¸ºç»„ä»¶çš„ä¸åŒç”Ÿå‘½é˜¶æ®µï¼Œæä¾›äº†è¿‘åä¸ªé’©å­æ–¹æ³•ã€‚componentWillMount()ï¼šç»„ä»¶åŠ è½½å‰è°ƒç”¨componentDidMount()ï¼šç»„ä»¶åŠ è½½åŽè°ƒç”¨componentWillUpdate(): ç»„ä»¶æ›´æ–°å‰è°ƒç”¨componentDidUpdate(): ç»„ä»¶æ›´æ–°åŽè°ƒç”¨componentWillUnmount()ï¼šç»„ä»¶å¸è½½å‰è°ƒç”¨componentWillReceiveProps()ï¼šç»„ä»¶æŽ¥å—æ–°çš„å‚æ•°æ—¶è°ƒç”¨æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™äº›é’©å­ï¼Œè‡ªåŠ¨å®Œæˆä¸€äº›æ“ä½œã€‚è¯¾å ‚ç»ƒä¹ ï¼šç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸç»„ä»¶å¯ä»¥é€šè¿‡ Ajax è¯·æ±‚ï¼Œä»ŽæœåŠ¡å™¨èŽ·å–æ•°æ®ã€‚Ajax è¯·æ±‚ä¸€èˆ¬åœ¨componentDidMountæ–¹æ³•é‡Œé¢å‘å‡ºã€‚123456componentDidMount() &#123; const url = '...'; $.getJSON(url) .done() .fail();&#125;æ‰“å¼€demos/react-lifecycle-demo/index.htmlï¼ŒæŒ‰ç…§ã€Šæ“ä½œè¯´æ˜Žã€‹ï¼Œå®Œæˆç»ƒä¹ ã€‚React ç»„ä»¶åº“React çš„ä¸€å¤§ä¼˜åŠ¿ï¼Œå°±æ˜¯ç½‘ä¸Šæœ‰å¾ˆå¤šå·²ç»å†™å¥½çš„ç»„ä»¶åº“ï¼Œå¯ä»¥ä½¿ç”¨ã€‚React-Bootstrapï¼šhttps://react-bootstrap.github.io/ç¤ºä¾‹ï¼šReChartsReCharts æ˜¯ä¸€ä¸ª React å›¾è¡¨ç»„ä»¶åº“ã€‚http://recharts.org/æµè§ˆå™¨æ‰“å¼€demos/recharts-demo/index.htmlï¼ŒæŒ‰ç…§ã€Šæ“ä½œè¯´æ˜Žã€‹ï¼Œä»”ç»†æŸ¥çœ‹æºç ï¼Œä½“ä¼š JSX è¯­æ³•å¯¹è¡¨è¾¾å¤æ‚ç»„ä»¶çš„ä¼˜åŠ¿ã€‚1234567&lt;LineChart width=&#123;1000&#125; height=&#123;400&#125; data=&#123;data&#125;&gt; &lt;XAxis dataKey="name"/&gt; &lt;YAxis/&gt; &lt;CartesianGrid stroke="#eee" strokeDasharray="5 5"/&gt; &lt;Line type="monotone" dataKey="uv" stroke="#8884d8" /&gt; &lt;Line type="monotone" dataKey="pv" stroke="#82ca9d" /&gt;&lt;/LineChart&gt;React çš„æ ¸å¿ƒæ€æƒ³View æ˜¯ State çš„è¾“å‡ºã€‚1view = f(state)ä¸Šå¼ä¸­ï¼Œfè¡¨ç¤ºå‡½æ•°å…³ç³»ã€‚åªè¦ State å‘ç”Ÿå˜åŒ–ï¼ŒView ä¹Ÿè¦éšä¹‹å˜åŒ–ã€‚React çš„æœ¬è´¨æ˜¯å°†å›¾å½¢ç•Œé¢ï¼ˆGUIï¼‰å‡½æ•°åŒ–ã€‚12345678const person = &#123; name: "michel", age: 31&#125;const App = (&#123; person &#125;) =&gt; &lt;h1&gt;&#123; person.name &#125;&lt;/h1&gt;ReactDOM.render(&lt;App person=&#123;person&#125; /&gt;, document.body)React æ²¡æœ‰è§£å†³çš„é—®é¢˜React æœ¬èº«åªæ˜¯ä¸€ä¸ª DOM çš„æŠ½è±¡å±‚ï¼Œä½¿ç”¨ç»„ä»¶æž„å»ºè™šæ‹Ÿ DOMã€‚å¦‚æžœå¼€å‘å¤§åº”ç”¨ï¼Œè¿˜éœ€è¦è§£å†³ä¸¤ä¸ªé—®é¢˜ã€‚æž¶æž„ï¼šå¤§åž‹åº”ç”¨ç¨‹åºåº”è¯¥å¦‚ä½•ç»„ç»‡ä»£ç ï¼Ÿé€šä¿¡ï¼šç»„ä»¶ä¹‹é—´å¦‚ä½•é€šä¿¡ï¼Ÿæž¶æž„é—®é¢˜React åªæ˜¯è§†å›¾å±‚çš„è§£å†³æ–¹æ¡ˆï¼Œå¯ä»¥ç”¨äºŽä»»ä½•ä¸€ç§æž¶æž„ã€‚MVCMVVMObserverReactiveâ€¦åˆ°åº•å“ªä¸€ç§æž¶æž„æœ€åˆé€‚ React ï¼Ÿé€šä¿¡é—®é¢˜ç»„ä»¶ä¼šå‘ç”Ÿä¸‰ç§é€šä¿¡ã€‚å‘å­ç»„ä»¶å‘æ¶ˆæ¯å‘çˆ¶ç»„ä»¶å‘æ¶ˆæ¯å‘å…¶ä»–ç»„ä»¶å‘æ¶ˆæ¯React åªæä¾›äº†ä¸€ç§é€šä¿¡æ‰‹æ®µï¼šä¼ å‚ã€‚å¯¹äºŽå¤§åº”ç”¨ï¼Œå¾ˆä¸æ–¹ä¾¿ã€‚çŠ¶æ€çš„åŒæ­¥é€šä¿¡çš„æœ¬è´¨æ˜¯çŠ¶æ€çš„åŒæ­¥ã€‚React åŒæ­¥çŠ¶æ€çš„åŸºæœ¬æ–¹æ³•ï¼šæ‰¾åˆ°é€šä¿¡åŒæ–¹æœ€è¿‘çš„å…±åŒçˆ¶ç»„ä»¶ï¼Œé€šè¿‡å®ƒçš„stateï¼Œä½¿å¾—å­ç»„ä»¶çš„çŠ¶æ€ä¿æŒåŒæ­¥ã€‚Flux æž¶æž„Facebook æå‡º Flux æž¶æž„çš„æ¦‚å¿µï¼Œè¢«è®¤ä¸ºæ˜¯ React åº”ç”¨çš„æ ‡å‡†æž¶æž„ã€‚æœ€å¤§ç‰¹ç‚¹ï¼šæ•°æ®å•å‘æµåŠ¨ã€‚ä¸Ž MVVM çš„æ•°æ®åŒå‘ç»‘å®šï¼Œå½¢æˆé²œæ˜Žå¯¹æ¯”ã€‚Flux çš„æ ¸å¿ƒæ€æƒ³ä¸åŒç»„ä»¶çš„stateï¼Œå­˜æ”¾åœ¨ä¸€ä¸ªå¤–éƒ¨çš„ã€å…¬å…±çš„ Store ä¸Šé¢ã€‚ç»„ä»¶è®¢é˜… Store çš„ä¸åŒéƒ¨åˆ†ã€‚ç»„ä»¶å‘é€ï¼ˆdispatchï¼‰åŠ¨ä½œï¼ˆactionï¼‰ï¼Œå¼•å‘ Store çš„æ›´æ–°ã€‚Flux åªæ˜¯ä¸€ä¸ªæ¦‚å¿µï¼Œæœ‰30å¤šç§å®žçŽ°ã€‚ç›®å‰æœ€æµè¡Œçš„ä¸¤ä¸ª React æž¶æž„React æž¶æž„çš„æœ€é‡è¦ä½œç”¨ï¼šç®¡ç† Store ä¸Ž View ä¹‹é—´çš„å…³ç³»ã€‚MobXï¼šå“åº”å¼ï¼ˆReactiveï¼‰ç®¡ç†ï¼Œstate æ˜¯å¯å˜å¯¹è±¡ï¼Œé€‚åˆä¸­å°åž‹é¡¹ç›®Reduxï¼šå‡½æ•°å¼ï¼ˆFunctionalï¼‰ç®¡ç†ï¼Œstate æ˜¯ä¸å¯å˜å¯¹è±¡ï¼Œé€‚åˆå¤§åž‹é¡¹ç›®MobX æž¶æž„MobX çš„æ ¸å¿ƒæ˜¯è§‚å¯Ÿè€…æ¨¡å¼ã€‚Store æ˜¯è¢«è§‚å¯Ÿè€…ï¼ˆobservableï¼‰ç»„ä»¶æ˜¯è§‚å¯Ÿè€…ï¼ˆobserverï¼‰ä¸€æ—¦Storeæœ‰å˜åŒ–ï¼Œä¼šç«‹åˆ»è¢«ç»„ä»¶è§‚å¯Ÿåˆ°ï¼Œä»Žè€Œå¼•å‘é‡æ–°æ¸²æŸ“ã€‚MobX çš„æœ€ç®€å•ä¾‹å­1234567891011const &#123;observable&#125; = mobx;const &#123;observer&#125; = mobxReact;const person = observable(&#123;name: "å¼ ä¸‰", age: 31&#125;);const App = observer( (&#123; person &#125;) =&gt; &lt;h1&gt;&#123; person.name &#125;&lt;/h1&gt;);ReactDOM.render(&lt;App person=&#123;person&#125; /&gt;, document.body);person.name = "æŽå››";ä»£ç ï¼šdemos/mobx-demo/browser-demoç›®å½•ç¤ºä¾‹ï¼šMobXè¿›å…¥demos/mobx-demoç›®å½•ï¼ŒæŒ‰ç…§ã€Šæ“ä½œè¯´æ˜Žã€‹ï¼Œç†è§£ MobX æ¡†æž¶ã€‚UI å±‚æ˜¯è§‚å¯Ÿè€…ï¼ŒStore æ˜¯è¢«è§‚å¯Ÿè€…ã€‚Store æ‰€æœ‰çš„å±žæ€§ï¼Œåˆ†æˆä¸¤å¤§ç±»ï¼šç›´æŽ¥è¢«è§‚å¯Ÿçš„å±žæ€§å’Œè‡ªåŠ¨è®¡ç®—å‡ºæ¥çš„å±žæ€§ã€‚123456class Store &#123; @observable name = 'Bartek'; @computed get decorated() &#123; return `$&#123;this.name&#125; is awesome!`; &#125;&#125;UI ä¼šè§‚å¯Ÿåˆ° Store çš„å˜åŒ–ï¼Œè‡ªåŠ¨é‡æ–°æ¸²æŸ“ã€‚Redux æž¶æž„Redux çš„æ ¸å¿ƒæ¦‚å¿µæ‰€æœ‰çš„çŠ¶æ€å­˜æ”¾åœ¨Storeã€‚ç»„ä»¶æ¯æ¬¡é‡æ–°æ¸²æŸ“ï¼Œéƒ½å¿…é¡»ç”±çŠ¶æ€å˜åŒ–å¼•èµ·ã€‚ç”¨æˆ·åœ¨ UI ä¸Šå‘å‡ºactionã€‚reducerå‡½æ•°æŽ¥æ”¶actionï¼Œç„¶åŽæ ¹æ®å½“å‰çš„stateï¼Œè®¡ç®—å‡ºæ–°çš„stateã€‚Redux åº”ç”¨çš„æž¶æž„Redux å±‚ä¿å­˜æ‰€æœ‰çŠ¶æ€ï¼ŒReact ç»„ä»¶æ‹¿åˆ°çŠ¶æ€ä»¥åŽï¼Œæ¸²æŸ“å‡º HTML ä»£ç ã€‚ç¤ºä¾‹ï¼šReduxè¿›å…¥demos/redux-demoç›®å½•ï¼ŒæŒ‰ç…§ã€Šæ“ä½œè¯´æ˜Žã€‹ï¼Œç†è§£ Redux æ¡†æž¶ã€‚Redux å°†ç»„ä»¶åˆ†æˆ UI ç»„ä»¶å’Œå®¹å™¨ç»„ä»¶ä¸¤ç±»ã€‚UI ç»„ä»¶æ˜¯çº¯ç»„ä»¶ï¼Œä¸åŒ…å« state å’Œç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œä¸æ¶‰åŠç»„ä»¶çš„è¡Œä¸ºï¼Œåªæ¶‰åŠç»„ä»¶çš„å¤–è§‚ã€‚1234567&lt;div className="index"&gt; &lt;p&gt;&#123;this.props.text&#125;&lt;/p&gt; &lt;input defaultValue=&#123;this.props.name&#125; onChange=&#123;this.props.onChange&#125; /&gt;&lt;/div&gt;å®¹å™¨ç»„ä»¶æ­£å¥½ç›¸åã€‚ä¸æ¶‰åŠç»„ä»¶çš„å¤–è§‚ï¼Œåªæ¶‰åŠç»„ä»¶çš„è¡Œä¸ºã€‚è´Ÿè´£è®¢é˜… Storeï¼Œå°† Store çš„æ•°æ®å¤„ç†ä»¥åŽï¼Œå†é€šè¿‡å‚æ•°ä¼ ç»™ UI ç»„ä»¶ã€‚ç”¨æˆ·ç»™å‡ºé…ç½®ä»¥åŽï¼Œç”± Redux ç”Ÿæˆã€‚12345// MyComponent æ˜¯çº¯çš„ UI ç»„ä»¶const App = connect( mapStateToProps, mapDispatchToProps)(MyComponent);mapStateToProps: å®šä¹‰ UI ç»„ä»¶å‚æ•°ä¸Ž State ä¹‹é—´çš„æ˜ å°„mapDispatchToPropsï¼šå®šä¹‰ UI ç»„ä»¶ä¸Ž Action ä¹‹é—´çš„æ˜ å°„æ‹†åˆ† UI ç»„ä»¶å’Œå®¹å™¨ç»„ä»¶çš„å¥½å¤„UI ç»„ä»¶ä¸ŽåŽå°æ•°æ®æ— å…³ï¼Œå¯ä»¥ç”±è®¾è®¡å¸ˆè´Ÿè´£å®¹å™¨ç»„ä»¶åªè´Ÿè´£æ•°æ®å’Œè¡Œä¸ºï¼Œä¸€æ—¦ Store çš„æ•°æ®ç»“æž„å˜åŒ–ï¼Œåªè¦è°ƒæ•´å®¹å™¨ç»„ä»¶å³å¯è¡¨çŽ°å±‚å’ŒåŠŸèƒ½å±‚è„±é’©ï¼Œæœ‰åˆ©äºŽä»£ç é‡ç”¨ï¼Œä¹Ÿæœ‰åˆ©äºŽçœ‹æ¸…åº”ç”¨çš„æ•°æ®ç»“æž„å’Œä¸šåŠ¡é€»è¾‘Reducer å‡½æ•°reduceræ˜¯ä¸€ä¸ªçº¯å‡½æ•°ï¼Œç”¨æ¥æŽ¥æ”¶actionï¼Œç®—å‡ºæ–°çš„stateã€‚123456789101112function reducer(state = &#123; text: 'ä½ å¥½ï¼Œè®¿é—®è€…', name: 'è®¿é—®è€…'&#125;, action) &#123; switch (action.type) &#123; case 'change': return &#123; name: action.payload, text: 'ä½ å¥½ï¼Œ' + action.payload &#125;; &#125;&#125;Storeç”± Redux æä¾›çš„createStoreæ–¹æ³•ç”Ÿæˆï¼Œè¯¥æ–¹æ³•æŽ¥å—reducerä½œä¸ºå‚æ•°ã€‚ä¸ºäº†æŠŠStoreä¼ å…¥ç»„ä»¶ï¼Œå¿…é¡»ä½¿ç”¨ Redux æä¾›çš„Providerç»„ä»¶åœ¨åº”ç”¨çš„æœ€å¤–é¢ï¼ŒåŒ…è£¹ä¸€å±‚ã€‚12345678const store = createStore(reducer);ReactDOM.render( &lt;Provider store=&#123;store&#125;&gt; &lt;App /&gt; &lt;/Provider&gt;, document.body.appendChild(document.createElement('div')));æœ¬æ–‡ä½œè€…ï¼š Andyæœ¬æ–‡åœ°å€ï¼š https://andyxw.com/archives/4a9b.htmlç‰ˆæƒå£°æ˜Žï¼š è½¬è½½è¯·æ³¨æ˜Žå‡ºå¤„ï¼]]></content>
      <categories>
        <category>React</category>
      </categories>
      <tags>
        <tag>React</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[React è®¾è®¡æ€æƒ³]]></title>
    <url>%2Farchives%2F7615.html</url>
    <content type="text"><![CDATA[React è®¾è®¡æ€æƒ³è¯‘è€…åºï¼šæœ¬æ–‡æ˜¯ React æ ¸å¿ƒå¼€å‘è€…ã€æœ‰ React API ç»ˆç»“è€…ä¹‹ç§°çš„ Sebastian MarkbÃ¥ge æ’°å†™ï¼Œé˜è¿°äº†ä»–è®¾è®¡ React çš„åˆè¡·ã€‚é˜…è¯»æ­¤æ–‡ï¼Œä½ èƒ½ç«™åœ¨æ›´é«˜çš„é«˜åº¦æ€è€ƒ React çš„è¿‡åŽ»ã€çŽ°åœ¨å’Œæœªæ¥ã€‚åŽŸæ–‡åœ°å€ï¼šhttps://github.com/reactjs/react-basicæˆ‘å†™æ­¤æ–‡æ˜¯æƒ³æ­£å¼åœ°é˜è¿°æˆ‘å¿ƒä¸­ React çš„å¿ƒæ™ºæ¨¡åž‹ã€‚ç›®çš„æ˜¯è§£é‡Šä¸ºä»€ä¹ˆæˆ‘ä»¬ä¼šè¿™æ ·è®¾è®¡ Reactï¼ŒåŒæ—¶ä½ ä¹Ÿå¯ä»¥æ ¹æ®è¿™äº›è®ºç‚¹åæŽ¨å‡º Reactã€‚ä¸å¯å¦è®¤ï¼Œæ­¤æ–‡ä¸­çš„éƒ¨åˆ†è®ºæ®æˆ–å‰æå°šå­˜äº‰è®®ï¼Œè€Œä¸”éƒ¨åˆ†ç¤ºä¾‹çš„è®¾è®¡å¯èƒ½å­˜åœ¨ bug æˆ–ç–å¿½ã€‚è¿™åªæ˜¯æ­£å¼ç¡®å®šå®ƒçš„æœ€åˆé˜¶æ®µã€‚å¦‚æžœä½ æœ‰æ›´å¥½çš„å®Œå–„å®ƒçš„æƒ³æ³•å¯ä»¥éšæ—¶æäº¤ pull requestã€‚æœ¬æ–‡ä¸ä¼šä»‹ç»æ¡†æž¶ç»†èŠ‚ä¸­çš„å¥‡æŠ€æ·«å·§ï¼Œç›¸ä¿¡è¿™æ ·èƒ½æçº²æŒˆé¢†ï¼Œè®©ä½ çœ‹æ¸… React ç”±ç®€å•åˆ°å¤æ‚çš„è®¾è®¡è¿‡ç¨‹ã€‚React.js çš„çœŸå®žå®žçŽ°ä¸­å……æ»¡äº†å…·ä½“é—®é¢˜çš„è§£å†³æ–¹æ¡ˆï¼Œæ¸è¿›å¼çš„è§£æ³•ï¼Œç®—æ³•ä¼˜åŒ–ï¼ŒåŽ†å²é—ç•™ä»£ç ï¼Œdebug å·¥å…·ä»¥åŠå…¶ä»–ä¸€äº›å¯ä»¥è®©å®ƒçœŸçš„å…·æœ‰é«˜å¯ç”¨æ€§çš„å†…å®¹ã€‚è¿™äº›ä»£ç å¯èƒ½å¹¶ä¸ç¨³å®šï¼Œå› ä¸ºæœªæ¥æµè§ˆå™¨çš„å˜åŒ–å’ŒåŠŸèƒ½æƒé‡çš„å˜åŒ–éšæ—¶é¢ä¸´æ”¹å˜ã€‚æ‰€ä»¥å…·ä½“çš„ä»£ç å¾ˆéš¾å½»åº•è§£é‡Šæ¸…æ¥šã€‚æˆ‘åå‘äºŽé€‰æ‹©ä¸€ç§æˆ‘èƒ½å®Œå…¨ hold ä½çš„ç®€æ´çš„å¿ƒæ™ºæ¨¡åž‹æ¥ä½œä»‹ç»ã€‚å˜æ¢ï¼ˆTransformationï¼‰è®¾è®¡ React çš„æ ¸å¿ƒå‰ææ˜¯è®¤ä¸º UI åªæ˜¯æŠŠæ•°æ®é€šè¿‡æ˜ å°„å…³ç³»å˜æ¢æˆå¦ä¸€ç§å½¢å¼çš„æ•°æ®ã€‚åŒæ ·çš„è¾“å…¥å¿…ä¼šæœ‰åŒæ ·çš„è¾“å‡ºã€‚è¿™æ°å¥½å°±æ˜¯çº¯å‡½æ•°ã€‚123function NameBox(name) &#123; return &#123; fontWeight: 'bold', labelContent: name &#125;;&#125;12&apos;Sebastian MarkbÃ¥ge&apos; -&gt;&#123; fontWeight: &apos;bold&apos;, labelContent: &apos;Sebastian MarkbÃ¥ge&apos; &#125;;æŠ½è±¡ï¼ˆAbstractionï¼‰ä½ ä¸å¯èƒ½ä»…ç”¨ä¸€ä¸ªå‡½æ•°å°±èƒ½å®žçŽ°å¤æ‚çš„ UIã€‚é‡è¦çš„æ˜¯ï¼Œä½ éœ€è¦æŠŠ UI æŠ½è±¡æˆå¤šä¸ªéšè—å†…éƒ¨ç»†èŠ‚ï¼Œåˆå¯å¤ç”¨çš„å‡½æ•°ã€‚é€šè¿‡åœ¨ä¸€ä¸ªå‡½æ•°ä¸­è°ƒç”¨å¦ä¸€ä¸ªå‡½æ•°æ¥å®žçŽ°å¤æ‚çš„ UIï¼Œè¿™å°±æ˜¯æŠ½è±¡ã€‚123456789function FancyUserBox(user) &#123; return &#123; borderStyle: '1px solid blue', childContent: [ 'Name: ', NameBox(user.firstName + ' ' + user.lastName) ] &#125;;&#125;12345678&#123; firstName: &apos;Sebastian&apos;, lastName: &apos;MarkbÃ¥ge&apos; &#125; -&gt;&#123; borderStyle: &apos;1px solid blue&apos;, childContent: [ &apos;Name: &apos;, &#123; fontWeight: &apos;bold&apos;, labelContent: &apos;Sebastian MarkbÃ¥ge&apos; &#125; ]&#125;;ç»„åˆï¼ˆCompositionï¼‰ä¸ºäº†çœŸæ­£è¾¾åˆ°é‡ç”¨çš„ç‰¹æ€§ï¼Œåªé‡ç”¨å¶å­ç„¶åŽæ¯æ¬¡éƒ½ä¸ºä»–ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„å®¹å™¨æ˜¯ä¸å¤Ÿçš„ã€‚ä½ è¿˜éœ€è¦å¯ä»¥åŒ…å«å…¶ä»–æŠ½è±¡çš„å®¹å™¨å†æ¬¡è¿›è¡Œç»„åˆã€‚æˆ‘ç†è§£çš„â€œç»„åˆâ€å°±æ˜¯å°†ä¸¤ä¸ªæˆ–è€…å¤šä¸ªä¸åŒçš„æŠ½è±¡åˆå¹¶ä¸ºä¸€ä¸ªã€‚12345678910111213function FancyBox(children) &#123; return &#123; borderStyle: '1px solid blue', children: children &#125;;&#125;function UserBox(user) &#123; return FancyBox([ 'Name: ', NameBox(user.firstName + ' ' + user.lastName) ]);&#125;çŠ¶æ€ï¼ˆStateï¼‰UI ä¸å•å•æ˜¯å¯¹æœåŠ¡å™¨ç«¯æˆ–ä¸šåŠ¡é€»è¾‘çŠ¶æ€çš„å¤åˆ¶ã€‚å®žé™…ä¸Šè¿˜æœ‰å¾ˆå¤šçŠ¶æ€æ˜¯é’ˆå¯¹å…·ä½“çš„æ¸²æŸ“ç›®æ ‡ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œåœ¨ä¸€ä¸ª text field ä¸­æ‰“å­—ã€‚å®ƒä¸ä¸€å®šè¦å¤åˆ¶åˆ°å…¶ä»–é¡µé¢æˆ–è€…ä½ çš„æ‰‹æœºè®¾å¤‡ã€‚æ»šåŠ¨ä½ç½®è¿™ä¸ªçŠ¶æ€æ˜¯ä¸€ä¸ªå…¸åž‹çš„ä½ å‡ ä¹Žä¸ä¼šå¤åˆ¶åˆ°å¤šä¸ªæ¸²æŸ“ç›®æ ‡çš„ã€‚æˆ‘ä»¬å€¾å‘äºŽä½¿ç”¨ä¸å¯å˜çš„æ•°æ®æ¨¡åž‹ã€‚æˆ‘ä»¬æŠŠå¯ä»¥æ”¹å˜ state çš„å‡½æ•°ä¸²è”èµ·æ¥ä½œä¸ºåŽŸç‚¹æ”¾ç½®åœ¨é¡¶å±‚ã€‚1234567891011121314151617181920212223function FancyNameBox(user, likes, onClick) &#123; return FancyBox([ 'Name: ', NameBox(user.firstName + ' ' + user.lastName), 'Likes: ', LikeBox(likes), LikeButton(onClick) ]);&#125;// å®žçŽ°ç»†èŠ‚var likes = 0;function addOneMoreLike() &#123; likes++; rerender();&#125;// åˆå§‹åŒ–FancyNameBox( &#123; firstName: 'Sebastian', lastName: 'MarkbÃ¥ge' &#125;, likes, addOneMoreLike);æ³¨æ„ï¼šæœ¬ä¾‹æ›´æ–°çŠ¶æ€æ—¶ä¼šå¸¦æ¥å‰¯ä½œç”¨ï¼ˆaddOneMoreLike å‡½æ•°ä¸­ï¼‰ã€‚æˆ‘å®žé™…çš„æƒ³æ³•æ˜¯å½“ä¸€ä¸ªâ€œupdateâ€ä¼ å…¥æ—¶æˆ‘ä»¬è¿”å›žä¸‹ä¸€ä¸ªç‰ˆæœ¬çš„çŠ¶æ€ï¼Œä½†é‚£æ ·ä¼šæ¯”è¾ƒå¤æ‚ã€‚æ­¤ç¤ºä¾‹å¾…æ›´æ–°Memoizationå¯¹äºŽçº¯å‡½æ•°ï¼Œä½¿ç”¨ç›¸åŒçš„å‚æ•°ä¸€æ¬¡æ¬¡è°ƒç”¨æœªå…å¤ªæµªè´¹èµ„æºã€‚æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªå‡½æ•°çš„ memorized ç‰ˆæœ¬ï¼Œç”¨æ¥è¿½è¸ªæœ€åŽä¸€ä¸ªå‚æ•°å’Œç»“æžœã€‚è¿™æ ·å¦‚æžœæˆ‘ä»¬ç»§ç»­ä½¿ç”¨åŒæ ·çš„å€¼ï¼Œå°±ä¸éœ€è¦åå¤æ‰§è¡Œå®ƒäº†ã€‚1234567891011121314151617181920212223function memoize(fn) &#123; var cachedArg; var cachedResult; return function(arg) &#123; if (cachedArg === arg) &#123; return cachedResult; &#125; cachedArg = arg; cachedResult = fn(arg); return cachedResult; &#125;;&#125;var MemoizedNameBox = memoize(NameBox);function NameAndAgeBox(user, currentTime) &#123; return FancyBox([ 'Name: ', MemoizedNameBox(user.firstName + ' ' + user.lastName), 'Age in milliseconds: ', currentTime - user.dateOfBirth ]);&#125;åˆ—è¡¨ï¼ˆListsï¼‰å¤§éƒ¨åˆ† UI éƒ½æ˜¯å±•ç¤ºåˆ—è¡¨æ•°æ®ä¸­ä¸åŒ item çš„åˆ—è¡¨ç»“æž„ã€‚è¿™æ˜¯ä¸€ä¸ªå¤©ç„¶çš„å±‚çº§ã€‚ä¸ºäº†ç®¡ç†åˆ—è¡¨ä¸­çš„æ¯ä¸€ä¸ª item çš„ state ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›é€ ä¸€ä¸ª Map å®¹çº³å…·ä½“ item çš„ stateã€‚123456789101112131415function UserList(users, likesPerUser, updateUserLikes) &#123; return users.map(user =&gt; FancyNameBox( user, likesPerUser.get(user.id), () =&gt; updateUserLikes(user.id, likesPerUser.get(user.id) + 1) ));&#125;var likesPerUser = new Map();function updateUserLikes(id, likeCount) &#123; likesPerUser.set(id, likeCount); rerender();&#125;UserList(data.users, likesPerUser, updateUserLikes);æ³¨æ„ï¼šçŽ°åœ¨æˆ‘ä»¬å‘ FancyNameBox ä¼ äº†å¤šä¸ªä¸åŒçš„å‚æ•°ã€‚è¿™æ‰“ç ´äº†æˆ‘ä»¬çš„ memoization å› ä¸ºæˆ‘ä»¬æ¯æ¬¡åªèƒ½å­˜å‚¨ä¸€ä¸ªå€¼ã€‚æ›´å¤šç›¸å…³å†…å®¹åœ¨ä¸‹é¢ã€‚è¿žç»­æ€§ï¼ˆContinuationsï¼‰ä¸å¹¸çš„æ˜¯ï¼Œè‡ªä»Ž UI ä¸­æœ‰å¤ªå¤šçš„åˆ—è¡¨ï¼Œæ˜Žç¡®çš„ç®¡ç†å°±éœ€è¦å¤§é‡çš„é‡å¤æ€§æ ·æ¿ä»£ç ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡æŽ¨è¿Ÿä¸€äº›å‡½æ•°çš„æ‰§è¡Œï¼Œè¿›è€ŒæŠŠä¸€äº›æ¨¡æ¿ç§»å‡ºä¸šåŠ¡é€»è¾‘ã€‚æ¯”å¦‚ï¼Œä½¿ç”¨â€œæŸ¯é‡ŒåŒ–â€ï¼ˆJavaScript ä¸­çš„ bindï¼‰ã€‚ç„¶åŽæˆ‘ä»¬å¯ä»¥ä»Žæ ¸å¿ƒçš„å‡½æ•°å¤–é¢ä¼ é€’ stateï¼Œè¿™æ ·å°±æ²¡æœ‰æ ·æ¿ä»£ç äº†ã€‚ä¸‹é¢è¿™æ ·å¹¶æ²¡æœ‰å‡å°‘æ ·æ¿ä»£ç ï¼Œä½†è‡³å°‘æŠŠå®ƒä»Žå…³é”®ä¸šåŠ¡é€»è¾‘ä¸­å‰¥ç¦»ã€‚123456789101112function FancyUserList(users) &#123; return FancyBox( UserList.bind(null, users) );&#125;const box = FancyUserList(data.users);const resolvedChildren = box.children(likesPerUser, updateUserLikes);const resolvedBox = &#123; ...box, children: resolvedChildren&#125;;State Mapä¹‹å‰æˆ‘ä»¬çŸ¥é“å¯ä»¥ä½¿ç”¨ç»„åˆé¿å…é‡å¤æ‰§è¡Œç›¸åŒçš„ä¸œè¥¿è¿™æ ·ä¸€ç§é‡å¤æ¨¡å¼ã€‚æˆ‘ä»¬å¯ä»¥æŠŠæ‰§è¡Œå’Œä¼ é€’ state é€»è¾‘æŒªåŠ¨åˆ°è¢«å¤ç”¨å¾ˆå¤šçš„ä½Žå±‚çº§çš„å‡½æ•°ä¸­åŽ»ã€‚12345678910111213141516171819202122232425262728function FancyBoxWithState( children, stateMap, updateState) &#123; return FancyBox( children.map(child =&gt; child.continuation( stateMap.get(child.key), updateState )) );&#125;function UserList(users) &#123; return users.map(user =&gt; &#123; continuation: FancyNameBox.bind(null, user), key: user.id &#125;);&#125;function FancyUserList(users) &#123; return FancyBoxWithState.bind(null, UserList(users) );&#125;const continuation = FancyUserList(data.users);continuation(likesPerUser, updateUserLikes);Memoization Mapä¸€æ—¦æˆ‘ä»¬æƒ³åœ¨ä¸€ä¸ª memoization åˆ—è¡¨ä¸­ memoize å¤šä¸ª item å°±ä¼šå˜å¾—å¾ˆå›°éš¾ã€‚å› ä¸ºä½ éœ€è¦åˆ¶å®šå¤æ‚çš„ç¼“å­˜ç®—æ³•æ¥å¹³è¡¡è°ƒç”¨é¢‘çŽ‡å’Œå†…å­˜å æœ‰çŽ‡ã€‚è¿˜å¥½ UI åœ¨åŒä¸€ä¸ªä½ç½®ä¼šç›¸å¯¹çš„ç¨³å®šã€‚ç›¸åŒçš„ä½ç½®ä¸€èˆ¬æ¯æ¬¡éƒ½ä¼šæŽ¥å—ç›¸åŒçš„å‚æ•°ã€‚è¿™æ ·ä»¥æ¥ï¼Œä½¿ç”¨ä¸€ä¸ªé›†åˆæ¥åš memoization æ˜¯ä¸€ä¸ªéžå¸¸å¥½ç”¨çš„ç­–ç•¥ã€‚æˆ‘ä»¬å¯ä»¥ç”¨å¯¹å¾… state åŒæ ·çš„æ–¹å¼ï¼Œåœ¨ç»„åˆçš„å‡½æ•°ä¸­ä¼ é€’ä¸€ä¸ª memoization ç¼“å­˜ã€‚12345678910111213141516171819202122232425262728function memoize(fn) &#123; return function(arg, memoizationCache) &#123; if (memoizationCache.arg === arg) &#123; return memoizationCache.result; &#125; const result = fn(arg); memoizationCache.arg = arg; memoizationCache.result = result; return result; &#125;;&#125;function FancyBoxWithState( children, stateMap, updateState, memoizationCache) &#123; return FancyBox( children.map(child =&gt; child.continuation( stateMap.get(child.key), updateState, memoizationCache.get(child.key) )) );&#125;const MemoizedFancyNameBox = memoize(FancyNameBox);ä»£æ•°æ•ˆåº”ï¼ˆAlgebraic Effectsï¼‰å¤šå±‚æŠ½è±¡éœ€è¦å…±äº«çç¢Žæ•°æ®æ—¶ï¼Œä¸€å±‚å±‚ä¼ é€’æ•°æ®éžå¸¸éº»çƒ¦ã€‚å¦‚æžœèƒ½æœ‰ä¸€ç§æ–¹å¼å¯ä»¥åœ¨å¤šå±‚æŠ½è±¡ä¸­å¿«æ·åœ°ä¼ é€’æ•°æ®ï¼ŒåŒæ—¶åˆä¸éœ€è¦ç‰µæ¶‰åˆ°ä¸­é—´å±‚çº§ï¼Œé‚£è¯¥æœ‰å¤šå¥½ã€‚React ä¸­æˆ‘ä»¬æŠŠå®ƒå«åšâ€œcontextâ€ã€‚æœ‰æ—¶å€™æ•°æ®ä¾èµ–å¹¶ä¸æ˜¯ä¸¥æ ¼æŒ‰ç…§æŠ½è±¡æ ‘è‡ªä¸Šè€Œä¸‹è¿›è¡Œã€‚ä¸¾ä¸ªä¾‹å­ï¼Œåœ¨å¸ƒå±€ç®—æ³•ä¸­ï¼Œä½ éœ€è¦åœ¨å®žçŽ°ä»–ä»¬çš„ä½ç½®ä¹‹å‰äº†è§£å­èŠ‚ç‚¹çš„å¤§å°ã€‚çŽ°åœ¨ï¼Œè¿™ä¸ªä¾‹å­æœ‰ä¸€ç‚¹è¶…çº²ã€‚æˆ‘ä¼šä½¿ç”¨ ä»£æ•°æ•ˆåº” è¿™ä¸ªç”±æˆ‘å‘èµ·çš„ ECMAScript æ–°ç‰¹æ€§æè®®ã€‚å¦‚æžœä½ å¯¹å‡½æ•°å¼ç¼–ç¨‹å¾ˆç†Ÿæ‚‰ï¼Œå®ƒä»¬ åœ¨é¿å…ç”± monad å¼ºåˆ¶å¼•å…¥çš„ä»ªå¼ä¸€æ ·çš„ç¼–ç ã€‚123456789101112131415161718192021222324function ThemeBorderColorRequest() &#123; &#125;function FancyBox(children) &#123; const color = raise new ThemeBorderColorRequest(); return &#123; borderWidth: '1px', borderColor: color, children: children &#125;;&#125;function BlueTheme(children) &#123; return try &#123; children(); &#125; catch effect ThemeBorderColorRequest -&gt; [, continuation] &#123; continuation('blue'); &#125;&#125;function App(data) &#123; return BlueTheme( FancyUserList.bind(null, data.users) );&#125;æœ¬æ–‡ä½œè€…ï¼š Andyæœ¬æ–‡åœ°å€ï¼š https://andyxw.com/archives/7615.htmlç‰ˆæƒå£°æ˜Žï¼š è½¬è½½è¯·æ³¨æ˜Žå‡ºå¤„ï¼]]></content>
      <categories>
        <category>React</category>
      </categories>
      <tags>
        <tag>React</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Reactä¸­çš„stateå’Œprops]]></title>
    <url>%2Farchives%2F992.html</url>
    <content type="text"><![CDATA[æ•´ç†ä¸€ä¸‹Reactä¸­å…³äºŽstateå’Œpropsçš„çŸ¥è¯†ç‚¹ã€‚åœ¨ä»»ä½•åº”ç”¨ä¸­ï¼Œæ•°æ®éƒ½æ˜¯å¿…ä¸å¯å°‘çš„ã€‚æˆ‘ä»¬éœ€è¦ç›´æŽ¥çš„æ”¹å˜é¡µé¢ä¸Šä¸€å—çš„åŒºåŸŸæ¥ä½¿å¾—è§†å›¾çš„åˆ·æ–°ï¼Œæˆ–è€…é—´æŽ¥åœ°æ”¹å˜å…¶ä»–åœ°æ–¹çš„æ•°æ®ã€‚Reactçš„æ•°æ®æ˜¯è‡ªé¡¶å‘ä¸‹å•å‘æµåŠ¨çš„ï¼Œå³ä»Žçˆ¶ç»„ä»¶åˆ°å­ç»„ä»¶ä¸­ï¼Œç»„ä»¶çš„æ•°æ®å­˜å‚¨åœ¨propså’Œstateä¸­ï¼Œè¿™ä¸¤ä¸ªå±žæ€§æœ‰å•¥å­åŒºåˆ«å‘¢ï¼ŸpropsReactçš„æ ¸å¿ƒæ€æƒ³å°±æ˜¯ç»„ä»¶åŒ–æ€æƒ³ï¼Œé¡µé¢ä¼šè¢«åˆ‡åˆ†æˆä¸€äº›ç‹¬ç«‹çš„ã€å¯å¤ç”¨çš„ç»„ä»¶ã€‚ç»„ä»¶ä»Žæ¦‚å¿µä¸Šçœ‹å°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå¯ä»¥æŽ¥å—ä¸€ä¸ªå‚æ•°ä½œä¸ºè¾“å…¥å€¼ï¼Œè¿™ä¸ªå‚æ•°å°±æ˜¯propsï¼Œæ‰€ä»¥å¯ä»¥æŠŠpropsç†è§£ä¸ºä»Žå¤–éƒ¨ä¼ å…¥ç»„ä»¶å†…éƒ¨çš„æ•°æ®ã€‚ç”±äºŽReactæ˜¯å•å‘æ•°æ®æµï¼Œæ‰€ä»¥propsåŸºæœ¬ä¸Šä¹Ÿå°±æ˜¯ä»Žæœçˆ¶çº§ç»„ä»¶å‘å­ç»„ä»¶ä¼ é€’çš„æ•°æ®ã€‚ç”¨æ³•å‡è®¾æˆ‘ä»¬çŽ°åœ¨éœ€è¦å®žçŽ°ä¸€ä¸ªåˆ—è¡¨ï¼Œæ ¹æ®Reactç»„ä»¶åŒ–æ€æƒ³ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠåˆ—è¡¨ä¸­çš„è¡Œå½“åšä¸€ä¸ªç»„ä»¶ï¼Œä¹Ÿå°±æ˜¯æœ‰è¿™æ ·ä¸¤ä¸ªç»„ä»¶ï¼š&lt;ItemList/&gt;å’Œ&lt;Item/&gt;ã€‚å…ˆçœ‹çœ‹&lt;ItemList/&gt;123456789import Item from &quot;./item&quot;;export default class ItemList extends React.Component&#123; const itemList = data.map(item =&gt; &lt;Item item=item /&gt;); render()&#123; return ( &#123;itemList&#125; ) &#125;&#125;åˆ—è¡¨çš„æ•°æ®æˆ‘ä»¬å°±æš‚æ—¶å…ˆå‡è®¾æ˜¯æ”¾åœ¨ä¸€ä¸ªdataå˜é‡ä¸­ï¼Œç„¶åŽé€šè¿‡mapå‡½æ•°è¿”å›žä¸€ä¸ªæ¯ä¸€é¡¹éƒ½æ˜¯&lt;Item item=&#39;æ•°æ®&#39;/&gt;çš„æ•°ç»„ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™é‡Œå…¶å®žåŒ…å«äº†data.lengthä¸ª&lt;Item/&gt;ç»„ä»¶ï¼Œæ•°æ®é€šè¿‡åœ¨ç»„ä»¶ä¸Šè‡ªå®šä¹‰ä¸€ä¸ªå‚æ•°ä¼ é€’ã€‚å½“ç„¶ï¼Œè¿™é‡Œæƒ³ä¼ é€’å‡ ä¸ªè‡ªå®šä¹‰å‚æ•°éƒ½å¯ä»¥ã€‚åœ¨&lt;Item /&gt;ä¸­æ˜¯è¿™æ ·çš„ï¼š1234567export default class Item extends React.Component&#123; render()&#123; return ( &lt;li&gt;&#123;this.props.item&#125;&lt;/li&gt; ) &#125;&#125;åœ¨renderå‡½æ•°ä¸­å¯ä»¥çœ‹å‡ºï¼Œç»„ä»¶å†…éƒ¨æ˜¯ä½¿ç”¨this.propsæ¥èŽ·å–ä¼ é€’åˆ°è¯¥ç»„ä»¶çš„æ‰€æœ‰æ•°æ®ï¼Œå®ƒæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«äº†æ‰€æœ‰ä½ å¯¹è¿™ä¸ªç»„ä»¶çš„é…ç½®ï¼ŒçŽ°åœ¨åªåŒ…å«äº†ä¸€ä¸ªitemå±žæ€§ï¼Œæ‰€ä»¥é€šè¿‡this.props.itemæ¥èŽ·å–å³å¯ã€‚åªè¯»æ€§propsç»å¸¸è¢«ç”¨ä½œæ¸²æŸ“ç»„ä»¶å’Œåˆå§‹åŒ–çŠ¶æ€ï¼Œå½“ä¸€ä¸ªç»„ä»¶è¢«å®žä¾‹åŒ–ä¹‹åŽï¼Œå®ƒçš„propsæ˜¯åªè¯»çš„ï¼Œä¸å¯æ”¹å˜çš„ã€‚å¦‚æžœpropsåœ¨æ¸²æŸ“è¿‡ç¨‹ä¸­å¯ä»¥è¢«æ”¹å˜ï¼Œä¼šå¯¼è‡´è¿™ä¸ªç»„ä»¶æ˜¾ç¤ºçš„å½¢æ€å˜å¾—ä¸å¯é¢„æµ‹ã€‚åªæœ‰é€šè¿‡çˆ¶ç»„ä»¶é‡æ–°æ¸²æŸ“çš„æ–¹å¼æ‰å¯ä»¥æŠŠæ–°çš„propsä¼ å…¥ç»„ä»¶ä¸­ã€‚é»˜è®¤å‚æ•°åœ¨ç»„ä»¶ä¸­ï¼Œæˆ‘ä»¬æœ€å¥½ä¸ºpropsä¸­çš„å‚æ•°è®¾ç½®ä¸€ä¸ªdefaultPropsï¼Œå¹¶ä¸”åˆ¶å®šå®ƒçš„ç±»åž‹ã€‚æ¯”å¦‚ï¼Œè¿™æ ·ï¼š1234567Item.defaultProps = &#123; item: &apos;Hello Props&apos;,&#125;;Item.propTypes = &#123; item: PropTypes.string,&#125;;å…³äºŽpropTypesï¼Œå¯ä»¥å£°æ˜Žä¸ºä»¥ä¸‹å‡ ç§ç±»åž‹ï¼š1234567optionalArray: PropTypes.array,optionalBool: PropTypes.bool,optionalFunc: PropTypes.func,optionalNumber: PropTypes.number,optionalObject: PropTypes.object,optionalString: PropTypes.string,optionalSymbol: PropTypes.symbol,æ³¨æ„ï¼Œboolå’Œfuncæ˜¯ç®€å†™ã€‚è¿™äº›çŸ¥è¯†åŸºç¡€æ•°æ®ç±»åž‹ï¼Œè¿˜æœ‰ä¸€äº›å¤æ‚çš„ï¼Œé™„ä¸Šé“¾æŽ¥ï¼šhttps://facebook.github.io/react/docs/typechecking-with-proptypes.htmlæ€»ç»“propsæ˜¯ä¸€ä¸ªä»Žå¤–éƒ¨ä¼ è¿›ç»„ä»¶çš„å‚æ•°ï¼Œä¸»è¦ä½œä¸ºå°±æ˜¯ä»Žçˆ¶ç»„ä»¶å‘å­ç»„ä»¶ä¼ é€’æ•°æ®ï¼Œå®ƒå…·æœ‰å¯è¯»æ€§å’Œä¸å˜æ€§ï¼Œåªèƒ½é€šè¿‡å¤–éƒ¨ç»„ä»¶ä¸»åŠ¨ä¼ å…¥æ–°çš„propsæ¥é‡æ–°æ¸²æŸ“å­ç»„ä»¶ï¼Œå¦åˆ™å­ç»„ä»¶çš„propsä»¥åŠå±•çŽ°å½¢å¼ä¸ä¼šæ”¹å˜ã€‚statestateæ˜¯ä»€ä¹ˆå‘¢ï¼ŸState is similar to props, but it is private and fully controlled by the component.ä¸€ä¸ªç»„ä»¶çš„æ˜¾ç¤ºå½¢æ€å¯ä»¥ç”±æ•°æ®çŠ¶æ€å’Œå¤–éƒ¨å‚æ•°æ‰€å†³å®šï¼Œå¤–éƒ¨å‚æ•°ä¹Ÿå°±æ˜¯propsï¼Œè€Œæ•°æ®çŠ¶æ€å°±æ˜¯stateã€‚ç”¨æ³•12345678910111213export default class ItemList extends React.Component&#123; constructor()&#123; super(); this.state = &#123; itemList:&apos;ä¸€äº›æ•°æ®&apos;, &#125; &#125; render()&#123; return ( &#123;this.state.itemList&#125; ) &#125;&#125;é¦–å…ˆï¼Œåœ¨ç»„ä»¶åˆå§‹åŒ–çš„æ—¶å€™ï¼Œé€šè¿‡this.stateç»™ç»„ä»¶è®¾å®šä¸€ä¸ªåˆå§‹çš„stateï¼Œåœ¨ç¬¬ä¸€æ¬¡renderçš„æ—¶å€™å°±ä¼šç”¨è¿™ä¸ªæ•°æ®æ¥æ¸²æŸ“ç»„ä»¶ã€‚setStatestateä¸åŒäºŽpropsçš„ä¸€ç‚¹æ˜¯ï¼Œstateæ˜¯å¯ä»¥è¢«æ”¹å˜çš„ã€‚ä¸è¿‡ï¼Œä¸å¯ä»¥ç›´æŽ¥é€šè¿‡this.state=çš„æ–¹å¼æ¥ä¿®æ”¹ï¼Œè€Œéœ€è¦é€šè¿‡this.setState()æ–¹æ³•æ¥ä¿®æ”¹stateã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé€šè¿‡å¼‚æ­¥æ“ä½œæ¥èŽ·å–æ•°æ®ï¼Œæˆ‘ä»¬éœ€è¦åœ¨didMounté˜¶æ®µæ¥æ‰§è¡Œå¼‚æ­¥æ“ä½œï¼š1234567componentDidMount()&#123; fetch(&apos;url&apos;) .then(response =&gt; response.json()) .then((data) =&gt; &#123; this.setState(&#123;itemList:item&#125;); &#125;&#125;å½“æ•°æ®èŽ·å–å®ŒæˆåŽï¼Œé€šè¿‡this.setStateæ¥ä¿®æ”¹æ•°æ®çŠ¶æ€ã€‚å½“æˆ‘ä»¬è°ƒç”¨this.setStateæ–¹æ³•æ—¶ï¼ŒReactä¼šæ›´æ–°ç»„ä»¶çš„æ•°æ®çŠ¶æ€stateï¼Œå¹¶ä¸”é‡æ–°è°ƒç”¨renderæ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯ä¼šå¯¹ç»„ä»¶è¿›è¡Œé‡æ–°æ¸²æŸ“ã€‚æ³¨æ„ï¼šé€šè¿‡this.state=æ¥åˆå§‹åŒ–stateï¼Œä½¿ç”¨this.setStateæ¥ä¿®æ”¹stateï¼Œconstructoræ˜¯å”¯ä¸€èƒ½å¤Ÿåˆå§‹åŒ–çš„åœ°æ–¹ã€‚setStateæŽ¥å—ä¸€ä¸ªå¯¹è±¡æˆ–è€…å‡½æ•°ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ï¼Œåªéœ€è¦ä¼ å…¥éœ€è¦æ›´æ–°çš„éƒ¨åˆ†å³å¯ï¼Œä¸éœ€è¦ä¼ å…¥æ•´ä¸ªå¯¹è±¡ï¼Œæ¯”å¦‚ï¼š123456789101112export default class ItemList extends React.Component&#123; constructor()&#123; super(); this.state = &#123; name:&apos;axuebin&apos;, age:25, &#125; &#125; componentDidMount()&#123; this.setState(&#123;age:18&#125;) &#125;&#125;åœ¨æ‰§è¡Œå®ŒsetStateä¹‹åŽçš„stateåº”è¯¥æ˜¯{name:&#39;axuebin&#39;,age:18}ã€‚setStateè¿˜å¯ä»¥æŽ¥å—ç¬¬äºŒä¸ªå‚æ•°ï¼Œå®ƒæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä¼šåœ¨setStateè°ƒç”¨å®Œæˆå¹¶ä¸”ç»„ä»¶å¼€å§‹é‡æ–°æ¸²æŸ“æ—¶è¢«è°ƒç”¨ï¼Œå¯ä»¥ç”¨æ¥ç›‘å¬æ¸²æŸ“æ˜¯å¦å®Œæˆï¼š123this.setState(&#123; name:&apos;xb&apos;&#125;,()=&gt;console.log(&apos;setState finished&apos;))æ€»ç»“stateçš„ä¸»è¦ä½œç”¨æ˜¯ç”¨äºŽç»„ä»¶ä¿å­˜ã€æŽ§åˆ¶ä»¥åŠä¿®æ”¹è‡ªå·±çš„çŠ¶æ€ï¼Œå®ƒåªèƒ½åœ¨constructorä¸­åˆå§‹åŒ–ï¼Œå®ƒç®—æ˜¯ç»„ä»¶çš„ç§æœ‰å±žæ€§ï¼Œä¸å¯é€šè¿‡å¤–éƒ¨è®¿é—®å’Œä¿®æ”¹ï¼Œåªèƒ½é€šè¿‡ç»„ä»¶å†…éƒ¨çš„this.setStateæ¥ä¿®æ”¹ï¼Œä¿®æ”¹stateå±žæ€§ä¼šå¯¼è‡´ç»„ä»¶çš„é‡æ–°æ¸²æŸ“ã€‚åŒºåˆ«stateæ˜¯ç»„ä»¶è‡ªå·±ç®¡ç†æ•°æ®ï¼ŒæŽ§åˆ¶è‡ªå·±çš„çŠ¶æ€ï¼Œå¯å˜ï¼›propsæ˜¯å¤–éƒ¨ä¼ å…¥çš„æ•°æ®å‚æ•°ï¼Œä¸å¯å˜ï¼›æ²¡æœ‰stateçš„å«åšæ— çŠ¶æ€ç»„ä»¶ï¼Œæœ‰stateçš„å«åšæœ‰çŠ¶æ€ç»„ä»¶ï¼›å¤šç”¨propsï¼Œå°‘ç”¨stateã€‚ä¹Ÿå°±æ˜¯å¤šå†™æ— çŠ¶æ€ç»„ä»¶ã€‚æœ¬æ–‡ä½œè€…ï¼š Andyæœ¬æ–‡åœ°å€ï¼š https://andyxw.com/archives/992.htmlç‰ˆæƒå£°æ˜Žï¼š è½¬è½½è¯·æ³¨æ˜Žå‡ºå¤„ï¼]]></content>
      <categories>
        <category>React</category>
      </categories>
      <tags>
        <tag>React</tag>
      </tags>
  </entry>
</search>
