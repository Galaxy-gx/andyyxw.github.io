<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[åä¸ªæ¡ˆä¾‹å­¦ä¼š React Hooks]]></title>
    <url>%2Farchives%2Fcca6.html</url>
    <content type="text"><![CDATA[åŸæ–‡åœ°å€åä¸ªæ¡ˆä¾‹å­¦ä¼š React Hookså‰è¨€åœ¨ React çš„ä¸–ç•Œä¸­ï¼Œæœ‰å®¹å™¨ç»„ä»¶å’Œ UI ç»„ä»¶ä¹‹åˆ†ï¼Œåœ¨ React Hooks å‡ºç°ä¹‹å‰ï¼ŒUI ç»„ä»¶æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å‡½æ•°ï¼Œæ— çŠ¶æ€ç»„ä»¶æ¥å±•ç¤º UIï¼Œè€Œå¯¹äºå®¹å™¨ç»„ä»¶ï¼Œå‡½æ•°ç»„ä»¶å°±æ˜¾å¾—æ— èƒ½ä¸ºåŠ›ï¼Œæˆ‘ä»¬ä¾èµ–äºç±»ç»„ä»¶æ¥è·å–æ•°æ®ï¼Œå¤„ç†æ•°æ®ï¼Œå¹¶å‘ä¸‹ä¼ é€’å‚æ•°ç»™ UI ç»„ä»¶è¿›è¡Œæ¸²æŸ“ã€‚åœ¨æˆ‘çœ‹æ¥ï¼Œä½¿ç”¨ React Hooks ç›¸æ¯”äºä»å‰çš„ç±»ç»„ä»¶æœ‰ä»¥ä¸‹å‡ ç‚¹å¥½å¤„ï¼šä»£ç å¯è¯»æ€§æ›´å¼ºï¼ŒåŸæœ¬åŒä¸€å—åŠŸèƒ½çš„ä»£ç é€»è¾‘è¢«æ‹†åˆ†åœ¨äº†ä¸åŒçš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°ä¸­ï¼Œå®¹æ˜“ä½¿å¼€å‘è€…ä¸åˆ©äºç»´æŠ¤å’Œè¿­ä»£ï¼Œé€šè¿‡ React Hooks å¯ä»¥å°†åŠŸèƒ½ä»£ç èšåˆï¼Œæ–¹ä¾¿é˜…è¯»ç»´æŠ¤ç»„ä»¶æ ‘å±‚çº§å˜æµ…ï¼Œåœ¨åŸæœ¬çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä½¿ç”¨ HOC/render props ç­‰æ–¹å¼æ¥å¤ç”¨ç»„ä»¶çš„çŠ¶æ€ï¼Œå¢å¼ºåŠŸèƒ½ç­‰ï¼Œæ— ç–‘å¢åŠ äº†ç»„ä»¶æ ‘å±‚æ•°åŠæ¸²æŸ“ï¼Œè€Œåœ¨ React Hooks ä¸­ï¼Œè¿™äº›åŠŸèƒ½éƒ½å¯ä»¥é€šè¿‡å¼ºå¤§çš„è‡ªå®šä¹‰çš„ Hooks æ¥å®ç°React åœ¨ v16.8 çš„ç‰ˆæœ¬ä¸­æ¨å‡ºäº† React Hooks æ–°ç‰¹æ€§ï¼Œè™½ç„¶ç¤¾åŒºè¿˜æ²¡æœ‰æœ€ä½³å®è·µå¦‚ä½•åŸºäº React Hooks æ¥æ‰“é€ å¤æ‚åº”ç”¨(è‡³å°‘æˆ‘è¿˜æ²¡æœ‰)ï¼Œå‡­å€Ÿç€é˜…è¯»ç¤¾åŒºä¸­å¤§é‡çš„å…³äºè¿™æ–¹é¢çš„æ–‡ç« ï¼Œä¸‹é¢æˆ‘å°†é€šè¿‡åä¸ªæ¡ˆä¾‹æ¥å¸®åŠ©ä½ è®¤è¯†ç†è§£å¹¶å¯ä»¥ç†Ÿç»ƒè¿ç”¨ React Hooks å¤§éƒ¨åˆ†ç‰¹æ€§ã€‚useState ä¿å­˜ç»„ä»¶çŠ¶æ€åœ¨ç±»ç»„ä»¶ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ this.state æ¥ä¿å­˜ç»„ä»¶çŠ¶æ€ï¼Œå¹¶å¯¹å…¶ä¿®æ”¹è§¦å‘ç»„ä»¶é‡æ–°æ¸²æŸ“ã€‚æ¯”å¦‚ä¸‹é¢è¿™ä¸ªç®€å•çš„è®¡æ•°å™¨ç»„ä»¶ï¼Œå¾ˆå¥½è¯ é‡Šäº†ç±»ç»„ä»¶å¦‚ä½•è¿è¡Œï¼šåœ¨çº¿ Demo1234567891011121314151617181920import React from "react";class App extends React.Component &#123; constructor(props) &#123; super(props); this.state = &#123; count: 0, name: "alife" &#125;; &#125; render() &#123; const &#123; count &#125; = this.state; return ( &lt;div&gt; Count: &#123;count&#125; &lt;button onClick=&#123;() =&gt; this.setState(&#123; count: count + 1 &#125;)&#125;&gt;+&lt;/button&gt; &lt;button onClick=&#123;() =&gt; this.setState(&#123; count: count - 1 &#125;)&#125;&gt;-&lt;/button&gt; &lt;/div&gt; ); &#125;&#125;ä¸€ä¸ªç®€å•çš„è®¡æ•°å™¨ç»„ä»¶å°±å®Œæˆäº†ï¼Œè€Œåœ¨å‡½æ•°ç»„ä»¶ä¸­ï¼Œç”±äºæ²¡æœ‰ this è¿™ä¸ªé»‘é­”æ³•ï¼ŒReact é€šè¿‡ useState æ¥å¸®æˆ‘ä»¬ä¿å­˜ç»„ä»¶çš„çŠ¶æ€ã€‚åœ¨çº¿ Demo1234567891011121314import React, &#123; useState &#125; from "react";function App() &#123; const [obj, setObject] = useState(&#123; count: 0, name: "alife" &#125;); return ( &lt;div className="App"&gt; Count: &#123;obj.count&#125; &lt;button onClick=&#123;() =&gt; setObject(&#123; ...obj, count: obj.count + 1 &#125;)&#125;&gt;+&lt;/button&gt; &lt;button onClick=&#123;() =&gt; setObject(&#123; ...obj, count: obj.count - 1 &#125;)&#125;&gt;-&lt;/button&gt; &lt;/div&gt; );&#125;é€šè¿‡ä¼ å…¥ useState å‚æ•°åè¿”å›ä¸€ä¸ªå¸¦æœ‰é»˜è®¤çŠ¶æ€å’Œæ”¹å˜çŠ¶æ€å‡½æ•°çš„æ•°ç»„ã€‚é€šè¿‡ä¼ å…¥æ–°çŠ¶æ€ç»™å‡½æ•°æ¥æ”¹å˜åŸæœ¬çš„çŠ¶æ€å€¼ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ useState ä¸å¸®åŠ©ä½ å¤„ç†çŠ¶æ€ï¼Œç›¸è¾ƒäº setState éè¦†ç›–å¼æ›´æ–°çŠ¶æ€ï¼ŒuseState è¦†ç›–å¼æ›´æ–°çŠ¶æ€ï¼Œéœ€è¦å¼€å‘è€…è‡ªå·±å¤„ç†é€»è¾‘ã€‚(ä»£ç å¦‚ä¸Š)ä¼¼ä¹æœ‰ä¸ª useState åï¼Œå‡½æ•°ç»„ä»¶ä¹Ÿå¯ä»¥æ‹¥æœ‰è‡ªå·±çš„çŠ¶æ€äº†ï¼Œä½†ä»…ä»…æ˜¯è¿™æ ·å®Œå…¨ä¸å¤Ÿã€‚useEffect å¤„ç†å‰¯ä½œç”¨å‡½æ•°ç»„ä»¶èƒ½ä¿å­˜çŠ¶æ€ï¼Œä½†æ˜¯å¯¹äºå¼‚æ­¥è¯·æ±‚ï¼Œå‰¯ä½œç”¨çš„æ“ä½œè¿˜æ˜¯æ— èƒ½ä¸ºåŠ›ï¼Œæ‰€ä»¥ React æä¾›äº† useEffect æ¥å¸®åŠ©å¼€å‘è€…å¤„ç†å‡½æ•°ç»„ä»¶çš„å‰¯ä½œç”¨ï¼Œåœ¨ä»‹ç»æ–° API ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ç±»ç»„ä»¶æ˜¯æ€ä¹ˆåšçš„ï¼šåœ¨çº¿ Demo1234567891011121314151617181920212223242526272829303132import React, &#123; Component &#125; from "react";class App extends Component &#123; state = &#123; count: 1 &#125;; componentDidMount() &#123; const &#123; count &#125; = this.state; document.title = "componentDidMount" + count; this.timer = setInterval(() =&gt; &#123; this.setState((&#123; count &#125;) =&gt; (&#123; count: count + 1 &#125;)); &#125;, 1000); &#125; componentDidUpdate() &#123; const &#123; count &#125; = this.state; document.title = "componentDidMount" + count; &#125; componentWillUnmount() &#123; document.title = "componentWillUnmount"; clearInterval(this.timer); &#125; render() &#123; const &#123; count &#125; = this.state; return ( &lt;div&gt; Count:&#123;count&#125; &lt;button onClick=&#123;() =&gt; clearInterval(this.timer)&#125;&gt;clear&lt;/button&gt; &lt;/div&gt; ); &#125;&#125;åœ¨ä¾‹å­ä¸­ï¼Œç»„ä»¶æ¯éš”ä¸€ç§’æ›´æ–°ç»„ä»¶çŠ¶æ€ï¼Œå¹¶ä¸”æ¯æ¬¡è§¦å‘æ›´æ–°éƒ½ä¼šè§¦å‘ document.title çš„æ›´æ–°(å‰¯ä½œç”¨)ï¼Œè€Œåœ¨ç»„ä»¶å¸è½½æ—¶ä¿®æ”¹ document.titleï¼ˆç±»ä¼¼äºæ¸…é™¤ï¼‰ä»ä¾‹å­ä¸­å¯ä»¥çœ‹åˆ°ï¼Œä¸€äº›é‡å¤çš„åŠŸèƒ½å¼€å‘è€…éœ€è¦åœ¨ componentDidMount å’Œ componentDidUpdate é‡å¤ç¼–å†™ï¼Œè€Œå¦‚æœä½¿ç”¨ useEffect åˆ™å®Œå…¨ä¸ä¸€æ ·ã€‚åœ¨çº¿ Demo123456789101112131415161718192021222324import React, &#123; useState, useEffect &#125; from "react";let timer = null;function App() &#123; const [count, setCount] = useState(0); useEffect(() =&gt; &#123; document.title = "componentDidMount" + count; &#125;,[count]); useEffect(() =&gt; &#123; timer = setInterval(() =&gt; &#123; setCount(prevCount =&gt; prevCount + 1); &#125;, 1000); return () =&gt; &#123; document.title = "componentWillUnmount"; clearInterval(timer); &#125;; &#125;, []); return ( &lt;div&gt; Count: &#123;count&#125; &lt;button onClick=&#123;() =&gt; clearInterval(timer)&#125;&gt;clear&lt;/button&gt; &lt;/div&gt; );&#125;æˆ‘ä»¬ä½¿ç”¨ useEffect é‡å†™äº†ä¸Šé¢çš„ä¾‹å­ï¼ŒuseEffect ç¬¬ä¸€ä¸ªå‚æ•°ä¼ é€’å‡½æ•°ï¼Œå¯ä»¥ç”¨æ¥åšä¸€äº›å‰¯ä½œç”¨æ¯”å¦‚å¼‚æ­¥è¯·æ±‚ï¼Œä¿®æ”¹å¤–éƒ¨å‚æ•°ç­‰è¡Œä¸ºï¼Œè€Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸ªæ•°ç»„ï¼Œå¦‚æœæ•°ç»„ä¸­çš„å€¼æ‰ä¼šè§¦å‘ useEffect ç¬¬ä¸€ä¸ªå‚æ•°ä¸­çš„å‡½æ•°ã€‚è¿”å›å€¼(å¦‚æœæœ‰)åˆ™åœ¨ç»„ä»¶é”€æ¯æˆ–è€…è°ƒç”¨å‡½æ•°å‰è°ƒç”¨ã€‚æ¯”å¦‚ç¬¬ä¸€ä¸ª useEffect ä¸­ï¼Œç†è§£èµ·æ¥å°±æ˜¯ä¸€æ—¦ count å€¼å‘ç”Ÿæ”¹å˜ï¼Œåˆ™ä¿®æ”¹ documen.title å€¼è€Œç¬¬äºŒä¸ª useEffect ä¸­æ•°ç»„æ²¡æœ‰ä¼ å€¼ï¼Œä»£è¡¨ä¸ç›‘å¬ä»»ä½•å‚æ•°å˜åŒ–ï¼Œå³åªæœ‰åœ¨ç»„ä»¶åˆå§‹åŒ–æˆ–é”€æ¯çš„æ—¶å€™æ‰ä¼šè§¦å‘ï¼Œç”¨æ¥ä»£æ›¿ componentDidMount å’Œ componentWillUnmountåŸºäºè¿™ä¸ªå¼ºå¤§ Hooksï¼Œæˆ‘ä»¬å¯ä»¥æ¨¡æ‹Ÿå°è£…å‡ºå…¶ä»–ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œæ¯”å¦‚ componentDidUpdate ä»£ç ååˆ†ç®€å•1234567891011function useUpdate(fn) &#123; // useRef åˆ›å»ºä¸€ä¸ªå¼•ç”¨ const mounting = useRef(true); useEffect(() =&gt; &#123; if (mounting.current) &#123; mounting.current = false; &#125; else &#123; fn(); &#125; &#125;);&#125;ç°åœ¨æˆ‘ä»¬æœ‰äº† useState ç®¡ç†çŠ¶æ€ï¼ŒuseEffect å¤„ç†å‰¯ä½œç”¨ï¼Œå¼‚æ­¥é€»è¾‘ï¼Œå­¦ä¼šè¿™ä¸¤æ‹›è¶³ä»¥åº”å¯¹å¤§éƒ¨åˆ†ç±»ç»„ä»¶çš„ä½¿ç”¨åœºæ™¯ã€‚useContext å‡å°‘ç»„ä»¶å±‚çº§ä¸Šé¢ä»‹ç»äº† useStateã€useEffect è¿™ä¸¤ä¸ªæœ€åŸºæœ¬çš„ APIï¼Œæ¥ä¸‹æ¥ä»‹ç»çš„ useContext æ˜¯ React å¸®ä½ å°è£…å¥½çš„ï¼Œç”¨æ¥å¤„ç†å¤šå±‚çº§ä¼ é€’æ•°æ®çš„æ–¹å¼ï¼Œåœ¨ä»¥å‰ç»„ä»¶æ ‘ç§ï¼Œè·¨å±‚çº§ç¥–å…ˆç»„ä»¶æƒ³è¦ç»™å­™å­ç»„ä»¶ä¼ é€’æ•°æ®çš„æ—¶å€™ï¼Œé™¤äº†ä¸€å±‚å±‚ props å¾€ä¸‹é€ä¼ ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨ React Context API æ¥å¸®æˆ‘ä»¬åšè¿™ä»¶äº‹ï¼Œä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼šåœ¨çº¿ Demo1234567891011121314const &#123; Provider, Consumer &#125; = React.createContext(null);function Bar() &#123; return &lt;Consumer&gt;&#123;color =&gt; &lt;div&gt;&#123;color&#125;&lt;/div&gt;&#125;&lt;/Consumer&gt;;&#125;function Foo() &#123; return &lt;Bar /&gt;;&#125;function App() &#123; return ( &lt;Provider value=&#123;"grey"&#125;&gt; &lt;Foo /&gt; &lt;/Provider&gt; );&#125;é€šè¿‡ React createContext çš„è¯­æ³•ï¼Œåœ¨ APP ç»„ä»¶ä¸­å¯ä»¥è·¨è¿‡ Foo ç»„ä»¶ç»™ Bar ä¼ é€’æ•°æ®ã€‚è€Œåœ¨ React Hooks ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ useContext è¿›è¡Œæ”¹é€ ã€‚åœ¨çº¿ Demo123456789101112131415const colorContext = React.createContext("gray");function Bar() &#123; const color = useContext(colorContext); return &lt;div&gt;&#123;color&#125;&lt;/div&gt;;&#125;function Foo() &#123; return &lt;Bar /&gt;;&#125;function App() &#123; return ( &lt;colorContext.Provider value=&#123;"red"&#125;&gt; &lt;Foo /&gt; &lt;/colorContext.Provider&gt; );&#125;ä¼ é€’ç»™ useContext çš„æ˜¯ context è€Œä¸æ˜¯ consumerï¼Œè¿”å›å€¼å³æ˜¯æƒ³è¦é€ä¼ çš„æ•°æ®äº†ã€‚ç”¨æ³•å¾ˆç®€å•ï¼Œä½¿ç”¨ useContext å¯ä»¥è§£å†³ Consumer å¤šçŠ¶æ€åµŒå¥—çš„é—®é¢˜ã€‚å‚è€ƒä¾‹å­123456789101112131415function HeaderBar() &#123; return ( &lt;CurrentUser.Consumer&gt; &#123;user =&gt; &lt;Notifications.Consumer&gt; &#123;notifications =&gt; &lt;header&gt; Welcome back, &#123;user.name&#125;! You have &#123;notifications.length&#125; notifications. &lt;/header&gt; &#125; &#125; &lt;/CurrentUser.Consumer&gt; );&#125;è€Œä½¿ç”¨ useContext åˆ™å˜å¾—ååˆ†ç®€æ´ï¼Œå¯è¯»æ€§æ›´å¼ºä¸”ä¸ä¼šå¢åŠ ç»„ä»¶æ ‘æ·±åº¦ã€‚12345678910function HeaderBar() &#123; const user = useContext(CurrentUser); const notifications = useContext(Notifications); return ( &lt;header&gt; Welcome back, &#123;user.name&#125;! You have &#123;notifications.length&#125; notifications. &lt;/header&gt; );&#125;useReduceruseReducer è¿™ä¸ª Hooks åœ¨ä½¿ç”¨ä¸Šå‡ ä¹è·Ÿ Redux/React-Redux ä¸€æ¨¡ä¸€æ ·ï¼Œå”¯ä¸€ç¼ºå°‘çš„å°±æ˜¯æ— æ³•ä½¿ç”¨ redux æä¾›çš„ä¸­é—´ä»¶ã€‚æˆ‘ä»¬å°†ä¸Šè¿°çš„è®¡æ—¶å™¨ç»„ä»¶æ”¹å†™ä¸º useReducerï¼Œåœ¨çº¿ Demo12345678910111213141516171819202122232425262728import React, &#123; useReducer &#125; from "react";const initialState = &#123; count: 0&#125;;function reducer(state, action) &#123; switch (action.type) &#123; case "increment": return &#123; count: state.count + action.payload &#125;; case "decrement": return &#123; count: state.count - action.payload &#125;; default: throw new Error(); &#125;&#125;function App() &#123; const [state, dispatch] = useReducer(reducer, initialState); return ( &lt;&gt; Count: &#123;state.count&#125; &lt;button onClick=&#123;() =&gt; dispatch(&#123; type: "increment", payload: 5 &#125;)&#125;&gt; + &lt;/button&gt; &lt;button onClick=&#123;() =&gt; dispatch(&#123; type: "decrement", payload: 5 &#125;)&#125;&gt; - &lt;/button&gt; &lt;/&gt; );&#125;ç”¨æ³•è·Ÿ Redux åŸºæœ¬ä¸Šæ˜¯ä¸€è‡´çš„ï¼Œç”¨æ³•ä¹Ÿå¾ˆç®€å•ï¼Œç®—æ˜¯æä¾›ä¸€ä¸ª mini çš„ Redux ç‰ˆæœ¬ã€‚useCallback è®°å¿†å‡½æ•°åœ¨ç±»ç»„ä»¶ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸çŠ¯ä¸‹é¢è¿™æ ·çš„é”™è¯¯ï¼š1234567class App &#123; render() &#123; return &lt;div&gt; &lt;SomeComponent style=&#123;&#123; fontSize: 14 &#125;&#125; doSomething=&#123; () =&gt; &#123; console.log('do something'); &#125;&#125; /&gt; &lt;/div&gt;; &#125;&#125;è¿™æ ·å†™æœ‰ä»€ä¹ˆåå¤„å‘¢ï¼Ÿä¸€æ—¦ App ç»„ä»¶çš„ props æˆ–è€…çŠ¶æ€æ”¹å˜äº†å°±ä¼šè§¦å‘é‡æ¸²æŸ“ï¼Œå³ä½¿è·Ÿ SomeComponent ç»„ä»¶ä¸ç›¸å…³ï¼Œç”±äºæ¯æ¬¡ render éƒ½ä¼šäº§ç”Ÿæ–°çš„ style å’Œ doSomethingï¼Œæ‰€ä»¥ä¼šå¯¼è‡´ SomeComponent é‡æ–°æ¸²æŸ“ï¼Œå€˜è‹¥ SomeComponent æ˜¯ä¸€ä¸ªå¤§å‹çš„ç»„ä»¶æ ‘ï¼Œè¿™æ ·çš„ Virtual Dom çš„æ¯”è¾ƒæ˜¾ç„¶æ˜¯å¾ˆæµªè´¹çš„ï¼Œè§£å†³çš„åŠæ³•ä¹Ÿå¾ˆç®€å•ï¼Œå°†å‚æ•°æŠ½ç¦»æˆå˜é‡ã€‚1234567891011const fontSizeStyle = &#123; fontSize: 14 &#125;;class App &#123; doSomething = () =&gt; &#123; console.log('do something'); &#125; render() &#123; return &lt;div&gt; &lt;SomeComponent style=&#123;fontSizeStyle&#125; doSomething=&#123; this.doSomething &#125; /&gt; &lt;/div&gt;; &#125;&#125;åœ¨ç±»ç»„ä»¶ä¸­ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡ this è¿™ä¸ªå¯¹è±¡æ¥å­˜å‚¨å‡½æ•°ï¼Œè€Œåœ¨å‡½æ•°ç»„ä»¶ä¸­æ²¡åŠæ³•è¿›è¡ŒæŒ‚è½½äº†ã€‚æ‰€ä»¥å‡½æ•°ç»„ä»¶åœ¨æ¯æ¬¡æ¸²æŸ“çš„æ—¶å€™å¦‚æœæœ‰ä¼ é€’å‡½æ•°çš„è¯éƒ½ä¼šé‡æ¸²æŸ“å­ç»„ä»¶ã€‚123456function App() &#123; const handleClick = () =&gt; &#123; console.log('Click happened'); &#125; return &lt;SomeComponent onClick=&#123;handleClick&#125;&gt;Click Me&lt;/SomeComponent&gt;;&#125;è€Œæœ‰äº† useCallback å°±ä¸ä¸€æ ·äº†ï¼Œä½ å¯ä»¥é€šè¿‡ useCallback è·å¾—ä¸€ä¸ªè®°å¿†åçš„å‡½æ•°ã€‚123456function App() &#123; const memoizedHandleClick = useCallback(() =&gt; &#123; console.log('Click happened') &#125;, []); // ç©ºæ•°ç»„ä»£è¡¨æ— è®ºä»€ä¹ˆæƒ…å†µä¸‹è¯¥å‡½æ•°éƒ½ä¸ä¼šå‘ç”Ÿæ”¹å˜ return &lt;SomeComponent onClick=&#123;memoizedHandleClick&#125;&gt;Click Me&lt;/SomeComponent&gt;;&#125;è€è§„çŸ©ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¼ å…¥ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„ä¸­çš„æ¯ä¸€é¡¹ä¸€æ—¦å€¼æˆ–è€…å¼•ç”¨å‘ç”Ÿæ”¹å˜ï¼ŒuseCallback å°±ä¼šé‡æ–°è¿”å›ä¸€ä¸ªæ–°çš„è®°å¿†å‡½æ•°æä¾›ç»™åé¢è¿›è¡Œæ¸²æŸ“ã€‚è¿™æ ·åªè¦å­ç»„ä»¶ç»§æ‰¿äº† PureComponent æˆ–è€…ä½¿ç”¨ React.memo å°±å¯ä»¥æœ‰æ•ˆé¿å…ä¸å¿…è¦çš„ VDOM æ¸²æŸ“ã€‚useMemo è®°å¿†ç»„ä»¶useCallback çš„åŠŸèƒ½å®Œå…¨å¯ä»¥ç”± useMemo æ‰€å–ä»£ï¼Œå¦‚æœä½ æƒ³é€šè¿‡ä½¿ç”¨ useMemo è¿”å›ä¸€ä¸ªè®°å¿†å‡½æ•°ä¹Ÿæ˜¯å®Œå…¨å¯ä»¥çš„ã€‚1useCallback(fn, inputs) is equivalent to useMemo(() =&gt; fn, inputs).æ‰€ä»¥å‰é¢ä½¿ç”¨ useCallback çš„ä¾‹å­å¯ä»¥ä½¿ç”¨ useMemo è¿›è¡Œæ”¹å†™ï¼š123456function App() &#123; const memoizedHandleClick = useMemo(() =&gt; () =&gt; &#123; console.log('Click happened') &#125;, []); // ç©ºæ•°ç»„ä»£è¡¨æ— è®ºä»€ä¹ˆæƒ…å†µä¸‹è¯¥å‡½æ•°éƒ½ä¸ä¼šå‘ç”Ÿæ”¹å˜ return &lt;SomeComponent onClick=&#123;memoizedHandleClick&#125;&gt;Click Me&lt;/SomeComponent&gt;;&#125;å”¯ä¸€çš„åŒºåˆ«æ˜¯ï¼šuseCallback ä¸ä¼šæ‰§è¡Œç¬¬ä¸€ä¸ªå‚æ•°å‡½æ•°ï¼Œè€Œæ˜¯å°†å®ƒè¿”å›ç»™ä½ ï¼Œè€Œ useMemo ä¼šæ‰§è¡Œç¬¬ä¸€ä¸ªå‡½æ•°å¹¶ä¸”å°†å‡½æ•°æ‰§è¡Œç»“æœè¿”å›ç»™ä½ ã€‚æ‰€ä»¥åœ¨å‰é¢çš„ä¾‹å­ä¸­ï¼Œå¯ä»¥è¿”å› handleClick æ¥è¾¾åˆ°å­˜å‚¨å‡½æ•°çš„ç›®çš„ã€‚æ‰€ä»¥ useCallback å¸¸ç”¨è®°å¿†äº‹ä»¶å‡½æ•°ï¼Œç”Ÿæˆè®°å¿†åçš„äº‹ä»¶å‡½æ•°å¹¶ä¼ é€’ç»™å­ç»„ä»¶ä½¿ç”¨ã€‚è€Œ useMemo æ›´é€‚åˆç»è¿‡å‡½æ•°è®¡ç®—å¾—åˆ°ä¸€ä¸ªç¡®å®šçš„å€¼ï¼Œæ¯”å¦‚è®°å¿†ç»„ä»¶ã€‚123456789101112function Parent(&#123; a, b &#125;) &#123; // Only re-rendered if `a` changes: const child1 = useMemo(() =&gt; &lt;Child1 a=&#123;a&#125; /&gt;, [a]); // Only re-rendered if `b` changes: const child2 = useMemo(() =&gt; &lt;Child2 b=&#123;b&#125; /&gt;, [b]); return ( &lt;&gt; &#123;child1&#125; &#123;child2&#125; &lt;/&gt; )&#125;å½“ a/b æ”¹å˜æ—¶ï¼Œchild1/child2 æ‰ä¼šé‡æ–°æ¸²æŸ“ã€‚ä»ä¾‹å­å¯ä»¥çœ‹å‡ºæ¥ï¼Œåªæœ‰åœ¨ç¬¬äºŒä¸ªå‚æ•°æ•°ç»„çš„å€¼å‘ç”Ÿå˜åŒ–æ—¶ï¼Œæ‰ä¼šè§¦å‘å­ç»„ä»¶çš„æ›´æ–°ã€‚useRef ä¿å­˜å¼•ç”¨å€¼useRef è·Ÿ createRef ç±»ä¼¼ï¼Œéƒ½å¯ä»¥ç”¨æ¥ç”Ÿæˆå¯¹ DOM å¯¹è±¡çš„å¼•ç”¨ï¼Œçœ‹ä¸ªç®€å•çš„ä¾‹å­ï¼šåœ¨çº¿ Demo1234567891011121314151617181920import React, &#123; useState, useRef &#125; from "react";function App() &#123; let [name, setName] = useState("Nate"); let nameRef = useRef(); const submitButton = () =&gt; &#123; setName(nameRef.current.value); &#125;; return ( &lt;div className="App"&gt; &lt;p&gt;&#123;name&#125;&lt;/p&gt; &lt;div&gt; &lt;input ref=&#123;nameRef&#125; type="text" /&gt; &lt;button type="button" onClick=&#123;submitButton&#125;&gt; Submit &lt;/button&gt; &lt;/div&gt; &lt;/div&gt; );&#125;useRef è¿”å›çš„å€¼ä¼ é€’ç»™ç»„ä»¶æˆ–è€… DOM çš„ ref å±æ€§ï¼Œå°±å¯ä»¥é€šè¿‡ ref.current å€¼è®¿é—®ç»„ä»¶æˆ–çœŸå®çš„ DOM èŠ‚ç‚¹ï¼Œä»è€Œå¯ä»¥å¯¹ DOM è¿›è¡Œä¸€äº›æ“ä½œï¼Œæ¯”å¦‚ç›‘å¬äº‹ä»¶ç­‰ç­‰ã€‚å½“ç„¶ useRef è¿œæ¯”ä½ æƒ³è±¡ä¸­çš„åŠŸèƒ½æ›´åŠ å¼ºå¤§ï¼ŒuseRef çš„åŠŸèƒ½æœ‰ç‚¹åƒç±»å±æ€§ï¼Œæˆ–è€…è¯´æ‚¨æƒ³è¦åœ¨ç»„ä»¶ä¸­è®°å½•ä¸€äº›å€¼ï¼Œå¹¶ä¸”è¿™äº›å€¼åœ¨ç¨åå¯ä»¥æ›´æ”¹ã€‚åˆ©ç”¨ useRef å°±å¯ä»¥ç»•è¿‡ Capture Value çš„ç‰¹æ€§ã€‚å¯ä»¥è®¤ä¸º ref åœ¨æ‰€æœ‰ Render è¿‡ç¨‹ä¸­ä¿æŒç€å”¯ä¸€å¼•ç”¨ï¼Œå› æ­¤æ‰€æœ‰å¯¹ ref çš„èµ‹å€¼æˆ–å–å€¼ï¼Œæ‹¿åˆ°çš„éƒ½åªæœ‰ä¸€ä¸ªæœ€ç»ˆçŠ¶æ€ï¼Œè€Œä¸ä¼šåœ¨æ¯ä¸ª Render é—´å­˜åœ¨éš”ç¦»ã€‚å‚è€ƒä¾‹å­ï¼šç²¾è¯»ã€ŠFunction VS Class ç»„ä»¶ã€‹React Hooks ä¸­å­˜åœ¨ Capture Value çš„ç‰¹æ€§ï¼šåœ¨çº¿ Demo12345678910111213141516171819202122function MessageThread() &#123; const [message, setMessage] = useState(""); const showMessage = () =&gt; &#123; alert("You said: " + message); &#125;; const handleSendClick = () =&gt; &#123; setTimeout(showMessage, 3000); &#125;; const handleMessageChange = e =&gt; &#123; setMessage(e.target.value); &#125;; return ( &lt;&gt; &lt;input value=&#123;message&#125; onChange=&#123;handleMessageChange&#125; /&gt; &lt;button onClick=&#123;handleSendClick&#125;&gt;Send&lt;/button&gt; &lt;/&gt; );&#125;åœ¨ç‚¹å‡» Send æŒ‰é’®åï¼Œå†æ¬¡ä¿®æ”¹è¾“å…¥æ¡†çš„å€¼ï¼Œ3 ç§’åçš„è¾“å‡ºä¾ç„¶æ˜¯ç‚¹å‡»å‰è¾“å…¥æ¡†çš„å€¼ã€‚è¿™å°±æ˜¯æ‰€è°“çš„ capture value çš„ç‰¹æ€§ã€‚è€Œåœ¨ç±»ç»„ä»¶ä¸­ 3 ç§’åè¾“å‡ºçš„å°±æ˜¯ä¿®æ”¹åçš„å€¼ï¼Œå› ä¸ºè¿™æ—¶å€™ message æ˜¯æŒ‚è½½åœ¨ this å˜é‡ä¸Šï¼Œå®ƒä¿ç•™çš„æ˜¯ä¸€ä¸ªå¼•ç”¨å€¼ï¼Œå¯¹ this å±æ€§çš„è®¿é—®éƒ½ä¼šè·å–åˆ°æœ€æ–°çš„å€¼ã€‚è®²åˆ°è¿™é‡Œä½ åº”è¯¥å°±æ˜ç™½äº†ï¼ŒuseRef åˆ›å»ºä¸€ä¸ªå¼•ç”¨ï¼Œå°±å¯ä»¥æœ‰æ•ˆè§„é¿ React Hooks ä¸­ Capture Value ç‰¹æ€§ã€‚123456789101112131415function MessageThread() &#123; const latestMessage = useRef(""); const showMessage = () =&gt; &#123; alert("You said: " + latestMessage.current); &#125;; const handleSendClick = () =&gt; &#123; setTimeout(showMessage, 3000); &#125;; const handleMessageChange = e =&gt; &#123; latestMessage.current = e.target.value; &#125;;&#125;åªè¦å°†èµ‹å€¼ä¸å–å€¼çš„å¯¹è±¡å˜æˆ useRefï¼Œè€Œä¸æ˜¯ useStateï¼Œå°±å¯ä»¥èº²è¿‡ capture value ç‰¹æ€§ï¼Œåœ¨ 3 ç§’åå¾—åˆ°æœ€æ–°çš„å€¼ã€‚useImperativeHandle é€ä¼  Refé€šè¿‡ useImperativeHandle ç”¨äºè®©çˆ¶ç»„ä»¶è·å–å­ç»„ä»¶å†…çš„ç´¢å¼• åœ¨çº¿ Demo123456789101112131415161718import React, &#123; useRef, useEffect, useImperativeHandle, forwardRef &#125; from "react";function ChildInputComponent(props, ref) &#123; const inputRef = useRef(null); useImperativeHandle(ref, () =&gt; inputRef.current); return &lt;input type="text" name="child input" ref=&#123;inputRef&#125; /&gt;;&#125;const ChildInput = forwardRef(ChildInputComponent);function App() &#123; const inputRef = useRef(null); useEffect(() =&gt; &#123; inputRef.current.focus(); &#125;, []); return ( &lt;div&gt; &lt;ChildInput ref=&#123;inputRef&#125; /&gt; &lt;/div&gt; );&#125;é€šè¿‡è¿™ç§æ–¹å¼ï¼ŒApp ç»„ä»¶å¯ä»¥è·å¾—å­ç»„ä»¶çš„ input çš„ DOM èŠ‚ç‚¹ã€‚useLayoutEffect åŒæ­¥æ‰§è¡Œå‰¯ä½œç”¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œä½¿ç”¨ useEffect å°±å¯ä»¥å¸®æˆ‘ä»¬å¤„ç†ç»„ä»¶çš„å‰¯ä½œç”¨ï¼Œä½†æ˜¯å¦‚æœæƒ³è¦åŒæ­¥è°ƒç”¨ä¸€äº›å‰¯ä½œç”¨ï¼Œæ¯”å¦‚å¯¹ DOM çš„æ“ä½œï¼Œå°±éœ€è¦ä½¿ç”¨ useLayoutEffectï¼ŒuseLayoutEffect ä¸­çš„å‰¯ä½œç”¨ä¼šåœ¨ DOM æ›´æ–°ä¹‹ååŒæ­¥æ‰§è¡Œã€‚åœ¨çº¿ Demo1234567891011121314151617181920function App() &#123; const [width, setWidth] = useState(0); useLayoutEffect(() =&gt; &#123; const title = document.querySelector("#title"); const titleWidth = title.getBoundingClientRect().width; console.log("useLayoutEffect"); if (width !== titleWidth) &#123; setWidth(titleWidth); &#125; &#125;); useEffect(() =&gt; &#123; console.log("useEffect"); &#125;); return ( &lt;div&gt; &lt;h1 id="title"&gt;hello&lt;/h1&gt; &lt;h2&gt;&#123;width&#125;&lt;/h2&gt; &lt;/div&gt; );&#125;åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼ŒuseLayoutEffect ä¼šåœ¨ renderï¼ŒDOM æ›´æ–°ä¹‹ååŒæ­¥è§¦å‘å‡½æ•°ï¼Œä¼šä¼˜äº useEffect å¼‚æ­¥è§¦å‘å‡½æ•°ã€‚React Hooks ä¸è¶³å°½ç®¡æˆ‘ä»¬é€šè¿‡ä¸Šé¢çš„ä¾‹å­çœ‹åˆ° React Hooks çš„å¼ºå¤§ä¹‹å¤„ï¼Œä¼¼ä¹ç±»ç»„ä»¶å®Œå…¨éƒ½å¯ä»¥ä½¿ç”¨ React Hooks é‡å†™ã€‚ä½†æ˜¯å½“ä¸‹ v16.8 çš„ç‰ˆæœ¬ä¸­ï¼Œè¿˜æ— æ³•å®ç° getSnapshotBeforeUpdate å’Œ componentDidCatch è¿™ä¸¤ä¸ªåœ¨ç±»ç»„ä»¶ä¸­çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°ã€‚å®˜æ–¹ä¹Ÿè®¡åˆ’åœ¨ä¸ä¹…çš„å°†æ¥åœ¨ React Hooks è¿›è¡Œå®ç°ã€‚æœ¬æ–‡ä½œè€…ï¼š Andyæœ¬æ–‡åœ°å€ï¼š https://andyxw.com/archives/cca6.htmlç‰ˆæƒå£°æ˜ï¼š è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>React</tag>
        <tag>å‰ç«¯</tag>
        <tag>React Hooks</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JS Iframeä¸çˆ¶çº§é¡µé¢é€šä¿¡åŠIE9å…¼å®¹æ€§]]></title>
    <url>%2Farchives%2Fd4bd.html</url>
    <content type="text"><![CDATA[æœ¬æ–‡ç”± ç®€æ‚¦ SimpRead è½¬ç ï¼Œ åŸæ–‡åœ°å€ https://www.cnblogs.com/haosit/p/11301350.htmlä¸€ã€ postMessagewindow.postMessage() æ–¹æ³•å®‰å…¨åœ°å¯ç”¨ Window å¯¹è±¡ä¹‹é—´çš„è·¨æºé€šä¿¡ï¼›ä¾‹å¦‚ï¼Œåœ¨é¡µé¢å’Œå®ƒäº§ç”Ÿçš„å¼¹å‡ºçª—å£ä¹‹é—´ï¼Œæˆ–è€…åœ¨é¡µé¢å’ŒåµŒå…¥å…¶ä¸­çš„ iframe ä¹‹é—´ã€‚äºŒã€è¯­æ³•otherWindow.postMessage(message, targetOrigin, [transfer]);otherWindowï¼šæ˜¯æ¥æ”¶å¯¹è±¡çš„çª—ä½“å¼•ç”¨ï¼Œä¾‹å¦‚ï¼šå­çª—ä½“ (iframe) å¯¹çˆ¶çº§çª—ä½“çš„å¼•ç”¨ â€œwindow.parentâ€ æˆ–è€…å…¶ä»– Iframe çš„å¼•ç”¨ â€œWindow.frames + ç´¢å¼•å€¼(å‘½åæˆ–æ•°å­—)â€messageï¼šå°†è¦å‘é€åˆ°å…¶ä»– window çš„æ•°æ®ã€‚åœ¨ IE9 ä»¥ä¸‹çš„æµè§ˆå™¨, message ä¸æ”¯æŒ JSON å¯¹è±¡ï¼Œå¿…é¡»æ˜¯å­—ç¬¦ä¸²ç±»å‹targetOriginï¼šé€šè¿‡çª—å£çš„ origin å±æ€§æ¥æŒ‡å®šå“ªäº›çª—å£èƒ½æ¥æ”¶åˆ°æ¶ˆæ¯äº‹ä»¶ï¼Œå…¶å€¼å¯ä»¥æ˜¯å­—ç¬¦ä¸² â€œ*â€ï¼ˆè¡¨ç¤ºæ— é™åˆ¶ï¼‰æˆ–è€…ä¸€ä¸ª URIã€‚åœ¨å‘é€æ¶ˆæ¯çš„æ—¶å€™ï¼Œå¦‚æœç›®æ ‡çª—å£çš„åè®®ã€ä¸»æœºåœ°å€æˆ–ç«¯å£è¿™ä¸‰è€…çš„ä»»æ„ä¸€é¡¹ä¸åŒ¹é… targetOrigin æä¾›çš„å€¼ï¼Œé‚£ä¹ˆæ¶ˆæ¯å°±ä¸ä¼šè¢«å‘é€ï¼›åªæœ‰ä¸‰è€…å®Œå…¨åŒ¹é…ï¼Œæ¶ˆæ¯æ‰ä¼šè¢«å‘é€ã€‚transferï¼šæ˜¯ä¸€ä¸²å’Œ message åŒæ—¶ä¼ é€’çš„ Transferable å¯¹è±¡. è¿™äº›å¯¹è±¡çš„æ‰€æœ‰æƒå°†è¢«è½¬ç§»ç»™æ¶ˆæ¯çš„æ¥æ”¶æ–¹ï¼Œè€Œå‘é€ä¸€æ–¹å°†ä¸å†ä¿æœ‰æ‰€æœ‰æƒã€‚ä¸‰ã€åº”ç”¨å­çª—ä½“å’Œçˆ¶çª—ä½“ä¹‹é—´çš„é€šä¿¡1. parent.htmlï¼šæ·»åŠ æœ‰ Iframe(childIframe.html) é¡µé¢ï¼Œå¹¶ç›‘å¬ message äº‹ä»¶ ; â€œå¤åˆ¶ä»£ç â€)12345678910111213141516171819202122&lt;html&gt;&lt;head&gt; &lt;meta charset=&quot;utf-8&quot; /&gt; &lt;meta /&gt; &lt;title&gt;&lt;/title&gt; &lt;style&gt; iframe&#123; border:none; width:100%; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;h1&gt;parent&lt;/h1&gt; &lt;iframe src=&quot;childiframe.html&quot;&gt;&lt;/iframe&gt; &lt;script&gt; window.addEventListener(&quot;message&quot;, function (message) &#123; alert(JSON.stringify(message.data)); &#125;); &lt;/script&gt;&lt;/body&gt;&lt;/html&gt;; â€œå¤åˆ¶ä»£ç â€) View Code2. childIframe.htmlï¼šç›´æ¥å‘ parent å‘é€ä¸€æ¡æ¶ˆæ¯ ; â€œå¤åˆ¶ä»£ç â€)1234567891011121314&lt;html&gt;&lt;head&gt; &lt;meta charset=&quot;utf-8&quot; /&gt; &lt;meta /&gt; &lt;title&gt;&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;h1&gt;childIframe&lt;/h1&gt; &lt;script&gt; window.parent.postMessage(&#123;type:&quot;open&quot;,url:&quot;iframe.html&quot;&#125;,&quot;*&quot;); &lt;/script&gt;&lt;/body&gt;&lt;/html&gt;; â€œå¤åˆ¶ä»£ç â€) View Code3. IE9 - å…¼å®¹é—®é¢˜ï¼šIE9 åŠä»¥ä¸‹çš„æµè§ˆå™¨, message ä¸æ”¯æŒ JSON å¯¹è±¡ï¼Œå¿…é¡»æ˜¯å­—ç¬¦ä¸²ç±»å‹ã€‚å‘é€æ—¶å°† JSON è½¬æ¢ä¸ºå­—ç¬¦ä¸²1window.parent.postMessage(JSON.stringify(&#123; type: &quot;open&quot;, url: &quot;iframe.html&quot; &#125;), &quot;*&quot;);IE9 è¿˜æ˜¯ IE8 ä¸å…¼å®¹ addEventListener å’Œ â€œmessageâ€ ç›‘å¬æ–¹æ³•å’Œäº‹ä»¶ï¼Œå…¼å®¹åŠæ³•; â€œå¤åˆ¶ä»£ç â€)12345678910//IE8,IE9å…¼å®¹æ–¹æ³•if (window.attachEvent) &#123; window.attachEvent(&apos;onmessage&apos;, function (message) &#123; console.log(JSON.parse(message.data)); &#125;);&#125; else &#123; window.addEventListener(&apos;message&apos;, function (message) &#123; console.log(JSON.parse(message.data)); &#125;);&#125;; â€œå¤åˆ¶ä»£ç â€)æœ¬æ–‡ä½œè€…ï¼š Andyæœ¬æ–‡åœ°å€ï¼š https://andyxw.com/archives/d4bd.htmlç‰ˆæƒå£°æ˜ï¼š è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>JS</tag>
        <tag>Iframe</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[A Complete Guide to useEffect]]></title>
    <url>%2Farchives%2F6387.html</url>
    <content type="text"><![CDATA[æœ¬æ–‡ç”± ç®€æ‚¦ SimpRead è½¬ç ï¼Œ åŸæ–‡åœ°å€ https://overreacted.io/a-complete-guide-to-useeffect/You wrote a few components with Hooks. Maybe even a small app. Youâ€™re mostly satisfied. Youâ€™re comfortable with the API and picked up a few tricks along the way. You even made some custom Hooks to extract repetitive logic (300 lines gone!) and showed it off to your colleagues. â€œGreat jobâ€, they said.But sometimes when you useEffect, the pieces donâ€™t quite fit together. You have a nagging feeling that youâ€™re missing something. It seems similar to class lifecyclesâ€¦ but is it really? You find yourself asking questions like:ğŸ¤” How do I replicate componentDidMount with useEffect?ğŸ¤” How do I correctly fetch data inside useEffect? What is []?ğŸ¤” Do I need to specify functions as effect dependencies or not?ğŸ¤” Why do I sometimes get an infinite refetching loop?ğŸ¤” Why do I sometimes get an old state or prop value inside my effect?When I just started using Hooks, I was confused by all of those questions too. Even when writing the initial docs, I didnâ€™t have a firm grasp on some of the subtleties. Iâ€™ve since had a few â€œahaâ€ moments that I want to share with you. This deep dive will make the answers to these questions look obvious to you.To see the answers, we need to take a step back. The goal of this article isnâ€™t to give you a list of bullet point recipes. Itâ€™s to help you truly â€œgrokâ€ useEffect. There wonâ€™t be much to learn. In fact, weâ€™ll spend most of our time _un_learning.Itâ€™s only after I stopped looking at the useEffect Hook through the prism of the familiar class lifecycle methods that everything came together for me.â€œUnlearn what you have learned.â€ â€” YodaThis article assumes that youâ€™re somewhat familiar with useEffect API.Itâ€™s also really long. Itâ€™s like a mini-book. Thatâ€™s just my preferred format. But I wrote a TLDR just below if youâ€™re in a rush or donâ€™t really care.If youâ€™re not comfortable with deep dives, you might want to wait until these explanations appear elsewhere. Just like when React came out in 2013, it will take some time for people to recognize a different mental model and teach it.TLDRHereâ€™s a quick TLDR if you donâ€™t want to read the whole thing. If some parts donâ€™t make sense, you can scroll down until you find something related.Feel free to skip it if you plan to read the whole post. Iâ€™ll link to it at the end.ğŸ¤” Question: How do I replicate componentDidMount with useEffect?While you can useEffect(fn, []), itâ€™s not an exact equivalent. Unlike componentDidMount, it will capture props and state. So even inside the callbacks, youâ€™ll see the initial props and state. If you want to see â€œlatestâ€ something, you can write it to a ref. But thereâ€™s usually a simpler way to structure the code so that you donâ€™t have to. Keep in mind that the mental model for effects is different from componentDidMount and other lifecycles, and trying to find their exact equivalents may confuse you more than help. To get productive, you need to â€œthink in effectsâ€, and their mental model is closer to implementing synchronization than to responding to lifecycle events.ğŸ¤” Question: How do I correctly fetch data inside useEffect? What is []?This article is a good primer on data fetching with useEffect. Make sure to read it to the end! Itâ€™s not as long as this one. [] means the effect doesnâ€™t use any value that participates in React data flow, and is for that reason safe to apply once. It is also a common source of bugs when the value actually _is_ used. Youâ€™ll need to learn a few strategies (primarily useReducer and useCallback) that can remove the need for a dependency instead of incorrectly omitting it.ğŸ¤” Question: Do I need to specify functions as effect dependencies or not?The recommendation is to hoist functions that donâ€™t need props or state outside of your component, and pull the ones that are used only by an effect inside of that effect. If after that your effect still ends up using functions in the render scope (including function from props), wrap them into useCallback where theyâ€™re defined, and repeat the process. Why does it matter? Functions can â€œseeâ€ values from props and state â€” so they participate in the data flow. Thereâ€™s a more detailed answer in our FAQ.ğŸ¤” Question: Why do I sometimes get an infinite refetching loop?This can happen if youâ€™re doing data fetching in an effect without the second dependencies argument. Without it, effects run after every render â€” and setting the state will trigger the effects again. An infinite loop may also happen if you specify a value that always changes in the dependency array. You can tell which one by removing them one by one. However, removing a dependency you use (or blindly specifying []) is usually the wrong fix. Instead, fix the problem at its source. For example, functions can cause this problem, and putting them inside effects, hoisting them out, or wrapping them with useCallback helps. To avoid recreating objects, useMemo can serve a similar purpose.ğŸ¤” Why do I sometimes get an old state or prop value inside my effect?Effects always â€œseeâ€ props and state from the render they were defined in. That helps prevent bugs but in some cases can be annoying. For those cases, you can explicitly maintain some value in a mutable ref (the linked article explains it at the end). If you think youâ€™re seeing some props or state from an old render but donâ€™t expect it, you probably missed some dependencies. Try using the lint rule to train yourself to see them. A few days, and itâ€™ll be like a second nature to you. See also this answer in our FAQ.I hope this TLDR was helpful! Otherwise, letâ€™s go.Each Render Has Its Own Props and StateBefore we can talk about effects, we need to talk about rendering.Hereâ€™s a counter. Look at the highlighted line closely:1234567891011function Counter() &#123; const [count, setCount] = useState(0); return ( &lt;div&gt; &lt;p&gt;You clicked &#123;count&#125; times&lt;/p&gt; &lt;button onClick=&#123;() =&gt; setCount(count + 1)&#125;&gt; Click me &lt;/button&gt; &lt;/div&gt; );&#125;What does it mean? Does count somehow â€œwatchâ€ changes to our state and update automatically? That might be a useful first intuition when you learn React but itâ€™s not an accurate mental model.In this example, count is just a number. Itâ€™s not a magic â€œdata bindingâ€, a â€œwatcherâ€, a â€œproxyâ€, or anything else. Itâ€™s a good old number like this one:123const count = 42;&lt;p&gt;You clicked &#123;count&#125; times&lt;/p&gt;The first time our component renders, the count variable we get from useState() is 0. When we call setCount(1), React calls our component again. This time, count will be 1. And so on:12345678910111213141516171819function Counter() &#123; const count = 0; &lt;p&gt;You clicked &#123;count&#125; times&lt;/p&gt; &#125;function Counter() &#123; const count = 1; &lt;p&gt;You clicked &#123;count&#125; times&lt;/p&gt; &#125;function Counter() &#123; const count = 2; &lt;p&gt;You clicked &#123;count&#125; times&lt;/p&gt; &#125;Whenever we update the state, React calls our component. Each render result â€œseesâ€ its own counter state value which is a constant inside our function.So this line doesnâ€™t do any special data binding:1&lt;p&gt;You clicked &#123;count&#125; times&lt;/p&gt;It only embeds a number value into the render output. That number is provided by React. When we setCount, React calls our component again with a different count value. Then React updates the DOM to match our latest render output.The key takeaway is that the count constant inside any particular render doesnâ€™t change over time. Itâ€™s our component thatâ€™s called again â€” and each render â€œseesâ€ its own count value thatâ€™s isolated between renders.(For an in-depth overview of this process, check out my post React as a UI Runtime.)Each Render Has Its Own Event HandlersSo far so good. What about event handlers?Look at this example. It shows an alert with the count after three seconds:12345678910111213function Counter() &#123; const [count, setCount] = useState(0); function handleAlertClick() &#123; setTimeout(() =&gt; &#123; alert(&apos;You clicked on: &apos; + count); &#125;, 3000); &#125; return ( &lt;div&gt; &lt;p&gt;You clicked &#123;count&#125; times&lt;/p&gt; &lt;button onClick=&#123;() =&gt; setCount(count + 1)&#125;&gt; Click me &lt;/button&gt; &lt;button onClick=&#123;handleAlertClick&#125;&gt; Show alert &lt;/button&gt; &lt;/div&gt; );&#125;Letâ€™s say I do this sequence of steps:Increment the counter to 3Press â€œShow alertâ€Increment it to 5 before the timeout firesWhat do you expect the alert to show? Will it show 5 â€” which is the counter state at the time of the alert? Or will it show 3 â€” the state when I clicked?spoilers aheadGo ahead and try it yourself!If the behavior doesnâ€™t quite make sense to you, imagine a more practical example: a chat app with the current recipient ID in the state, and a Send button. This article explores the reasons in depth but the correct answer is 3.The alert will â€œcaptureâ€ the state at the time I clicked the button.(There are ways to implement the other behavior too but Iâ€™ll be focusing on the default case for now. When building a mental model, itâ€™s important that we distinguish the â€œpath of least resistanceâ€ from the opt-in escape hatches.)But how does it work?Weâ€™ve discussed that the count value is constant for every particular call to our function. Itâ€™s worth emphasizing this â€” our function gets called many times (once per each render), but every one of those times the count value inside of it is constant and set to a particular value (state for that render).This is not specific to React â€” regular functions work in a similar way:1234567891011121314function sayHi(person) &#123; const name = person.name; setTimeout(() =&gt; &#123; alert(&apos;Hello, &apos; + name); &#125;, 3000);&#125;let someone = &#123;name: &apos;Dan&apos;&#125;;sayHi(someone);someone = &#123;name: &apos;Yuzhi&apos;&#125;;sayHi(someone);someone = &#123;name: &apos;Dominic&apos;&#125;;sayHi(someone);In this example, the outer someone variable is reassigned several times. (Just like somewhere in React, the current component state can change.) However, inside sayHi, there is a local name constant that is associated with a person from a particular call. That constant is local, so itâ€™s isolated between the calls! As a result, when the timeouts fire, each alert â€œremembersâ€ its own name.This explains how our event handler captures the count at the time of the click. If we apply the same substitution principle, each render â€œseesâ€ its own count:12345678910111213141516171819202122232425262728293031function Counter() &#123; const count = 0; function handleAlertClick() &#123; setTimeout(() =&gt; &#123; alert(&apos;You clicked on: &apos; + count); &#125;, 3000); &#125; &#125;function Counter() &#123; const count = 1; function handleAlertClick() &#123; setTimeout(() =&gt; &#123; alert(&apos;You clicked on: &apos; + count); &#125;, 3000); &#125; &#125;function Counter() &#123; const count = 2; function handleAlertClick() &#123; setTimeout(() =&gt; &#123; alert(&apos;You clicked on: &apos; + count); &#125;, 3000); &#125; &#125;So effectively, each render returns its own â€œversionâ€ of handleAlertClick. Each of those versions â€œremembersâ€ its own count:12345678910111213141516171819202122232425262728293031function Counter() &#123; function handleAlertClick() &#123; setTimeout(() =&gt; &#123; alert(&apos;You clicked on: &apos; + 0); &#125;, 3000); &#125; &lt;button onClick=&#123;handleAlertClick&#125; /&gt; &#125;function Counter() &#123; function handleAlertClick() &#123; setTimeout(() =&gt; &#123; alert(&apos;You clicked on: &apos; + 1); &#125;, 3000); &#125; &lt;button onClick=&#123;handleAlertClick&#125; /&gt; &#125;function Counter() &#123; function handleAlertClick() &#123; setTimeout(() =&gt; &#123; alert(&apos;You clicked on: &apos; + 2); &#125;, 3000); &#125; &lt;button onClick=&#123;handleAlertClick&#125; /&gt; &#125;This is why in this demo event handlers â€œbelongâ€ to a particular render, and when you click, it keeps using the counter state from that render.Inside any particular render, props and state forever stay the same. But if props and state are isolated between renders, so are any values using them (including the event handlers). They also â€œbelongâ€ to a particular render. So even async functions inside an event handler will â€œseeâ€ the same count value.Side note: I inlined concrete count values right into handleAlertClick functions above. This mental substitution is safe because count canâ€™t possibly change within a particular render. Itâ€™s declared as a const and is a number. It would be safe to think the same way about other values like objects too, but only if we agree to avoid mutating state. Calling setSomething(newObj) with a newly created object instead of mutating it is fine because state belonging to previous renders is intact.Each Render Has Its Own EffectsThis was supposed to be a post about effects but we still havenâ€™t talked about effects yet! Weâ€™ll rectify this now. Turns out, effects arenâ€™t really any different.Letâ€™s go back to an example from the docs:12345678910111213function Counter() &#123; const [count, setCount] = useState(0); useEffect(() =&gt; &#123; document.title = `You clicked $&#123;count&#125; times`; &#125;); return ( &lt;div&gt; &lt;p&gt;You clicked &#123;count&#125; times&lt;/p&gt; &lt;button onClick=&#123;() =&gt; setCount(count + 1)&#125;&gt; Click me &lt;/button&gt; &lt;/div&gt; );&#125;Hereâ€™s a question for you: how does the effect read the latest count state?Maybe, thereâ€™s some kind of â€œdata bindingâ€ or â€œwatchingâ€ that makes count update live inside the effect function? Maybe count is a mutable variable that React sets inside our component so that our effect always sees the latest value?Nope.We already know that count is constant within a particular component render. Event handlers â€œseeâ€ the count state from the render that they â€œbelongâ€ to because count is a variable in their scope. The same is true for effects!Itâ€™s not the count variable that somehow changes inside an â€œunchangingâ€ effect. Itâ€™s the effect function itself thatâ€™s different on every render.Each version â€œseesâ€ the count value from the render that it â€œbelongsâ€ to:12345678910111213141516171819202122function Counter() &#123; useEffect( () =&gt; &#123; document.title = `You clicked $&#123;0&#125; times`; &#125; ); &#125;function Counter() &#123; useEffect( () =&gt; &#123; document.title = `You clicked $&#123;1&#125; times`; &#125; ); &#125;function Counter() &#123; useEffect( () =&gt; &#123; document.title = `You clicked $&#123;2&#125; times`; &#125; ); &#125;React remembers the effect function you provided, and runs it after flushing changes to the DOM and letting the browser paint the screen.So even if we speak of a single conceptual effect here (updating the document title), it is represented by a different function on every render â€” and each effect function â€œseesâ€ props and state from the particular render it â€œbelongsâ€ to.Conceptually, you can imagine effects are a part of the render result.Strictly saying, theyâ€™re not (in order to allow Hook composition without clumsy syntax or runtime overhead). But in the mental model weâ€™re building up, effect functions belong to a particular render in the same way that event handlers do.To make sure we have a solid understanding, letâ€™s recap our first render:React: Give me the UI when the state is 0.Your component:Hereâ€™s the render result: &lt;p&gt;You clicked 0 times&lt;/p&gt;.Also remember to run this effect after youâ€™re done: () =&gt; { document.title = &#39;You clicked 0 times&#39; }.React: Sure. Updating the UI. Hey browser, Iâ€™m adding some stuff to the DOM.Browser: Cool, I painted it to the screen.React: OK, now Iâ€™m going to run the effect you gave me.Running () =&gt; { document.title = &#39;You clicked 0 times&#39; }.Now letâ€™s recap what happens after we click:Your component: Hey React, set my state to 1.React: Give me the UI for when the state is 1.Your component:Hereâ€™s the render result: &lt;p&gt;You clicked 1 times&lt;/p&gt;.Also remember to run this effect after youâ€™re done: () =&gt; { document.title = &#39;You clicked 1 times&#39; }.React: Sure. Updating the UI. Hey browser, Iâ€™ve changed the DOM.Browser: Cool, I painted your changes to the screen.React: OK, now Iâ€™ll run the effect that belongs to the render I just did.Running () =&gt; { document.title = &#39;You clicked 1 times&#39; }.Each Render Has Its Ownâ€¦ EverythingWe know now that effects run after every render, are conceptually a part of the component output, and â€œseeâ€ the props and state from that particular render.Letâ€™s try a thought experiment. Consider this code:12345678910111213function Counter() &#123; const [count, setCount] = useState(0); useEffect(() =&gt; &#123; setTimeout(() =&gt; &#123; console.log(`You clicked $&#123;count&#125; times`); &#125;, 3000); &#125;); return ( &lt;div&gt; &lt;p&gt;You clicked &#123;count&#125; times&lt;/p&gt; &lt;button onClick=&#123;() =&gt; setCount(count + 1)&#125;&gt; Click me &lt;/button&gt; &lt;/div&gt; );&#125;If I click several times with a small delay, what is the log going to look like?spoilers aheadYou might think this is a gotcha and the end result is unintuitive. Itâ€™s not! Weâ€™re going to see a sequence of logs â€” each one belonging to a particular render and thus with its own count value. You can try it yourself:You may think: â€œOf course thatâ€™s how it works! How else could it work?â€Well, thatâ€™s not how this.state works in classes. Itâ€™s easy to make the mistake of thinking that this class implementation is equivalent:12345componentDidUpdate() &#123; setTimeout(() =&gt; &#123; console.log(`You clicked $&#123;this.state.count&#125; times`); &#125;, 3000);&#125;However, this.state.count always points at the latest count rather than the one belonging to a particular render. So youâ€™ll see 5 logged each time instead:I think itâ€™s ironic that Hooks rely so much on JavaScript closures, and yet itâ€™s the class implementation that suffers from the canonical wrong-value-in-a-timeout confusion thatâ€™s often associated with closures. This is because the actual source of the confusion in this example is the mutation (React mutates this.state in classes to point to the latest state) and not closures themselves.Closures are great when the values you close over never change. That makes them easy to think about because youâ€™re essentially referring to constants. And as we discussed, props and state never change within a particular render. By the way, we can fix the class versionâ€¦ by using a closure.Swimming Against the TideAt this point itâ€™s important that we call it out explicitly: every function inside the component render (including event handlers, effects, timeouts or API calls inside them) captures the props and state of the render call that defined it.So these two examples are equivalent:1234567function Example(props) &#123; useEffect(() =&gt; &#123; setTimeout(() =&gt; &#123; console.log(props.counter); &#125;, 1000); &#125;); &#125;1234567function Example(props) &#123; const counter = props.counter; useEffect(() =&gt; &#123; setTimeout(() =&gt; &#123; console.log(counter); &#125;, 1000); &#125;); &#125;It doesnâ€™t matter whether you read from props or state â€œearlyâ€ inside of your component. Theyâ€™re not going to change! Inside the scope of a single render, props and state stay the same. (Destructuring props makes this more obvious.)Of course, sometimes you want to read the latest rather than captured value inside some callback defined in an effect. The easiest way to do it is by using refs, as described in the last section of this article.Be aware that when you want to read the future props or state from a function in a past render, youâ€™re swimming against the tide. Itâ€™s not wrong (and in some cases necessary) but it might look less â€œcleanâ€ to break out of the paradigm. This is an intentional consequence because it helps highlight which code is fragile and depends on timing. In classes, itâ€™s less obvious when this happens.Hereâ€™s a version of our counter example that replicates the class behavior:1234567function Example() &#123; const [count, setCount] = useState(0); const latestCount = useRef(count); useEffect(() =&gt; &#123; latestCount.current = count; setTimeout(() =&gt; &#123; console.log(`You clicked $&#123;latestCount.current&#125; times`); &#125;, 3000); &#125;);It might seem quirky to mutate something in React. However, this is exactly how React itself reassigns this.state in classes. Unlike with captured props and state, you donâ€™t have any guarantees that reading latestCount.current would give you the same value in any particular callback. By definition, you can mutate it any time. This is why itâ€™s not a default, and you have to opt into that.So What About Cleanup?As the docs explain, some effects might have a cleanup phase. Essentially, its purpose is to â€œundoâ€ an effect for cases like subscriptions.Consider this code:123456useEffect(() =&gt; &#123; ChatAPI.subscribeToFriendStatus(props.id, handleStatusChange); return () =&gt; &#123; ChatAPI.unsubscribeFromFriendStatus(props.id, handleStatusChange); &#125;;&#125;);Say props is {id: 10} on the first render, and {id: 20} on the second render. You might think that something like this happens:React cleans up the effect for {id: 10}.React renders UI for {id: 20}.React runs the effect for {id: 20}.(This is not quite the case.)With this mental model, you might think the cleanup â€œseesâ€ the old props because it runs before we re-render, and then the new effect â€œseesâ€ the new props because it runs after the re-render. Thatâ€™s the mental model lifted directly from the class lifecycles, and itâ€™s not accurate here. Letâ€™s see why.React only runs the effects after letting the browser paint. This makes your app faster as most effects donâ€™t need to block screen updates. Effect cleanup is also delayed. The previous effect is cleaned up after the re-render with new props:React renders UI for {id: 20}.The browser paints. We see the UI for {id: 20} on the screen.React cleans up the effect for {id: 10}.React runs the effect for {id: 20}.You might be wondering: but how can the cleanup of the previous effect still â€œseeâ€ the old {id: 10} props if it runs after the props change to {id: 20}?Weâ€™ve been here beforeâ€¦ ğŸ¤”Quoting the previous section:Every function inside the component render (including event handlers, effects, timeouts or API calls inside them) captures the props and state of the render call that defined it.Now the answer is clear! The effect cleanup doesnâ€™t read the â€œlatestâ€ props, whatever that means. It reads props that belong to the render itâ€™s defined in:1234567891011121314151617181920212223242526function Example() &#123; useEffect( () =&gt; &#123; ChatAPI.subscribeToFriendStatus(10, handleStatusChange); return () =&gt; &#123; ChatAPI.unsubscribeFromFriendStatus(10, handleStatusChange); &#125;; &#125; ); &#125;function Example() &#123; useEffect( () =&gt; &#123; ChatAPI.subscribeToFriendStatus(20, handleStatusChange); return () =&gt; &#123; ChatAPI.unsubscribeFromFriendStatus(20, handleStatusChange); &#125;; &#125; ); &#125;Kingdoms will rise and turn into ashes, the Sun will shed its outer layers to be a white dwarf, and the last civilization will end. But nothing will make the props â€œseenâ€ by the first render effectâ€™s cleanup anything other than {id: 10}.Thatâ€™s what allows React to deal with effects right after painting â€” and make your apps faster by default. The old props are still there if our code needs them.Synchronization, Not LifecycleOne of my favorite things about React is that it unifies describing the initial render result and the updates. This reduces the entropy of your program.Say my component looks like this:1234567function Greeting(&#123; name &#125;) &#123; return ( &lt;h1 class&gt; Hello, &#123;name&#125; &lt;/h1&gt; );&#125;It doesnâ€™t matter if I render &lt;Greeting /&gt; and later &lt;Greeting /&gt;, or if I just render &lt;Greeting /&gt;. In the end, we will see â€œHello, Yuzhiâ€ in both cases.People say: â€œItâ€™s all about the journey, not the destinationâ€. With React, itâ€™s the opposite. Itâ€™s all about the destination, not the journey. Thatâ€™s the difference between $.addClass and $.removeClass calls in jQuery code (our â€œjourneyâ€) and specifying what the CSS class should be in React code (our â€œdestinationâ€).React synchronizes the DOM according to our current props and state. There is no distinction between a â€œmountâ€ or an â€œupdateâ€ when rendering.You should think of effects in a similar way. useEffect lets you synchronize things outside of the React tree according to our props and state.1234567function Greeting(&#123; name &#125;) &#123; useEffect(() =&gt; &#123; document.title = &apos;Hello, &apos; + name; &#125;); return ( &lt;h1 class&gt; Hello, &#123;name&#125; &lt;/h1&gt; );&#125;This is subtly different from the familiar mount/update/unmount mental model. It is important really to internalize this. If youâ€™re trying to write an effect that behaves differently depending on whether the component renders for the first time or not, youâ€™re swimming against the tide! Weâ€™re failing at synchronizing if our result depends on the â€œjourneyâ€ rather than the â€œdestinationâ€.It shouldnâ€™t matter whether we rendered with props A, B, and C, or if we rendered with C immediately. While there may be some temporary differences (e.g. while weâ€™re fetching data), eventually the end result should be the same.Still, of course running all effects on every render might not be efficient. (And in some cases, it would lead to infinite loops.)So how can we fix this?Teaching React to Diff Your EffectsWeâ€™ve already learned that lesson with the DOM itself. Instead of touching it on every re-render, React only updates the parts of the DOM that actually change.When youâ€™re updating123&lt;h1 class&gt; Hello, Dan&lt;/h1&gt;to123&lt;h1 class&gt; Hello, Yuzhi&lt;/h1&gt;React sees two objects:12const oldProps = &#123;className: &apos;Greeting&apos;, children: &apos;Hello, Dan&apos;&#125;;const newProps = &#123;className: &apos;Greeting&apos;, children: &apos;Hello, Yuzhi&apos;&#125;;It goes over each of their props and determine that children have changed and need a DOM update, but className did not. So it can just do:1domNode.innerText = &apos;Hello, Yuzhi&apos;;Could we do something like this with effects too? It would be nice to avoid re-running them when applying the effect is unnecessary.For example, maybe our component re-renders because of a state change:12345678910111213function Greeting(&#123; name &#125;) &#123; const [counter, setCounter] = useState(0); useEffect(() =&gt; &#123; document.title = &apos;Hello, &apos; + name; &#125;); return ( &lt;h1 class&gt; Hello, &#123;name&#125; &lt;button onClick=&#123;() =&gt; setCounter(count + 1)&#125;&gt; Increment &lt;/button&gt; &lt;/h1&gt; );&#125;But our effect doesnâ€™t use the counter state. Our effect synchronizes the document.title with the name prop, but the name prop is the same. Re-assigning document.title on every counter change seems non-ideal.OK, so can React justâ€¦ diff effects?12let oldEffect = () =&gt; &#123; document.title = &apos;Hello, Dan&apos;; &#125;;let newEffect = () =&gt; &#123; document.title = &apos;Hello, Dan&apos;; &#125;;Not really. React canâ€™t guess what the function does without calling it. (The source doesnâ€™t really contain specific values, it just closes over the name prop.)This is why if you want to avoid re-running effects unnecessarily, you can provide a dependency array (also known as â€œdepsâ€) argument to useEffect:123useEffect(() =&gt; &#123; document.title = &apos;Hello, &apos; + name;&#125;, [name]);Itâ€™s like if we told React: â€œHey, I know you canâ€™t see inside this function, but I promise it only uses name and nothing else from the render scope.â€If each of these values is the same between the current and the previous time this effect ran, thereâ€™s nothing to synchronize so React can skip the effect:12345const oldEffect = () =&gt; &#123; document.title = &apos;Hello, Dan&apos;; &#125;;const oldDeps = [&apos;Dan&apos;];const newEffect = () =&gt; &#123; document.title = &apos;Hello, Dan&apos;; &#125;;const newDeps = [&apos;Dan&apos;];If even one of the values in the dependency array is different between renders, we know running the effect canâ€™t be skipped. Synchronize all the things!Donâ€™t Lie to React About DependenciesLying to React about dependencies has bad consequences. Intuitively, this makes sense, but Iâ€™ve seen pretty much everyone who tries useEffect with a mental model from classes try to cheat the rules. (And I did that too at first!)1234567891011function SearchResults() &#123; async function fetchData() &#123; &#125; useEffect(() =&gt; &#123; fetchData(); &#125;, []); &#125;(The Hooks FAQ explains what to do instead. Weâ€™ll come back to this example below.)â€œBut I only want to run it on mount!â€, youâ€™ll say. For now, remember: if you specify deps, all values from inside your component that are used by the effect must be there. Including props, state, functions â€” anything in your component.Sometimes when you do that, it causes a problem. For example, maybe you see an infinite refetching loop, or a socket is recreated too often. The solution to that problem is not to remove a dependency. Weâ€™ll look at the solutions soon.But before we jump to solutions, letâ€™s understand the problem better.What Happens When Dependencies LieIf deps contain every value used by the effect, React knows when to re-run it:123useEffect(() =&gt; &#123; document.title = &apos;Hello, &apos; + name;&#125;, [name]);(Dependencies are different, so we re-run the effect.)But if we specified [] for this effect, the new effect function wouldnâ€™t run:123useEffect(() =&gt; &#123; document.title = &apos;Hello, &apos; + name;&#125;, []);(Dependencies are equal, so we skip the effect.)In this case the problem might seem obvious. But the intuition can fool you in other cases where a class solution â€œjumps outâ€ from your memory.For example, letâ€™s say weâ€™re writing a counter that increments every second. With a class, our intuition is: â€œSet up the interval once and destroy it onceâ€. Hereâ€™s an example of how we can do it. When we mentally translate this code to useEffect, we instinctively add [] to the deps. â€œI want it to run onceâ€, right?1234567891011function Counter() &#123; const [count, setCount] = useState(0); useEffect(() =&gt; &#123; const id = setInterval(() =&gt; &#123; setCount(count + 1); &#125;, 1000); return () =&gt; clearInterval(id); &#125;, []); return &lt;h1&gt;&#123;count&#125;&lt;/h1&gt;;&#125;However, this example only increments once. Oops.If your mental model is â€œdependencies let me specify when I want to re-trigger the effectâ€, this example might give you an existential crisis. You want to trigger it once because itâ€™s an interval â€” so why is it causing issues?However, this makes sense if you know that dependencies are our hint to React about everything that the effect uses from the render scope. It uses count but we lied that it doesnâ€™t with []. Itâ€™s only a matter of time before this bites us!In the first render, count is 0. Therefore, setCount(count + 1) in the first renderâ€™s effect means setCount(0 + 1). Since we never re-run the effect because of [] deps, it will keep calling setCount(0 + 1) every second:123456789101112131415161718192021222324252627function Counter() &#123; useEffect( () =&gt; &#123; const id = setInterval(() =&gt; &#123; setCount(0 + 1); &#125;, 1000); return () =&gt; clearInterval(id); &#125;, [] ); &#125;function Counter() &#123; useEffect( () =&gt; &#123; const id = setInterval(() =&gt; &#123; setCount(1 + 1); &#125;, 1000); return () =&gt; clearInterval(id); &#125;, [] ); &#125;We lied to React by saying our effect doesnâ€™t depend on a value from inside our component, when in fact it does!Our effect uses count â€” a value inside the component (but outside the effect):123456const count = useEffect(() =&gt; &#123; const id = setInterval(() =&gt; &#123; setCount(count + 1); &#125;, 1000); return () =&gt; clearInterval(id);&#125;, []);Therefore, specifying [] as a dependency will create a bug. React will compare the dependencies, and skip updating this effect:(Dependencies are equal, so we skip the effect.)Issues like this are difficult to think about. Therefore, I encourage you to adopt it as a hard rule to always be honest about the effect dependencies, and specify them all. (We provide a lint rule if you want to enforce this on your team.)Two Ways to Be Honest About DependenciesThere are two strategies to be honest about dependencies. You should generally start with the first one, and then apply the second one if needed.The first strategy is to fix the dependency array to include all the values inside the component that are used inside the effect. Letâ€™s include count as a dep:12345useEffect(() =&gt; &#123; const id = setInterval(() =&gt; &#123; setCount(count + 1); &#125;, 1000); return () =&gt; clearInterval(id);&#125;, [count]);This makes the dependency array correct. It may not be ideal but thatâ€™s the first issue we needed to fix. Now a change to count will re-run the effect, with each next interval referencing count from its render in setCount(count + 1):1234567891011121314151617181920212223242526function Counter() &#123; useEffect( () =&gt; &#123; const id = setInterval(() =&gt; &#123; setCount(0 + 1); &#125;, 1000); return () =&gt; clearInterval(id); &#125;, [0] ); &#125;function Counter() &#123; useEffect( () =&gt; &#123; const id = setInterval(() =&gt; &#123; setCount(1 + 1); &#125;, 1000); return () =&gt; clearInterval(id); &#125;, [1] ); &#125;That would fix the problem but our interval would be cleared and set again whenever the count changes. That may be undesirable:(Dependencies are different, so we re-run the effect.)The second strategy is to change our effect code so that it wouldnâ€™t need a value that changes more often than we want. We donâ€™t want to lie about the dependencies â€” we just want to change our effect to have fewer of them.Letâ€™s look at a few common techniques for removing dependencies.Making Effects Self-SufficientWe want to get rid of the count dependency in our effect.12345useEffect(() =&gt; &#123; const id = setInterval(() =&gt; &#123; setCount(count + 1); &#125;, 1000); return () =&gt; clearInterval(id);&#125;, [count]);To do this, we need to ask ourselves: what are we using count for? It seems like we only use it for the setCount call. In that case, we donâ€™t actually need count in the scope at all. When we want to update state based on the previous state, we can use the functional updater form of setState:12345useEffect(() =&gt; &#123; const id = setInterval(() =&gt; &#123; setCount(c =&gt; c + 1); &#125;, 1000); return () =&gt; clearInterval(id);&#125;, []);I like to think of these cases as â€œfalse dependenciesâ€. Yes, count was a necessary dependency because we wrote setCount(count + 1) inside the effect. However, we only truly needed count to transform it into count + 1 and â€œsend it backâ€ to React. But React already knows the current count. All we needed to tell React is to increment the state â€” whatever it is right now.Thatâ€™s exactly what setCount(c =&gt; c + 1) does. You can think of it as â€œsending an instructionâ€ to React about how the state should change. This â€œupdater formâ€ also helps in other cases, like when you batch multiple updates.Note that we actually did the work to remove the dependency. We didnâ€™t cheat. Our effect doesnâ€™t read the counter value from the render scope anymore:(Dependencies are equal, so we skip the effect.)You can try it here.Even though this effect only runs once, the interval callback that belongs to the first render is perfectly capable of sending the c =&gt; c + 1 update instruction every time the interval fires. It doesnâ€™t need to know the current counter state anymore. React already knows it.Functional Updates and Google DocsRemember how we talked about synchronization being the mental model for effects? An interesting aspect of synchronization is that you often want to keep the â€œmessagesâ€ between the systems untangled from their state. For example, editing a document in Google Docs doesnâ€™t actually send the whole page to the server. That would be very inefficient. Instead, it sends a representation of what the user tried to do.While our use case is different, a similar philosophy applies to effects. It helps to send only the minimal necessary information from inside the effects into a component. The updater form like setCount(c =&gt; c + 1) conveys strictly less information than setCount(count + 1) because it isnâ€™t â€œtaintedâ€ by the current count. It only expresses the action (â€œincrementingâ€). Thinking in React involves finding the minimal state. This is the same principle, but for updates.Encoding the intent (rather than the result) is similar to how Google Docs solves collaborative editing. While this is stretching the analogy, functional updates serve a similar role in React. They ensure updates from multiple sources (event handlers, effect subscriptions, etc) can be correctly applied in a batch and in a predictable way.However, even setCount(c =&gt; c + 1) isnâ€™t that great. It looks a bit weird and itâ€™s very limited in what it can do. For example, if we had two state variables whose values depend on each other, or if we needed to calculate the next state based on a prop, it wouldnâ€™t help us. Luckily, setCount(c =&gt; c + 1) has a more powerful sister pattern. Its name is useReducer.Decoupling Updates from ActionsLetâ€™s modify the previous example to have two state variables: count and step. Our interval will increment the count by the value of the step input:12345678910111213141516function Counter() &#123; const [count, setCount] = useState(0); const [step, setStep] = useState(1); useEffect(() =&gt; &#123; const id = setInterval(() =&gt; &#123; setCount(c =&gt; c + step); &#125;, 1000); return () =&gt; clearInterval(id); &#125;, [step]); return ( &lt;&gt; &lt;h1&gt;&#123;count&#125;&lt;/h1&gt; &lt;input value=&#123;step&#125; onChange=&#123;e =&gt; setStep(Number(e.target.value))&#125; /&gt; &lt;/&gt; );&#125;(Hereâ€™s a demo.)Note that weâ€™re not cheating. Since I started using step inside the effect, I added it to the dependencies. And thatâ€™s why the code runs correctly.The current behavior in this example is that changing the step restarts the interval â€” because itâ€™s one of the dependencies. And in many cases, that is exactly what you want! Thereâ€™s nothing wrong with tearing down an effect and setting it up anew, and we shouldnâ€™t avoid that unless we have a good reason.However, letâ€™s say we want the interval clock to not reset on changes to the step. How do we remove the step dependency from our effect?When setting a state variable depends on the current value of another state variable, you might want to try replacing them both with useReducer.When you find yourself writing setSomething(something =&gt; ...), itâ€™s a good time to consider using a reducer instead. A reducer lets you decouple expressing the â€œactionsâ€ that happened in your component from how the state updates in response to them.Letâ€™s trade the step dependency for a dispatch dependency in our effect:1234567const [state, dispatch] = useReducer(reducer, initialState);const &#123; count, step &#125; = state;useEffect(() =&gt; &#123; const id = setInterval(() =&gt; &#123; dispatch(&#123; type: &apos;tick&apos; &#125;); &#125;, 1000); return () =&gt; clearInterval(id);&#125;, [dispatch]);(See the demo.)You might ask me: â€œHow is this any better?â€ The answer is that React guarantees the dispatch function to be constant throughout the component lifetime. So the example above doesnâ€™t ever need to resubscribe the interval.We solved our problem!(You may omit dispatch, setState, and useRef container values from the deps because React guarantees them to be static. But it also doesnâ€™t hurt to specify them.)Instead of reading the state inside an effect, it dispatches an action that encodes the information about what happened. This allows our effect to stay decoupled from the step state. Our effect doesnâ€™t care how we update the state, it just tells us about what happened. And the reducer centralizes the update logic:12345678910111213const initialState = &#123; count: 0, step: 1,&#125;;function reducer(state, action) &#123; const &#123; count, step &#125; = state; if (action.type === &apos;tick&apos;) &#123; return &#123; count: count + step, step &#125;; &#125; else if (action.type === &apos;step&apos;) &#123; return &#123; count, step: action.step &#125;; &#125; else &#123; throw new Error(); &#125;&#125;(Hereâ€™s a demo if you missed it earlier).Why useReducer Is the Cheat Mode of HooksWeâ€™ve seen how to remove dependencies when an effect needs to set state based on previous state, or on another state variable. But what if we need props to calculate the next state? For example, maybe our API is &lt;Counter step={1} /&gt;. Surely, in this case we canâ€™t avoid specifying props.step as a dependency?In fact, we can! We can put the reducer itself inside our component to read props:123456789101112131415161718function Counter(&#123; step &#125;) &#123; const [count, dispatch] = useReducer(reducer, 0); function reducer(state, action) &#123; if (action.type === &apos;tick&apos;) &#123; return state + step; &#125; else &#123; throw new Error(); &#125; &#125; useEffect(() =&gt; &#123; const id = setInterval(() =&gt; &#123; dispatch(&#123; type: &apos;tick&apos; &#125;); &#125;, 1000); return () =&gt; clearInterval(id); &#125;, [dispatch]); return &lt;h1&gt;&#123;count&#125;&lt;/h1&gt;;&#125;This pattern disables a few optimizations so try not to use it everywhere, but you can totally access props from a reducer if you need to. (Hereâ€™s a demo.)Even in that case, dispatch identity is still guaranteed to be stable between re-renders. So you may omit it from the effect deps if you want. Itâ€™s not going to cause the effect to re-run.You may be wondering: how can this possibly work? How can the reducer â€œknowâ€ props when called from inside an effect that belongs to another render? The answer is that when you dispatch, React just remembers the action â€” but it will call your reducer during the next render. At that point the fresh props will be in scope, and you wonâ€™t be inside an effect.This is why I like to think of useReducer as the â€œcheat modeâ€ of Hooks. It lets me decouple the update logic from describing what happened. This, in turn, helps me remove unnecessary dependencies from my effects and avoid re-running them more often than necessary.Moving Functions Inside EffectsA common mistake is to think functions shouldnâ€™t be dependencies. For example, this seems like it could work:12345678910111213function SearchResults() &#123; const [data, setData] = useState(&#123; hits: [] &#125;); async function fetchData() &#123; const result = await axios( &apos;https://hn.algolia.com/api/v1/search?query=react&apos;, ); setData(result.data); &#125; useEffect(() =&gt; &#123; fetchData(); &#125;, []);(This example is adapted from a great article by Robin Wieruch â€” check it out!)And to be clear, this code does work. But the problem with simply omitting local functions is that it gets pretty hard to tell whether weâ€™re handling all cases as the component grows!Imagine our code was split like this and each function was five times larger:123456789101112131415161718function SearchResults() &#123; function getFetchUrl() &#123; return &apos;https://hn.algolia.com/api/v1/search?query=react&apos;; &#125; async function fetchData() &#123; const result = await axios(getFetchUrl()); setData(result.data); &#125; useEffect(() =&gt; &#123; fetchData(); &#125;, []); &#125;Now letâ€™s say we later use some state or prop in one of these functions:12345678910111213141516171819function SearchResults() &#123; const [query, setQuery] = useState(&apos;react&apos;); function getFetchUrl() &#123; return &apos;https://hn.algolia.com/api/v1/search?query=&apos; + query; &#125; async function fetchData() &#123; const result = await axios(getFetchUrl()); setData(result.data); &#125; useEffect(() =&gt; &#123; fetchData(); &#125;, []); &#125;If we forget to update the deps of any effects that call these functions (possibly, through other functions!), our effects will fail to synchronize changes from our props and state. This doesnâ€™t sound great.Luckily, there is an easy solution to this problem. If you only use some functions inside an effect, move them directly into that effect:12345678function SearchResults() &#123; useEffect(() =&gt; &#123; function getFetchUrl() &#123; return &apos;https://hn.algolia.com/api/v1/search?query=react&apos;; &#125; async function fetchData() &#123; const result = await axios(getFetchUrl()); setData(result.data); &#125; fetchData(); &#125;, []); &#125;(Hereâ€™s a demo.)So what is the benefit? We no longer have to think about the â€œtransitive dependenciesâ€. Our dependencies array isnâ€™t lying anymore: we truly arenâ€™t using anything from the outer scope of the component in our effect.If we later edit getFetchUrl to use the query state, weâ€™re much more likely to notice that weâ€™re editing it inside an effect â€” and therefore, we need to add query to the effect dependencies:12345678910111213141516function SearchResults() &#123; const [query, setQuery] = useState(&apos;react&apos;); useEffect(() =&gt; &#123; function getFetchUrl() &#123; return &apos;https://hn.algolia.com/api/v1/search?query=&apos; + query; &#125; async function fetchData() &#123; const result = await axios(getFetchUrl()); setData(result.data); &#125; fetchData(); &#125;, [query]); &#125;(Hereâ€™s a demo.)By adding this dependency, weâ€™re not just â€œappeasing Reactâ€. It makes sense to refetch the data when the query changes. The design of useEffect forces you to notice the change in our data flow and choose how our effects should synchronize it â€” instead of ignoring it until our product users hit a bug.Thanks to the exhaustive-deps lint rule from the eslint-plugin-react-hooks plugin, you can analyze the effects as you type in your editor and receive suggestions about which dependencies are missing. In other words, a machine can tell you which data flow changes arenâ€™t handled correctly by a component.Pretty sweet.But I Canâ€™t Put This Function Inside an EffectSometimes you might not want to move a function inside an effect. For example, several effects in the same component may call the same function, and you donâ€™t want to copy and paste its logic. Or maybe itâ€™s a prop.Should you skip a function like this in the effect dependencies? I think not. Again, effects shouldnâ€™t lie about their dependencies. There are usually better solutions. A common misconception is that â€œa function would never changeâ€. But as we learned throughout this article, this couldnâ€™t be further from truth. Indeed, a function defined inside a component changes on every render!That by itself presents a problem. Say two effects call getFetchUrl:1234567891011121314151617function SearchResults() &#123; function getFetchUrl(query) &#123; return &apos;https://hn.algolia.com/api/v1/search?query=&apos; + query; &#125; useEffect(() =&gt; &#123; const url = getFetchUrl(&apos;react&apos;); &#125;, []); useEffect(() =&gt; &#123; const url = getFetchUrl(&apos;redux&apos;); &#125;, []); &#125;In that case you might not want to move getFetchUrl inside either of the effects since you wouldnâ€™t be able to share the logic.On the other hand, if youâ€™re â€œhonestâ€ about the effect dependencies, you may run into a problem. Since both our effects depend on getFetchUrl (which is different on every render), our dependency arrays are useless:1234567891011121314function SearchResults() &#123; function getFetchUrl(query) &#123; return &apos;https://hn.algolia.com/api/v1/search?query=&apos; + query; &#125; useEffect(() =&gt; &#123; const url = getFetchUrl(&apos;react&apos;); &#125;, [getFetchUrl]); useEffect(() =&gt; &#123; const url = getFetchUrl(&apos;redux&apos;); &#125;, [getFetchUrl]); &#125;A tempting solution to this is to just skip the getFetchUrl function in the deps list. However, I donâ€™t think itâ€™s a good solution. This makes it difficult to notice when we are adding a change to the data flow that needs to be handled by an effect. This leads to bugs like the â€œnever updating intervalâ€ we saw earlier.Instead, there are two other solutions that are simpler.First of all, if a function doesnâ€™t use anything from the component scope, you can hoist it outside the component and then freely use it inside your effects:1234567891011121314function getFetchUrl(query) &#123; return &apos;https://hn.algolia.com/api/v1/search?query=&apos; + query;&#125;function SearchResults() &#123; useEffect(() =&gt; &#123; const url = getFetchUrl(&apos;react&apos;); &#125;, []); useEffect(() =&gt; &#123; const url = getFetchUrl(&apos;redux&apos;); &#125;, []); &#125;Thereâ€™s no need to specify it in deps because itâ€™s not in the render scope and canâ€™t be affected by the data flow. It canâ€™t accidentally depend on props or state.Alternatively, you can wrap it into the useCallback Hook:1234567891011121314function SearchResults() &#123; const getFetchUrl = useCallback((query) =&gt; &#123; return &apos;https://hn.algolia.com/api/v1/search?query=&apos; + query; &#125;, []); useEffect(() =&gt; &#123; const url = getFetchUrl(&apos;react&apos;); &#125;, [getFetchUrl]); useEffect(() =&gt; &#123; const url = getFetchUrl(&apos;redux&apos;); &#125;, [getFetchUrl]); &#125;useCallback is essentially like adding another layer of dependency checks. Itâ€™s solving the problem on the other end â€” rather than avoid a function dependency, we make the function itself only change when necessary.Letâ€™s see why this approach is useful. Previously, our example showed two search results (for &#39;react&#39; and &#39;redux&#39; search queries). But letâ€™s say we want to add an input so that you can search for an arbitrary query. So instead of taking query as an argument, getFetchUrl will now read it from local state.Weâ€™ll immediately see that itâ€™s missing a query dependency:123456function SearchResults() &#123; const [query, setQuery] = useState(&apos;react&apos;); const getFetchUrl = useCallback(() =&gt; &#123; return &apos;https://hn.algolia.com/api/v1/search?query=&apos; + query; &#125;, []); &#125;If I fix my useCallback deps to include query, any effect with getFetchUrl in deps will re-run whenever the query changes:1234567891011function SearchResults() &#123; const [query, setQuery] = useState(&apos;react&apos;); const getFetchUrl = useCallback(() =&gt; &#123; return &apos;https://hn.algolia.com/api/v1/search?query=&apos; + query; &#125;, [query]); useEffect(() =&gt; &#123; const url = getFetchUrl(); &#125;, [getFetchUrl]); &#125;Thanks to useCallback, if query is the same, getFetchUrl also stays the same, and our effect doesnâ€™t re-run. But if query changes, getFetchUrl will also change, and we will re-fetch the data. Itâ€™s a lot like when you change some cell in an Excel spreadsheet, and the other cells using it recalculate automatically.This is just a consequence of embracing the data flow and the synchronization mindset. The same solution works for function props passed from parents:12345678910111213141516function Parent() &#123; const [query, setQuery] = useState(&apos;react&apos;); const fetchData = useCallback(() =&gt; &#123; const url = &apos;https://hn.algolia.com/api/v1/search?query=&apos; + query; &#125;, [query]); return &lt;Child fetchData=&#123;fetchData&#125; /&gt;&#125;function Child(&#123; fetchData &#125;) &#123; let [data, setData] = useState(null); useEffect(() =&gt; &#123; fetchData().then(setData); &#125;, [fetchData]); &#125;Since fetchData only changes inside Parent when its query state changes, our Child wonâ€™t refetch the data until itâ€™s actually necessary for the app.Are Functions Part of the Data Flow?Interestingly, this pattern is broken with classes in a way that really shows the difference between the effect and lifecycle paradigms. Consider this translation:1234567891011121314151617class Parent extends Component &#123; state = &#123; query: &apos;react&apos; &#125;; fetchData = () =&gt; &#123; const url = &apos;https://hn.algolia.com/api/v1/search?query=&apos; + this.state.query; &#125;; render() &#123; return &lt;Child fetchData=&#123;this.fetchData&#125; /&gt;; &#125;&#125;class Child extends Component &#123; state = &#123; data: null &#125;; componentDidMount() &#123; this.props.fetchData(); &#125; render() &#123; &#125;&#125;You might be thinking: â€œCome on Dan, we all know that useEffect is like componentDidMount and componentDidUpdate combined, you canâ€™t keep beating that drum!â€ Yet this doesnâ€™t work even with componentDidUpdate:1234567891011class Child extends Component &#123; state = &#123; data: null &#125;; componentDidMount() &#123; this.props.fetchData(); &#125; componentDidUpdate(prevProps) &#123; if (this.props.fetchData !== prevProps.fetchData) &#123; this.props.fetchData(); &#125; &#125; render() &#123; &#125;&#125;Of course, fetchData is a class method! (Or, rather, a class property â€” but that doesnâ€™t change anything.) Itâ€™s not going to be different because of a state change. So this.props.fetchData will stay equal to prevProps.fetchData and weâ€™ll never refetch. Letâ€™s just remove this condition then?123componentDidUpdate(prevProps) &#123; this.props.fetchData();&#125;Oh wait, this fetches on every re-render. (Adding an animation above in the tree is a fun way to discover it.) Maybe letâ€™s bind it to a particular query?123render() &#123; return &lt;Child fetchData=&#123;this.fetchData.bind(this, this.state.query)&#125; /&gt;;&#125;But then this.props.fetchData !== prevProps.fetchData is always true, even if the query didnâ€™t change! So weâ€™ll always refetch.The only real solution to this conundrum with classes is to bite the bullet and pass the query itself into the Child component. The Child doesnâ€™t actually end up using the query, but it can trigger a refetch when it changes:12345678910111213141516171819202122232425class Parent extends Component &#123; state = &#123; query: &apos;react&apos; &#125;; fetchData = () =&gt; &#123; const url = &apos;https://hn.algolia.com/api/v1/search?query=&apos; + this.state.query; &#125;; render() &#123; return &lt;Child fetchData=&#123;this.fetchData&#125; query=&#123;this.state.query&#125; /&gt;; &#125;&#125;class Child extends Component &#123; state = &#123; data: null &#125;; componentDidMount() &#123; this.props.fetchData(); &#125; componentDidUpdate(prevProps) &#123; if (this.props.query !== prevProps.query) &#123; this.props.fetchData(); &#125; &#125; render() &#123; &#125;&#125;Over the years of working with classes with React, Iâ€™ve gotten so used to passing unnecessary props down and breaking encapsulation of parent components that I only realized a week ago why we had to do it.With classes, function props by themselves arenâ€™t truly a part of the data flow. Methods close over the mutable this variable so we canâ€™t rely on their identity to mean anything. Therefore, even when we only want a function, we have to pass a bunch of other data around in order to be able to â€œdiffâ€ it. We canâ€™t know whether this.props.fetchData passed from the parent depends on some state or not, and whether that state has just changed.With useCallback, functions can fully participate in the data flow. We can say that if the function inputs changed, the function itself has changed, but if not, it stayed the same. Thanks to the granularity provided by useCallback, changes to props like props.fetchData can propagate down automatically.Similarly, useMemo lets us do the same for complex objects:1234567function ColorPicker() &#123; const [color, setColor] = useState(&apos;pink&apos;); const style = useMemo(() =&gt; (&#123; color &#125;), [color]); return &lt;Child style=&#123;style&#125; /&gt;;&#125;I want to emphasize that putting useCallback everywhere is pretty clunky. Itâ€™s a nice escape hatch and itâ€™s useful when a function is both passed down and called from inside an effect in some children. Or if youâ€™re trying to prevent breaking memoization of a child component. But Hooks lend themselves better to avoiding passing callbacks down altogether.In the above examples, Iâ€™d much prefer if fetchData was either inside my effect (which itself could be extracted to a custom Hook) or a top-level import. I want to keep the effects simple, and callbacks in them donâ€™t help that. (â€œWhat if some props.onComplete callback changes while the request was in flight?â€) You can simulate the class behavior but that doesnâ€™t solve race conditions.Speaking of Race ConditionsA classic data fetching example with classes might look like this:12345678910111213class Article extends Component &#123; state = &#123; article: null &#125;; componentDidMount() &#123; this.fetchData(this.props.id); &#125; async fetchData(id) &#123; const article = await API.fetchArticle(id); this.setState(&#123; article &#125;); &#125; &#125;As you probably know, this code is buggy. It doesnâ€™t handle updates. So the second classic example you could find online is something like this:12345678910111213class Article extends Component &#123; state = &#123; article: null &#125;; componentDidMount() &#123; this.fetchData(this.props.id); &#125; componentDidUpdate(prevProps) &#123; if (prevProps.id !== this.props.id) &#123; this.fetchData(this.props.id); &#125; &#125; async fetchData(id) &#123; const article = await API.fetchArticle(id); this.setState(&#123; article &#125;); &#125; &#125;This is definitely better! But itâ€™s still buggy. The reason itâ€™s buggy is that the request may come out of order. So if Iâ€™m fetching {id: 10}, switch to {id: 20}, but the {id: 20} request comes first, the request that started earlier but finished later would incorrectly overwrite my state.This is called a race condition, and itâ€™s typical in code that mixes async / await (which assumes something waits for the result) with top-down data flow (props or state can change while weâ€™re in the middle of an async function).Effects donâ€™t magically solve this problem, although theyâ€™ll warn you if you try to pass an async function to the effect directly. (Weâ€™ll need to improve that warning to better explain the problems you might run into.)If the async approach you use supports cancellation, thatâ€™s great! You can cancel the async request right in your cleanup function.Alternatively, the easiest stopgap approach is to track it with a boolean:1234567891011121314151617function Article(&#123; id &#125;) &#123; const [article, setArticle] = useState(null); useEffect(() =&gt; &#123; let didCancel = false; async function fetchData() &#123; const article = await API.fetchArticle(id); if (!didCancel) &#123; setArticle(article); &#125; &#125; fetchData(); return () =&gt; &#123; didCancel = true; &#125;; &#125;, [id]); &#125;This article goes into more detail about how you can handle errors and loading states, as well as extract that logic into a custom Hook. I recommend you to check it out if youâ€™re interested to learn more about data fetching with Hooks.Raising the BarWith the class lifecycle mindset, side effects behave differently from the render output. Rendering the UI is driven by props and state, and is guaranteed to be consistent with them, but side effects are not. This is a common source of bugs.With the mindset of useEffect, things are synchronized by default. Side effects become a part of the React data flow. For every useEffect call, once you get it right, your component handles edge cases much better.However, the upfront cost of getting it right is higher. This can be annoying. Writing synchronization code that handles edge cases well is inherently more difficult than firing one-off side effects that arenâ€™t consistent with rendering.This could be worrying if useEffect was meant to be the tool you use most of the time. However, itâ€™s a low-level building block. Itâ€™s an early time for Hooks so everybody uses low-level ones all the time, especially in tutorials. But in practice, itâ€™s likely the community will start moving to higher-level Hooks as good APIs gain momentum.Iâ€™m seeing different apps create their own Hooks like useFetch that encapsulates some of their appâ€™s auth logic or useTheme which uses theme context. Once you have a toolbox of those, you donâ€™t reach for useEffect that often. But the resilience it brings benefits every Hook built on top of it.So far, useEffect is most commonly used for data fetching. But data fetching isnâ€™t exactly a synchronization problem. This is especially obvious because our deps are often []. What are we even synchronizing?In the longer term, Suspense for Data Fetching will allow third-party libraries to have a first-class way to tell React to suspend rendering until something async (anything: code, data, images) is ready.As Suspense gradually covers more data fetching use cases, I anticipate that useEffect will fade into background as a power user tool for cases when you actually want to synchronize props and state to some side effect. Unlike data fetching, it handles this case naturally because it was designed for it. But until then, custom Hooks like shown here are a good way to reuse data fetching logic.In ClosingNow that you know pretty much everything I know about using effects, check out the TLDR in the beginning. Does it make sense? Did I miss something? (I havenâ€™t run out of paper yet!)Iâ€™d love to hear from you on Twitter! Thanks for reading.æœ¬æ–‡ä½œè€…ï¼š Andyæœ¬æ–‡åœ°å€ï¼š https://andyxw.com/archives/6387.htmlç‰ˆæƒå£°æ˜ï¼š è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>React</tag>
        <tag>å‰ç«¯</tag>
        <tag>React Hooks</tag>
        <tag>useEffect</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[A Complete Guide to useEffectï¼ˆä¸­æ–‡ç‰ˆï¼‰]]></title>
    <url>%2Farchives%2F4233.html</url>
    <content type="text"><![CDATA[æœ¬æ–‡ç”± ç®€æ‚¦ SimpRead è½¬ç ï¼Œ åŸæ–‡åœ°å€ https://overreacted.io/zh-hans/a-complete-guide-to-useeffect/ä½ ç”¨ Hooks å†™äº†ä¸€äº›ç»„ä»¶ï¼Œç”šæˆ–å†™äº†ä¸€ä¸ªå°å‹åº”ç”¨ã€‚ä½ å¯èƒ½å¾ˆæ»¡æ„ï¼Œä½¿ç”¨å®ƒçš„ API å¾ˆèˆ’æœå¹¶ä¸”åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­è·å¾—äº†ä¸€äº›å°æŠ€å·§ã€‚ä½ ç”šè‡³å¯èƒ½å†™äº†ä¸€äº› custom Hooks å»æŠ½ç¦»é‡å¤çš„é€»è¾‘ï¼ˆç²¾ç®€æ‰äº† 300 è¡Œä»£ç ï¼‰ï¼Œå¹¶ä¸”å¾—æ„åœ°å±•ç¤ºç»™ä½ çš„åŒäº‹çœ‹ï¼Œâ€œå¹²å¾—æ¼‚äº®â€ï¼Œä»–ä»¬å¦‚æ˜¯è¯´ã€‚ä½†æœ‰æ—¶å€™å½“ä½ ä½¿ç”¨useEffectä½ æ€»è§‰å¾—å“ªå„¿æœ‰ç‚¹ä¸å¯¹åŠ²ã€‚ä½ ä¼šå˜€å’•ä½ å¯èƒ½é—æ¼äº†ä»€ä¹ˆã€‚å®ƒçœ‹èµ·æ¥åƒ class çš„ç”Ÿå‘½å‘¨æœŸâ€¦ ä½†çœŸçš„æ˜¯è¿™æ ·å—ï¼Ÿä½ å‘è§‰è‡ªå·±åœ¨é—®ç±»ä¼¼ä¸‹é¢çš„è¿™äº›é—®é¢˜ï¼šğŸ¤” å¦‚ä½•ç”¨useEffectæ¨¡æ‹ŸcomponentDidMountç”Ÿå‘½å‘¨æœŸï¼ŸğŸ¤” å¦‚ä½•æ­£ç¡®åœ°åœ¨useEffecté‡Œè¯·æ±‚æ•°æ®ï¼Ÿ[]åˆæ˜¯ä»€ä¹ˆï¼ŸğŸ¤” æˆ‘åº”è¯¥æŠŠå‡½æ•°å½“åš effect çš„ä¾èµ–å—ï¼ŸğŸ¤” ä¸ºä»€ä¹ˆæœ‰æ—¶å€™ä¼šå‡ºç°æ— é™é‡å¤è¯·æ±‚çš„é—®é¢˜ï¼ŸğŸ¤” ä¸ºä»€ä¹ˆæœ‰æ—¶å€™åœ¨ effect é‡Œæ‹¿åˆ°çš„æ˜¯æ—§çš„ state æˆ– propï¼Ÿå½“æˆ‘åˆšå¼€å§‹ä½¿ç”¨ Hooks çš„æ—¶å€™ï¼Œæˆ‘ä¹ŸåŒæ ·è¢«ä¸Šé¢è¿™äº›é—®é¢˜æ‰€å›°æ‰°ã€‚ç”šè‡³å½“æˆ‘å†™æœ€åˆçš„æ–‡æ¡£æ—¶ï¼Œæˆ‘ä¹Ÿå¹¶æ²¡æœ‰æ‰å®åœ°æŒæ¡æŸäº›ç»†èŠ‚ã€‚æˆ‘ç»å†äº†ä¸€äº› â€œå•Šå“ˆâ€ çš„å¼€çªæ—¶åˆ»ï¼Œæˆ‘æƒ³æŠŠè¿™äº›åˆ†äº«ç»™ä½ ã€‚è¿™ç¯‡æ–‡ç« ä¼šæ·±å…¥è®²è§£å¸®ä½ æ˜ç™½ä¸Šé¢é—®é¢˜çš„ç­”æ¡ˆã€‚åœ¨çœ‹ç­”æ¡ˆä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆå¾€åé€€ä¸€æ­¥ã€‚è¿™ç¯‡æ–‡ç« çš„ç›®çš„ä¸æ˜¯ç»™ä½ ä¸€ä¸ªè¦ç‚¹æ¸…å•ï¼Œè€Œæ˜¯æƒ³å¸®ä½ çœŸæ­£åœ°é¢†ä¼šuseEffectã€‚å…¶å®æˆ‘ä»¬å¹¶æ²¡æœ‰å¤ªå¤šéœ€è¦å­¦ä¹ çš„ï¼Œäº‹å®ä¸Šï¼Œæˆ‘ä»¬ä¼šèŠ±å¾ˆå¤šæ—¶é—´è¯•å›¾å¿˜è®°æŸäº›å·²ç»ä¹ å¾—çš„æ¦‚å¿µï¼ˆunlearningï¼‰ã€‚å½“æˆ‘ä¸å†é€è¿‡ç†Ÿæ‚‰çš„ class ç”Ÿå‘½å‘¨æœŸæ–¹æ³•å»çª¥è§†useEffect è¿™ä¸ª Hook çš„æ—¶å€™ï¼Œæˆ‘æ‰å¾—ä»¥èä¼šè´¯é€šã€‚â€œå¿˜è®°ä½ å·²ç»å­¦åˆ°çš„ã€‚â€ â€” Yodaè¿™ç¯‡æ–‡ç« ä¼šå‡è®¾ä½ å¯¹ useEffect API æœ‰ä¸€å®šç¨‹åº¦çš„äº†è§£ã€‚è¿™ç¯‡æ–‡ç« çœŸçš„å¾ˆé•¿ã€‚å®ƒæ›´åƒä¸€æœ¬ mini ä¹¦ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘æ›´å–œæ¬¢çš„å½¢å¼ã€‚å¦‚æœä½ å¾ˆåŒ†å¿™æˆ–è€…å¹¶ä¸æ˜¯å¤ªå…³å¿ƒæœ¬æ–‡ä¸»é¢˜çš„è¯ï¼Œä½ ä¹Ÿå¯ä»¥ç›´æ¥çœ‹ä¸‹é¢çš„æ‘˜è¦ã€‚å¦‚æœä½ å¯¹äºæ·±å…¥ç ”ç©¶æ„Ÿè§‰ä¸æ˜¯å¾ˆé€‚åº”çš„è¯ï¼Œä½ æˆ–è®¸å¯ä»¥ç­‰ä¸‹é¢è¿™äº›è§£é‡Šå‡ºç°åœ¨å…¶ä»–æ–‡ç« ä¸­å†å»äº†è§£ä¹Ÿè¡Œã€‚å°±åƒ 2013 å¹´ React åˆšå‡ºä¸–çš„æ—¶å€™ï¼Œå¤§å®¶éœ€è¦æ—¶é—´å»ç†è§£æ¶ˆåŒ–ä¸€ç§ä¸åŒçš„å¿ƒæ™ºæ¨¡å‹ã€‚çŸ¥è¯†ä¹Ÿéœ€è¦æ—¶é—´å»æ™®åŠã€‚æ‘˜è¦å¦‚æœä½ ä¸æƒ³é˜…è¯»æ•´ç¯‡æ–‡ç« ï¼Œå¯ä»¥å¿«é€Ÿæµè§ˆè¿™ä»½æ‘˜è¦ã€‚è¦æ˜¯æŸäº›éƒ¨åˆ†ä¸å®¹æ˜“ç†è§£ï¼Œä½ å¯ä»¥å¾€ä¸‹æ»šåŠ¨å¯»æ‰¾ç›¸å…³çš„å†…å®¹å»é˜…è¯»ã€‚å¦‚æœä½ æ‰“ç®—é˜…è¯»æ•´ç¯‡æ–‡ç« ï¼Œä½ å®Œå…¨å¯ä»¥è·³è¿‡è¿™éƒ¨åˆ†ã€‚æˆ‘ä¼šåœ¨æ–‡ç« æœ«å°¾å¸¦ä¸Šæ‘˜è¦çš„é“¾æ¥ã€‚ğŸ¤” Question: å¦‚ä½•ç”¨useEffectæ¨¡æ‹ŸcomponentDidMountç”Ÿå‘½å‘¨æœŸï¼Ÿè™½ç„¶å¯ä»¥ä½¿ç”¨useEffect(fn, [])ï¼Œä½†å®ƒä»¬å¹¶ä¸å®Œå…¨ç›¸ç­‰ã€‚å’ŒcomponentDidMountä¸ä¸€æ ·ï¼ŒuseEffectä¼š_æ•è·_ props å’Œ stateã€‚æ‰€ä»¥å³ä¾¿åœ¨å›è°ƒå‡½æ•°é‡Œï¼Œä½ æ‹¿åˆ°çš„è¿˜æ˜¯åˆå§‹çš„ props å’Œ stateã€‚å¦‚æœä½ æƒ³å¾—åˆ° â€œæœ€æ–°â€ çš„å€¼ï¼Œä½ å¯ä»¥ä½¿ç”¨ refã€‚ä¸è¿‡ï¼Œé€šå¸¸ä¼šæœ‰æ›´ç®€å•çš„å®ç°æ–¹å¼ï¼Œæ‰€ä»¥ä½ å¹¶ä¸ä¸€å®šè¦ç”¨ refã€‚è®°ä½ï¼Œeffects çš„å¿ƒæ™ºæ¨¡å‹å’ŒcomponentDidMountä»¥åŠå…¶ä»–ç”Ÿå‘½å‘¨æœŸæ˜¯ä¸åŒçš„ï¼Œè¯•å›¾æ‰¾åˆ°å®ƒä»¬ä¹‹é—´å®Œå…¨ä¸€è‡´çš„è¡¨è¾¾åè€Œæ›´å®¹æ˜“ä½¿ä½ æ··æ·†ã€‚æƒ³è¦æ›´æœ‰æ•ˆï¼Œä½ éœ€è¦ â€œthink in effectsâ€ï¼Œå®ƒçš„å¿ƒæ™ºæ¨¡å‹æ›´æ¥è¿‘äºå®ç°çŠ¶æ€åŒæ­¥ï¼Œè€Œä¸æ˜¯å“åº”ç”Ÿå‘½å‘¨æœŸäº‹ä»¶ã€‚ğŸ¤” Question: å¦‚ä½•æ­£ç¡®åœ°åœ¨useEffecté‡Œè¯·æ±‚æ•°æ®ï¼Ÿ[]åˆæ˜¯ä»€ä¹ˆï¼Ÿè¿™ç¯‡æ–‡ç«  æ˜¯å¾ˆå¥½çš„å…¥é—¨ï¼Œä»‹ç»äº†å¦‚ä½•åœ¨useEffecté‡Œåšæ•°æ®è¯·æ±‚ã€‚è¯·åŠ¡å¿…è¯»å®Œå®ƒï¼å®ƒæ²¡æœ‰æˆ‘çš„è¿™ç¯‡è¿™ä¹ˆé•¿ã€‚[]è¡¨ç¤º effect æ²¡æœ‰ä½¿ç”¨ä»»ä½• React æ•°æ®æµé‡Œçš„å€¼ï¼Œå› æ­¤è¯¥ effect ä»…è¢«è°ƒç”¨ä¸€æ¬¡æ˜¯å®‰å…¨çš„ã€‚[]åŒæ ·ä¹Ÿæ˜¯ä¸€ç±»å¸¸è§é—®é¢˜çš„æ¥æºï¼Œä¹Ÿå³ä½ ä»¥ä¸ºæ²¡ä½¿ç”¨æ•°æ®æµé‡Œçš„å€¼ä½†å…¶å®ä½¿ç”¨äº†ã€‚ä½ éœ€è¦å­¦ä¹ ä¸€äº›ç­–ç•¥ï¼ˆä¸»è¦æ˜¯useReducer å’Œ useCallbackï¼‰æ¥ç§»é™¤è¿™äº› effect ä¾èµ–ï¼Œè€Œä¸æ˜¯é”™è¯¯åœ°å¿½ç•¥å®ƒä»¬ã€‚ğŸ¤” Question: æˆ‘åº”è¯¥æŠŠå‡½æ•°å½“åš effect çš„ä¾èµ–å—ï¼Ÿä¸€èˆ¬å»ºè®®æŠŠä¸ä¾èµ– props å’Œ state çš„å‡½æ•°æåˆ°ä½ çš„ç»„ä»¶å¤–é¢ï¼Œå¹¶ä¸”æŠŠé‚£äº›ä»…è¢« effect ä½¿ç”¨çš„å‡½æ•°æ”¾åˆ° effect é‡Œé¢ã€‚å¦‚æœè¿™æ ·åšäº†ä»¥åï¼Œä½ çš„ effect è¿˜æ˜¯éœ€è¦ç”¨åˆ°ç»„ä»¶å†…çš„å‡½æ•°ï¼ˆåŒ…æ‹¬é€šè¿‡ props ä¼ è¿›æ¥çš„å‡½æ•°ï¼‰ï¼Œå¯ä»¥åœ¨å®šä¹‰å®ƒä»¬çš„åœ°æ–¹ç”¨useCallbackåŒ…ä¸€å±‚ã€‚ä¸ºä»€ä¹ˆè¦è¿™æ ·åšå‘¢ï¼Ÿå› ä¸ºè¿™äº›å‡½æ•°å¯ä»¥è®¿é—®åˆ° props å’Œ stateï¼Œå› æ­¤å®ƒä»¬ä¼šå‚ä¸åˆ°æ•°æ®æµä¸­ã€‚æˆ‘ä»¬å®˜ç½‘çš„ FAQ æœ‰æ›´è¯¦ç»†çš„ç­”æ¡ˆã€‚ğŸ¤” Question: ä¸ºä»€ä¹ˆæœ‰æ—¶å€™ä¼šå‡ºç°æ— é™é‡å¤è¯·æ±‚çš„é—®é¢˜ï¼Ÿè¿™ä¸ªé€šå¸¸å‘ç”Ÿäºä½ åœ¨ effect é‡Œåšæ•°æ®è¯·æ±‚å¹¶ä¸”æ²¡æœ‰è®¾ç½® effect ä¾èµ–å‚æ•°çš„æƒ…å†µã€‚æ²¡æœ‰è®¾ç½®ä¾èµ–ï¼Œeffect ä¼šåœ¨æ¯æ¬¡æ¸²æŸ“åæ‰§è¡Œä¸€æ¬¡ï¼Œç„¶ååœ¨ effect ä¸­æ›´æ–°äº†çŠ¶æ€å¼•èµ·æ¸²æŸ“å¹¶å†æ¬¡è§¦å‘ effectã€‚æ— é™å¾ªç¯çš„å‘ç”Ÿä¹Ÿå¯èƒ½æ˜¯å› ä¸ºä½ è®¾ç½®çš„ä¾èµ–æ€»æ˜¯ä¼šæ”¹å˜ã€‚ä½ å¯ä»¥é€šè¿‡ä¸€ä¸ªä¸€ä¸ªç§»é™¤çš„æ–¹å¼æ’æŸ¥å‡ºå“ªä¸ªä¾èµ–å¯¼è‡´äº†é—®é¢˜ã€‚ä½†æ˜¯ï¼Œç§»é™¤ä½ ä½¿ç”¨çš„ä¾èµ–ï¼ˆæˆ–è€…ç›²ç›®åœ°ä½¿ç”¨[]ï¼‰é€šå¸¸æ˜¯ä¸€ç§é”™è¯¯çš„è§£å†³æ–¹å¼ã€‚ä½ åº”è¯¥åšçš„æ˜¯è§£å†³é—®é¢˜çš„æ ¹æºã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå‡½æ•°å¯èƒ½ä¼šå¯¼è‡´è¿™ä¸ªé—®é¢˜ï¼Œä½ å¯ä»¥æŠŠå®ƒä»¬æ”¾åˆ° effect é‡Œï¼Œæˆ–è€…æåˆ°ç»„ä»¶å¤–é¢ï¼Œæˆ–è€…ç”¨useCallbackåŒ…ä¸€å±‚ã€‚useMemo å¯ä»¥åšç±»ä¼¼çš„äº‹æƒ…ä»¥é¿å…é‡å¤ç”Ÿæˆå¯¹è±¡ã€‚ğŸ¤” ä¸ºä»€ä¹ˆæœ‰æ—¶å€™åœ¨ effect é‡Œæ‹¿åˆ°çš„æ˜¯æ—§çš„ state æˆ– prop å‘¢ï¼ŸEffect æ‹¿åˆ°çš„æ€»æ˜¯å®šä¹‰å®ƒçš„é‚£æ¬¡æ¸²æŸ“ä¸­çš„ props å’Œ stateã€‚è¿™èƒ½å¤Ÿé¿å…ä¸€äº› bugsï¼Œä½†åœ¨ä¸€äº›åœºæ™¯ä¸­åˆä¼šæœ‰äº›è®¨äººå«Œã€‚å¯¹äºè¿™äº›åœºæ™¯ï¼Œä½ å¯ä»¥æ˜ç¡®åœ°ä½¿ç”¨å¯å˜çš„ ref ä¿å­˜ä¸€äº›å€¼ï¼ˆä¸Šé¢æ–‡ç« çš„æœ«å°¾è§£é‡Šäº†è¿™ä¸€ç‚¹ï¼‰ã€‚å¦‚æœä½ è§‰å¾—åœ¨æ¸²æŸ“ä¸­æ‹¿åˆ°äº†ä¸€äº›æ—§çš„ props å’Œ stateï¼Œä¸”ä¸æ˜¯ä½ æƒ³è¦çš„ï¼Œä½ å¾ˆå¯èƒ½é—æ¼äº†ä¸€äº›ä¾èµ–ã€‚å¯ä»¥å°è¯•ä½¿ç”¨è¿™ä¸ª lint è§„åˆ™æ¥è®­ç»ƒä½ å‘ç°è¿™äº›ä¾èµ–ã€‚å¯èƒ½æ²¡è¿‡å‡ å¤©ï¼Œè¿™ç§èƒ½åŠ›ä¼šå˜å¾—åƒæ˜¯ä½ çš„ç¬¬äºŒå¤©æ€§ã€‚åŒæ ·å¯ä»¥çœ‹æˆ‘ä»¬å®˜ç½‘ FAQ ä¸­çš„è¿™ä¸ªå›ç­”ã€‚æˆ‘å¸Œæœ›è¿™ä¸ªæ‘˜è¦å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼è¦ä¸ï¼Œæˆ‘ä»¬å¼€å§‹æ­£æ–‡ã€‚æ¯ä¸€æ¬¡æ¸²æŸ“éƒ½æœ‰å®ƒè‡ªå·±çš„ Props and Stateåœ¨æˆ‘ä»¬è®¨è®º effects ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆè®¨è®ºä¸€ä¸‹æ¸²æŸ“ï¼ˆrenderingï¼‰ã€‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªè®¡æ•°å™¨ç»„ä»¶ Counterï¼Œæ³¨æ„é«˜äº®çš„é‚£ä¸€è¡Œï¼š1234567891011function Counter() &#123; const [count, setCount] = useState(0); return ( &lt;div&gt; &lt;p&gt;You clicked &#123;count&#125; times&lt;/p&gt; &lt;button onClick=&#123;() =&gt; setCount(count + 1)&#125;&gt; Click me &lt;/button&gt; &lt;/div&gt; );&#125;é«˜äº®çš„ä»£ç ç©¶ç«Ÿæ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿcount ä¼š â€œç›‘å¬â€ çŠ¶æ€çš„å˜åŒ–å¹¶è‡ªåŠ¨æ›´æ–°å—ï¼Ÿè¿™ä¹ˆæƒ³å¯èƒ½æ˜¯å­¦ä¹  React çš„æ—¶å€™æœ‰ç”¨çš„ç¬¬ä¸€ç›´è§‰ï¼Œä½†å®ƒå¹¶ä¸æ˜¯ç²¾ç¡®çš„å¿ƒæ™ºæ¨¡å‹ã€‚ä¸Šé¢ä¾‹å­ä¸­ï¼Œcountä»…æ˜¯ä¸€ä¸ªæ•°å­—è€Œå·²ã€‚å®ƒä¸æ˜¯ç¥å¥‡çš„ â€œdata bindingâ€, â€œwatcherâ€, â€œproxyâ€ï¼Œæˆ–è€…å…¶ä»–ä»»ä½•ä¸œè¥¿ã€‚å®ƒå°±æ˜¯ä¸€ä¸ªæ™®é€šçš„æ•°å­—åƒä¸‹é¢è¿™ä¸ªä¸€æ ·ï¼š123const count = 42;&lt;p&gt;You clicked &#123;count&#125; times&lt;/p&gt;æˆ‘ä»¬çš„ç»„ä»¶ç¬¬ä¸€æ¬¡æ¸²æŸ“çš„æ—¶å€™ï¼Œä»useState()æ‹¿åˆ°countçš„åˆå§‹å€¼0ã€‚å½“æˆ‘ä»¬è°ƒç”¨setCount(1)ï¼ŒReact ä¼šå†æ¬¡æ¸²æŸ“ç»„ä»¶ï¼Œè¿™ä¸€æ¬¡countæ˜¯1ã€‚å¦‚æ­¤ç­‰ç­‰ï¼š12345678910111213141516171819function Counter() &#123; const count = 0; &lt;p&gt;You clicked &#123;count&#125; times&lt;/p&gt; &#125;function Counter() &#123; const count = 1; &lt;p&gt;You clicked &#123;count&#125; times&lt;/p&gt; &#125;function Counter() &#123; const count = 2; &lt;p&gt;You clicked &#123;count&#125; times&lt;/p&gt; &#125;å½“æˆ‘ä»¬æ›´æ–°çŠ¶æ€çš„æ—¶å€™ï¼ŒReact ä¼šé‡æ–°æ¸²æŸ“ç»„ä»¶ã€‚æ¯ä¸€æ¬¡æ¸²æŸ“éƒ½èƒ½æ‹¿åˆ°ç‹¬ç«‹çš„count çŠ¶æ€ï¼Œè¿™ä¸ªçŠ¶æ€å€¼æ˜¯å‡½æ•°ä¸­çš„ä¸€ä¸ªå¸¸é‡ã€‚æ‰€ä»¥ä¸‹é¢çš„è¿™è¡Œä»£ç æ²¡æœ‰åšä»»ä½•ç‰¹æ®Šçš„æ•°æ®ç»‘å®šï¼š1&lt;p&gt;You clicked &#123;count&#125; times&lt;/p&gt;å®ƒä»…ä»…åªæ˜¯åœ¨æ¸²æŸ“è¾“å‡ºä¸­æ’å…¥äº† count è¿™ä¸ªæ•°å­—ã€‚è¿™ä¸ªæ•°å­—ç”± React æä¾›ã€‚å½“setCountçš„æ—¶å€™ï¼ŒReact ä¼šå¸¦ç€ä¸€ä¸ªä¸åŒçš„countå€¼å†æ¬¡è°ƒç”¨ç»„ä»¶ã€‚ç„¶åï¼ŒReact ä¼šæ›´æ–° DOM ä»¥ä¿æŒå’Œæ¸²æŸ“è¾“å‡ºä¸€è‡´ã€‚è¿™é‡Œå…³é”®çš„ç‚¹åœ¨äºä»»æ„ä¸€æ¬¡æ¸²æŸ“ä¸­çš„countå¸¸é‡éƒ½ä¸ä¼šéšç€æ—¶é—´æ”¹å˜ã€‚æ¸²æŸ“è¾“å‡ºä¼šå˜æ˜¯å› ä¸ºæˆ‘ä»¬çš„ç»„ä»¶è¢«ä¸€æ¬¡æ¬¡è°ƒç”¨ï¼Œè€Œæ¯ä¸€æ¬¡è°ƒç”¨å¼•èµ·çš„æ¸²æŸ“ä¸­ï¼Œå®ƒåŒ…å«çš„countå€¼ç‹¬ç«‹äºå…¶ä»–æ¸²æŸ“ã€‚ï¼ˆå…³äºè¿™ä¸ªè¿‡ç¨‹æ›´æ·±å…¥çš„æ¢è®¨å¯ä»¥æŸ¥çœ‹æˆ‘çš„å¦ä¸€ç¯‡æ–‡ç«  React as a UI Runtimeã€‚ï¼‰æ¯ä¸€æ¬¡æ¸²æŸ“éƒ½æœ‰å®ƒè‡ªå·±çš„äº‹ä»¶å¤„ç†å‡½æ•°åˆ°ç›®å‰ä¸ºæ­¢ä¸€åˆ‡éƒ½è¿˜å¥½ã€‚é‚£ä¹ˆäº‹ä»¶å¤„ç†å‡½æ•°å‘¢ï¼Ÿçœ‹ä¸‹é¢çš„è¿™ä¸ªä¾‹å­ã€‚å®ƒåœ¨ä¸‰ç§’åä¼š alert ç‚¹å‡»æ¬¡æ•°countï¼š12345678910111213function Counter() &#123; const [count, setCount] = useState(0); function handleAlertClick() &#123; setTimeout(() =&gt; &#123; alert(&apos;You clicked on: &apos; + count); &#125;, 3000); &#125; return ( &lt;div&gt; &lt;p&gt;You clicked &#123;count&#125; times&lt;/p&gt; &lt;button onClick=&#123;() =&gt; setCount(count + 1)&#125;&gt; Click me &lt;/button&gt; &lt;button onClick=&#123;handleAlertClick&#125;&gt; Show alert &lt;/button&gt; &lt;/div&gt; );&#125;å¦‚æœæˆ‘æŒ‰ç…§ä¸‹é¢çš„æ­¥éª¤å»æ“ä½œï¼šç‚¹å‡»å¢åŠ  counter åˆ° 3ç‚¹å‡»ä¸€ä¸‹ â€œShow alertâ€ç‚¹å‡»å¢åŠ  counter åˆ° 5 å¹¶ä¸”åœ¨å®šæ—¶å™¨å›è°ƒè§¦å‘å‰å®Œæˆä½ çŒœ alert ä¼šå¼¹å‡ºä»€ä¹ˆå‘¢ï¼Ÿä¼šæ˜¯ 5 å—ï¼Ÿâ€” è¿™ä¸ªå€¼æ˜¯ alert çš„æ—¶å€™ counter çš„å®æ—¶çŠ¶æ€ã€‚æˆ–è€…ä¼šæ˜¯ 3 å—ï¼Ÿâ€” è¿™ä¸ªå€¼æ˜¯æˆ‘ç‚¹å‡»æ—¶å€™çš„çŠ¶æ€ã€‚å‰§é€é¢„è­¦æ¥è‡ªå·± è¯•è¯•å§ï¼å¦‚æœç»“æœå’Œä½ é¢„æ–™ä¸ä¸€æ ·ï¼Œä½ å¯ä»¥æƒ³è±¡ä¸€ä¸ªæ›´å®é™…çš„ä¾‹å­ï¼šä¸€ä¸ªèŠå¤©åº”ç”¨åœ¨ state ä¸­ä¿å­˜äº†å½“å‰æ¥æ”¶è€…çš„ IDï¼Œä»¥åŠä¸€ä¸ªå‘é€æŒ‰é’®ã€‚ è¿™ç¯‡æ–‡ç« æ·±å…¥æ¢ç´¢äº†ä¸ªä¸­ç¼˜ç”±ã€‚æ­£ç¡®çš„ç­”æ¡ˆå°±æ˜¯ 3ã€‚alert ä¼š â€œæ•è·â€ æˆ‘ç‚¹å‡»æŒ‰é’®æ—¶å€™çš„çŠ¶æ€ã€‚ï¼ˆè™½ç„¶æœ‰å…¶ä»–åŠæ³•å¯ä»¥å®ç°ä¸åŒçš„è¡Œä¸ºï¼Œä½†ç°åœ¨æˆ‘ä¼šä¸“æ³¨äºè¿™ä¸ªé»˜è®¤çš„åœºæ™¯ã€‚å½“æˆ‘ä»¬åœ¨æ„å»ºä¸€ç§å¿ƒæ™ºæ¨¡å‹çš„æ—¶å€™ï¼Œåœ¨å¯é€‰çš„ç­–ç•¥ä¸­åˆ†è¾¨å‡º â€œæœ€å°é˜»åŠ›è·¯å¾„â€ æ˜¯éå¸¸é‡è¦çš„ã€‚ï¼‰ä½†å®ƒç©¶ç«Ÿæ˜¯å¦‚ä½•å·¥ä½œçš„å‘¢ï¼Ÿæˆ‘ä»¬å‘ç°countåœ¨æ¯ä¸€æ¬¡å‡½æ•°è°ƒç”¨ä¸­éƒ½æ˜¯ä¸€ä¸ªå¸¸é‡å€¼ã€‚å€¼å¾—å¼ºè°ƒçš„æ˜¯ â€” æˆ‘ä»¬çš„ç»„ä»¶å‡½æ•°æ¯æ¬¡æ¸²æŸ“éƒ½ä¼šè¢«è°ƒç”¨ï¼Œä½†æ˜¯æ¯ä¸€æ¬¡è°ƒç”¨ä¸­countå€¼éƒ½æ˜¯å¸¸é‡ï¼Œå¹¶ä¸”å®ƒè¢«èµ‹äºˆäº†å½“å‰æ¸²æŸ“ä¸­çš„çŠ¶æ€å€¼ã€‚è¿™å¹¶ä¸æ˜¯ React ç‰¹æœ‰çš„ï¼Œæ™®é€šçš„å‡½æ•°ä¹Ÿæœ‰ç±»ä¼¼çš„è¡Œä¸ºï¼š1234567891011121314function sayHi(person) &#123; const name = person.name; setTimeout(() =&gt; &#123; alert(&apos;Hello, &apos; + name); &#125;, 3000);&#125;let someone = &#123;name: &apos;Dan&apos;&#125;;sayHi(someone);someone = &#123;name: &apos;Yuzhi&apos;&#125;;sayHi(someone);someone = &#123;name: &apos;Dominic&apos;&#125;;sayHi(someone);åœ¨ è¿™ä¸ªä¾‹å­ä¸­, å¤–å±‚çš„someoneä¼šè¢«èµ‹å€¼å¾ˆå¤šæ¬¡ï¼ˆå°±åƒåœ¨ React ä¸­ï¼Œ_å½“å‰_çš„ç»„ä»¶çŠ¶æ€ä¼šæ”¹å˜ä¸€æ ·ï¼‰ã€‚ç„¶åï¼Œåœ¨sayHiå‡½æ•°ä¸­ï¼Œå±€éƒ¨å¸¸é‡nameä¼šå’ŒæŸæ¬¡è°ƒç”¨ä¸­çš„personå…³è”ã€‚å› ä¸ºè¿™ä¸ªå¸¸é‡æ˜¯å±€éƒ¨çš„ï¼Œæ‰€ä»¥æ¯ä¸€æ¬¡è°ƒç”¨éƒ½æ˜¯ç›¸äº’ç‹¬ç«‹çš„ã€‚ç»“æœå°±æ˜¯ï¼Œå½“å®šæ—¶å™¨å›è°ƒè§¦å‘çš„æ—¶å€™ï¼Œæ¯ä¸€ä¸ª alert éƒ½ä¼šå¼¹å‡ºå®ƒæ‹¥æœ‰çš„nameã€‚è¿™å°±è§£é‡Šäº†æˆ‘ä»¬çš„äº‹ä»¶å¤„ç†å‡½æ•°å¦‚ä½•æ•è·äº†ç‚¹å‡»æ—¶å€™çš„countå€¼ã€‚å¦‚æœæˆ‘ä»¬åº”ç”¨ç›¸åŒçš„æ›¿æ¢åŸç†ï¼Œæ¯ä¸€æ¬¡æ¸²æŸ“ â€œçœ‹åˆ°â€ çš„æ˜¯å®ƒè‡ªå·±çš„countï¼š12345678910111213141516171819202122232425262728293031function Counter() &#123; const count = 0; function handleAlertClick() &#123; setTimeout(() =&gt; &#123; alert(&apos;You clicked on: &apos; + count); &#125;, 3000); &#125; &#125;function Counter() &#123; const count = 1; function handleAlertClick() &#123; setTimeout(() =&gt; &#123; alert(&apos;You clicked on: &apos; + count); &#125;, 3000); &#125; &#125;function Counter() &#123; const count = 2; function handleAlertClick() &#123; setTimeout(() =&gt; &#123; alert(&apos;You clicked on: &apos; + count); &#125;, 3000); &#125; &#125;æ‰€ä»¥å®é™…ä¸Šï¼Œæ¯ä¸€æ¬¡æ¸²æŸ“éƒ½æœ‰ä¸€ä¸ª â€œæ–°ç‰ˆæœ¬â€ çš„handleAlertClickã€‚æ¯ä¸€ä¸ªç‰ˆæœ¬çš„handleAlertClickâ€œè®°ä½â€ äº†å®ƒè‡ªå·±çš„ countï¼š12345678910111213141516171819202122232425262728293031function Counter() &#123; function handleAlertClick() &#123; setTimeout(() =&gt; &#123; alert(&apos;You clicked on: &apos; + 0); &#125;, 3000); &#125; &lt;button onClick=&#123;handleAlertClick&#125; /&gt; &#125;function Counter() &#123; function handleAlertClick() &#123; setTimeout(() =&gt; &#123; alert(&apos;You clicked on: &apos; + 1); &#125;, 3000); &#125; &lt;button onClick=&#123;handleAlertClick&#125; /&gt; &#125;function Counter() &#123; function handleAlertClick() &#123; setTimeout(() =&gt; &#123; alert(&apos;You clicked on: &apos; + 2); &#125;, 3000); &#125; &lt;button onClick=&#123;handleAlertClick&#125; /&gt; &#125;è¿™å°±æ˜¯ä¸ºä»€ä¹ˆåœ¨è¿™ä¸ª demo ä¸­ä¸­ï¼Œäº‹ä»¶å¤„ç†å‡½æ•° â€œå±äºâ€ æŸä¸€æ¬¡ç‰¹å®šçš„æ¸²æŸ“ï¼Œå½“ä½ ç‚¹å‡»çš„æ—¶å€™ï¼Œå®ƒä¼šä½¿ç”¨é‚£æ¬¡æ¸²æŸ“ä¸­counterçš„çŠ¶æ€å€¼ã€‚åœ¨ä»»æ„ä¸€æ¬¡æ¸²æŸ“ä¸­ï¼Œprops å’Œ state æ˜¯å§‹ç»ˆä¿æŒä¸å˜çš„ã€‚å¦‚æœ props å’Œ state åœ¨ä¸åŒçš„æ¸²æŸ“ä¸­æ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œé‚£ä¹ˆä½¿ç”¨åˆ°å®ƒä»¬çš„ä»»ä½•å€¼ä¹Ÿæ˜¯ç‹¬ç«‹çš„ï¼ˆåŒ…æ‹¬äº‹ä»¶å¤„ç†å‡½æ•°ï¼‰ã€‚å®ƒä»¬éƒ½ â€œå±äºâ€ ä¸€æ¬¡ç‰¹å®šçš„æ¸²æŸ“ã€‚å³ä¾¿æ˜¯äº‹ä»¶å¤„ç†ä¸­çš„å¼‚æ­¥å‡½æ•°è°ƒç”¨ â€œçœ‹åˆ°â€ çš„ä¹Ÿæ˜¯è¿™æ¬¡æ¸²æŸ“ä¸­çš„countå€¼ã€‚å¤‡æ³¨ï¼šä¸Šé¢æˆ‘å°†å…·ä½“çš„countå€¼ç›´æ¥å†…è”åˆ°äº†handleAlertClickå‡½æ•°ä¸­ã€‚è¿™ç§å¿ƒæ™ºä¸Šçš„æ›¿æ¢æ˜¯å®‰å…¨çš„å› ä¸ºcount å€¼åœ¨æŸæ¬¡ç‰¹å®šæ¸²æŸ“ä¸­ä¸å¯èƒ½è¢«æ”¹å˜ã€‚å®ƒè¢«å£°æ˜æˆäº†ä¸€ä¸ªå¸¸é‡å¹¶ä¸”æ˜¯ä¸€ä¸ªæ•°å­—ã€‚è¿™æ ·å»æ€è€ƒå…¶ä»–ç±»å‹çš„å€¼æ¯”å¦‚å¯¹è±¡ä¹ŸåŒæ ·æ˜¯å®‰å…¨çš„ï¼Œå½“ç„¶éœ€è¦åœ¨æˆ‘ä»¬éƒ½åŒæ„åº”è¯¥é¿å…ç›´æ¥ä¿®æ”¹ state è¿™ä¸ªå‰æä¸‹ã€‚é€šè¿‡è°ƒç”¨setSomething(newObj)çš„æ–¹å¼å»ç”Ÿæˆä¸€ä¸ªæ–°çš„å¯¹è±¡è€Œä¸æ˜¯ç›´æ¥ä¿®æ”¹å®ƒæ˜¯æ›´å¥½çš„é€‰æ‹©ï¼Œå› ä¸ºè¿™æ ·èƒ½ä¿è¯ä¹‹å‰æ¸²æŸ“ä¸­çš„ state ä¸ä¼šè¢«æ±¡æŸ“ã€‚æ¯æ¬¡æ¸²æŸ“éƒ½æœ‰å®ƒè‡ªå·±çš„ Effectsè¿™ç¯‡æ–‡ç« æ˜¯å…³äº effects çš„ï¼Œä½†ç›®å‰æˆ‘ä»¬å±…ç„¶è¿˜æ²¡æœ‰è®¨è®º effectsï¼ è¨€å½’æ­£ä¼ ï¼Œç”±ä¸Šé¢çš„åˆ†æå¾—å‡ºä¸€ä¸ªç»“æœï¼Œeffects å…¶å®å¹¶æ²¡æœ‰ä»€ä¹ˆä¸¤æ ·ã€‚è®©æˆ‘ä»¬å›åˆ°å®˜ç½‘æ–‡æ¡£ä¸­çš„è¿™ä¸ªä¾‹å­ï¼š12345678910111213function Counter() &#123; const [count, setCount] = useState(0); useEffect(() =&gt; &#123; document.title = `You clicked $&#123;count&#125; times`; &#125;); return ( &lt;div&gt; &lt;p&gt;You clicked &#123;count&#125; times&lt;/p&gt; &lt;button onClick=&#123;() =&gt; setCount(count + 1)&#125;&gt; Click me &lt;/button&gt; &lt;/div&gt; );&#125;æŠ›ä¸€ä¸ªé—®é¢˜ç»™ä½ ï¼šeffect æ˜¯å¦‚ä½•è¯»å–åˆ°æœ€æ–°çš„count çŠ¶æ€å€¼çš„å‘¢ï¼Ÿä¹Ÿè®¸ï¼Œæ˜¯æŸç§ â€œdata bindingâ€ æˆ–â€œwatchingâ€æœºåˆ¶ä½¿å¾—countèƒ½å¤Ÿåœ¨ effect å‡½æ•°å†…æ›´æ–°ï¼Ÿä¹Ÿæˆ–è®¸countæ˜¯ä¸€ä¸ªå¯å˜çš„å€¼ï¼ŒReact ä¼šåœ¨æˆ‘ä»¬ç»„ä»¶å†…éƒ¨ä¿®æ”¹å®ƒä»¥ä½¿æˆ‘ä»¬çš„ effect å‡½æ•°æ€»èƒ½æ‹¿åˆ°æœ€æ–°çš„å€¼ï¼Ÿéƒ½ä¸æ˜¯ã€‚æˆ‘ä»¬å·²ç»çŸ¥é“countæ˜¯æŸä¸ªç‰¹å®šæ¸²æŸ“ä¸­çš„å¸¸é‡ã€‚äº‹ä»¶å¤„ç†å‡½æ•° â€œçœ‹åˆ°â€ çš„æ˜¯å±äºå®ƒé‚£æ¬¡ç‰¹å®šæ¸²æŸ“ä¸­çš„countçŠ¶æ€å€¼ã€‚å¯¹äº effects ä¹ŸåŒæ ·å¦‚æ­¤ï¼šå¹¶ä¸æ˜¯countçš„å€¼åœ¨ â€œä¸å˜â€ çš„ effect ä¸­å‘ç”Ÿäº†æ”¹å˜ï¼Œè€Œæ˜¯ effect å‡½æ•°æœ¬èº«åœ¨æ¯ä¸€æ¬¡æ¸²æŸ“ä¸­éƒ½ä¸ç›¸åŒã€‚æ¯ä¸€ä¸ª effect ç‰ˆæœ¬ â€œçœ‹åˆ°â€ çš„countå€¼éƒ½æ¥è‡ªäºå®ƒå±äºçš„é‚£æ¬¡æ¸²æŸ“ï¼š12345678910111213141516171819202122function Counter() &#123; useEffect( () =&gt; &#123; document.title = `You clicked $&#123;0&#125; times`; &#125; ); &#125;function Counter() &#123; useEffect( () =&gt; &#123; document.title = `You clicked $&#123;1&#125; times`; &#125; ); &#125;function Counter() &#123; useEffect( () =&gt; &#123; document.title = `You clicked $&#123;2&#125; times`; &#125; ); &#125;React ä¼šè®°ä½ä½ æä¾›çš„ effect å‡½æ•°ï¼Œå¹¶ä¸”ä¼šåœ¨æ¯æ¬¡æ›´æ”¹ä½œç”¨äº DOM å¹¶è®©æµè§ˆå™¨ç»˜åˆ¶å±å¹•åå»è°ƒç”¨å®ƒã€‚æ‰€ä»¥è™½ç„¶æˆ‘ä»¬è¯´çš„æ˜¯ä¸€ä¸ª effectï¼ˆè¿™é‡ŒæŒ‡æ›´æ–° document çš„ titleï¼‰ï¼Œä½†å…¶å®æ¯æ¬¡æ¸²æŸ“éƒ½æ˜¯ä¸€ä¸ªä¸åŒçš„å‡½æ•° â€” å¹¶ä¸”æ¯ä¸ª effect å‡½æ•° â€œçœ‹åˆ°â€ çš„ props å’Œ state éƒ½æ¥è‡ªäºå®ƒå±äºçš„é‚£æ¬¡ç‰¹å®šæ¸²æŸ“ã€‚æ¦‚å¿µä¸Šï¼Œä½ å¯ä»¥æƒ³è±¡ effects æ˜¯æ¸²æŸ“ç»“æœçš„ä¸€éƒ¨åˆ†ã€‚ä¸¥æ ¼åœ°è¯´ï¼Œå®ƒä»¬å¹¶ä¸æ˜¯ï¼ˆä¸ºäº†å…è®¸ Hook çš„ç»„åˆå¹¶ä¸”ä¸å¼•å…¥ç¬¨æ‹™çš„è¯­æ³•æˆ–è€…è¿è¡Œæ—¶ï¼‰ã€‚ä½†æ˜¯åœ¨æˆ‘ä»¬æ„å»ºçš„å¿ƒæ™ºæ¨¡å‹ä¸Šï¼Œeffect å‡½æ•°_å±äº_æŸä¸ªç‰¹å®šçš„æ¸²æŸ“ï¼Œå°±åƒäº‹ä»¶å¤„ç†å‡½æ•°ä¸€æ ·ã€‚ä¸ºäº†ç¡®ä¿æˆ‘ä»¬å·²ç»æœ‰äº†æ‰å®çš„ç†è§£ï¼Œæˆ‘ä»¬å†å›é¡¾ä¸€ä¸‹ç¬¬ä¸€æ¬¡çš„æ¸²æŸ“è¿‡ç¨‹ï¼šReact: ç»™æˆ‘çŠ¶æ€ä¸º 0æ—¶å€™çš„ UIã€‚ä½ çš„ç»„ä»¶:ç»™ä½ éœ€è¦æ¸²æŸ“çš„å†…å®¹: &lt;p&gt;You clicked 0 times&lt;/p&gt;ã€‚è®°å¾—åœ¨æ¸²æŸ“å®Œäº†ä¹‹åè°ƒç”¨è¿™ä¸ª effect: () =&gt; { document.title = &#39;You clicked 0 times&#39; }ã€‚React: æ²¡é—®é¢˜ã€‚å¼€å§‹æ›´æ–° UIï¼Œå–‚æµè§ˆå™¨ï¼Œæˆ‘è¦ç»™ DOM æ·»åŠ ä¸€äº›ä¸œè¥¿ã€‚æµè§ˆå™¨: é…·ï¼Œæˆ‘å·²ç»æŠŠå®ƒç»˜åˆ¶åˆ°å±å¹•ä¸Šäº†ã€‚React: å¥½çš„ï¼Œ æˆ‘ç°åœ¨å¼€å§‹è¿è¡Œç»™æˆ‘çš„ effectè¿è¡Œ () =&gt; { document.title = &#39;You clicked 0 times&#39; }ã€‚ç°åœ¨æˆ‘ä»¬å›é¡¾ä¸€ä¸‹æˆ‘ä»¬ç‚¹å‡»ä¹‹åå‘ç”Ÿäº†ä»€ä¹ˆï¼šä½ çš„ç»„ä»¶: å–‚ React, æŠŠæˆ‘çš„çŠ¶æ€è®¾ç½®ä¸º1ã€‚React: ç»™æˆ‘çŠ¶æ€ä¸º 1æ—¶å€™çš„ UIã€‚ä½ çš„ç»„ä»¶:ç»™ä½ éœ€è¦æ¸²æŸ“çš„å†…å®¹: &lt;p&gt;You clicked 1 times&lt;/p&gt;ã€‚è®°å¾—åœ¨æ¸²æŸ“å®Œäº†ä¹‹åè°ƒç”¨è¿™ä¸ª effectï¼š () =&gt; { document.title = &#39;You clicked 1 times&#39; }ã€‚React: æ²¡é—®é¢˜ã€‚å¼€å§‹æ›´æ–° UIï¼Œå–‚æµè§ˆå™¨ï¼Œæˆ‘ä¿®æ”¹äº† DOMã€‚Browser: é…·ï¼Œæˆ‘å·²ç»å°†æ›´æ”¹ç»˜åˆ¶åˆ°å±å¹•ä¸Šäº†ã€‚React: å¥½çš„ï¼Œ æˆ‘ç°åœ¨å¼€å§‹è¿è¡Œå±äºè¿™æ¬¡æ¸²æŸ“çš„ effectè¿è¡Œ () =&gt; { document.title = &#39;You clicked 1 times&#39; }ã€‚æ¯ä¸€æ¬¡æ¸²æŸ“éƒ½æœ‰å®ƒè‡ªå·±çš„â€¦ æ‰€æœ‰æˆ‘ä»¬ç°åœ¨çŸ¥é“ effects ä¼šåœ¨æ¯æ¬¡æ¸²æŸ“åè¿è¡Œï¼Œå¹¶ä¸”æ¦‚å¿µä¸Šå®ƒæ˜¯ç»„ä»¶è¾“å‡ºçš„ä¸€éƒ¨åˆ†ï¼Œå¯ä»¥ â€œçœ‹åˆ°â€ å±äºæŸæ¬¡ç‰¹å®šæ¸²æŸ“çš„ props å’Œ stateã€‚æˆ‘ä»¬æ¥åšä¸€ä¸ªæ€æƒ³å®éªŒï¼Œæ€è€ƒä¸‹é¢çš„ä»£ç ï¼š12345678910111213function Counter() &#123; const [count, setCount] = useState(0); useEffect(() =&gt; &#123; setTimeout(() =&gt; &#123; console.log(`You clicked $&#123;count&#125; times`); &#125;, 3000); &#125;); return ( &lt;div&gt; &lt;p&gt;You clicked &#123;count&#125; times&lt;/p&gt; &lt;button onClick=&#123;() =&gt; setCount(count + 1)&#125;&gt; Click me &lt;/button&gt; &lt;/div&gt; );&#125;å¦‚æœæˆ‘ç‚¹å‡»äº†å¾ˆå¤šæ¬¡å¹¶ä¸”åœ¨ effect é‡Œè®¾ç½®äº†å»¶æ—¶ï¼Œæ‰“å°å‡ºæ¥çš„ç»“æœä¼šæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿå‰§é€é¢„è­¦ä½ å¯èƒ½ä¼šè®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªå¾ˆç»•çš„é¢˜å¹¶ä¸”ç»“æœæ˜¯åç›´è§‰çš„ã€‚å®Œå…¨é”™äº†ï¼æˆ‘ä»¬çœ‹åˆ°çš„å°±æ˜¯é¡ºåºçš„æ‰“å°è¾“å‡º â€” æ¯ä¸€ä¸ªéƒ½å±äºæŸæ¬¡ç‰¹å®šçš„æ¸²æŸ“ï¼Œå› æ­¤æœ‰å®ƒè¯¥æœ‰çš„countå€¼ã€‚ä½ å¯ä»¥è‡ªå·±è¯•ä¸€è¯•ï¼šä½ å¯èƒ½ä¼šæƒ³ï¼šâ€œå®ƒå½“ç„¶åº”è¯¥æ˜¯è¿™æ ·çš„ã€‚å¦åˆ™è¿˜ä¼šæ€ä¹ˆæ ·å‘¢ï¼Ÿâ€ä¸è¿‡ï¼Œclass ä¸­çš„this.stateå¹¶ä¸æ˜¯è¿™æ ·è¿ä½œçš„ã€‚ä½ å¯èƒ½ä¼šæƒ³å½“ç„¶ä»¥ä¸ºä¸‹é¢çš„ class å®ç°å’Œä¸Šé¢æ˜¯ç›¸ç­‰çš„ï¼š12345componentDidUpdate() &#123; setTimeout(() =&gt; &#123; console.log(`You clicked $&#123;this.state.count&#125; times`); &#125;, 3000);&#125;ç„¶è€Œï¼Œthis.state.countæ€»æ˜¯æŒ‡å‘_æœ€æ–°_çš„ count å€¼ï¼Œè€Œä¸æ˜¯å±äºæŸæ¬¡ç‰¹å®šæ¸²æŸ“çš„å€¼ã€‚æ‰€ä»¥ä½ ä¼šçœ‹åˆ°æ¯æ¬¡æ‰“å°è¾“å‡ºéƒ½æ˜¯5ï¼šæˆ‘è§‰å¾— Hooks è¿™ä¹ˆä¾èµ– Javascript é—­åŒ…æ˜¯æŒºè®½åˆºçš„ä¸€ä»¶äº‹ã€‚æœ‰æ—¶å€™ç»„ä»¶çš„ class å®ç°æ–¹å¼ä¼šå—é—­åŒ…ç›¸å…³çš„è‹¦ï¼ˆthe canonical wrong-value-in-a-timeout confusionï¼‰ï¼Œä½†å…¶å®è¿™ä¸ªä¾‹å­ä¸­çœŸæ­£çš„æ··ä¹±æ¥æºæ˜¯å¯å˜æ•°æ®ï¼ˆReact ä¿®æ”¹äº† class ä¸­çš„this.stateä½¿å…¶æŒ‡å‘æœ€æ–°çŠ¶æ€ï¼‰ï¼Œå¹¶ä¸æ˜¯é—­åŒ…æœ¬èº«çš„é”™ã€‚å½“å°é—­çš„å€¼å§‹ç»ˆä¸ä¼šå˜çš„æƒ…å†µä¸‹é—­åŒ…æ˜¯éå¸¸æ£’çš„ã€‚è¿™ä½¿å®ƒä»¬éå¸¸å®¹æ˜“æ€è€ƒå› ä¸ºä½ æœ¬è´¨ä¸Šåœ¨å¼•ç”¨å¸¸é‡ã€‚æ­£å¦‚æˆ‘ä»¬æ‰€è®¨è®ºçš„ï¼Œprops å’Œ state åœ¨æŸä¸ªç‰¹å®šæ¸²æŸ“ä¸­æ˜¯ä¸ä¼šæ”¹å˜çš„ã€‚é¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨é—­åŒ…ä¿®å¤ä¸Šé¢çš„ class ç‰ˆæœ¬â€¦é€†æ½®è€ŒåŠ¨åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å¯ä»¥æ˜ç¡®åœ°å–Šå‡ºä¸‹é¢é‡è¦çš„äº‹å®ï¼šæ¯ä¸€ä¸ªç»„ä»¶å†…çš„å‡½æ•°ï¼ˆåŒ…æ‹¬äº‹ä»¶å¤„ç†å‡½æ•°ï¼Œeffectsï¼Œå®šæ—¶å™¨æˆ–è€… API è°ƒç”¨ç­‰ç­‰ï¼‰ä¼šæ•è·æŸæ¬¡æ¸²æŸ“ä¸­å®šä¹‰çš„ props å’Œ stateã€‚æ‰€ä»¥ä¸‹é¢çš„ä¸¤ä¸ªä¾‹å­æ˜¯ç›¸ç­‰çš„ï¼š1234567function Example(props) &#123; useEffect(() =&gt; &#123; setTimeout(() =&gt; &#123; console.log(props.counter); &#125;, 1000); &#125;); &#125;1234567function Example(props) &#123; const counter = props.counter; useEffect(() =&gt; &#123; setTimeout(() =&gt; &#123; console.log(counter); &#125;, 1000); &#125;); &#125;åœ¨ç»„ä»¶å†…ä»€ä¹ˆæ—¶å€™å»è¯»å– props æˆ–è€… state æ˜¯æ— å…³ç´§è¦çš„ã€‚å› ä¸ºå®ƒä»¬ä¸ä¼šæ”¹å˜ã€‚åœ¨å•æ¬¡æ¸²æŸ“çš„èŒƒå›´å†…ï¼Œprops å’Œ state å§‹ç»ˆä¿æŒä¸å˜ã€‚ï¼ˆè§£æ„èµ‹å€¼çš„ props ä½¿å¾—è¿™ä¸€ç‚¹æ›´æ˜æ˜¾ã€‚ï¼‰å½“ç„¶ï¼Œæœ‰æ—¶å€™ä½ å¯èƒ½_æƒ³_åœ¨ effect çš„å›è°ƒå‡½æ•°é‡Œè¯»å–æœ€æ–°çš„å€¼è€Œä¸æ˜¯æ•è·çš„å€¼ã€‚æœ€ç®€å•çš„å®ç°æ–¹æ³•æ˜¯ä½¿ç”¨ refsï¼Œè¿™ç¯‡æ–‡ç« çš„æœ€åä¸€éƒ¨åˆ†ä»‹ç»äº†ç›¸å…³å†…å®¹ã€‚éœ€è¦æ³¨æ„çš„æ˜¯å½“ä½ æƒ³è¦ä»_è¿‡å»æ¸²æŸ“ä¸­çš„å‡½æ•°é‡Œè¯»å–æœªæ¥çš„ props å’Œ stateï¼Œä½ æ˜¯åœ¨é€†æ½®è€ŒåŠ¨ã€‚è™½ç„¶å®ƒå¹¶æ²¡æœ‰é”™_ï¼ˆæœ‰æ—¶å€™å¯èƒ½ä¹Ÿéœ€è¦è¿™æ ·åšï¼‰ï¼Œä½†å®ƒå› ä¸ºæ‰“ç ´äº†é»˜è®¤èŒƒå¼ä¼šä½¿ä»£ç æ˜¾å¾—ä¸å¤Ÿ â€œå¹²å‡€â€ã€‚è¿™æ˜¯æˆ‘ä»¬æœ‰æ„ä¸ºä¹‹çš„ï¼Œå› ä¸ºå®ƒèƒ½å¸®åŠ©çªå‡ºå“ªäº›ä»£ç æ˜¯è„†å¼±çš„ï¼Œæ˜¯éœ€è¦ä¾èµ–æ—¶é—´æ¬¡åºçš„ã€‚åœ¨ class ä¸­ï¼Œå¦‚æœå‘ç”Ÿè¿™ç§æƒ…å†µå°±æ²¡é‚£ä¹ˆæ˜¾è€Œæ˜“è§äº†ã€‚ä¸‹é¢è¿™ä¸ªè®¡æ•°å™¨ç‰ˆæœ¬ æ¨¡æ‹Ÿäº† class ä¸­çš„è¡Œä¸ºï¼š1234567function Example() &#123; const [count, setCount] = useState(0); const latestCount = useRef(count); useEffect(() =&gt; &#123; latestCount.current = count; setTimeout(() =&gt; &#123; console.log(`You clicked $&#123;latestCount.current&#125; times`); &#125;, 3000); &#125;);åœ¨ React ä¸­å»ç›´æ¥ä¿®æ”¹å€¼çœ‹ä¸Šå»æœ‰ç‚¹æ€ªå¼‚ã€‚ç„¶è€Œï¼Œåœ¨ class ç»„ä»¶ä¸­ React æ­£æ˜¯è¿™æ ·å»ä¿®æ”¹this.stateçš„ã€‚ä¸åƒæ•è·çš„ props å’Œ stateï¼Œä½ æ²¡æ³•ä¿è¯åœ¨ä»»æ„ä¸€ä¸ªå›è°ƒå‡½æ•°ä¸­è¯»å–çš„latestCount.currentæ˜¯ä¸å˜çš„ã€‚æ ¹æ®å®šä¹‰ï¼Œä½ å¯ä»¥éšæ—¶ä¿®æ”¹å®ƒã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå®ƒä¸æ˜¯é»˜è®¤è¡Œä¸ºï¼Œè€Œæ˜¯éœ€è¦ä½ ä¸»åŠ¨é€‰æ‹©è¿™æ ·åšã€‚é‚£ Effect ä¸­çš„æ¸…ç†åˆæ˜¯æ€æ ·çš„å‘¢ï¼Ÿåƒ æ–‡æ¡£ä¸­è§£é‡Šçš„, æœ‰äº› effects å¯èƒ½éœ€è¦æœ‰ä¸€ä¸ªæ¸…ç†æ­¥éª¤ã€‚æœ¬è´¨ä¸Šï¼Œå®ƒçš„ç›®çš„æ˜¯æ¶ˆé™¤å‰¯ä½œç”¨ï¼ˆeffect)ï¼Œæ¯”å¦‚å–æ¶ˆè®¢é˜…ã€‚æ€è€ƒä¸‹é¢çš„ä»£ç :123456useEffect(() =&gt; &#123; ChatAPI.subscribeToFriendStatus(props.id, handleStatusChange); return () =&gt; &#123; ChatAPI.unsubscribeFromFriendStatus(props.id, handleStatusChange); &#125;;&#125;);å‡è®¾ç¬¬ä¸€æ¬¡æ¸²æŸ“çš„æ—¶å€™propsæ˜¯{id: 10}ï¼Œç¬¬äºŒæ¬¡æ¸²æŸ“çš„æ—¶å€™æ˜¯{id: 20}ã€‚ä½ _å¯èƒ½_ä¼šè®¤ä¸ºå‘ç”Ÿäº†ä¸‹é¢çš„è¿™äº›äº‹ï¼šReact æ¸…é™¤äº† {id: 10}çš„ effectã€‚React æ¸²æŸ“{id: 20}çš„ UIã€‚React è¿è¡Œ{id: 20}çš„ effectã€‚(äº‹å®å¹¶ä¸æ˜¯è¿™æ ·ã€‚)å¦‚æœä¾èµ–è¿™ç§å¿ƒæ™ºæ¨¡å‹ï¼Œä½ å¯èƒ½ä¼šè®¤ä¸ºæ¸…é™¤è¿‡ç¨‹ â€œçœ‹åˆ°â€ çš„æ˜¯æ—§çš„ props å› ä¸ºå®ƒæ˜¯åœ¨é‡æ–°æ¸²æŸ“ä¹‹å‰è¿è¡Œçš„ï¼Œæ–°çš„ effectâ€œçœ‹åˆ°â€çš„æ˜¯æ–°çš„ props å› ä¸ºå®ƒæ˜¯åœ¨é‡æ–°æ¸²æŸ“ä¹‹åè¿è¡Œçš„ã€‚è¿™ç§å¿ƒæ™ºæ¨¡å‹ç›´æ¥æ¥æºäº class ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸã€‚ä¸è¿‡å®ƒå¹¶ä¸ç²¾ç¡®ã€‚è®©æˆ‘ä»¬æ¥ä¸€æ¢ç©¶ç«Ÿã€‚React åªä¼šåœ¨æµè§ˆå™¨ç»˜åˆ¶åè¿è¡Œ effectsã€‚è¿™ä½¿å¾—ä½ çš„åº”ç”¨æ›´æµç•…å› ä¸ºå¤§å¤šæ•° effects å¹¶ä¸ä¼šé˜»å¡å±å¹•çš„æ›´æ–°ã€‚Effect çš„æ¸…é™¤åŒæ ·è¢«å»¶è¿Ÿäº†ã€‚ä¸Šä¸€æ¬¡çš„ effect ä¼šåœ¨é‡æ–°æ¸²æŸ“åè¢«æ¸…é™¤ï¼šReact æ¸²æŸ“{id: 20}çš„ UIã€‚æµè§ˆå™¨ç»˜åˆ¶ã€‚æˆ‘ä»¬åœ¨å±å¹•ä¸Šçœ‹åˆ°{id: 20}çš„ UIã€‚React æ¸…é™¤{id: 10}çš„ effectã€‚React è¿è¡Œ{id: 20}çš„ effectã€‚ä½ å¯èƒ½ä¼šå¥½å¥‡ï¼šå¦‚æœæ¸…é™¤ä¸Šä¸€æ¬¡çš„ effect å‘ç”Ÿåœ¨ props å˜æˆ{id: 20}ä¹‹åï¼Œé‚£å®ƒä¸ºä»€ä¹ˆè¿˜èƒ½ â€œçœ‹åˆ°â€ æ—§çš„{id: 10}ï¼Ÿä½ æ›¾ç»æ¥è¿‡è¿™é‡Œâ€¦ ğŸ¤”å¼•ç”¨ä¸ŠåŠéƒ¨åˆ†å¾—åˆ°çš„ç»“è®º:ç»„ä»¶å†…çš„æ¯ä¸€ä¸ªå‡½æ•°ï¼ˆåŒ…æ‹¬äº‹ä»¶å¤„ç†å‡½æ•°ï¼Œeffectsï¼Œå®šæ—¶å™¨æˆ–è€… API è°ƒç”¨ç­‰ç­‰ï¼‰ä¼šæ•è·å®šä¹‰å®ƒä»¬çš„é‚£æ¬¡æ¸²æŸ“ä¸­çš„ props å’Œ stateã€‚ç°åœ¨ç­”æ¡ˆæ˜¾è€Œæ˜“è§ã€‚effect çš„æ¸…é™¤å¹¶ä¸ä¼šè¯»å– â€œæœ€æ–°â€ çš„ propsã€‚å®ƒåªèƒ½è¯»å–åˆ°å®šä¹‰å®ƒçš„é‚£æ¬¡æ¸²æŸ“ä¸­çš„ props å€¼ï¼š1234567891011121314151617181920212223242526function Example() &#123; useEffect( () =&gt; &#123; ChatAPI.subscribeToFriendStatus(10, handleStatusChange); return () =&gt; &#123; ChatAPI.unsubscribeFromFriendStatus(10, handleStatusChange); &#125;; &#125; ); &#125;function Example() &#123; useEffect( () =&gt; &#123; ChatAPI.subscribeToFriendStatus(20, handleStatusChange); return () =&gt; &#123; ChatAPI.unsubscribeFromFriendStatus(20, handleStatusChange); &#125;; &#125; ); &#125;ç‹å›½ä¼šå´›èµ·è½¬è€Œå¤å½’å°˜åœŸï¼Œå¤ªé˜³ä¼šè„±è½å¤–å±‚å˜ä¸ºç™½çŸ®æ˜Ÿï¼Œæœ€åçš„æ–‡æ˜ä¹Ÿè¿Ÿæ—©ä¼šç»“æŸã€‚ä½†æ˜¯ç¬¬ä¸€æ¬¡æ¸²æŸ“ä¸­ effect çš„æ¸…é™¤å‡½æ•°åªèƒ½çœ‹åˆ°{id: 10}è¿™ä¸ª propsã€‚è¿™æ­£æ˜¯ä¸ºä»€ä¹ˆ React èƒ½åšåˆ°åœ¨ç»˜åˆ¶åç«‹å³å¤„ç† effects â€” å¹¶ä¸”é»˜è®¤æƒ…å†µä¸‹ä½¿ä½ çš„åº”ç”¨è¿è¡Œæ›´æµç•…ã€‚å¦‚æœä½ çš„ä»£ç éœ€è¦ä¾ç„¶å¯ä»¥è®¿é—®åˆ°è€çš„ propsã€‚åŒæ­¥ï¼Œ è€Œéç”Ÿå‘½å‘¨æœŸæˆ‘æœ€å–œæ¬¢ React çš„ä¸€ç‚¹æ˜¯å®ƒç»Ÿä¸€æè¿°äº†åˆå§‹æ¸²æŸ“å’Œä¹‹åçš„æ›´æ–°ã€‚è¿™é™ä½äº†ä½ ç¨‹åºçš„ç†µã€‚æ¯”å¦‚æˆ‘æœ‰ä¸ªç»„ä»¶åƒä¸‹é¢è¿™æ ·ï¼š1234567function Greeting(&#123; name &#125;) &#123; return ( &lt;h1 class&gt; Hello, &#123;name&#125; &lt;/h1&gt; );&#125;æˆ‘å…ˆæ¸²æŸ“&lt;Greeting /&gt;ç„¶åæ¸²æŸ“&lt;Greeting /&gt;ï¼Œå’Œæˆ‘ç›´æ¥æ¸²æŸ“&lt;Greeting /&gt;å¹¶æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚åœ¨è¿™ä¸¤ç§æƒ…å†µä¸­ï¼Œæˆ‘æœ€åçœ‹åˆ°çš„éƒ½æ˜¯ â€œHello, Yuzhiâ€ã€‚äººä»¬æ€»æ˜¯è¯´ï¼šâ€œé‡è¦çš„æ˜¯æ—…è¡Œè¿‡ç¨‹ï¼Œè€Œä¸æ˜¯ç›®çš„åœ°â€ã€‚åœ¨ React ä¸–ç•Œä¸­ï¼Œæ°å¥½ç›¸åã€‚é‡è¦çš„æ˜¯ç›®çš„ï¼Œè€Œä¸æ˜¯è¿‡ç¨‹ã€‚è¿™å°±æ˜¯ JQuery ä»£ç ä¸­ $.addClass æˆ– $.removeClassè¿™æ ·çš„è°ƒç”¨ï¼ˆè¿‡ç¨‹ï¼‰å’Œ React ä»£ç ä¸­å£°æ˜ CSS ç±»ååº”è¯¥æ˜¯ä»€ä¹ˆï¼ˆç›®çš„ï¼‰ä¹‹é—´çš„åŒºåˆ«ã€‚React ä¼šæ ¹æ®æˆ‘ä»¬å½“å‰çš„ props å’Œ state åŒæ­¥åˆ° DOMã€‚â€œmountâ€å’Œ â€œupdateâ€ ä¹‹äºæ¸²æŸ“å¹¶æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚ä½ åº”è¯¥ä»¥ç›¸åŒçš„æ–¹å¼å»æ€è€ƒ effectsã€‚useEffectä½¿ä½ èƒ½å¤Ÿæ ¹æ® props å’Œ state _åŒæ­¥_ React tree ä¹‹å¤–çš„ä¸œè¥¿ã€‚1234567function Greeting(&#123; name &#125;) &#123; useEffect(() =&gt; &#123; document.title = &apos;Hello, &apos; + name; &#125;); return ( &lt;h1 class&gt; Hello, &#123;name&#125; &lt;/h1&gt; );&#125;è¿™å°±æ˜¯å’Œå¤§å®¶ç†ŸçŸ¥çš„ mount/update/unmount å¿ƒæ™ºæ¨¡å‹ä¹‹é—´ç»†å¾®çš„åŒºåˆ«ã€‚ç†è§£å’Œå†…åŒ–è¿™ç§åŒºåˆ«æ˜¯éå¸¸é‡è¦çš„ã€‚å¦‚æœä½ è¯•å›¾å†™ä¸€ä¸ª effect ä¼šæ ¹æ®æ˜¯å¦ç¬¬ä¸€æ¬¡æ¸²æŸ“è€Œè¡¨ç°ä¸ä¸€è‡´ï¼Œä½ æ­£åœ¨é€†æ½®è€ŒåŠ¨ã€‚å¦‚æœæˆ‘ä»¬çš„ç»“æœä¾èµ–äºè¿‡ç¨‹è€Œä¸æ˜¯ç›®çš„ï¼Œæˆ‘ä»¬ä¼šåœ¨åŒæ­¥ä¸­çŠ¯é”™ã€‚å…ˆæ¸²æŸ“å±æ€§ Aï¼ŒB å†æ¸²æŸ“ Cï¼Œå’Œç«‹å³æ¸²æŸ“ C å¹¶æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚è™½ç„¶ä»–ä»¬å¯èƒ½çŸ­æš‚åœ°ä¼šæœ‰ç‚¹ä¸åŒï¼ˆæ¯”å¦‚è¯·æ±‚æ•°æ®æ—¶ï¼‰ï¼Œä½†æœ€ç»ˆçš„ç»“æœæ˜¯ä¸€æ ·çš„ã€‚ä¸è¿‡è¯è¯´å›æ¥ï¼Œåœ¨æ¯ä¸€æ¬¡æ¸²æŸ“åéƒ½å»è¿è¡Œæ‰€æœ‰çš„ effects å¯èƒ½å¹¶ä¸é«˜æ•ˆã€‚ï¼ˆå¹¶ä¸”åœ¨æŸäº›åœºæ™¯ä¸‹ï¼Œå®ƒå¯èƒ½ä¼šå¯¼è‡´æ— é™å¾ªç¯ã€‚ï¼‰æ‰€ä»¥æˆ‘ä»¬è¯¥æ€ä¹ˆè§£å†³è¿™ä¸ªé—®é¢˜ï¼Ÿå‘Šè¯‰ React å»æ¯”å¯¹ä½ çš„ Effectså…¶å®æˆ‘ä»¬å·²ç»ä» React å¤„ç† DOM çš„æ–¹å¼ä¸­å­¦ä¹ åˆ°äº†è§£å†³åŠæ³•ã€‚React åªä¼šæ›´æ–° DOM çœŸæ­£å‘ç”Ÿæ”¹å˜çš„éƒ¨åˆ†ï¼Œè€Œä¸æ˜¯æ¯æ¬¡æ¸²æŸ“éƒ½å¤§åŠ¨å¹²æˆˆã€‚å½“ä½ æŠŠ123&lt;h1 class&gt; Hello, Dan&lt;/h1&gt;æ›´æ–°åˆ°123&lt;h1 class&gt; Hello, Yuzhi&lt;/h1&gt;React èƒ½å¤Ÿçœ‹åˆ°ä¸¤ä¸ªå¯¹è±¡:12const oldProps = &#123;className: &apos;Greeting&apos;, children: &apos;Hello, Dan&apos;&#125;;const newProps = &#123;className: &apos;Greeting&apos;, children: &apos;Hello, Yuzhi&apos;&#125;;å®ƒä¼šæ£€æµ‹æ¯ä¸€ä¸ª propsï¼Œå¹¶ä¸”å‘ç°childrenå‘ç”Ÿæ”¹å˜éœ€è¦æ›´æ–° DOMï¼Œä½†classNameå¹¶æ²¡æœ‰ã€‚æ‰€ä»¥å®ƒåªéœ€è¦è¿™æ ·åšï¼š1domNode.innerText = &apos;Hello, Yuzhi&apos;;æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨ç±»ä¼¼çš„æ–¹å¼å¤„ç† effects å—ï¼Ÿå¦‚æœèƒ½å¤Ÿåœ¨ä¸éœ€è¦çš„æ—¶å€™é¿å…è°ƒç”¨ effect å°±å¤ªå¥½äº†ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬çš„ç»„ä»¶å¯èƒ½å› ä¸ºçŠ¶æ€å˜æ›´è€Œé‡æ–°æ¸²æŸ“ï¼š12345678910111213function Greeting(&#123; name &#125;) &#123; const [counter, setCounter] = useState(0); useEffect(() =&gt; &#123; document.title = &apos;Hello, &apos; + name; &#125;); return ( &lt;h1 class&gt; Hello, &#123;name&#125; &lt;button onClick=&#123;() =&gt; setCounter(counter + 1)&#125;&gt; Increment &lt;/button&gt; &lt;/h1&gt; );&#125;ä½†æ˜¯æˆ‘ä»¬çš„ effect å¹¶æ²¡æœ‰ä½¿ç”¨counterè¿™ä¸ªçŠ¶æ€ã€‚æˆ‘ä»¬çš„ effect åªä¼šåŒæ­¥nameå±æ€§ç»™document.titleï¼Œä½†nameå¹¶æ²¡æœ‰å˜ã€‚åœ¨æ¯ä¸€æ¬¡ counter æ”¹å˜åé‡æ–°ç»™document.titleèµ‹å€¼å¹¶ä¸æ˜¯ç†æƒ³çš„åšæ³•ã€‚å¥½äº†ï¼Œé‚£ React å¯ä»¥â€¦ åŒºåˆ† effects çš„ä¸åŒå—ï¼Ÿ12let oldEffect = () =&gt; &#123; document.title = &apos;Hello, Dan&apos;; &#125;;let newEffect = () =&gt; &#123; document.title = &apos;Hello, Dan&apos;; &#125;;å¹¶ä¸èƒ½ã€‚React å¹¶ä¸èƒ½çŒœæµ‹åˆ°å‡½æ•°åšäº†ä»€ä¹ˆå¦‚æœä¸å…ˆè°ƒç”¨çš„è¯ã€‚ï¼ˆæºç ä¸­å¹¶æ²¡æœ‰åŒ…å«ç‰¹æ®Šçš„å€¼ï¼Œå®ƒä»…ä»…æ˜¯å¼•ç”¨äº†nameå±æ€§ã€‚ï¼‰è¿™æ˜¯ä¸ºä»€ä¹ˆä½ å¦‚æœæƒ³è¦é¿å… effects ä¸å¿…è¦çš„é‡å¤è°ƒç”¨ï¼Œä½ å¯ä»¥æä¾›ç»™useEffectä¸€ä¸ªä¾èµ–æ•°ç»„å‚æ•° (deps)ï¼š123useEffect(() =&gt; &#123; document.title = &apos;Hello, &apos; + name;&#125;, [name]);è¿™å¥½æ¯”ä½ å‘Šè¯‰ Reactï¼šâ€œHeyï¼Œæˆ‘çŸ¥é“ä½ çœ‹ä¸åˆ°è¿™ä¸ªå‡½æ•°é‡Œçš„ä¸œè¥¿ï¼Œä½†æˆ‘å¯ä»¥ä¿è¯åªä½¿ç”¨äº†æ¸²æŸ“ä¸­çš„nameï¼Œåˆ«æ— å…¶ä»–ã€‚â€å¦‚æœå½“å‰æ¸²æŸ“ä¸­çš„è¿™äº›ä¾èµ–é¡¹å’Œä¸Šä¸€æ¬¡è¿è¡Œè¿™ä¸ª effect çš„æ—¶å€™å€¼ä¸€æ ·ï¼Œå› ä¸ºæ²¡æœ‰ä»€ä¹ˆéœ€è¦åŒæ­¥ React ä¼šè‡ªåŠ¨è·³è¿‡è¿™æ¬¡ effectï¼š12345const oldEffect = () =&gt; &#123; document.title = &apos;Hello, Dan&apos;; &#125;;const oldDeps = [&apos;Dan&apos;];const newEffect = () =&gt; &#123; document.title = &apos;Hello, Dan&apos;; &#125;;const newDeps = [&apos;Dan&apos;];å³ä½¿ä¾èµ–æ•°ç»„ä¸­åªæœ‰ä¸€ä¸ªå€¼åœ¨ä¸¤æ¬¡æ¸²æŸ“ä¸­ä¸ä¸€æ ·ï¼Œæˆ‘ä»¬ä¹Ÿä¸èƒ½è·³è¿‡ effect çš„è¿è¡Œã€‚è¦åŒæ­¥æ‰€æœ‰ï¼å…³äºä¾èµ–é¡¹ä¸è¦å¯¹ React æ’’è°å…³äºä¾èµ–é¡¹å¯¹ React æ’’è°ä¼šæœ‰ä¸å¥½çš„ç»“æœã€‚ç›´è§‰ä¸Šï¼Œè¿™å¾ˆå¥½ç†è§£ï¼Œä½†æˆ‘æ›¾çœ‹åˆ°å‡ ä¹æ‰€æœ‰ä¾èµ– class å¿ƒæ™ºæ¨¡å‹ä½¿ç”¨useEffectçš„äººéƒ½è¯•å›¾è¿åè¿™ä¸ªè§„åˆ™ã€‚ï¼ˆæˆ‘åˆšå¼€å§‹ä¹Ÿè¿™ä¹ˆå¹²äº†ï¼ï¼‰1234567891011function SearchResults() &#123; async function fetchData() &#123; &#125; useEffect(() =&gt; &#123; fetchData(); &#125;, []); &#125;(å®˜ç½‘çš„ Hooks FAQ è§£é‡Šäº†åº”è¯¥æ€ä¹ˆåšã€‚ æˆ‘ä»¬åœ¨ä¸‹é¢ä¼šé‡æ–°å›é¡¾è¿™ä¸ªä¾‹å­ã€‚)â€œä½†æˆ‘åªæ˜¯æƒ³åœ¨æŒ‚è½½çš„æ—¶å€™è¿è¡Œå®ƒï¼â€ï¼Œä½ å¯èƒ½ä¼šè¯´ã€‚ç°åœ¨åªéœ€è¦è®°ä½ï¼šå¦‚æœä½ è®¾ç½®äº†ä¾èµ–é¡¹ï¼Œeffect ä¸­ç”¨åˆ°çš„æ‰€æœ‰ç»„ä»¶å†…çš„å€¼éƒ½è¦åŒ…å«åœ¨ä¾èµ–ä¸­ã€‚è¿™åŒ…æ‹¬ propsï¼Œstateï¼Œå‡½æ•° â€” ç»„ä»¶å†…çš„ä»»ä½•ä¸œè¥¿ã€‚æœ‰æ—¶å€™ä½ æ˜¯è¿™æ ·åšäº†ï¼Œä½†å¯èƒ½ä¼šå¼•èµ·ä¸€ä¸ªé—®é¢˜ã€‚æ¯”å¦‚ï¼Œä½ å¯èƒ½ä¼šé‡åˆ°æ— é™è¯·æ±‚çš„é—®é¢˜ï¼Œæˆ–è€… socket è¢«é¢‘ç¹åˆ›å»ºçš„é—®é¢˜ã€‚è§£å†³é—®é¢˜çš„æ–¹æ³•ä¸æ˜¯ç§»é™¤ä¾èµ–é¡¹ã€‚æˆ‘ä»¬ä¼šå¾ˆå¿«äº†è§£å…·ä½“çš„è§£å†³æ–¹æ¡ˆã€‚ä¸è¿‡åœ¨æˆ‘ä»¬æ·±å…¥è§£å†³æ–¹æ¡ˆä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆå°è¯•æ›´å¥½åœ°ç†è§£é—®é¢˜ã€‚å¦‚æœè®¾ç½®äº†é”™è¯¯çš„ä¾èµ–ä¼šæ€ä¹ˆæ ·å‘¢ï¼Ÿå¦‚æœä¾èµ–é¡¹åŒ…å«äº†æ‰€æœ‰ effect ä¸­ä½¿ç”¨åˆ°çš„å€¼ï¼ŒReact å°±èƒ½çŸ¥é“ä½•æ—¶éœ€è¦è¿è¡Œå®ƒï¼š123useEffect(() =&gt; &#123; document.title = &apos;Hello, &apos; + name;&#125;, [name]);(ä¾èµ–å‘ç”Ÿäº†å˜æ›´ï¼Œæ‰€ä»¥ä¼šé‡æ–°è¿è¡Œ effectã€‚)ä½†æ˜¯å¦‚æœæˆ‘ä»¬å°†[]è®¾ä¸º effect çš„ä¾èµ–ï¼Œæ–°çš„ effect å‡½æ•°ä¸ä¼šè¿è¡Œï¼š123useEffect(() =&gt; &#123; document.title = &apos;Hello, &apos; + name;&#125;, []);(ä¾èµ–æ²¡æœ‰å˜ï¼Œæ‰€ä»¥ä¸ä¼šå†æ¬¡è¿è¡Œ effectã€‚)åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œé—®é¢˜çœ‹èµ·æ¥æ˜¾è€Œæ˜“è§ã€‚ä½†åœ¨æŸäº›æƒ…å†µä¸‹å¦‚æœä½ è„‘å­é‡Œ â€œè·³å‡ºâ€class ç»„ä»¶çš„è§£å†³åŠæ³•ï¼Œä½ çš„ç›´è§‰å¾ˆå¯èƒ½ä¼šæ¬ºéª—ä½ ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬æ¥å†™ä¸€ä¸ªæ¯ç§’é€’å¢çš„è®¡æ•°å™¨ã€‚åœ¨ Class ç»„ä»¶ä¸­ï¼Œæˆ‘ä»¬çš„ç›´è§‰æ˜¯ï¼šâ€œå¼€å¯ä¸€æ¬¡å®šæ—¶å™¨ï¼Œæ¸…é™¤ä¹Ÿæ˜¯ä¸€æ¬¡â€ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªä¾‹å­è¯´æ˜æ€ä¹ˆå®ç°å®ƒã€‚å½“æˆ‘ä»¬ç†æ‰€å½“ç„¶åœ°æŠŠå®ƒç”¨useEffectçš„æ–¹å¼ç¿»è¯‘ï¼Œç›´è§‰ä¸Šæˆ‘ä»¬ä¼šè®¾ç½®ä¾èµ–ä¸º[]ã€‚â€œæˆ‘åªæƒ³è¿è¡Œä¸€æ¬¡ effectâ€ï¼Œå¯¹å—ï¼Ÿ1234567891011function Counter() &#123; const [count, setCount] = useState(0); useEffect(() =&gt; &#123; const id = setInterval(() =&gt; &#123; setCount(count + 1); &#125;, 1000); return () =&gt; clearInterval(id); &#125;, []); return &lt;h1&gt;&#123;count&#125;&lt;/h1&gt;;&#125;ç„¶è€Œï¼Œè¿™ä¸ªä¾‹å­åªä¼šé€’å¢ä¸€æ¬¡ã€‚å¤©äº†å™œã€‚å¦‚æœä½ çš„å¿ƒæ™ºæ¨¡å‹æ˜¯ â€œåªæœ‰å½“æˆ‘æƒ³é‡æ–°è§¦å‘ effect çš„æ—¶å€™æ‰éœ€è¦å»è®¾ç½®ä¾èµ–â€ï¼Œè¿™ä¸ªä¾‹å­å¯èƒ½ä¼šè®©ä½ äº§ç”Ÿå­˜åœ¨å±æœºã€‚ä½ æƒ³è¦è§¦å‘ä¸€æ¬¡å› ä¸ºå®ƒæ˜¯å®šæ—¶å™¨ â€” ä½†ä¸ºä»€ä¹ˆä¼šæœ‰é—®é¢˜ï¼Ÿå¦‚æœä½ çŸ¥é“ä¾èµ–æ˜¯æˆ‘ä»¬ç»™ React çš„æš—ç¤ºï¼Œå‘Šè¯‰å®ƒ effect æ‰€æœ‰éœ€è¦ä½¿ç”¨çš„æ¸²æŸ“ä¸­çš„å€¼ï¼Œä½ å°±ä¸ä¼šåƒæƒŠäº†ã€‚effect ä¸­ä½¿ç”¨äº†countä½†æˆ‘ä»¬æ’’è°è¯´å®ƒæ²¡æœ‰ä¾èµ–ã€‚å¦‚æœæˆ‘ä»¬è¿™æ ·åšè¿Ÿæ—©ä¼šå‡ºå¹ºè›¾å­ã€‚åœ¨ç¬¬ä¸€æ¬¡æ¸²æŸ“ä¸­ï¼Œcountæ˜¯0ã€‚å› æ­¤ï¼ŒsetCount(count + 1)åœ¨ç¬¬ä¸€æ¬¡æ¸²æŸ“ä¸­ç­‰ä»·äºsetCount(0 + 1)ã€‚æ—¢ç„¶æˆ‘ä»¬è®¾ç½®äº†[]ä¾èµ–ï¼Œeffect ä¸ä¼šå†é‡æ–°è¿è¡Œï¼Œå®ƒåé¢æ¯ä¸€ç§’éƒ½ä¼šè°ƒç”¨setCount(0 + 1) ï¼š123456789101112131415161718192021222324252627function Counter() &#123; useEffect( () =&gt; &#123; const id = setInterval(() =&gt; &#123; setCount(0 + 1); &#125;, 1000); return () =&gt; clearInterval(id); &#125;, [] ); &#125;function Counter() &#123; useEffect( () =&gt; &#123; const id = setInterval(() =&gt; &#123; setCount(1 + 1); &#125;, 1000); return () =&gt; clearInterval(id); &#125;, [] ); &#125;æˆ‘ä»¬å¯¹ React æ’’è°è¯´æˆ‘ä»¬çš„ effect ä¸ä¾èµ–ç»„ä»¶å†…çš„ä»»ä½•å€¼ï¼Œå¯å®é™…ä¸Šæˆ‘ä»¬çš„ effect æœ‰ä¾èµ–ï¼æˆ‘ä»¬çš„ effect ä¾èµ–count - å®ƒæ˜¯ç»„ä»¶å†…çš„å€¼ï¼ˆä¸è¿‡åœ¨ effect å¤–é¢å®šä¹‰ï¼‰ï¼š123456const count = useEffect(() =&gt; &#123; const id = setInterval(() =&gt; &#123; setCount(count + 1); &#125;, 1000); return () =&gt; clearInterval(id);&#125;, []);å› æ­¤ï¼Œè®¾ç½®[]ä¸ºä¾èµ–ä¼šå¼•å…¥ä¸€ä¸ª bugã€‚React ä¼šå¯¹æ¯”ä¾èµ–ï¼Œå¹¶ä¸”è·³è¿‡åé¢çš„ effectï¼š(ä¾èµ–æ²¡æœ‰å˜ï¼Œæ‰€ä»¥ä¸ä¼šå†æ¬¡è¿è¡Œ effectã€‚)ç±»ä¼¼äºè¿™æ ·çš„é—®é¢˜æ˜¯å¾ˆéš¾è¢«æƒ³åˆ°çš„ã€‚å› æ­¤ï¼Œæˆ‘é¼“åŠ±ä½ å°†è¯šå®åœ°å‘ŠçŸ¥ effect ä¾èµ–ä½œä¸ºä¸€æ¡ç¡¬æ€§è§„åˆ™ï¼Œå¹¶ä¸”è¦åˆ—å‡ºæ‰€ä»¥ä¾èµ–ã€‚ï¼ˆæˆ‘ä»¬æä¾›äº†ä¸€ä¸ª lint è§„åˆ™å¦‚æœä½ æƒ³åœ¨ä½ çš„å›¢é˜Ÿå†…åšç¡¬æ€§è§„å®šã€‚ï¼‰ä¸¤ç§è¯šå®å‘ŠçŸ¥ä¾èµ–çš„æ–¹æ³•æœ‰ä¸¤ç§è¯šå®å‘ŠçŸ¥ä¾èµ–çš„ç­–ç•¥ã€‚ä½ åº”è¯¥ä»ç¬¬ä¸€ç§å¼€å§‹ï¼Œç„¶ååœ¨éœ€è¦çš„æ—¶å€™åº”ç”¨ç¬¬äºŒç§ã€‚ç¬¬ä¸€ç§ç­–ç•¥æ˜¯åœ¨ä¾èµ–ä¸­åŒ…å«æ‰€æœ‰ effect ä¸­ç”¨åˆ°çš„ç»„ä»¶å†…çš„å€¼ã€‚è®©æˆ‘ä»¬åœ¨ä¾èµ–ä¸­åŒ…å«countï¼š12345useEffect(() =&gt; &#123; const id = setInterval(() =&gt; &#123; setCount(count + 1); &#125;, 1000); return () =&gt; clearInterval(id);&#125;, [count]);ç°åœ¨ä¾èµ–æ•°ç»„æ­£ç¡®äº†ã€‚è™½ç„¶å®ƒå¯èƒ½ä¸æ˜¯å¤ªç†æƒ³ä½†ç¡®å®è§£å†³äº†ä¸Šé¢çš„é—®é¢˜ã€‚ç°åœ¨ï¼Œæ¯æ¬¡countä¿®æ”¹éƒ½ä¼šé‡æ–°è¿è¡Œ effectï¼Œå¹¶ä¸”å®šæ—¶å™¨ä¸­çš„setCount(count + 1)ä¼šæ­£ç¡®å¼•ç”¨æŸæ¬¡æ¸²æŸ“ä¸­çš„ countå€¼ï¼š1234567891011121314151617181920212223242526function Counter() &#123; useEffect( () =&gt; &#123; const id = setInterval(() =&gt; &#123; setCount(0 + 1); &#125;, 1000); return () =&gt; clearInterval(id); &#125;, [0] ); &#125;function Counter() &#123; useEffect( () =&gt; &#123; const id = setInterval(() =&gt; &#123; setCount(1 + 1); &#125;, 1000); return () =&gt; clearInterval(id); &#125;, [1] ); &#125;è¿™èƒ½è§£å†³é—®é¢˜ä½†æ˜¯æˆ‘ä»¬çš„å®šæ—¶å™¨ä¼šåœ¨æ¯ä¸€æ¬¡countæ”¹å˜åæ¸…é™¤å’Œé‡æ–°è®¾å®šã€‚è¿™åº”è¯¥ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ç»“æœï¼š(ä¾èµ–å‘ç”Ÿäº†å˜æ›´ï¼Œæ‰€ä»¥ä¼šé‡æ–°è¿è¡Œ effectã€‚)ç¬¬äºŒç§ç­–ç•¥æ˜¯ä¿®æ”¹ effect å†…éƒ¨çš„ä»£ç ä»¥ç¡®ä¿å®ƒåŒ…å«çš„å€¼åªä¼šåœ¨éœ€è¦çš„æ—¶å€™å‘ç”Ÿå˜æ›´ã€‚æˆ‘ä»¬ä¸æƒ³å‘ŠçŸ¥é”™è¯¯çš„ä¾èµ– - æˆ‘ä»¬åªæ˜¯ä¿®æ”¹ effect ä½¿å¾—ä¾èµ–æ›´å°‘ã€‚è®©æˆ‘ä»¬æ¥çœ‹ä¸€äº›ç§»é™¤ä¾èµ–çš„å¸¸ç”¨æŠ€å·§ã€‚è®© Effects è‡ªç»™è‡ªè¶³æˆ‘ä»¬æƒ³å»æ‰ effect çš„countä¾èµ–ã€‚12345useEffect(() =&gt; &#123; const id = setInterval(() =&gt; &#123; setCount(count + 1); &#125;, 1000); return () =&gt; clearInterval(id);&#125;, [count]);ä¸ºäº†å®ç°è¿™ä¸ªç›®çš„ï¼Œæˆ‘ä»¬éœ€è¦é—®è‡ªå·±ä¸€ä¸ªé—®é¢˜ï¼šæˆ‘ä»¬ä¸ºä»€ä¹ˆè¦ç”¨countï¼Ÿå¯ä»¥çœ‹åˆ°æˆ‘ä»¬åªåœ¨setCountè°ƒç”¨ä¸­ç”¨åˆ°äº†countã€‚åœ¨è¿™ä¸ªåœºæ™¯ä¸­ï¼Œæˆ‘ä»¬å…¶å®å¹¶ä¸éœ€è¦åœ¨ effect ä¸­ä½¿ç”¨countã€‚å½“æˆ‘ä»¬æƒ³è¦æ ¹æ®å‰ä¸€ä¸ªçŠ¶æ€æ›´æ–°çŠ¶æ€çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨setStateçš„å‡½æ•°å½¢å¼ï¼š12345useEffect(() =&gt; &#123; const id = setInterval(() =&gt; &#123; setCount(c =&gt; c + 1); &#125;, 1000); return () =&gt; clearInterval(id);&#125;, []);æˆ‘å–œæ¬¢æŠŠç±»ä¼¼è¿™ç§æƒ…å†µç§°ä¸º â€œé”™è¯¯çš„ä¾èµ–â€ã€‚æ˜¯çš„ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨ effect ä¸­å†™äº†setCount(count + 1)æ‰€ä»¥countæ˜¯ä¸€ä¸ªå¿…éœ€çš„ä¾èµ–ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬çœŸæ­£æƒ³è¦çš„æ˜¯æŠŠcountè½¬æ¢ä¸ºcount+1ï¼Œç„¶åè¿”å›ç»™ Reactã€‚å¯æ˜¯ React å…¶å®å·²ç»çŸ¥é“å½“å‰çš„countã€‚æˆ‘ä»¬éœ€è¦å‘ŠçŸ¥ React çš„ä»…ä»…æ˜¯å»é€’å¢çŠ¶æ€ - ä¸ç®¡å®ƒç°åœ¨å…·ä½“æ˜¯ä»€ä¹ˆå€¼ã€‚è¿™æ­£æ˜¯setCount(c =&gt; c + 1)åšçš„äº‹æƒ…ã€‚ä½ å¯ä»¥è®¤ä¸ºå®ƒæ˜¯åœ¨ç»™ Reactâ€œå‘é€æŒ‡ä»¤â€å‘ŠçŸ¥å¦‚ä½•æ›´æ–°çŠ¶æ€ã€‚è¿™ç§ â€œæ›´æ–°å½¢å¼â€ åœ¨å…¶ä»–æƒ…å†µä¸‹ä¹Ÿæœ‰å¸®åŠ©ï¼Œæ¯”å¦‚ä½ éœ€è¦æ‰¹é‡æ›´æ–°ã€‚æ³¨æ„æˆ‘ä»¬åšåˆ°äº†ç§»é™¤ä¾èµ–ï¼Œå¹¶ä¸”æ²¡æœ‰æ’’è°ã€‚æˆ‘ä»¬çš„ effect ä¸å†è¯»å–æ¸²æŸ“ä¸­çš„countå€¼ã€‚(ä¾èµ–æ²¡æœ‰å˜ï¼Œæ‰€ä»¥ä¸ä¼šå†æ¬¡è¿è¡Œ effectã€‚)ä½ å¯ä»¥è‡ªå·± è¯•è¯•ã€‚å°½ç®¡ effect åªè¿è¡Œäº†ä¸€æ¬¡ï¼Œç¬¬ä¸€æ¬¡æ¸²æŸ“ä¸­çš„å®šæ—¶å™¨å›è°ƒå‡½æ•°å¯ä»¥å®Œç¾åœ°åœ¨æ¯æ¬¡è§¦å‘çš„æ—¶å€™ç»™ React å‘é€c =&gt; c + 1æ›´æ–°æŒ‡ä»¤ã€‚å®ƒä¸å†éœ€è¦çŸ¥é“å½“å‰çš„countå€¼ã€‚å› ä¸º React å·²ç»çŸ¥é“äº†ã€‚å‡½æ•°å¼æ›´æ–° å’Œ Google Docsè¿˜è®°å¾—æˆ‘ä»¬è¯´è¿‡åŒæ­¥æ‰æ˜¯ç†è§£ effects çš„å¿ƒæ™ºæ¨¡å‹å—ï¼ŸåŒæ­¥çš„ä¸€ä¸ªæœ‰è¶£åœ°æ–¹åœ¨äºä½ é€šå¸¸æƒ³è¦æŠŠåŒæ­¥çš„ â€œä¿¡æ¯â€ å’ŒçŠ¶æ€è§£è€¦ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå½“ä½ åœ¨ Google Docs ç¼–è¾‘æ–‡æ¡£çš„æ—¶å€™ï¼ŒGoogle å¹¶ä¸ä¼šæŠŠæ•´ç¯‡æ–‡ç« å‘é€ç»™æœåŠ¡å™¨ã€‚é‚£æ ·åšä¼šéå¸¸ä½æ•ˆã€‚ç›¸åçš„ï¼Œå®ƒåªæ˜¯æŠŠä½ çš„ä¿®æ”¹ä»¥ä¸€ç§å½¢å¼å‘é€ç»™æœåŠ¡ç«¯ã€‚è™½ç„¶æˆ‘ä»¬ effect çš„æƒ…å†µä¸å°½ç›¸åŒï¼Œä½†å¯ä»¥åº”ç”¨ç±»ä¼¼çš„æ€æƒ³ã€‚åªåœ¨ effects ä¸­ä¼ é€’æœ€å°çš„ä¿¡æ¯ä¼šå¾ˆæœ‰å¸®åŠ©ã€‚ç±»ä¼¼äºsetCount(c =&gt; c + 1)è¿™æ ·çš„æ›´æ–°å½¢å¼æ¯”setCount(count + 1)ä¼ é€’äº†æ›´å°‘çš„ä¿¡æ¯ï¼Œå› ä¸ºå®ƒä¸å†è¢«å½“å‰çš„ count å€¼ â€œæ±¡æŸ“â€ã€‚å®ƒåªæ˜¯è¡¨è¾¾äº†ä¸€ç§è¡Œä¸ºï¼ˆâ€œé€’å¢â€ï¼‰ã€‚â€œThinking in Reactâ€ ä¹Ÿè®¨è®ºäº†å¦‚ä½•æ‰¾åˆ°æœ€å°çŠ¶æ€ã€‚åŸåˆ™æ˜¯ç±»ä¼¼çš„ï¼Œåªä¸è¿‡ç°åœ¨å…³æ³¨çš„æ˜¯å¦‚ä½•æ›´æ–°ã€‚è¡¨è¾¾_æ„å›¾_ï¼ˆè€Œä¸æ˜¯ç»“æœï¼‰å’Œ Google Docs å¦‚ä½•å¤„ç†å…±åŒç¼–è¾‘å¼‚æ›²åŒå·¥ã€‚è™½ç„¶è¿™ä¸ªç±»æ¯”ç•¥å¾®å»¶ä¼¸äº†ä¸€ç‚¹ï¼Œå‡½æ•°å¼æ›´æ–°åœ¨ React ä¸­æ‰®æ¼”äº†ç±»ä¼¼çš„è§’è‰²ã€‚å®ƒä»¬ç¡®ä¿èƒ½ä»¥æ‰¹é‡åœ°å’Œå¯é¢„æµ‹çš„æ–¹å¼æ¥å¤„ç†å„ç§æºå¤´ï¼ˆäº‹ä»¶å¤„ç†å‡½æ•°ï¼Œeffect ä¸­çš„è®¢é˜…ï¼Œç­‰ç­‰ï¼‰çš„çŠ¶æ€æ›´æ–°ã€‚ç„¶è€Œï¼Œå³ä½¿æ˜¯setCount(c =&gt; c + 1)ä¹Ÿå¹¶ä¸å®Œç¾ã€‚å®ƒçœ‹èµ·æ¥æœ‰ç‚¹æ€ªï¼Œå¹¶ä¸”éå¸¸å—é™äºå®ƒèƒ½åšçš„äº‹ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœæˆ‘ä»¬æœ‰ä¸¤ä¸ªäº’ç›¸ä¾èµ–çš„çŠ¶æ€ï¼Œæˆ–è€…æˆ‘ä»¬æƒ³åŸºäºä¸€ä¸ª prop æ¥è®¡ç®—ä¸‹ä¸€æ¬¡çš„ stateï¼Œå®ƒå¹¶ä¸èƒ½åšåˆ°ã€‚å¹¸è¿çš„æ˜¯ï¼Œ setCount(c =&gt; c + 1)æœ‰ä¸€ä¸ªæ›´å¼ºå¤§çš„å§å¦¹æ¨¡å¼ï¼Œå®ƒçš„åå­—å«useReducerã€‚è§£è€¦æ¥è‡ª Actions çš„æ›´æ–°æˆ‘ä»¬æ¥ä¿®æ”¹ä¸Šé¢çš„ä¾‹å­è®©å®ƒåŒ…å«ä¸¤ä¸ªçŠ¶æ€ï¼šcount å’Œ stepã€‚æˆ‘ä»¬çš„å®šæ—¶å™¨ä¼šæ¯æ¬¡åœ¨ count ä¸Šå¢åŠ ä¸€ä¸ªstepå€¼ï¼š12345678910111213141516function Counter() &#123; const [count, setCount] = useState(0); const [step, setStep] = useState(1); useEffect(() =&gt; &#123; const id = setInterval(() =&gt; &#123; setCount(c =&gt; c + step); &#125;, 1000); return () =&gt; clearInterval(id); &#125;, [step]); return ( &lt;&gt; &lt;h1&gt;&#123;count&#125;&lt;/h1&gt; &lt;input value=&#123;step&#125; onChange=&#123;e =&gt; setStep(Number(e.target.value))&#125; /&gt; &lt;/&gt; );&#125;(è¿™é‡Œæ˜¯ demo.)æ³¨æ„æˆ‘ä»¬æ²¡æœ‰æ’’è°ã€‚æ—¢ç„¶æˆ‘ä»¬åœ¨ effect é‡Œä½¿ç”¨äº†stepï¼Œæˆ‘ä»¬å°±æŠŠå®ƒåŠ åˆ°ä¾èµ–é‡Œã€‚æ‰€ä»¥è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä»£ç èƒ½è¿è¡Œæ­£ç¡®ã€‚è¿™ä¸ªä¾‹å­ç›®å‰çš„è¡Œä¸ºæ˜¯ä¿®æ”¹stepä¼šé‡å¯å®šæ—¶å™¨ - å› ä¸ºå®ƒæ˜¯ä¾èµ–é¡¹ä¹‹ä¸€ã€‚åœ¨å¤§å¤šæ•°åœºæ™¯ä¸‹ï¼Œè¿™æ­£æ˜¯ä½ æ‰€éœ€è¦çš„ã€‚æ¸…é™¤ä¸Šä¸€æ¬¡çš„ effect ç„¶åé‡æ–°è¿è¡Œæ–°çš„ effect å¹¶æ²¡æœ‰ä»»ä½•é”™ã€‚é™¤éæˆ‘ä»¬æœ‰å¾ˆå¥½çš„ç†ç”±ï¼Œæˆ‘ä»¬ä¸åº”è¯¥æ”¹å˜è¿™ä¸ªé»˜è®¤è¡Œä¸ºã€‚ä¸è¿‡ï¼Œå‡å¦‚æˆ‘ä»¬ä¸æƒ³åœ¨stepæ”¹å˜åé‡å¯å®šæ—¶å™¨ï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•ä» effect ä¸­ç§»é™¤å¯¹stepçš„ä¾èµ–å‘¢ï¼Ÿå½“ä½ æƒ³æ›´æ–°ä¸€ä¸ªçŠ¶æ€ï¼Œå¹¶ä¸”è¿™ä¸ªçŠ¶æ€æ›´æ–°ä¾èµ–äºå¦ä¸€ä¸ªçŠ¶æ€çš„å€¼æ—¶ï¼Œä½ å¯èƒ½éœ€è¦ç”¨useReducerå»æ›¿æ¢å®ƒä»¬ã€‚å½“ä½ å†™ç±»ä¼¼setSomething(something =&gt; ...)è¿™ç§ä»£ç çš„æ—¶å€™ï¼Œä¹Ÿè®¸å°±æ˜¯è€ƒè™‘ä½¿ç”¨ reducer çš„å¥‘æœºã€‚reducer å¯ä»¥è®©ä½ æŠŠç»„ä»¶å†…å‘ç”Ÿäº†ä»€ä¹ˆ (actions) å’ŒçŠ¶æ€å¦‚ä½•å“åº”å¹¶æ›´æ–°åˆ†å¼€è¡¨è¿°ã€‚æˆ‘ä»¬ç”¨ä¸€ä¸ªdispatchä¾èµ–å»æ›¿æ¢ effect çš„stepä¾èµ–ï¼š1234567const [state, dispatch] = useReducer(reducer, initialState);const &#123; count, step &#125; = state;useEffect(() =&gt; &#123; const id = setInterval(() =&gt; &#123; dispatch(&#123; type: &apos;tick&apos; &#125;); &#125;, 1000); return () =&gt; clearInterval(id);&#125;, [dispatch]);(æŸ¥çœ‹ demoã€‚)ä½ å¯èƒ½ä¼šé—®ï¼šâ€œè¿™æ€ä¹ˆå°±æ›´å¥½äº†ï¼Ÿâ€ ç­”æ¡ˆæ˜¯ React ä¼šä¿è¯dispatchåœ¨ç»„ä»¶çš„å£°æ˜å‘¨æœŸå†…ä¿æŒä¸å˜ã€‚æ‰€ä»¥ä¸Šé¢ä¾‹å­ä¸­ä¸å†éœ€è¦é‡æ–°è®¢é˜…å®šæ—¶å™¨ã€‚æˆ‘ä»¬è§£å†³äº†é—®é¢˜!ï¼ˆä½ å¯ä»¥ä»ä¾èµ–ä¸­å»é™¤dispatch, setState, å’ŒuseRefåŒ…è£¹çš„å€¼å› ä¸º React ä¼šç¡®ä¿å®ƒä»¬æ˜¯é™æ€çš„ã€‚ä¸è¿‡ä½ è®¾ç½®äº†å®ƒä»¬ä½œä¸ºä¾èµ–ä¹Ÿæ²¡ä»€ä¹ˆé—®é¢˜ã€‚ï¼‰ç›¸æ¯”äºç›´æ¥åœ¨ effect é‡Œé¢è¯»å–çŠ¶æ€ï¼Œå®ƒ dispatch äº†ä¸€ä¸ª action æ¥æè¿°å‘ç”Ÿäº†ä»€ä¹ˆã€‚è¿™ä½¿å¾—æˆ‘ä»¬çš„ effect å’ŒstepçŠ¶æ€è§£è€¦ã€‚æˆ‘ä»¬çš„ effect ä¸å†å…³å¿ƒæ€ä¹ˆæ›´æ–°çŠ¶æ€ï¼Œå®ƒåªè´Ÿè´£å‘Šè¯‰æˆ‘ä»¬å‘ç”Ÿäº†ä»€ä¹ˆã€‚æ›´æ–°çš„é€»è¾‘å…¨éƒ½äº¤ç”± reducer å»ç»Ÿä¸€å¤„ç†:12345678910111213const initialState = &#123; count: 0, step: 1,&#125;;function reducer(state, action) &#123; const &#123; count, step &#125; = state; if (action.type === &apos;tick&apos;) &#123; return &#123; count: count + step, step &#125;; &#125; else if (action.type === &apos;step&apos;) &#123; return &#123; count, step: action.step &#125;; &#125; else &#123; throw new Error(); &#125;&#125;(è¿™é‡Œæ˜¯ demo å¦‚æœä½ ä¹‹å‰é”™è¿‡äº†ã€‚)ä¸ºä»€ä¹ˆ useReducer æ˜¯ Hooks çš„ä½œå¼Šæ¨¡å¼æˆ‘ä»¬å·²ç»å­¦ä¹ åˆ°å¦‚ä½•ç§»é™¤ effect çš„ä¾èµ–ï¼Œä¸ç®¡çŠ¶æ€æ›´æ–°æ˜¯ä¾èµ–ä¸Šä¸€ä¸ªçŠ¶æ€è¿˜æ˜¯ä¾èµ–å¦ä¸€ä¸ªçŠ¶æ€ã€‚ä½†å‡å¦‚æˆ‘ä»¬éœ€è¦ä¾èµ– props å»è®¡ç®—ä¸‹ä¸€ä¸ªçŠ¶æ€å‘¢ï¼Ÿä¸¾ä¸ªä¾‹å­ï¼Œä¹Ÿè®¸æˆ‘ä»¬çš„ API æ˜¯&lt;Counter step={1} /&gt;ã€‚ç¡®å®šçš„æ˜¯ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ²¡æ³•é¿å…ä¾èµ–props.step ã€‚æ˜¯å—ï¼Ÿå®é™…ä¸Šï¼Œ æˆ‘ä»¬å¯ä»¥é¿å…ï¼æˆ‘ä»¬å¯ä»¥æŠŠ reducer å‡½æ•°æ”¾åˆ°ç»„ä»¶å†…å»è¯»å– propsï¼š123456789101112131415161718function Counter(&#123; step &#125;) &#123; const [count, dispatch] = useReducer(reducer, 0); function reducer(state, action) &#123; if (action.type === &apos;tick&apos;) &#123; return state + step; &#125; else &#123; throw new Error(); &#125; &#125; useEffect(() =&gt; &#123; const id = setInterval(() =&gt; &#123; dispatch(&#123; type: &apos;tick&apos; &#125;); &#125;, 1000); return () =&gt; clearInterval(id); &#125;, [dispatch]); return &lt;h1&gt;&#123;count&#125;&lt;/h1&gt;;&#125;è¿™ç§æ¨¡å¼ä¼šä½¿ä¸€äº›ä¼˜åŒ–å¤±æ•ˆï¼Œæ‰€ä»¥ä½ åº”è¯¥é¿å…æ»¥ç”¨å®ƒï¼Œä¸è¿‡å¦‚æœä½ éœ€è¦ä½ å®Œå…¨å¯ä»¥åœ¨ reducer é‡Œé¢è®¿é—® propsã€‚ï¼ˆè¿™é‡Œæ˜¯ demoã€‚ï¼‰å³ä½¿æ˜¯åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒReact ä¹Ÿä¿è¯dispatchåœ¨æ¯æ¬¡æ¸²æŸ“ä¸­éƒ½æ˜¯ä¸€æ ·çš„ã€‚ æ‰€ä»¥ä½ å¯ä»¥åœ¨ä¾èµ–ä¸­å»æ‰å®ƒã€‚å®ƒä¸ä¼šå¼•èµ· effect ä¸å¿…è¦çš„é‡å¤æ‰§è¡Œã€‚ä½ å¯èƒ½ä¼šç–‘æƒ‘ï¼šè¿™æ€ä¹ˆå¯èƒ½ï¼Ÿåœ¨ä¹‹å‰æ¸²æŸ“ä¸­è°ƒç”¨çš„ reducer æ€ä¹ˆ â€œçŸ¥é“â€ æ–°çš„ propsï¼Ÿç­”æ¡ˆæ˜¯å½“ä½ dispatchçš„æ—¶å€™ï¼ŒReact åªæ˜¯è®°ä½äº† action - å®ƒä¼šåœ¨ä¸‹ä¸€æ¬¡æ¸²æŸ“ä¸­å†æ¬¡è°ƒç”¨ reducerã€‚åœ¨é‚£ä¸ªæ—¶å€™ï¼Œæ–°çš„ props å°±å¯ä»¥è¢«è®¿é—®åˆ°ï¼Œè€Œä¸” reducer è°ƒç”¨ä¹Ÿä¸æ˜¯åœ¨ effect é‡Œã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘å€¾å‘è®¤ä¸ºuseReduceræ˜¯ Hooks çš„ â€œä½œå¼Šæ¨¡å¼â€ã€‚å®ƒå¯ä»¥æŠŠæ›´æ–°é€»è¾‘å’Œæè¿°å‘ç”Ÿäº†ä»€ä¹ˆåˆ†å¼€ã€‚ç»“æœæ˜¯ï¼Œè¿™å¯ä»¥å¸®åŠ©æˆ‘ç§»é™¤ä¸å¿…éœ€çš„ä¾èµ–ï¼Œé¿å…ä¸å¿…è¦çš„ effect è°ƒç”¨ã€‚æŠŠå‡½æ•°ç§»åˆ° Effects é‡Œä¸€ä¸ªå…¸å‹çš„è¯¯è§£æ˜¯è®¤ä¸ºå‡½æ•°ä¸åº”è¯¥æˆä¸ºä¾èµ–ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œä¸‹é¢çš„ä»£ç çœ‹ä¸Šå»å¯ä»¥è¿è¡Œæ­£å¸¸ï¼š12345678910111213function SearchResults() &#123; const [data, setData] = useState(&#123; hits: [] &#125;); async function fetchData() &#123; const result = await axios( &apos;https://hn.algolia.com/api/v1/search?query=react&apos;, ); setData(result.data); &#125; useEffect(() =&gt; &#123; fetchData(); &#125;, []);(è¿™ä¸ªä¾‹å­ æ”¹ç¼–è‡ª Robin Wieruch è¿™ç¯‡å¾ˆæ£’çš„æ–‡ç«  â€” ç‚¹å‡»æŸ¥çœ‹ï¼)éœ€è¦æ˜ç¡®çš„æ˜¯ï¼Œä¸Šé¢çš„ä»£ç å¯ä»¥æ­£å¸¸å·¥ä½œã€‚ä½†è¿™æ ·åšåœ¨ç»„ä»¶æ—¥æ¸å¤æ‚çš„è¿­ä»£è¿‡ç¨‹ä¸­æˆ‘ä»¬å¾ˆéš¾ç¡®ä¿å®ƒåœ¨å„ç§æƒ…å†µä¸‹è¿˜èƒ½æ­£å¸¸è¿è¡Œã€‚æƒ³è±¡ä¸€ä¸‹æˆ‘ä»¬çš„ä»£ç åšä¸‹é¢è¿™æ ·çš„åˆ†ç¦»ï¼Œå¹¶ä¸”æ¯ä¸€ä¸ªå‡½æ•°çš„ä½“é‡æ˜¯ç°åœ¨çš„äº”å€ï¼š123456789101112131415161718function SearchResults() &#123; function getFetchUrl() &#123; return &apos;https://hn.algolia.com/api/v1/search?query=react&apos;; &#125; async function fetchData() &#123; const result = await axios(getFetchUrl()); setData(result.data); &#125; useEffect(() =&gt; &#123; fetchData(); &#125;, []); &#125;ç„¶åæˆ‘ä»¬åœ¨æŸäº›å‡½æ•°å†…ä½¿ç”¨äº†æŸäº› state æˆ–è€… propï¼š12345678910111213141516171819function SearchResults() &#123; const [query, setQuery] = useState(&apos;react&apos;); function getFetchUrl() &#123; return &apos;https://hn.algolia.com/api/v1/search?query=&apos; + query; &#125; async function fetchData() &#123; const result = await axios(getFetchUrl()); setData(result.data); &#125; useEffect(() =&gt; &#123; fetchData(); &#125;, []); &#125;å¦‚æœæˆ‘ä»¬å¿˜è®°å»æ›´æ–°ä½¿ç”¨è¿™äº›å‡½æ•°ï¼ˆå¾ˆå¯èƒ½é€šè¿‡å…¶ä»–å‡½æ•°è°ƒç”¨ï¼‰çš„ effects çš„ä¾èµ–ï¼Œæˆ‘ä»¬çš„ effects å°±ä¸ä¼šåŒæ­¥ props å’Œ state å¸¦æ¥çš„å˜æ›´ã€‚è¿™å½“ç„¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚å¹¸è¿çš„æ˜¯ï¼Œå¯¹äºè¿™ä¸ªé—®é¢˜æœ‰ä¸€ä¸ªç®€å•çš„è§£å†³æ–¹æ¡ˆã€‚å¦‚æœæŸäº›å‡½æ•°ä»…åœ¨ effect ä¸­è°ƒç”¨ï¼Œä½ å¯ä»¥æŠŠå®ƒä»¬çš„å®šä¹‰ç§»åˆ° effect ä¸­ï¼š12345678function SearchResults() &#123; useEffect(() =&gt; &#123; function getFetchUrl() &#123; return &apos;https://hn.algolia.com/api/v1/search?query=react&apos;; &#125; async function fetchData() &#123; const result = await axios(getFetchUrl()); setData(result.data); &#125; fetchData(); &#125;, []); &#125;(è¿™é‡Œæ˜¯ demo.)è¿™ä¹ˆåšæœ‰ä»€ä¹ˆå¥½å¤„å‘¢ï¼Ÿæˆ‘ä»¬ä¸å†éœ€è¦å»è€ƒè™‘è¿™äº› â€œé—´æ¥ä¾èµ–â€ã€‚æˆ‘ä»¬çš„ä¾èµ–æ•°ç»„ä¹Ÿä¸å†æ’’è°ï¼šåœ¨æˆ‘ä»¬çš„ effect ä¸­ç¡®å®æ²¡æœ‰å†ä½¿ç”¨ç»„ä»¶èŒƒå›´å†…çš„ä»»ä½•ä¸œè¥¿ã€‚å¦‚æœæˆ‘ä»¬åé¢ä¿®æ”¹ getFetchUrlå»ä½¿ç”¨queryçŠ¶æ€ï¼Œæˆ‘ä»¬æ›´å¯èƒ½ä¼šæ„è¯†åˆ°æˆ‘ä»¬æ­£åœ¨ effect é‡Œé¢ç¼–è¾‘å®ƒ - å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦æŠŠqueryæ·»åŠ åˆ° effect çš„ä¾èµ–é‡Œï¼š12345678910111213141516function SearchResults() &#123; const [query, setQuery] = useState(&apos;react&apos;); useEffect(() =&gt; &#123; function getFetchUrl() &#123; return &apos;https://hn.algolia.com/api/v1/search?query=&apos; + query; &#125; async function fetchData() &#123; const result = await axios(getFetchUrl()); setData(result.data); &#125; fetchData(); &#125;, [query]); &#125;(è¿™é‡Œæ˜¯ demo.)æ·»åŠ è¿™ä¸ªä¾èµ–ï¼Œæˆ‘ä»¬ä¸ä»…ä»…æ˜¯åœ¨ â€œå–æ‚¦ Reactâ€ã€‚åœ¨ query æ”¹å˜åå»é‡æ–°è¯·æ±‚æ•°æ®æ˜¯åˆç†çš„ã€‚useEffectçš„è®¾è®¡æ„å›¾å°±æ˜¯è¦å¼ºè¿«ä½ å…³æ³¨æ•°æ®æµçš„æ”¹å˜ï¼Œç„¶åå†³å®šæˆ‘ä»¬çš„ effects è¯¥å¦‚ä½•å’Œå®ƒåŒæ­¥ - è€Œä¸æ˜¯å¿½è§†å®ƒç›´åˆ°æˆ‘ä»¬çš„ç”¨æˆ·é‡åˆ°äº† bugã€‚æ„Ÿè°¢eslint-plugin-react-hooks æ’ä»¶çš„exhaustive-depslint è§„åˆ™ï¼Œå®ƒä¼šåœ¨ä½ ç¼–ç çš„æ—¶å€™å°±åˆ†æ effects å¹¶ä¸”æä¾›å¯èƒ½é—æ¼ä¾èµ–çš„å»ºè®®ã€‚æ¢å¥è¯è¯´ï¼Œæœºå™¨ä¼šå‘Šè¯‰ä½ ç»„ä»¶ä¸­å“ªäº›æ•°æ®æµå˜æ›´æ²¡æœ‰è¢«æ­£ç¡®åœ°å¤„ç†ã€‚éå¸¸æ£’ã€‚ä½†æˆ‘ä¸èƒ½æŠŠè¿™ä¸ªå‡½æ•°æ”¾åˆ° Effect é‡Œæœ‰æ—¶å€™ä½ å¯èƒ½ä¸æƒ³æŠŠå‡½æ•°ç§»å…¥ effect é‡Œã€‚æ¯”å¦‚ï¼Œç»„ä»¶å†…æœ‰å‡ ä¸ª effect ä½¿ç”¨äº†ç›¸åŒçš„å‡½æ•°ï¼Œä½ ä¸æƒ³åœ¨æ¯ä¸ª effect é‡Œå¤åˆ¶é»è´´ä¸€éè¿™ä¸ªé€»è¾‘ã€‚ä¹Ÿæˆ–è®¸è¿™ä¸ªå‡½æ•°æ˜¯ä¸€ä¸ª propã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ä½ åº”è¯¥å¿½ç•¥å¯¹å‡½æ•°çš„ä¾èµ–å—ï¼Ÿæˆ‘ä¸è¿™ä¹ˆè®¤ä¸ºã€‚å†æ¬¡å¼ºè°ƒï¼Œefffects ä¸åº”è¯¥å¯¹å®ƒçš„ä¾èµ–æ’’è°ã€‚é€šå¸¸æˆ‘ä»¬è¿˜æœ‰æ›´å¥½çš„è§£å†³åŠæ³•ã€‚ä¸€ä¸ªå¸¸è§çš„è¯¯è§£æ˜¯ï¼Œâ€œå‡½æ•°ä»æ¥ä¸ä¼šæ”¹å˜â€ã€‚ä½†æ˜¯è¿™ç¯‡æ–‡ç« ä½ è¯»åˆ°ç°åœ¨ï¼Œä½ çŸ¥é“è¿™æ˜¾ç„¶ä¸æ˜¯äº‹å®ã€‚å®é™…ä¸Šï¼Œåœ¨ç»„ä»¶å†…å®šä¹‰çš„å‡½æ•°æ¯ä¸€æ¬¡æ¸²æŸ“éƒ½åœ¨å˜ã€‚å‡½æ•°æ¯æ¬¡æ¸²æŸ“éƒ½ä¼šæ”¹å˜è¿™ä¸ªäº‹å®æœ¬èº«å°±æ˜¯ä¸ªé—®é¢˜ã€‚ æ¯”å¦‚æœ‰ä¸¤ä¸ª effects ä¼šè°ƒç”¨ getFetchUrl:1234567891011121314151617function SearchResults() &#123; function getFetchUrl(query) &#123; return &apos;https://hn.algolia.com/api/v1/search?query=&apos; + query; &#125; useEffect(() =&gt; &#123; const url = getFetchUrl(&apos;react&apos;); &#125;, []); useEffect(() =&gt; &#123; const url = getFetchUrl(&apos;redux&apos;); &#125;, []); &#125;åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œä½ å¯èƒ½ä¸æƒ³æŠŠgetFetchUrl ç§»åˆ° effects ä¸­ï¼Œå› ä¸ºä½ æƒ³å¤ç”¨é€»è¾‘ã€‚å¦ä¸€æ–¹é¢ï¼Œå¦‚æœä½ å¯¹ä¾èµ–å¾ˆ â€œè¯šå®â€ï¼Œä½ å¯èƒ½ä¼šæ‰åˆ°é™·é˜±é‡Œã€‚æˆ‘ä»¬çš„ä¸¤ä¸ª effects éƒ½ä¾èµ–getFetchUrlï¼Œè€Œå®ƒæ¯æ¬¡æ¸²æŸ“éƒ½ä¸åŒï¼Œæ‰€ä»¥æˆ‘ä»¬çš„ä¾èµ–æ•°ç»„ä¼šå˜å¾—æ— ç”¨ï¼š1234567891011121314function SearchResults() &#123; function getFetchUrl(query) &#123; return &apos;https://hn.algolia.com/api/v1/search?query=&apos; + query; &#125; useEffect(() =&gt; &#123; const url = getFetchUrl(&apos;react&apos;); &#125;, [getFetchUrl]); useEffect(() =&gt; &#123; const url = getFetchUrl(&apos;redux&apos;); &#125;, [getFetchUrl]); &#125;ä¸€ä¸ªå¯èƒ½çš„è§£å†³åŠæ³•æ˜¯æŠŠgetFetchUrlä»ä¾èµ–ä¸­å»æ‰ã€‚ä½†æ˜¯ï¼Œæˆ‘ä¸è®¤ä¸ºè¿™æ˜¯å¥½çš„è§£å†³æ–¹å¼ã€‚è¿™ä¼šä½¿æˆ‘ä»¬åé¢å¯¹æ•°æ®æµçš„æ”¹å˜å¾ˆéš¾è¢«å‘ç°ä»è€Œå¿˜è®°å»å¤„ç†ã€‚è¿™ä¼šå¯¼è‡´ç±»ä¼¼äºä¸Šé¢ â€œå®šæ—¶å™¨ä¸æ›´æ–°å€¼â€ çš„é—®é¢˜ã€‚ç›¸åçš„ï¼Œæˆ‘ä»¬æœ‰ä¸¤ä¸ªæ›´ç®€å•çš„è§£å†³åŠæ³•ã€‚ç¬¬ä¸€ä¸ªï¼Œ å¦‚æœä¸€ä¸ªå‡½æ•°æ²¡æœ‰ä½¿ç”¨ç»„ä»¶å†…çš„ä»»ä½•å€¼ï¼Œä½ åº”è¯¥æŠŠå®ƒæåˆ°ç»„ä»¶å¤–é¢å»å®šä¹‰ï¼Œç„¶åå°±å¯ä»¥è‡ªç”±åœ°åœ¨ effects ä¸­ä½¿ç”¨ï¼š1234567891011121314function getFetchUrl(query) &#123; return &apos;https://hn.algolia.com/api/v1/search?query=&apos; + query;&#125;function SearchResults() &#123; useEffect(() =&gt; &#123; const url = getFetchUrl(&apos;react&apos;); &#125;, []); useEffect(() =&gt; &#123; const url = getFetchUrl(&apos;redux&apos;); &#125;, []); &#125;ä½ ä¸å†éœ€è¦æŠŠå®ƒè®¾ä¸ºä¾èµ–ï¼Œå› ä¸ºå®ƒä»¬ä¸åœ¨æ¸²æŸ“èŒƒå›´å†…ï¼Œå› æ­¤ä¸ä¼šè¢«æ•°æ®æµå½±å“ã€‚å®ƒä¸å¯èƒ½çªç„¶æ„å¤–åœ°ä¾èµ–äº props æˆ– stateã€‚æˆ–è€…ï¼Œ ä½ ä¹Ÿå¯ä»¥æŠŠå®ƒåŒ…è£…æˆ useCallback Hook:1234567891011121314function SearchResults() &#123; const getFetchUrl = useCallback((query) =&gt; &#123; return &apos;https://hn.algolia.com/api/v1/search?query=&apos; + query; &#125;, []); useEffect(() =&gt; &#123; const url = getFetchUrl(&apos;react&apos;); &#125;, [getFetchUrl]); useEffect(() =&gt; &#123; const url = getFetchUrl(&apos;redux&apos;); &#125;, [getFetchUrl]); &#125;useCallbackæœ¬è´¨ä¸Šæ˜¯æ·»åŠ äº†ä¸€å±‚ä¾èµ–æ£€æŸ¥ã€‚å®ƒä»¥å¦ä¸€ç§æ–¹å¼è§£å†³äº†é—®é¢˜ - æˆ‘ä»¬ä½¿å‡½æ•°æœ¬èº«åªåœ¨éœ€è¦çš„æ—¶å€™æ‰æ”¹å˜ï¼Œè€Œä¸æ˜¯å»æ‰å¯¹å‡½æ•°çš„ä¾èµ–ã€‚æˆ‘ä»¬æ¥çœ‹çœ‹ä¸ºä»€ä¹ˆè¿™ç§æ–¹å¼æ˜¯æœ‰ç”¨çš„ã€‚ä¹‹å‰ï¼Œæˆ‘ä»¬çš„ä¾‹å­ä¸­å±•ç¤ºäº†ä¸¤ç§æœç´¢ç»“æœï¼ˆæŸ¥è¯¢æ¡ä»¶åˆ†åˆ«ä¸º&#39;react&#39;å’Œ&#39;redux&#39;ï¼‰ã€‚ä½†å¦‚æœæˆ‘ä»¬æƒ³æ·»åŠ ä¸€ä¸ªè¾“å…¥æ¡†å…è®¸ä½ è¾“å…¥ä»»æ„çš„æŸ¥è¯¢æ¡ä»¶ (query)ã€‚ä¸åŒäºä¼ é€’queryå‚æ•°çš„æ–¹å¼ï¼Œç°åœ¨getFetchUrlä¼šä»çŠ¶æ€ä¸­è¯»å–ã€‚æˆ‘ä»¬å¾ˆå¿«å‘ç°å®ƒé—æ¼äº†queryä¾èµ–ï¼šå¦‚æœæˆ‘æŠŠqueryæ·»åŠ åˆ°useCallback çš„ä¾èµ–ä¸­ï¼Œä»»ä½•è°ƒç”¨äº†getFetchUrlçš„ effect åœ¨queryæ”¹å˜åéƒ½ä¼šé‡æ–°è¿è¡Œï¼š1234567891011function SearchResults() &#123; const [query, setQuery] = useState(&apos;react&apos;); const getFetchUrl = useCallback(() =&gt; &#123; return &apos;https://hn.algolia.com/api/v1/search?query=&apos; + query; &#125;, [query]); useEffect(() =&gt; &#123; const url = getFetchUrl(); &#125;, [getFetchUrl]); &#125;æˆ‘ä»¬è¦æ„Ÿè°¢useCallbackï¼Œå› ä¸ºå¦‚æœquery ä¿æŒä¸å˜ï¼ŒgetFetchUrlä¹Ÿä¼šä¿æŒä¸å˜ï¼Œæˆ‘ä»¬çš„ effect ä¹Ÿä¸ä¼šé‡æ–°è¿è¡Œã€‚ä½†æ˜¯å¦‚æœqueryä¿®æ”¹äº†ï¼ŒgetFetchUrlä¹Ÿä¼šéšä¹‹æ”¹å˜ï¼Œå› æ­¤ä¼šé‡æ–°è¯·æ±‚æ•°æ®ã€‚è¿™å°±åƒä½ åœ¨ Excel é‡Œä¿®æ”¹äº†ä¸€ä¸ªå•å…ƒæ ¼çš„å€¼ï¼Œå¦ä¸€ä¸ªä½¿ç”¨å®ƒçš„å•å…ƒæ ¼ä¼šè‡ªåŠ¨é‡æ–°è®¡ç®—ä¸€æ ·ã€‚è¿™æ­£æ˜¯æ‹¥æŠ±æ•°æ®æµå’ŒåŒæ­¥æ€ç»´çš„ç»“æœã€‚å¯¹äºé€šè¿‡å±æ€§ä»çˆ¶ç»„ä»¶ä¼ å…¥çš„å‡½æ•°è¿™ä¸ªæ–¹æ³•ä¹Ÿé€‚ç”¨ï¼š12345678910111213141516function Parent() &#123; const [query, setQuery] = useState(&apos;react&apos;); const fetchData = useCallback(() =&gt; &#123; const url = &apos;https://hn.algolia.com/api/v1/search?query=&apos; + query; &#125;, [query]); return &lt;Child fetchData=&#123;fetchData&#125; /&gt;&#125;function Child(&#123; fetchData &#125;) &#123; let [data, setData] = useState(null); useEffect(() =&gt; &#123; fetchData().then(setData); &#125;, [fetchData]); &#125;å› ä¸ºfetchDataåªæœ‰åœ¨Parentçš„queryçŠ¶æ€å˜æ›´æ—¶æ‰ä¼šæ”¹å˜ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„Childåªä¼šåœ¨éœ€è¦çš„æ—¶å€™æ‰å»é‡æ–°è¯·æ±‚æ•°æ®ã€‚å‡½æ•°æ˜¯æ•°æ®æµçš„ä¸€éƒ¨åˆ†å—ï¼Ÿæœ‰è¶£çš„æ˜¯ï¼Œè¿™ç§æ¨¡å¼åœ¨ class ç»„ä»¶ä¸­è¡Œä¸é€šï¼Œå¹¶ä¸”è¿™ç§è¡Œä¸é€šæ°åˆ°å¥½å¤„åœ°æ­ç¤ºäº† effect å’Œç”Ÿå‘½å‘¨æœŸèŒƒå¼ä¹‹é—´çš„åŒºåˆ«ã€‚è€ƒè™‘ä¸‹é¢çš„è½¬æ¢ï¼š1234567891011121314151617class Parent extends Component &#123; state = &#123; query: &apos;react&apos; &#125;; fetchData = () =&gt; &#123; const url = &apos;https://hn.algolia.com/api/v1/search?query=&apos; + this.state.query; &#125;; render() &#123; return &lt;Child fetchData=&#123;this.fetchData&#125; /&gt;; &#125;&#125;class Child extends Component &#123; state = &#123; data: null &#125;; componentDidMount() &#123; this.props.fetchData(); &#125; render() &#123; &#125;&#125;ä½ å¯èƒ½ä¼šæƒ³ï¼šâ€œå°‘æ¥äº† Danï¼Œæˆ‘ä»¬éƒ½çŸ¥é“useEffect å°±åƒcomponentDidMount å’Œ componentDidUpdateçš„ç»“åˆï¼Œä½ ä¸èƒ½è€æ˜¯ç ´åè¿™ä¸€æ¡ï¼â€ å¥½å§ï¼Œå°±ç®—åŠ äº†componentDidUpdateç…§æ ·æ— ç”¨ï¼š1234567891011class Child extends Component &#123; state = &#123; data: null &#125;; componentDidMount() &#123; this.props.fetchData(); &#125; componentDidUpdate(prevProps) &#123; if (this.props.fetchData !== prevProps.fetchData) &#123; this.props.fetchData(); &#125; &#125; render() &#123; &#125;&#125;å½“ç„¶å¦‚æ­¤ï¼ŒfetchDataæ˜¯ä¸€ä¸ª class æ–¹æ³•ï¼ï¼ˆæˆ–è€…ä½ ä¹Ÿå¯ä»¥è¯´æ˜¯ class å±æ€§ - ä½†è¿™ä¸èƒ½æ”¹å˜ä»€ä¹ˆã€‚ï¼‰å®ƒä¸ä¼šå› ä¸ºçŠ¶æ€çš„æ”¹å˜è€Œä¸åŒï¼Œæ‰€ä»¥this.props.fetchDataå’Œ prevProps.fetchDataå§‹ç»ˆç›¸ç­‰ï¼Œå› æ­¤ä¸ä¼šé‡æ–°è¯·æ±‚ã€‚é‚£æˆ‘ä»¬åˆ æ‰æ¡ä»¶åˆ¤æ–­æ€ä¹ˆæ ·ï¼Ÿ123componentDidUpdate(prevProps) &#123; this.props.fetchData();&#125;ç­‰ç­‰ï¼Œè¿™æ ·ä¼šåœ¨æ¯æ¬¡æ¸²æŸ“åéƒ½å»è¯·æ±‚ã€‚(æ·»åŠ ä¸€ä¸ªåŠ è½½åŠ¨ç”»å¯èƒ½æ˜¯ä¸€ç§æœ‰è¶£çš„å‘ç°è¿™ç§æƒ…å†µçš„æ–¹å¼ã€‚) ä¹Ÿè®¸æˆ‘ä»¬å¯ä»¥ç»‘å®šä¸€ä¸ªç‰¹å®šçš„ query?123render() &#123; return &lt;Child fetchData=&#123;this.fetchData.bind(this, this.state.query)&#125; /&gt;;&#125;ä½†è¿™æ ·ä¸€æ¥ï¼Œthis.props.fetchData !== prevProps.fetchData è¡¨è¾¾å¼æ°¸è¿œæ˜¯trueï¼Œå³ä½¿queryå¹¶æœªæ”¹å˜ã€‚è¿™ä¼šå¯¼è‡´æˆ‘ä»¬æ€»æ˜¯å»è¯·æ±‚ã€‚æƒ³è¦è§£å†³è¿™ä¸ª class ç»„ä»¶ä¸­çš„éš¾é¢˜ï¼Œå”¯ä¸€ç°å®å¯è¡Œçš„åŠæ³•æ˜¯ç¡¬ç€å¤´çš®æŠŠqueryæœ¬èº«ä¼ å…¥ Child ç»„ä»¶ã€‚ Child è™½ç„¶å®é™…å¹¶æ²¡æœ‰ç›´æ¥_ä½¿ç”¨_è¿™ä¸ªqueryçš„å€¼ï¼Œä½†èƒ½åœ¨å®ƒæ”¹å˜çš„æ—¶å€™è§¦å‘ä¸€æ¬¡é‡æ–°è¯·æ±‚ï¼š12345678910111213141516171819202122232425class Parent extends Component &#123; state = &#123; query: &apos;react&apos; &#125;; fetchData = () =&gt; &#123; const url = &apos;https://hn.algolia.com/api/v1/search?query=&apos; + this.state.query; &#125;; render() &#123; return &lt;Child fetchData=&#123;this.fetchData&#125; query=&#123;this.state.query&#125; /&gt;; &#125;&#125;class Child extends Component &#123; state = &#123; data: null &#125;; componentDidMount() &#123; this.props.fetchData(); &#125; componentDidUpdate(prevProps) &#123; if (this.props.query !== prevProps.query) &#123; this.props.fetchData(); &#125; &#125; render() &#123; &#125;&#125;åœ¨ä½¿ç”¨ React çš„ class ç»„ä»¶è¿™ä¹ˆå¤šå¹´åï¼Œæˆ‘å·²ç»å¦‚æ­¤ä¹ æƒ¯äºæŠŠä¸å¿…è¦çš„ props ä¼ é€’ä¸‹å»å¹¶ä¸”ç ´åçˆ¶ç»„ä»¶çš„å°è£…ä»¥è‡³äºæˆ‘åœ¨ä¸€å‘¨ä¹‹å‰æ‰æ„è¯†åˆ°æˆ‘ä¸ºä»€ä¹ˆä¸€å®šè¦è¿™æ ·åšã€‚åœ¨ class ç»„ä»¶ä¸­ï¼Œå‡½æ•°å±æ€§æœ¬èº«å¹¶ä¸æ˜¯æ•°æ®æµçš„ä¸€éƒ¨åˆ†ã€‚ç»„ä»¶çš„æ–¹æ³•ä¸­åŒ…å«äº†å¯å˜çš„thiså˜é‡å¯¼è‡´æˆ‘ä»¬ä¸èƒ½ç¡®å®šæ— ç–‘åœ°è®¤ä¸ºå®ƒæ˜¯ä¸å˜çš„ã€‚å› æ­¤ï¼Œå³ä½¿æˆ‘ä»¬åªéœ€è¦ä¸€ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬ä¹Ÿå¿…é¡»æŠŠä¸€å †æ•°æ®ä¼ é€’ä¸‹å»ä»…ä»…æ˜¯ä¸ºäº†åš â€œdiffâ€ã€‚æˆ‘ä»¬æ— æ³•çŸ¥é“ä¼ å…¥çš„this.props.fetchData æ˜¯å¦ä¾èµ–çŠ¶æ€ï¼Œå¹¶ä¸”ä¸çŸ¥é“å®ƒä¾èµ–çš„çŠ¶æ€æ˜¯å¦æ”¹å˜äº†ã€‚ä½¿ç”¨useCallbackï¼Œå‡½æ•°å®Œå…¨å¯ä»¥å‚ä¸åˆ°æ•°æ®æµä¸­ã€‚æˆ‘ä»¬å¯ä»¥è¯´å¦‚æœä¸€ä¸ªå‡½æ•°çš„è¾“å…¥æ”¹å˜äº†ï¼Œè¿™ä¸ªå‡½æ•°å°±æ”¹å˜äº†ã€‚å¦‚æœæ²¡æœ‰ï¼Œå‡½æ•°ä¹Ÿä¸ä¼šæ”¹å˜ã€‚æ„Ÿè°¢å‘¨åˆ°çš„useCallbackï¼Œå±æ€§æ¯”å¦‚props.fetchDataçš„æ”¹å˜ä¹Ÿä¼šè‡ªåŠ¨ä¼ é€’ä¸‹å»ã€‚ç±»ä¼¼çš„ï¼ŒuseMemoå¯ä»¥è®©æˆ‘ä»¬å¯¹å¤æ‚å¯¹è±¡åšç±»ä¼¼çš„äº‹æƒ…ã€‚1234567function ColorPicker() &#123; const [color, setColor] = useState(&apos;pink&apos;); const style = useMemo(() =&gt; (&#123; color &#125;), [color]); return &lt;Child style=&#123;style&#125; /&gt;;&#125;æˆ‘æƒ³å¼ºè°ƒçš„æ˜¯ï¼Œåˆ°å¤„ä½¿ç”¨useCallbackæ˜¯ä»¶æŒºç¬¨æ‹™çš„äº‹ã€‚å½“æˆ‘ä»¬éœ€è¦å°†å‡½æ•°ä¼ é€’ä¸‹å»å¹¶ä¸”å‡½æ•°ä¼šåœ¨å­ç»„ä»¶çš„ effect ä¸­è¢«è°ƒç”¨çš„æ—¶å€™ï¼ŒuseCallback æ˜¯å¾ˆå¥½çš„æŠ€å·§ä¸”éå¸¸æœ‰ç”¨ã€‚æˆ–è€…ä½ æƒ³è¯•å›¾å‡å°‘å¯¹å­ç»„ä»¶çš„è®°å¿†è´Ÿæ‹…ï¼Œä¹Ÿä¸å¦¨ä¸€è¯•ã€‚ä½†æ€»çš„æ¥è¯´ Hooks æœ¬èº«èƒ½æ›´å¥½åœ°é¿å…ä¼ é€’å›è°ƒå‡½æ•°ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘æ›´å€¾å‘äºæŠŠfetchDataæ”¾åœ¨æˆ‘çš„ effect é‡Œï¼ˆå®ƒå¯ä»¥æŠ½ç¦»æˆä¸€ä¸ªè‡ªå®šä¹‰ Hookï¼‰æˆ–è€…æ˜¯ä»é¡¶å±‚å¼•å…¥ã€‚æˆ‘æƒ³è®© effects ä¿æŒç®€å•ï¼Œè€Œåœ¨é‡Œé¢è°ƒç”¨å›è°ƒä¼šè®©äº‹æƒ…å˜å¾—å¤æ‚ã€‚ï¼ˆâ€œå¦‚æœæŸä¸ªprops.onCompleteå›è°ƒæ”¹å˜äº†è€Œè¯·æ±‚è¿˜åœ¨è¿›è¡Œä¸­ä¼šæ€ä¹ˆæ ·ï¼Ÿâ€ï¼‰ä½ å¯ä»¥æ¨¡æ‹Ÿ class çš„è¡Œä¸ºä½†é‚£æ ·å¹¶ä¸èƒ½è§£å†³ç«æ€çš„é—®é¢˜ã€‚è¯´è¯´ç«æ€ä¸‹é¢æ˜¯ä¸€ä¸ªå…¸å‹çš„åœ¨ class ç»„ä»¶é‡Œå‘è¯·æ±‚çš„ä¾‹å­ï¼š12345678910111213class Article extends Component &#123; state = &#123; article: null &#125;; componentDidMount() &#123; this.fetchData(this.props.id); &#125; async fetchData(id) &#123; const article = await API.fetchArticle(id); this.setState(&#123; article &#125;); &#125; &#125;ä½ å¾ˆå¯èƒ½å·²ç»çŸ¥é“ï¼Œä¸Šé¢çš„ä»£ç åŸ‹ä¼äº†ä¸€äº›é—®é¢˜ã€‚å®ƒå¹¶æ²¡æœ‰å¤„ç†æ›´æ–°çš„æƒ…å†µã€‚æ‰€ä»¥ç¬¬äºŒä¸ªä½ èƒ½å¤Ÿåœ¨ç½‘ä¸Šæ‰¾åˆ°çš„ç»å…¸ä¾‹å­æ˜¯ä¸‹é¢è¿™æ ·çš„ï¼š12345678910111213class Article extends Component &#123; state = &#123; article: null &#125;; componentDidMount() &#123; this.fetchData(this.props.id); &#125; componentDidUpdate(prevProps) &#123; if (prevProps.id !== this.props.id) &#123; this.fetchData(this.props.id); &#125; &#125; async fetchData(id) &#123; const article = await API.fetchArticle(id); this.setState(&#123; article &#125;); &#125; &#125;è¿™æ˜¾ç„¶å¥½å¤šäº†ï¼ä½†ä¾æ—§æœ‰é—®é¢˜ã€‚æœ‰é—®é¢˜çš„åŸå› æ˜¯è¯·æ±‚ç»“æœè¿”å›çš„é¡ºåºä¸èƒ½ä¿è¯ä¸€è‡´ã€‚æ¯”å¦‚æˆ‘å…ˆè¯·æ±‚ {id: 10}ï¼Œç„¶åæ›´æ–°åˆ°{id: 20}ï¼Œä½†{id: 20}çš„è¯·æ±‚æ›´å…ˆè¿”å›ã€‚è¯·æ±‚æ›´æ—©ä½†è¿”å›æ›´æ™šçš„æƒ…å†µä¼šé”™è¯¯åœ°è¦†ç›–çŠ¶æ€å€¼ã€‚è¿™è¢«å«åšç«æ€ï¼Œè¿™åœ¨æ··åˆäº†async / awaitï¼ˆå‡è®¾åœ¨ç­‰å¾…ç»“æœè¿”å›ï¼‰å’Œè‡ªé¡¶å‘ä¸‹æ•°æ®æµçš„ä»£ç ä¸­éå¸¸å…¸å‹ï¼ˆprops å’Œ state å¯èƒ½ä¼šåœ¨ async å‡½æ•°è°ƒç”¨è¿‡ç¨‹ä¸­å‘ç”Ÿæ”¹å˜ï¼‰ã€‚Effects å¹¶æ²¡æœ‰ç¥å¥‡åœ°è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå°½ç®¡å®ƒä¼šè­¦å‘Šä½ å¦‚æœä½ ç›´æ¥ä¼ äº†ä¸€ä¸ªasync å‡½æ•°ç»™ effectã€‚ï¼ˆæˆ‘ä»¬ä¼šæ”¹å–„è¿™ä¸ªè­¦å‘Šæ¥æ›´å¥½åœ°è§£é‡Šä½ å¯èƒ½ä¼šé‡åˆ°çš„è¿™äº›é—®é¢˜ã€‚ï¼‰å¦‚æœä½ ä½¿ç”¨çš„å¼‚æ­¥æ–¹å¼æ”¯æŒå–æ¶ˆï¼Œé‚£å¤ªæ£’äº†ã€‚ä½ å¯ä»¥ç›´æ¥åœ¨æ¸…é™¤å‡½æ•°ä¸­å–æ¶ˆå¼‚æ­¥è¯·æ±‚ã€‚æˆ–è€…ï¼Œæœ€ç®€å•çš„æƒå®œä¹‹è®¡æ˜¯ç”¨ä¸€ä¸ªå¸ƒå°”å€¼æ¥è·Ÿè¸ªå®ƒï¼š1234567891011121314151617function Article(&#123; id &#125;) &#123; const [article, setArticle] = useState(null); useEffect(() =&gt; &#123; let didCancel = false; async function fetchData() &#123; const article = await API.fetchArticle(id); if (!didCancel) &#123; setArticle(article); &#125; &#125; fetchData(); return () =&gt; &#123; didCancel = true; &#125;; &#125;, [id]); &#125;è¿™ç¯‡æ–‡ç« è®¨è®ºäº†æ›´å¤šå…³äºå¦‚ä½•å¤„ç†é”™è¯¯å’ŒåŠ è½½çŠ¶æ€ï¼Œä»¥åŠæŠ½ç¦»é€»è¾‘åˆ°è‡ªå®šä¹‰çš„ Hookã€‚æˆ‘æ¨èä½ è®¤çœŸé˜…è¯»ä¸€ä¸‹å¦‚æœä½ æƒ³å­¦ä¹ æ›´å¤šå…³äºå¦‚ä½•åœ¨ Hooks é‡Œè¯·æ±‚æ•°æ®çš„å†…å®¹ã€‚æé«˜æ°´å‡†åœ¨ class ç»„ä»¶ç”Ÿå‘½å‘¨æœŸçš„æ€ç»´æ¨¡å‹ä¸­ï¼Œå‰¯ä½œç”¨çš„è¡Œä¸ºå’Œæ¸²æŸ“è¾“å‡ºæ˜¯ä¸åŒçš„ã€‚UI æ¸²æŸ“æ˜¯è¢« props å’Œ state é©±åŠ¨çš„ï¼Œå¹¶ä¸”èƒ½ç¡®ä¿æ­¥è°ƒä¸€è‡´ï¼Œä½†å‰¯ä½œç”¨å¹¶ä¸æ˜¯è¿™æ ·ã€‚è¿™æ˜¯ä¸€ç±»å¸¸è§é—®é¢˜çš„æ¥æºã€‚è€Œåœ¨useEffectçš„æ€ç»´æ¨¡å‹ä¸­ï¼Œé»˜è®¤éƒ½æ˜¯åŒæ­¥çš„ã€‚å‰¯ä½œç”¨å˜æˆäº† React æ•°æ®æµçš„ä¸€éƒ¨åˆ†ã€‚å¯¹äºæ¯ä¸€ä¸ªuseEffectè°ƒç”¨ï¼Œä¸€æ—¦ä½ å¤„ç†æ­£ç¡®ï¼Œä½ çš„ç»„ä»¶èƒ½å¤Ÿæ›´å¥½åœ°å¤„ç†è¾¹ç¼˜æƒ…å†µã€‚ç„¶è€Œï¼Œç”¨å¥½useEffectçš„å‰æœŸå­¦ä¹ æˆæœ¬æ›´é«˜ã€‚è¿™å¯èƒ½è®©äººæ°”æ¼ã€‚ç”¨åŒæ­¥çš„ä»£ç å»å¤„ç†è¾¹ç¼˜æƒ…å†µå¤©ç„¶å°±æ¯”è§¦å‘ä¸€æ¬¡ä¸ç”¨å’Œæ¸²æŸ“ç»“æœæ­¥è°ƒä¸€è‡´çš„å‰¯ä½œç”¨æ›´éš¾ã€‚è¿™éš¾å…è®©äººæ‹…å¿§å¦‚æœuseEffectæ˜¯ä½ ç°åœ¨ä½¿ç”¨æœ€å¤šçš„å·¥å…·ã€‚ä¸è¿‡ï¼Œç›®å‰å¤§æŠµè¿˜å¤„ç†ä½æ°´å¹³ä½¿ç”¨é˜¶æ®µã€‚å› ä¸º Hooks å¤ªæ–°äº†æ‰€ä»¥å¤§å®¶éƒ½è¿˜åœ¨ä½æ°´å¹³åœ°ä½¿ç”¨å®ƒï¼Œå°¤å…¶æ˜¯åœ¨ä¸€äº›æ•™ç¨‹ç¤ºä¾‹ä¸­ã€‚ä½†åœ¨å®è·µä¸­ï¼Œç¤¾åŒºå¾ˆå¯èƒ½å³å°†å¼€å§‹é«˜æ°´å¹³åœ°ä½¿ç”¨ Hooksï¼Œå› ä¸ºå¥½çš„ API ä¼šæœ‰æ›´å¥½çš„åŠ¨é‡å’Œå†²åŠ²ã€‚æˆ‘çœ‹åˆ°ä¸åŒçš„åº”ç”¨åœ¨åˆ›é€ ä»–ä»¬è‡ªå·±çš„ Hooksï¼Œæ¯”å¦‚å°è£…äº†åº”ç”¨é‰´æƒé€»è¾‘çš„useFetchæˆ–è€…ä½¿ç”¨ theme context çš„useTheme ã€‚ä½ ä¸€æ—¦æœ‰äº†åŒ…å«è¿™äº›çš„å·¥å…·ç®±ï¼Œä½ å°±ä¸ä¼šé‚£ä¹ˆé¢‘ç¹åœ°ç›´æ¥ä½¿ç”¨useEffectã€‚ä½†æ¯ä¸€ä¸ªåŸºäºå®ƒçš„ Hook éƒ½èƒ½ä»å®ƒçš„é€‚åº”èƒ½åŠ›ä¸­å¾—åˆ°ç›Šå¤„ã€‚ç›®å‰ä¸ºæ­¢ï¼ŒuseEffectä¸»è¦ç”¨äºæ•°æ®è¯·æ±‚ã€‚ä½†æ˜¯æ•°æ®è¯·æ±‚å‡†ç¡®è¯´å¹¶ä¸æ˜¯ä¸€ä¸ªåŒæ­¥é—®é¢˜ã€‚å› ä¸ºæˆ‘ä»¬çš„ä¾èµ–ç»å¸¸æ˜¯[]æ‰€ä»¥è¿™ä¸€ç‚¹å°¤å…¶æ˜æ˜¾ã€‚é‚£æˆ‘ä»¬ç©¶ç«Ÿåœ¨åŒæ­¥ä»€ä¹ˆï¼Ÿé•¿è¿œæ¥çœ‹ï¼Œ Suspense ç”¨äºæ•°æ®è¯·æ±‚ ä¼šå…è®¸ç¬¬ä¸‰æ–¹åº“é€šè¿‡ç¬¬ä¸€ç­‰çš„é€”å¾„å‘Šè¯‰ React æš‚åœæ¸²æŸ“ç›´åˆ°æŸäº›å¼‚æ­¥äº‹ç‰©ï¼ˆä»»ä½•ä¸œè¥¿ï¼šä»£ç ï¼Œæ•°æ®ï¼Œå›¾ç‰‡ï¼‰å·²ç»å‡†å¤‡å°±ç»ªã€‚å½“ Suspense é€æ¸åœ°è¦†ç›–åˆ°æ›´å¤šçš„æ•°æ®è¯·æ±‚ä½¿ç”¨åœºæ™¯ï¼Œæˆ‘é¢„æ–™useEffect ä¼šé€€å±…å¹•åä½œä¸ºä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œç”¨äºåŒæ­¥ props å’Œ state åˆ°æŸäº›å‰¯ä½œç”¨ã€‚ä¸åƒæ•°æ®è¯·æ±‚ï¼Œå®ƒå¯ä»¥å¾ˆå¥½åœ°å¤„ç†è¿™äº›åœºæ™¯å› ä¸ºå®ƒå°±æ˜¯ä¸ºæ­¤è€Œè®¾è®¡çš„ã€‚ä¸è¿‡åœ¨é‚£ä¹‹å‰ï¼Œè‡ªå®šä¹‰çš„ Hooks æ¯”å¦‚è¿™å„¿æåˆ°çš„æ˜¯å¤ç”¨æ•°æ®è¯·æ±‚é€»è¾‘å¾ˆå¥½çš„æ–¹å¼ã€‚åœ¨ç»“æŸå‰ç°åœ¨ä½ å·®ä¸å¤šçŸ¥é“äº†æˆ‘å…³äºå¦‚ä½•ä½¿ç”¨ effects çš„æ‰€æœ‰çŸ¥è¯†ï¼Œå¯ä»¥æ£€æŸ¥ä¸€ä¸‹å¼€å¤´çš„ TLDRã€‚ä½ ç°åœ¨è§‰å¾—å®ƒè¯´å¾—æœ‰é“ç†å—ï¼Ÿæˆ‘æœ‰é—æ¼ä»€ä¹ˆå—ï¼Ÿï¼ˆæˆ‘çš„çº¸è¿˜æ²¡æœ‰å†™å®Œï¼ï¼‰æˆ‘å¾ˆæƒ³åœ¨ Twitter ä¸Šå¬å¬ä½ çš„æƒ³æ³•ã€‚è°¢è°¢é˜…è¯»ã€‚æœ¬æ–‡ä½œè€…ï¼š Andyæœ¬æ–‡åœ°å€ï¼š https://andyxw.com/archives/4233.htmlç‰ˆæƒå£°æ˜ï¼š è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>React</tag>
        <tag>å‰ç«¯</tag>
        <tag>React Hooks</tag>
        <tag>useEffect</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[What are React Hooks]]></title>
    <url>%2Farchives%2Fef81.html</url>
    <content type="text"><![CDATA[æœ¬æ–‡ç”± ç®€æ‚¦ SimpRead è½¬ç ï¼Œ åŸæ–‡åœ°å€ https://www.robinwieruch.de/react-hooks/October 29, 2018 - Edit this Post on GitHubReact Hooks were introduced at React Conf October 2018 as a way to use state and side-effects in React function components. Whereas function components have been called functional stateless components (FSC) before, they are finally able to use state with React Hooks. Therefore, many people refer to them as function components now.In this walkthrough, I want to explain the motivation behind hooks, what will change in React and why we shouldnâ€™t panic, and how React hooks can be used in function components by showcasing common React Hooks such as the state and effect hooks by example.React Hooks were invented by the React team to introduce state management and side-effects in function components. Itâ€™s their way of making it more effortless to use only React function components without the need to refactor a React function component to a React class component for using lifecycle methods, in order to use have side-effects, or local state. React Hooks enable us to write React applications with only function components.Unnecessary Component Refactorings: Previously, only React class components were used for local state management and lifecycle methods. The latter have been essential for introducing side-effects, such as listeners or data fetching, in React class components.12345678910111213141516171819202122232425262728import React from &apos;react&apos;;class Counter extends React.Component &#123; constructor(props) &#123; super(props); this.state = &#123; count: 0, &#125;; &#125; render() &#123; return ( &lt;div&gt; &lt;p&gt;You clicked &#123;this.state.count&#125; times&lt;/p&gt; &lt;button onClick=&#123;() =&gt; this.setState(&#123; count: this.state.count + 1 &#125;) &#125; &gt; Click me &lt;/button&gt; &lt;/div&gt; ); &#125;&#125;export default Counter;Only if you didnâ€™t need state or lifecycle methods, React functional stateless components could be used. And because React function components are more lightweight (and elegant), people already used plenty of function components. This came with the drawback of refactoring components from React function components to React class components every time state or lifecycle methods were needed (and vice versa).1234567891011121314151617import React, &#123; useState &#125; from &apos;react&apos;;// how to use the state hook in a React function componentfunction Counter() &#123; const [count, setCount] = useState(0); return ( &lt;div&gt; &lt;p&gt;You clicked &#123;count&#125; times&lt;/p&gt; &lt;button onClick=&#123;() =&gt; setCount(count + 1)&#125;&gt; Click me &lt;/button&gt; &lt;/div&gt; );&#125;export default Counter;With Hooks there is no need for this refactoring. Side-effects and state are finally available in React function components. Thatâ€™s why a rebranding from functional stateless components to function components would be reasonable.Side-effect Logic: In React class components, side-effects were mostly introduced in lifecycle methods (e.g. componentDidMount, componentDidUpdate, componentWillUnmount). A side-effect could be fetching data in React or interacting with the Browser API. Usually these side-effects came with a setup and clean up phase. For instance, if you would miss to remove your listener, you could run into React performance issues.12345678910111213141516171819202122232425262728293031// side-effects in a React class componentclass MyComponent extends Component &#123; // setup phase componentDidMount() &#123; // add listener for feature 1 // add listener for feature 2 &#125; // clean up phase componentWillUnmount() &#123; // remove listener for feature 1 // remove listener for feature 2 &#125; ...&#125;// side-effects in React function component with React Hooksfunction MyComponent() &#123; useEffect(() =&gt; &#123; // add listener for feature 1 (setup) // return function to remove listener for feature 1 (clean up) &#125;); useEffect(() =&gt; &#123; // add listener for feature 2 (setup) // return function to remove listener for feature 2 (clean up) &#125;); ...&#125;Now, if you would introduce more than one of these side-effects in a React class componentâ€™s lifecycle methods, all side-effects would be grouped by lifecycle method but not by side-effect. Thatâ€™s what React Hooks are going to change by encapsulating a side-effect in one hook whereas every hook has its own side-effect with a setup and clean up phase. You will see later in a tutorial how this works for real by adding and removing listeners in a React Hook.Reactâ€™s Abstraction Hell: Abstraction and thus reusability were introduced with Higher-Order Components and Render Prop Components in React. There is also Reactâ€™s Context with its Provider and Consumer Components that introduce another level of abstraction. All of these advanced patterns in React are using so called wrapping components. The implementation of the following components shouldnâ€™t be foreign to developers who are creating larger React applications.12345678910111213141516171819import &#123; compose &#125; from &apos;recompose&apos;;import &#123; withRouter &#125; from &apos;react-router-dom&apos;;function App(&#123; history, state, dispatch &#125;) &#123; return ( &lt;ThemeContext.Consumer&gt; &#123;theme =&gt; &lt;Content theme=&#123;theme&#125;&gt; ... &lt;/Content&gt; &#125; &lt;/ThemeContext.Consumer&gt; );&#125;export default compose( withRouter, withReducer(reducer, initialState))(App);Sophie Alpert coined it â€œthe wrapper hellâ€ in React. You are not only seeing it in the implementation, but also when inspecting your components in the browser. There are dozens of wrapped components due to Render Prop Components (including Consumer components from Reactâ€™s Context) and Higher-Order Components. It becomes an unreadable component tree, because all the abstracted logic is covered up in other React components. The actual visible components are hard to track down in the browserâ€™s DOM. So what if these additional components were not needed because the logic is only encapsulated in functions as side-effects instead? Then you would remove all these wrapping components and flatten your component treeâ€™s structure:12345678910111213function App() &#123; const theme = useTheme(); const history = useRouter(); const [state, dispatch] = useReducer(reducer, initialState); return ( &lt;Content theme=&#123;theme&#125;&gt; ... &lt;/Content&gt; );&#125;export default App;Thatâ€™s what React Hooks are bringing on the table. All side-effects are sitting directly in the component without introducing other components as container for business logic. The container disappears and the logic just sits in React Hooks that are only functions. Andrew Clark already left a statement in favor of React Hooks in his popular Higher-Order Component library called recompose.JavaScript Class Confusion: JavaScript mixes two worlds pretty well: Object-oriented programming (OOP) and functional programming. React introduces many developers to both worlds. On the one side, React (and Redux) introduced people to functional programming (FP) with function compositions, general programming concepts with functions (e.g. higher-order functions, JavaScript built-in methods like map, reduce, filter) and other terms such as immutability and side-effects. React itself didnâ€™t really introduce these things, because they are features of the language or the programming paradigm itself, but they are heavily used in React whereas every React developer becomes automatically a better JavaScript developer.On the other side, React uses JavaScript classes as one way to define React components. A class is only the declaration whereas the actual usage of the component is the instantiation of it. It creates a class instance whereas the this object of the class instance is used to interact with class methods (e.g. setState, forceUpdate, other custom class methods). However, classes come with a steeper learning curve for React beginners who are not coming from an OOP background. Thatâ€™s why class bindings, the this object and inheritance can be confusing. I have a few chapters in my React book focusing only on this aspect of React which is always the most confusing thing about React for beginners.123456789101112131415161718192021222324252627282930313233343536373839404142// I THOUGHT WE ARE USING A CLASS. WHY IS IT EXTENDING FROM SOMETHING?class Counter extends Component &#123; // WAIT ... THIS WORKS??? state = &#123; value: 0 &#125;; // I THOUGH IT&apos;S THIS WAY, BUT WHY DO I NEED PROPS HERE? // constructor(props) &#123; // SUPER??? // super(props); // // this.state = &#123; // value: 0, // &#125;; // &#125; // WHY DO I HAVE TO USE AN ARROW FUNCTION??? onIncrement = () =&gt; &#123; this.setState(state =&gt; (&#123; value: state.value + 1 &#125;)); &#125;; // SHOULDN&apos;T IT BE this.onDecrement = this.onDecrement.bind(this); in the constructor??? // WHAT&apos;S this.onDecrement = this.onDecrement.bind(this); DOING ANYWAY? onDecrement = () =&gt; &#123; this.setState(state =&gt; (&#123; value: state.value - 1 &#125;)); &#125;; render() &#123; return ( &lt;div&gt; &#123;this.state.value&#125; &#123;/* WHY IS EVERYTHING AVAILABLE ON &quot;THIS&quot;??? */&#125; &lt;button onClick=&#123;this.onIncrement&#125;&gt;+&lt;/button&gt; &lt;button onClick=&#123;this.onDecrement&#125;&gt;-&lt;/button&gt; &lt;/div&gt; ) &#125;&#125;Now, many people argue React shouldnâ€™t take JavaScript classes away because people donâ€™t understand them. After all, they belong to the language. However, one of the hypotheses of introducing the Hooks API is a smoother learning curve for React beginners when writing their React components without JavaScript classes in the first place.Every time a new feature is introduced, people are concerned about it. There is one side of the group that is ecstatic about the change, and the other side that fears the change. I heard the most common concerns for React Hooks are:Everything changes! Subtle panic mode â€¦React is becoming bloated like Angular!Itâ€™s useless, classes worked fine.Itâ€™s magic!Let me address these concerns here:Everything changes: React Hooks will change how we write React applications in the future. However, at the moment, nothing changes. You can still write class components with local state and lifecycle methods and deploy advanced patterns such as Higher-Order Components or Render Prop Components. Nobody takes these learnings away from you. See how I upgraded all my open source projects from older versions to React 16.6. and none of of these projects had problems. They are using HOCs, Render Props and I believe even the old context API (correct me if am wrong). Everything I have learned all these years still works. The React team makes sure that React stays backward compatible. It will be the same with React 16.7.React is becoming bloated like Angular: React was always seen as a library with a slim API. Thatâ€™s true and shall be true in the future. However, in order to adjust things that were the status quo of building component-based applications a few years ago, and not to be overtaken by other libraries who adapt to the new status quo, React introduces changes in favor of older APIs. If React would start out fresh this year, maybe there would be only function components and hooks. But React was released a couple of years ago and needs to adapt to keep up with the status quo or to invent a status quo. Maybe there will follow deprecations of React class components and lifecycle methods in a few years in favor of React function components and hooks, but at the moment, the React team keeps React class components in their repertoire of tools. After all, the React team utilizes hooks as an invention to run a marathon with React an not to win a sprint. Obviously, React Hooks add yet another API to React, but it is in favor to simplify Reactâ€™s API in the future. I like this transition more than having a React 2 where everything is different.Itâ€™s useless, classes worked fine: Imagine you would start from zero to learn React and you would be introduced to React with Hooks. Maybe create-react-app wouldnâ€™t start out with a React class component but with a React function component. Everything you need to learn for your components would be React Hooks. They manage state and side-effects, so you would only need to know about the state and the effect hook. Itâ€™s everything a React class component did for you before. It will be simpler for React beginners to learn React without all the other overhead that comes with JavaScript classes (inheritance, this, bindings, super, â€¦). Imagine React Hooks as a new way of how to write React components - Itâ€™s a new mindset. I am a skeptical person myself, but once I wrote a couple of simpler scenarios with React Hooks, I was convinced that this is the simplest way to write but also to learn React. As someone who is doing lots of React workshops, I argue that it takes away all the frustration classes bring on the table for React beginners.Itâ€™s magic: React is known to be down to earth with JavaScript. Writing React applications makes you a better JavaScript developer - thatâ€™s one of the best things about React when someone asks me: â€œWhy should I learn React?â€. Whether there comes another library in the future or not, everyone is prepared by honing their JavaScript skills and general programming skills when using React. Itâ€™s one of the things that made Redux, often used in React, popular: There is no magic, it is plain JavaScript. Now these React Hooks come along the way, introduce something stateful in a previously often pure function component, a couple of not easily to accept rules, and many donâ€™t understand whatâ€™s going on under the hood. But think about it this way: A function component in React is not a mere function. You still have to import React as library to your source code file. It does something with your function, because the function becomes a function component in React land. This function component comes with hidden implementations that were there all the time. How else would it have been possible to use functions as function components as we did it before React Hooks were introduced? And people accepted it too, even though itâ€™s kinda magic. Now, the only thing changed (and maybe it has already been this way before) is that these function components come with an extra hidden object that keeps track of hooks. To quote Dan Abramov from his article about hooks: â€œPerhaps youâ€™re wondering where React keeps the state for Hooks. The answer is itâ€™s kept in the exact same place where React keeps state for classes. React has an internal update queue which is the source of truth for any state, no matter how you define your components.â€.Finally, think about it this way: Component-based solutions such as Angular, Vue, and React are pushing the boundaries of web development with every release. They build up on top of technologies that were invented more than two decades ago. They adapt them to make web development effortless in 2018 and not 1998. They optimize them like crazy to meet the needs in the here and now. We are building web applications with components and not with HTML templates anymore. We are not there yet, but I imagine a future where we sit together and invent a component-based standard for the browser. Angular, Vue and React are only the spearhead of this movement.In the following, I want to dive into a few popular React Hooks by example to get you up to speed. All examples can be found in this GitHub repository.You have seen the useState Hook before in a code snippet for a typical counter example. It is used to manage local state in function components. Letâ€™s use the hook in a more elaborate example where we are going to manage an array of items. In another article of mine, you can learn more about managing arrays as state in React, but this time we are doing it with React hooks. Letâ€™s get started:12345678910111213141516171819202122232425262728293031import React, &#123; useState &#125; from &apos;react&apos;;const INITIAL_LIST = [ &#123; id: &apos;0&apos;, title: &apos;React with RxJS for State Management Tutorial&apos;, url: &apos;https://www.robinwieruch.de/react-rxjs-state-management-tutorial/&apos;, &#125;, &#123; id: &apos;1&apos;, title: &apos;A complete React with Apollo and GraphQL Tutorial&apos;, url: &apos;https://www.robinwieruch.de/react-graphql-apollo-tutorial&apos;, &#125;,];function App() &#123; const [list, setList] = useState(INITIAL_LIST); return ( &lt;ul&gt; &#123;list.map(item =&gt; ( &lt;li key=&#123;item.id&#125;&gt; &lt;a href=&#123;item.url&#125;&gt;&#123;item.title&#125;&lt;/a&gt; &lt;/li&gt; ))&#125; &lt;/ul&gt; );&#125;export default App;The useState hook accepts an initial state as argument and returns, by using array destructuring, two variables that can be named however you want to name them. Whereas the first variable is the actual state, the second variable is a function to update the state by providing a new state.The goal of this scenario is to remove an item from the list. In order to accomplish it, every item in the rendered list has a button with a click handler. The click handler can be inlined in the function component, because it will make use of list and setList later. Hence you donâ€™t need to pass these variables to the handler, because they are already available from the outer scope of the component.123456789101112131415161718192021function App() &#123; const [list, setList] = useState(INITIAL_LIST); function onRemoveItem() &#123; // remove item from &quot;list&quot; // set the new list in state with &quot;setList&quot; &#125; return ( &lt;ul&gt; &#123;list.map(item =&gt; ( &lt;li key=&#123;item.id&#125;&gt; &lt;a href=&#123;item.url&#125;&gt;&#123;item.title&#125;&lt;/a&gt; &lt;button type=&quot;button&quot; onClick=&#123;onRemoveItem&#125;&gt; Remove &lt;/button&gt; &lt;/li&gt; ))&#125; &lt;/ul&gt; );&#125;Somehow we need to know about the item that should be removed from the list. Using a higher-order function, we can pass the identifier of the item to the handler function. Otherwise we wouldnâ€™t be able to identify the item that should be removed from the list.123456789101112131415161718192021function App() &#123; const [list, setList] = useState(INITIAL_LIST); function onRemoveItem(id) &#123; // remove item from &quot;list&quot; // set the new list in state with &quot;setList&quot; &#125; return ( &lt;ul&gt; &#123;list.map(item =&gt; ( &lt;li key=&#123;item.id&#125;&gt; &lt;a href=&#123;item.url&#125;&gt;&#123;item.title&#125;&lt;/a&gt; &lt;button type=&quot;button&quot; onClick=&#123;() =&gt; onRemoveItem(item.id)&#125;&gt; Remove &lt;/button&gt; &lt;/li&gt; ))&#125; &lt;/ul&gt; );&#125;Finally, use the identifier to filter the list with a built-in array method. It returns a new list which is used to set the new state of the list.123456789101112131415161718192021function App() &#123; const [list, setList] = useState(INITIAL_LIST); function onRemoveItem(id) &#123; const newList = list.filter(item =&gt; item.id !== id); setList(newList); &#125; return ( &lt;ul&gt; &#123;list.map(item =&gt; ( &lt;li key=&#123;item.id&#125;&gt; &lt;a href=&#123;item.url&#125;&gt;&#123;item.title&#125;&lt;/a&gt; &lt;button type=&quot;button&quot; onClick=&#123;() =&gt; onRemoveItem(item.id)&#125;&gt; Remove &lt;/button&gt; &lt;/li&gt; ))&#125; &lt;/ul&gt; );&#125;That should do the job. You are able to remove an item from the list based on the identifier you pass to the handler. The handler then filters the list and sets the new state of the list with the setList function.The useState hook gives you everything you need to manage state in a function component: initial state, the latest state, and a state update function. Everything else is JavaScript again. Furthermore, you donâ€™t need to bother about the state object with its shallow merge as before in a class component. Instead, you encapsulate one domain (e.g. list) with useState, but if you would need another state (e.g. counter), then just encapsulate this domain with another useState. You can read more about the useState hook in Reactâ€™s documentation.Letâ€™s head over to the next hook called useEffect. As mentioned before, function components should be able to manage state and side-effects with hooks. Managing state was showcased with the useState hook. Now comes the useEffect hook into play for side-effects which are usually used for interactions with the Browser/DOM API or external API like data fetching. Letâ€™s see how the useEffect hook can be used for interaction with the Browser API by implementing a simple stopwatch. You can see how it is done in a React class component in this GitHub repository.1234567891011121314151617181920212223import React, &#123; useState &#125; from &apos;react&apos;;function App() &#123; const [isOn, setIsOn] = useState(false); return ( &lt;div&gt; &#123;!isOn &amp;&amp; ( &lt;button type=&quot;button&quot; onClick=&#123;() =&gt; setIsOn(true)&#125;&gt; Start &lt;/button&gt; )&#125; &#123;isOn &amp;&amp; ( &lt;button type=&quot;button&quot; onClick=&#123;() =&gt; setIsOn(false)&#125;&gt; Stop &lt;/button&gt; )&#125; &lt;/div&gt; );&#125;export default App;There is no stopwatch yet. But at least there are is a conditional rendering to show either a â€œStartâ€ or â€œStopâ€ button. The state for the boolean flag is managed by the useState hook.Letâ€™s introduce our side-effect with useEffect that registers an interval. The function used for the interval emits a console logging every second to your developer tools of your browser.123456789101112131415161718192021222324252627import React, &#123; useState, useEffect &#125; from &apos;react&apos;;function App() &#123; const [isOn, setIsOn] = useState(false); useEffect(() =&gt; &#123; setInterval(() =&gt; console.log(&apos;tick&apos;), 1000); &#125;); return ( &lt;div&gt; &#123;!isOn &amp;&amp; ( &lt;button type=&quot;button&quot; onClick=&#123;() =&gt; setIsOn(true)&#125;&gt; Start &lt;/button&gt; )&#125; &#123;isOn &amp;&amp; ( &lt;button type=&quot;button&quot; onClick=&#123;() =&gt; setIsOn(false)&#125;&gt; Stop &lt;/button&gt; )&#125; &lt;/div&gt; );&#125;export default App;In order to remove the interval when the component unmounts (but also after every other render update), you can return a function in useEffect for anything to be called for the clean up. For instance, there shouldnâ€™t be any memory leak left behind when the component isnâ€™t there anymore.123456789101112131415import React, &#123; useState, useEffect &#125; from &apos;react&apos;;function App() &#123; const [isOn, setIsOn] = useState(false); useEffect(() =&gt; &#123; const interval = setInterval(() =&gt; console.log(&apos;tick&apos;), 1000); return () =&gt; clearInterval(interval); &#125;); ...&#125;export default App;Now, you want to setup the side-effect when mounting the component and the clean up the side-effect when unmounting the component. If you would log how many times the function within the effect is called, you would see that it sets a new interval every time the state of the component changes (e.g. click on â€œStartâ€/â€œStopâ€ button).12345678910111213141516import React, &#123; useState, useEffect &#125; from &apos;react&apos;;function App() &#123; const [isOn, setIsOn] = useState(false); useEffect(() =&gt; &#123; console.log(&apos;effect runs&apos;); const interval = setInterval(() =&gt; console.log(&apos;tick&apos;), 1000); return () =&gt; clearInterval(interval); &#125;); ...&#125;export default App;In order to only run the effect on mount and unmount of the component, you can pass it an empty array as second argument.123456789101112131415import React, &#123; useState, useEffect &#125; from &apos;react&apos;;function App() &#123; const [isOn, setIsOn] = useState(false); useEffect(() =&gt; &#123; const interval = setInterval(() =&gt; console.log(&apos;tick&apos;), 1000); return () =&gt; clearInterval(interval); &#125;, []); ...&#125;export default App;However, since the interval is cleaned up after every render too, we need to set the interval in our update cycle too. But we can tell the effect to run only when the isOn variable changes. Only when one of the variables in the array changes, the effect will run during the update cycle. If you keep the array empty, the effect will only run on mount and unmount, because there is no variable to be checked for running the side-effect again.123456789101112131415import React, &#123; useState, useEffect &#125; from &apos;react&apos;;function App() &#123; const [isOn, setIsOn] = useState(false); useEffect(() =&gt; &#123; const interval = setInterval(() =&gt; console.log(&apos;tick&apos;), 1000); return () =&gt; clearInterval(interval); &#125;, [isOn]); ...&#125;export default App;The interval is running whether the isOn boolean is true or false. It would be great to only run it when the stopwatch is activated.12345678910111213141516171819import React, &#123; useState, useEffect &#125; from &apos;react&apos;;function App() &#123; const [isOn, setIsOn] = useState(false); useEffect(() =&gt; &#123; let interval; if (isOn) &#123; interval = setInterval(() =&gt; console.log(&apos;tick&apos;), 1000); &#125; return () =&gt; clearInterval(interval); &#125;, [isOn]); ...&#125;export default App;Now introduce another state in your function component to keep track of the timer of the stopwatch. It is used to update the timer, but only when the stopwatch is activated.123456789101112131415161718192021222324252627282930313233343536373839import React, &#123; useState, useEffect &#125; from &apos;react&apos;;function App() &#123; const [isOn, setIsOn] = useState(false); const [timer, setTimer] = useState(0); useEffect(() =&gt; &#123; let interval; if (isOn) &#123; interval = setInterval( () =&gt; setTimer(timer + 1), 1000, ); &#125; return () =&gt; clearInterval(interval); &#125;, [isOn]); return ( &lt;div&gt; &#123;timer&#125; &#123;!isOn &amp;&amp; ( &lt;button type=&quot;button&quot; onClick=&#123;() =&gt; setIsOn(true)&#125;&gt; Start &lt;/button&gt; )&#125; &#123;isOn &amp;&amp; ( &lt;button type=&quot;button&quot; onClick=&#123;() =&gt; setIsOn(false)&#125;&gt; Stop &lt;/button&gt; )&#125; &lt;/div&gt; );&#125;export default App;There is still one mistake in the code. When the interval is running, it updates the timer every second by increasing it by one. However, it always relies on a stale state for the timer. Only when the inOn boolean flag changes the state is fine. In order to receive always the latest state for the timer when the interval is running, you can use a function instead for the state update function which always has the latest state.1234567891011121314151617181920212223import React, &#123; useState, useEffect &#125; from &apos;react&apos;;function App() &#123; const [isOn, setIsOn] = useState(false); const [timer, setTimer] = useState(0); useEffect(() =&gt; &#123; let interval; if (isOn) &#123; interval = setInterval( () =&gt; setTimer(timer =&gt; timer + 1), 1000, ); &#125; return () =&gt; clearInterval(interval); &#125;, [isOn]); ...&#125;export default App;An alternative would have been to run the effect also when the timer changes. Then the effect would receive the latest timer state.1234567891011121314151617181920212223import React, &#123; useState, useEffect &#125; from &apos;react&apos;;function App() &#123; const [isOn, setIsOn] = useState(false); const [timer, setTimer] = useState(0); useEffect(() =&gt; &#123; let interval; if (isOn) &#123; interval = setInterval( () =&gt; setTimer(timer + 1), 1000, ); &#125; return () =&gt; clearInterval(interval); &#125;, [isOn, timer]); ...&#125;export default App;Thatâ€™s the implementation for the stopwatch that uses the Browser API If you want to continue, you can extend the example by providing a â€œResetâ€ button too.123456789101112131415161718192021222324252627282930313233343536373839404142434445464748import React, &#123; useState, useEffect &#125; from &apos;react&apos;;function App() &#123; const [isOn, setIsOn] = useState(false); const [timer, setTimer] = useState(0); useEffect(() =&gt; &#123; let interval; if (isOn) &#123; interval = setInterval( () =&gt; setTimer(timer =&gt; timer + 1), 1000, ); &#125; return () =&gt; clearInterval(interval); &#125;, [isOn]); const onReset = () =&gt; &#123; setIsOn(false); setTimer(0); &#125;; return ( &lt;div&gt; &#123;timer&#125; &#123;!isOn &amp;&amp; ( &lt;button type=&quot;button&quot; onClick=&#123;() =&gt; setIsOn(true)&#125;&gt; Start &lt;/button&gt; )&#125; &#123;isOn &amp;&amp; ( &lt;button type=&quot;button&quot; onClick=&#123;() =&gt; setIsOn(false)&#125;&gt; Stop &lt;/button&gt; )&#125; &lt;button type=&quot;button&quot; disabled=&#123;timer === 0&#125; onClick=&#123;onReset&#125;&gt; Reset &lt;/button&gt; &lt;/div&gt; );&#125;export default App;Thatâ€™s it. The useEffect hook is used for side-effects in React function components that are used for interacting with the Browser/DOM API or other third-party APIs (e.g. data fetching). You can read more about the useEffect hook in Reactâ€™s documentation.Last but not least, after you have learned about the two most popular hooks that introduce state and side-effects in function components, there is one last thing I want to show you: custom hooks. Thatâ€™s right, you can implement your own custom React Hooks that can be reused in your application or by others. Letâ€™s see how they work with an example application which is able to detect whether your device is online or offline.12345678910111213import React, &#123; useState &#125; from &apos;react&apos;;function App() &#123; const [isOffline, setIsOffline] = useState(false); if (isOffline) &#123; return &lt;div&gt;Sorry, you are offline ...&lt;/div&gt;; &#125; return &lt;div&gt;You are online!&lt;/div&gt;;&#125;export default App;Again, introduce the useEffect hook for the side-effect. In this case, the effect adds and removes listeners that check if the device is online or offline. Both listeners are setup only once on mount and cleaned up once on unmount (empty array as second argument). Whenever one of the listeners is called, it sets the state for the isOffline boolean.12345678910111213141516171819202122232425262728293031import React, &#123; useState, useEffect &#125; from &apos;react&apos;;function App() &#123; const [isOffline, setIsOffline] = useState(false); function onOffline() &#123; setIsOffline(true); &#125; function onOnline() &#123; setIsOffline(false); &#125; useEffect(() =&gt; &#123; window.addEventListener(&apos;offline&apos;, onOffline); window.addEventListener(&apos;online&apos;, onOnline); return () =&gt; &#123; window.removeEventListener(&apos;offline&apos;, onOffline); window.removeEventListener(&apos;online&apos;, onOnline); &#125;; &#125;, []); if (isOffline) &#123; return &lt;div&gt;Sorry, you are offline ...&lt;/div&gt;; &#125; return &lt;div&gt;You are online!&lt;/div&gt;;&#125;export default App;Everything is nicely encapsulated in one effect now. Itâ€™s a great functionality which should be reuse somewhere else too. Thatâ€™s why we can extract the functionality as its a custom hook which follows the same naming convention as the other hooks.12345678910111213141516171819202122232425262728293031323334353637import React, &#123; useState, useEffect &#125; from &apos;react&apos;;function useOffline() &#123; const [isOffline, setIsOffline] = useState(false); function onOffline() &#123; setIsOffline(true); &#125; function onOnline() &#123; setIsOffline(false); &#125; useEffect(() =&gt; &#123; window.addEventListener(&apos;offline&apos;, onOffline); window.addEventListener(&apos;online&apos;, onOnline); return () =&gt; &#123; window.removeEventListener(&apos;offline&apos;, onOffline); window.removeEventListener(&apos;online&apos;, onOnline); &#125;; &#125;, []); return isOffline;&#125;function App() &#123; const isOffline = useOffline(); if (isOffline) &#123; return &lt;div&gt;Sorry, you are offline ...&lt;/div&gt;; &#125; return &lt;div&gt;You are online!&lt;/div&gt;;&#125;export default App;Extracting the custom hook as function was not the only thing. You also have to return the isOffline state from the custom hook in order to use it in your application to show a message to users who are offline. Otherwise, it should render the normal application. Thatâ€™s it for the custom hook that detects whether you are online or offline. You can read more about custom hooks in Reactâ€™s documentation.React Hooks being reusable is the best thing about them, because there is the potential to grow an ecosystem of custom React Hooks that can be installed from npm for any React application. And not only for React applications. Evan You, creator of Vue, is hooked (!) by them as well. Maybe we will see a bridge between both ecosystems where it is possible to share hooks between Vue and React.If you want to dive deeper into the state and effect hooks, you can check out the following React hook tutorials:How to useReducer Hook?Migration from Class Components to HooksComparison useState vs useReducerModern State Management with HooksHow to fetch data with React HooksCheckout the official FAQ and Rules for hooks in Reactâ€™s documentation to learn more about their fine-grained behaviour. In addition, you can checkout all officially available React Hooks too.For everyone who is still concerned about React Hooks: Give them a shot yourself. Implement a couple of React function components with state and side-effects. I had to do it myself to understand how they work and to feel comfortable with them. And I must say it feels pretty great to use them.The Road to learn ReactBuild a Hacker News App along the way. No setup configuration. No tooling. No Redux. Plain React in 200+ pages of learning material. Learn React like 50.000+ readers.Get the Book for freeNever miss an article about web development, JavaScript and self-growth.Take PartJoin 30.000+ DevelopersLearn Web Development with JavaScriptTips and TricksAccess Tutorials, eBooks and CoursesPersonal Development as a Software Engineeræœ¬æ–‡ä½œè€…ï¼š Andyæœ¬æ–‡åœ°å€ï¼š https://andyxw.com/archives/ef81.htmlç‰ˆæƒå£°æ˜ï¼š è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>React</tag>
        <tag>å‰ç«¯</tag>
        <tag>React Hooks</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å‰ç«¯ç›¸å…³æ–‡ç« æ”¶è—]]></title>
    <url>%2Farchives%2Ff37d.html</url>
    <content type="text"><![CDATA[å‰ç«¯æ¶æ„æ”¯ä»˜å®å‰ç«¯åº”ç”¨æ¶æ„çš„å‘å±•å’Œé€‰æ‹©æœ¬æ–‡ä½œè€…ï¼š Andyæœ¬æ–‡åœ°å€ï¼š https://andyxw.com/archives/f37d.htmlç‰ˆæƒå£°æ˜ï¼š è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>å‰ç«¯</tag>
        <tag>é“¾æ¥</tag>
        <tag>æ”¶è—</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æœåŠ¡å™¨é‡ç½®å¯†ç ]]></title>
    <url>%2Farchives%2Ffe92.html</url>
    <content type="text"><![CDATA[æœ‰æ—¶å€™ä¼šå¿˜è®°æœåŠ¡å™¨å¯†ç ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡å®˜ç½‘é¢æ¿ç­‰æ–¹å¼è¿ä¸Šæ—¶ï¼Œå¯ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ä¿®æ”¹rootå¯†ç ï¼šæ•´æ®µèµ‹å€¼ä¸‹é¢çš„å‘½ä»¤ï¼ˆâ€æ–°å¯†ç â€å¤„ æ›¿æ¢ä¸ºè¦ä¿®æ”¹çš„å¯†ç ï¼‰ï¼š1234echo root:æ–°å¯†ç  |sudo chpasswd rootsudo sed -i &apos;s/^.*PermitRootLogin.*/PermitRootLogin yes/g&apos; /etc/ssh/sshd_config;sudo sed -i &apos;s/^.*PasswordAuthentication.*/PasswordAuthentication yes/g&apos; /etc/ssh/sshd_config;sudo rebooté‡å¯åç”¨rootè´¦æˆ·ç™»å½•å³å¯ã€‚æœ¬æ–‡ä½œè€…ï¼š Andyæœ¬æ–‡åœ°å€ï¼š https://andyxw.com/archives/fe92.htmlç‰ˆæƒå£°æ˜ï¼š è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼]]></content>
      <categories>
        <category>æœåŠ¡å™¨</category>
      </categories>
      <tags>
        <tag>æœåŠ¡å™¨</tag>
        <tag>Linux</tag>
        <tag>é‡ç½®å¯†ç </tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è§£å¯†ä¼ ç»Ÿç»„ä»¶é—´é€šä¿¡ä¸Reactç»„ä»¶é—´é€šä¿¡]]></title>
    <url>%2Farchives%2Fac71.html</url>
    <content type="text"><![CDATA[åœ¨Reactä¸­æœ€å°çš„é€»è¾‘å•å…ƒæ˜¯ç»„ä»¶ï¼Œç»„ä»¶ä¹‹é—´å¦‚æœæœ‰è€¦åˆå…³ç³»å°±ä¼šè¿›è¡Œé€šä¿¡ï¼Œæœ¬æ–‡å°†ä¼šä»‹ç»Reactä¸­çš„ç»„ä»¶é€šä¿¡çš„ä¸åŒæ–¹å¼é€šè¿‡å½’çº³èŒƒï¼Œå¯ä»¥å°†ä»»æ„ç»„ä»¶é—´çš„é€šä¿¡å½’ç±»ä¸ºå››ç§ç±»å‹çš„ç»„ä»¶é—´é€šä¿¡ï¼Œåˆ†åˆ«æ˜¯çˆ¶å­ç»„ä»¶ï¼Œçˆ·å­™ç»„ä»¶ï¼Œå…„å¼Ÿç»„ä»¶å’Œä»»æ„ç»„ä»¶ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯å‰ä¸‰ä¸ªä¹Ÿå¯ä»¥ç®—ä½œä»»æ„ç»„ä»¶çš„èŒƒç•´ï¼Œæ‰€ä»¥æœ€åä¸€ä¸ªæ˜¯ä¸‡èƒ½æ–¹æ³•çˆ¶å­ç»„ä»¶çˆ¶å­ç»„ä»¶é—´çš„é€šä¿¡åˆ†ä¸ºçˆ¶ç»„ä»¶å‘å­ç»„ä»¶é€šä¿¡å’Œå­ç»„ä»¶å‘çˆ¶ç»„ä»¶é€šä¿¡ä¸¤ç§æƒ…å†µï¼Œä¸‹é¢å…ˆæ¥ä»‹ç»çˆ¶ç»„ä»¶å‘å­ç»„ä»¶é€šä¿¡ï¼Œä¼ ç»Ÿåšæ³•åˆ†ä¸ºä¸¤ç§æƒ…å†µï¼Œåˆ†åˆ«æ˜¯åˆå§‹åŒ–æ—¶çš„å‚æ•°ä¼ é€’å’Œå®ä¾‹é˜¶æ®µçš„æ–¹æ³•è°ƒç”¨ï¼Œä¾‹å­å¦‚ä¸‹12345678910111213141516171819202122232425262728class Child &#123; constructor(name) &#123; // è·å–domå¼•ç”¨ this.$div = document.querySelector('#wp'); // åˆå§‹åŒ–æ—¶ä¼ å…¥name this.updateName(name); &#125; updateName(name) &#123; // å¯¹å¤–æä¾›æ›´æ–°çš„api this.name = name; // æ›´æ–°dom this.$div.innerHTML = name; &#125;&#125;class Parent &#123; constructor() &#123; // åˆå§‹åŒ–é˜¶æ®µ this.child = new Child('yan'); setTimeout(() =&gt; &#123; // å®ä¾‹åŒ–é˜¶æ®µ this.child.updateName('hou'); &#125;, 2000); &#125;&#125;åœ¨Reactä¸­å°†ä¸¤ä¸ªæƒ…å†µç»Ÿä¸€å¤„ç†ï¼Œå…¨éƒ¨é€šè¿‡å±æ€§æ¥å®Œæˆï¼Œä¹‹æ‰€ä»¥èƒ½å¤Ÿè¿™æ ·æ˜¯å› ä¸ºReactåœ¨å±æ€§æ›´æ–°æ—¶ä¼šè‡ªåŠ¨é‡æ–°æ¸²æŸ“å­ç»„ä»¶ï¼Œä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œ2ç§’åå­ç»„ä»¶ä¼šè‡ªåŠ¨é‡æ–°æ¸²æŸ“ï¼Œå¹¶è·å–æ–°çš„å±æ€§å€¼1234567891011121314151617181920class Child extends Component &#123; render() &#123; return &lt;div&gt;&#123;this.props.name&#125;&lt;/div&gt; &#125;&#125;class Parent extends Component &#123; constructor() &#123; // åˆå§‹åŒ–é˜¶æ®µ this.state = &#123;name: 'yan'&#125;; setTimeout(() =&gt; &#123; // å®ä¾‹åŒ–é˜¶æ®µ this.setState(&#123;name: 'hou'&#125;) &#125;, 2000); &#125; render() &#123; return &lt;Child name=&#123;this.state.name&#125; /&gt; &#125;&#125;ä¸‹é¢æ¥çœ‹ä¸€ä¸‹å­ç»„ä»¶å¦‚ä½•å‘çˆ¶ç»„ä»¶é€šä¿¡ï¼Œä¼ ç»Ÿåšæ³•æœ‰ä¸¤ç§ï¼Œä¸€ç§æ˜¯å›è°ƒå‡½æ•°ï¼Œå¦ä¸€ç§æ˜¯ä¸ºå­ç»„ä»¶éƒ¨ç½²æ¶ˆæ¯æ¥å£å…ˆæ¥çœ‹å›è°ƒå‡½æ•°çš„ä¾‹å­ï¼Œå›è°ƒå‡½æ•°çš„ä¼˜ç‚¹æ˜¯éå¸¸ç®€å•ï¼Œç¼ºç‚¹å°±æ˜¯å¿…é¡»åœ¨åˆå§‹åŒ–çš„æ—¶å€™ä¼ å…¥ï¼Œå¹¶ä¸”ä¸å¯æ’¤å›ï¼Œå¹¶ä¸”åªèƒ½ä¼ å…¥ä¸€ä¸ªå‡½æ•°123456789101112131415class Child &#123; constructor(cb) &#123; // è°ƒç”¨çˆ¶ç»„ä»¶ä¼ å…¥çš„å›è°ƒå‡½æ•°ï¼Œå‘é€æ¶ˆæ¯ setTimeout(() =&gt; &#123; cb() &#125;, 2000); &#125;&#125;class Parent &#123; constructor() &#123; // åˆå§‹åŒ–é˜¶æ®µï¼Œä¼ å…¥å›è°ƒå‡½æ•° this.child = new Child(function () &#123; console.log('child update') &#125;); &#125;&#125;ä¸‹é¢æ¥çœ‹çœ‹æ¶ˆæ¯æ¥å£æ–¹æ³•ï¼Œé¦–å…ˆéœ€è¦ä¸€ä¸ªå¯ä»¥å‘å¸ƒå’Œè®¢é˜…æ¶ˆæ¯çš„åŸºç±»ï¼Œæ¯”å¦‚ä¸‹é¢å®ç°äº†ä¸€ä¸ªç®€å•çš„EventEimtterï¼Œå®é™…ç”Ÿäº§ä¸­å¯ä»¥ç›´æ¥ä½¿ç”¨åˆ«äººå†™å¥½çš„ç±»åº“ï¼Œæ¯”å¦‚@jsmini/eventï¼Œå­ç»„ä»¶ç»§æ‰¿æ¶ˆæ¯åŸºç±»ï¼Œå°±æœ‰äº†å‘å¸ƒæ¶ˆæ¯çš„èƒ½åŠ›ï¼Œç„¶åçˆ¶ç»„ä»¶è®¢é˜…å­ç»„ä»¶çš„æ¶ˆæ¯ï¼Œå³å¯å®ç°å­ç»„ä»¶å‘çˆ¶ç»„ä»¶é€šä¿¡çš„åŠŸèƒ½æ¶ˆæ¯æ¥å£çš„ä¼˜ç‚¹å°±æ˜¯å¯ä»¥éšå¤„è®¢é˜…ï¼Œå¹¶ä¸”å¯ä»¥å¤šæ¬¡è®¢é˜…ï¼Œè¿˜å¯ä»¥å–æ¶ˆè®¢é˜…ï¼Œç¼ºç‚¹æ˜¯ç•¥æ˜¾éº»çƒ¦ï¼Œéœ€è¦å¼•å…¥æ¶ˆæ¯åŸºç±»123456789101112131415161718192021222324252627282930313233// æ¶ˆæ¯æ¥å£ï¼Œè®¢é˜…å‘å¸ƒæ¨¡å¼ï¼Œç±»ä¼¼ç»‘å®šäº‹ä»¶ï¼Œè§¦å‘äº‹ä»¶class EventEimtter &#123; constructor() &#123; this.eventMap = &#123;&#125;; &#125; sub(name, cb) &#123; const eventList = this.eventMap[name] = this.eventMap[name] || &#123;&#125;; eventList.push(cb); &#125; pub(name, ...data) &#123; (this.eventMap[name] || []).forEach(cb =&gt; cb(...data)); &#125;&#125;class Child extends EventEimtter &#123; constructor() &#123; super(); // é€šè¿‡æ¶ˆæ¯æ¥å£å‘å¸ƒæ¶ˆæ¯ setTimeout(() =&gt; &#123; this.pub('update') &#125;, 2000); &#125;&#125;class Parent &#123; constructor() &#123; // åˆå§‹åŒ–é˜¶æ®µï¼Œä¼ å…¥å›è°ƒå‡½æ•° this.child = new Child(); // è®¢é˜…å­ç»„ä»¶çš„æ¶ˆæ¯ this.child.sub('update', function () &#123; console.log('child update') &#125;); &#125;&#125;Backbone.jså°±åŒæ—¶æ”¯æŒå›è°ƒå‡½æ•°å’Œæ¶ˆæ¯æ¥å£æ–¹å¼ï¼Œä½†Reactä¸­é€‰æ‹©äº†æ¯”è¾ƒç®€å•çš„å›è°ƒå‡½æ•°æ¨¡å¼ï¼Œä¸‹é¢æ¥çœ‹ä¸€ä¸‹Reactçš„ä¾‹å­1234567891011121314class Child extends Component &#123; constructor(props) &#123; setTimeout(() =&gt; &#123; this.props.cb() &#125;, 2000); &#125; render() &#123; return &lt;div&gt;&lt;/div&gt; &#125;&#125;class Parent extends Component &#123; render() &#123; return &lt;Child cb=&#123;() =&gt; &#123;console.log('update')&#125;&#125; /&gt; &#125;&#125;çˆ·å­™ç»„ä»¶çˆ¶å­ç»„ä»¶å…¶å®å¯ä»¥ç®—æ˜¯çˆ·å­™ç»„ä»¶çš„ä¸€ç§ç‰¹ä¾‹ï¼Œè¿™é‡Œçš„çˆ·å­™ç»„ä»¶ä¸å…‰æŒ‡çˆ·çˆ·å’Œå­™å­ï¼Œè€Œæ˜¯æ³›æŒ‡ç¥–å…ˆä¸åä»£ç»„ä»¶é€šä¿¡ï¼Œå¯èƒ½éš”ç€å¾ˆå¤šå±‚çº§ï¼Œæˆ‘ä»¬å·²ç»è§£å†³äº†çˆ¶å­ç»„ä»¶é€šä¿¡çš„é—®é¢˜ï¼Œæ ¹æ®åŒ–å½’æ³•ï¼Œå¾ˆå®¹æ˜“å¾—å‡ºçˆ·å­™ç»„ä»¶çš„ç­”æ¡ˆï¼Œé‚£å°±æ˜¯å±‚å±‚ä¼ é€’å±æ€§ä¹ˆï¼ŒæŠŠçˆ·å­™ç»„ä»¶é€šä¿¡åˆ†è§£ä¸ºå¤šä¸ªçˆ¶å­ç»„ä»¶é€šä¿¡çš„é—®é¢˜å±‚å±‚ä¼ é€’çš„ä¼˜ç‚¹æ˜¯éå¸¸ç®€å•ï¼Œç”¨å·²æœ‰çŸ¥è¯†å°±èƒ½è§£å†³ï¼Œé—®é¢˜æ˜¯ä¼šæµªè´¹å¾ˆå¤šä»£ç ï¼Œéå¸¸ç¹çï¼Œä¸­é—´ä½œä¸ºæ¡¥æ¢çš„ç»„ä»¶ä¼šå¼•å…¥å¾ˆå¤šä¸å±äºè‡ªå·±çš„å±æ€§åœ¨Reactä¸­ï¼Œé€šè¿‡contextå¯ä»¥è®©ç¥–å…ˆç»„ä»¶ç›´æ¥æŠŠå±æ€§ä¼ é€’åˆ°åä»£ç»„ä»¶ï¼Œæœ‰ç‚¹ç±»ä¼¼æ˜Ÿé™…æ—…è¡Œä¸­çš„è™«æ´ä¸€æ ·ï¼Œé€šè¿‡contextè¿™ä¸ªç‰¹æ®Šçš„æ¡¥æ¢ï¼Œå¯ä»¥è·¨è¶Šä»»æ„å±‚æ¬¡å‘åä»£ç»„ä»¶ä¼ é€’æ¶ˆæ¯æ€ä¹ˆåœ¨éœ€è¦é€šä¿¡çš„ç»„ä»¶ä¹‹é—´å¼€å¯è¿™ä¸ªè™«æ´å‘¢ï¼Ÿéœ€è¦åŒå‘å£°æ˜ï¼Œä¹Ÿå°±æ˜¯åœ¨ç¥–å…ˆç»„ä»¶å£°æ˜å±æ€§ï¼Œå¹¶åœ¨åä»£ç»„ä»¶ä¸Šå†æ¬¡å£°æ˜å±æ€§ï¼Œç„¶ååœ¨ç¥–å…ˆç»„ä»¶ä¸Šæ”¾ä¸Šå±æ€§å°±å¯ä»¥äº†ï¼Œå°±å¯ä»¥åœ¨åä»£ç»„ä»¶è¯»å–å±æ€§äº†ï¼Œä¸‹é¢çœ‹ä¸€ä¸ªä¾‹å­123456789101112131415161718192021222324import PropTypes from 'prop-types';class Child extends Component &#123; // åä»£ç»„ä»¶å£°æ˜éœ€è¦è¯»å–contextä¸Šçš„æ•°æ® static contextTypes = &#123; text: PropTypes.string &#125; render() &#123; // é€šè¿‡this.context è¯»å–contextä¸Šçš„æ•°æ® return &lt;div&gt;&#123;this.context.text&#125;&lt;/div&gt; &#125;&#125;class Ancestor extends Component &#123; // ç¥–å…ˆç»„ä»¶å£°æ˜éœ€è¦æ”¾å…¥contextä¸Šçš„æ•°æ® static childContextTypes = &#123; text: PropTypes.string &#125; // ç¥–å…ˆç»„ä»¶å¾€contextæ”¾å…¥æ•°æ® getChildContext() &#123; return &#123;text: 'yanhaijing'&#125; &#125;&#125;contextçš„ä¼˜ç‚¹æ˜¯å¯ä»¥çœå»å±‚å±‚ä¼ é€’çš„éº»çƒ¦ï¼Œå¹¶ä¸”é€šè¿‡åŒå‘å£°æ˜æ§åˆ¶äº†æ•°æ®çš„å¯è§æ€§ï¼Œå¯¹äºå±‚æ•°å¾ˆå¤šæ—¶ï¼Œä¸å¤±ä¸ºä¸€ç§æ–¹æ¡ˆï¼›ä½†ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œå°±åƒå…¨å±€å˜é‡ä¸€æ ·ï¼Œå¦‚æœä¸åŠ èŠ‚åˆ¶å¾ˆå®¹æ˜“é€ æˆæ··ä¹±ï¼Œè€Œä¸”ä¹Ÿå®¹æ˜“å‡ºç°é‡åè¦†ç›–çš„é—®é¢˜ä¸ªäººçš„å»ºè®®æ˜¯å¯¹ä¸€äº›æ‰€æœ‰ç»„ä»¶å…±äº«çš„åªè¯»ä¿¡æ¯å¯ä»¥é‡‡ç”¨contextæ¥ä¼ é€’ï¼Œæ¯”å¦‚ç™»å½•çš„ç”¨æˆ·ä¿¡æ¯ç­‰å°è´´å£«ï¼šReact Routerè·¯ç”±å°±æ˜¯é€šè¿‡contextæ¥ä¼ é€’è·¯ç”±å±æ€§çš„å…„å¼Ÿç»„ä»¶å¦‚æœä¸¤ä¸ªç»„ä»¶æ˜¯å…„å¼Ÿå…³ç³»ï¼Œå¯ä»¥é€šè¿‡çˆ¶ç»„ä»¶ä½œä¸ºæ¡¥æ¢ï¼Œæ¥è®©ä¸¤ä¸ªç»„ä»¶ä¹‹é—´é€šä¿¡ï¼Œè¿™å…¶å®å°±æ˜¯ä¸»æ¨¡å—æ¨¡å¼ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œä¸¤ä¸ªå­ç»„ä»¶é€šè¿‡çˆ¶ç»„ä»¶æ¥å®ç°æ˜¾ç¤ºæ•°å­—åŒæ­¥çš„åŠŸèƒ½123456789101112131415class Parent extends Component &#123; constructor() &#123; this.onChange = function (num) &#123; this.setState(&#123;num&#125;) &#125;.bind(this); &#125; render() &#123; return ( &lt;div&gt; &lt;Child1 num=&#123;this.state.num&#125; onChange=&#123;this.onChange&#125;&gt; &lt;Child2 num=&#123;this.state.num&#125; onChange=&#123;this.onChange&#125;&gt; &lt;/div&gt; ); &#125;&#125;ä¸»æ¨¡å—æ¨¡å¼çš„ä¼˜ç‚¹å°±æ˜¯è§£è€¦ï¼ŒæŠŠä¸¤ä¸ªå­ç»„ä»¶ä¹‹é—´çš„è€¦åˆå…³ç³»ï¼Œè§£è€¦æˆå­ç»„ä»¶å’Œçˆ¶ç»„ä»¶ä¹‹é—´çš„è€¦åˆï¼ŒæŠŠåˆ†æ•£çš„ä¸œè¥¿æ”¶é›†åœ¨ä¸€èµ·å¥½å¤„éå¸¸æ˜æ˜¾ï¼Œèƒ½å¸¦æ¥æ›´å¥½çš„å¯ç»´æŠ¤æ€§å’Œå¯æ‰©å±•æ€§ä»»æ„ç»„ä»¶ä»»æ„ç»„ä»¶åŒ…æ‹¬ä¸Šé¢çš„ä¸‰ç§å…³ç³»ç»„ä»¶ï¼Œä¸Šé¢ä¸‰ç§å…³ç³»åº”è¯¥ä¼˜å…ˆä½¿ç”¨ä¸Šé¢ä»‹ç»çš„æ–¹æ³•ï¼Œå¯¹äºä»»æ„çš„ä¸¤ä¸ªç»„ä»¶é—´é€šä¿¡ï¼Œæ€»å…±æœ‰ä¸‰ç§åŠæ³•ï¼Œåˆ†åˆ«æ˜¯å…±åŒç¥–å…ˆæ³•ï¼Œæ¶ˆæ¯ä¸­é—´ä»¶å’ŒçŠ¶æ€ç®¡ç†åŸºäºæˆ‘ä»¬ä¸Šé¢ä»‹ç»çš„çˆ·å­™ç»„ä»¶å’Œå…„å¼Ÿç»„ä»¶ï¼Œåªè¦æ‰¾åˆ°ä¸¤ä¸ªç»„ä»¶çš„å…±åŒç¥–å…ˆï¼Œå°±å¯ä»¥å°†ä»»æ„ç»„ä»¶ä¹‹é—´çš„é€šä¿¡ï¼Œè½¬åŒ–ä¸ºä»»æ„ç»„ä»¶å’Œå…±åŒç¥–å…ˆä¹‹é—´çš„é€šä¿¡ï¼Œè¿™ä¸ªæ–¹æ³•çš„å¥½å¤„å°±æ˜¯éå¸¸ç®€å•ï¼Œå·²çŸ¥çŸ¥è¯†å°±èƒ½æå®šï¼Œç¼ºç‚¹å°±æ˜¯ä¸Šé¢ä¸¤ç§æ¨¡å¼ç¼ºç‚¹çš„å åŠ ï¼Œé™¤äº†ä¸´æ—¶æ–¹æ¡ˆï¼Œä¸å»ºè®®ä½¿ç”¨è¿™ç§æ–¹æ³•å¦ä¸€ç§æ¯”è¾ƒå¸¸ç”¨çš„æ–¹æ³•æ˜¯æ¶ˆæ¯ä¸­é—´ä»¶ï¼Œå°±æ˜¯å¼•å…¥ä¸€ä¸ªå…¨å±€æ¶ˆæ¯å·¥å…·ï¼Œä¸¤ä¸ªç»„ä»¶é€šè¿‡è¿™ä¸ªå…¨å±€å·¥å…·è¿›è¡Œé€šä¿¡ï¼Œè¿™æ ·ä¸¤ä¸ªç»„ä»¶é—´çš„é€šä¿¡ï¼Œå°±é€šè¿‡å…¨å±€æ¶ˆæ¯åª’ä»‹å®Œæˆäº†è¿˜è®°å¾—ä¸Šé¢ä»‹ç»çš„æ¶ˆæ¯åŸºç±»å—ï¼Ÿä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œç»„ä»¶1å’Œç»„ä»¶2é€šè¿‡å…¨å±€eventè¿›è¡Œé€šä¿¡12345678910111213141516171819202122232425262728293031class EventEimtter &#123; constructor() &#123; this.eventMap = &#123;&#125;; &#125; sub(name, cb) &#123; const eventList = this.eventMap[name] = this.eventMap[name] || &#123;&#125;; eventList.push(cb); &#125; pub(name, ...data) &#123; (this.eventMap[name] || []).forEach(cb =&gt; cb(...data)); &#125;&#125;// å…¨å±€æ¶ˆæ¯å·¥å…·const event = new EventEimtter;// ä¸€ä¸ªç»„ä»¶class Element1 extends Component &#123; constructor() &#123; // è®¢é˜…æ¶ˆæ¯ event.sub('element2update', () =&gt; &#123;console.log('element2 update')&#125;); &#125;&#125;// å¦ä¸€ä¸ªç»„ä»¶ã€‚class Element2 extends Component &#123; constructor() &#123; // å‘å¸ƒæ¶ˆæ¯ setTimeout(function () &#123; event.pub('element2update') &#125;, 2000) &#125;&#125;æ¶ˆæ¯ä¸­é—´ä»¶çš„æ¨¡å¼éå¸¸ç®€å•ï¼Œåˆ©ç”¨äº†è§‚å¯Ÿè€…æ¨¡å¼ï¼Œå°†ä¸¤ä¸ªç»„ä»¶ä¹‹é—´çš„è€¦åˆè§£è€¦æˆäº†ç»„ä»¶å’Œæ¶ˆæ¯ä¸­å¿ƒ+æ¶ˆæ¯åç§°çš„è€¦åˆï¼Œä½†ä¸ºäº†è§£è€¦å´å¼•å…¥å…¨å±€æ¶ˆæ¯ä¸­å¿ƒå’Œæ¶ˆæ¯åç§°ï¼Œæ¶ˆæ¯ä¸­å¿ƒå¯¹ç»„ä»¶çš„ä¾µå…¥æ€§å¾ˆå¼ºï¼Œå’Œç¬¬ä¸‰æ–¹ç»„ä»¶é€šä¿¡ä¸èƒ½ä½¿ç”¨è¿™ç§æ–¹å¼å°å‹é¡¹ç›®æ¯”è¾ƒé€‚åˆä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œä½†éšç€é¡¹ç›®è§„æ¨¡çš„æ‰©å¤§ï¼Œè¾¾åˆ°ä¸­ç­‰é¡¹ç›®ä»¥åï¼Œæ¶ˆæ¯åå­—çˆ†ç‚¸å¼å¢é•¿ï¼Œæ¶ˆæ¯åå­—çš„ç»´æŠ¤æˆäº†æ£˜æ‰‹çš„é—®é¢˜ï¼Œé‡åæ¦‚ç‡æå¤§ï¼Œæ²¡æœ‰äººæ•¢éšä¾¿åˆ é™¤æ¶ˆæ¯ä¿¡æ¯ï¼Œæ¶ˆæ¯çš„å‘å¸ƒè€…æ‰¾ä¸åˆ°æ¶ˆæ¯è®¢é˜…è€…çš„ä¿¡æ¯ç­‰å…¶å®ä¸Šé¢çš„é—®é¢˜ä¹Ÿä¸æ˜¯æ²¡æœ‰è§£å†³åŠæ³•ï¼Œé‡åçš„é—®é¢˜å¯ä»¥é€šè¿‡åˆ¶å®šè§„èŒƒï¼Œæ¶ˆæ¯å‘½åç©ºé—´ç­‰æ–¹å¼æ¥æå¤§é™ä½å†²çªï¼Œå…¶ä»–é—®é¢˜å¯ä»¥é€šè¿‡æŠŠæ¶ˆæ¯åå­—ç»Ÿä¸€ç»´æŠ¤åˆ°ä¸€ä¸ªæ–‡ä»¶ï¼Œé€šè¿‡å¯¹æ¶ˆæ¯çš„ä¸­å¿ƒåŒ–ç®¡ç†ï¼Œå¯ä»¥è®©å¾ˆå¤šé—®é¢˜éƒ½å¾ˆå®¹æ˜“è§£å†³å¦‚æœä½ çš„é¡¹ç›®éå¸¸å¤§ï¼Œä¸Šé¢ä¸¤ç§æ–¹æ¡ˆéƒ½ä¸åˆé€‚ï¼Œé‚£ä½ å¯èƒ½éœ€è¦ä¸€ä¸ªçŠ¶æ€ç®¡ç†å·¥å…·ï¼Œé€šè¿‡çŠ¶æ€ç®¡ç†å·¥å…·æŠŠç»„ä»¶ä¹‹é—´çš„å…³ç³»ï¼Œå’Œå…³ç³»çš„å¤„ç†é€»è¾‘ä»ç»„å»ºä¸­æŠ½è±¡å‡ºæ¥ï¼Œå¹¶é›†ä¸­åŒ–åˆ°ç»Ÿä¸€çš„åœ°æ–¹æ¥å¤„ç†ï¼ŒReduxå°±æ˜¯ä¸€ä¸ªéå¸¸ä¸é”™çš„çŠ¶æ€ç®¡ç†å·¥å…·é™¤äº†Reduxï¼Œè¿˜æœ‰Mobxï¼ŒRematchï¼Œreselectç­‰å·¥å…·ï¼Œæœ¬æ–‡ä¸å±•å¼€ä»‹ç»ï¼Œæœ‰æœºä¼šåé¢å•ç‹¬æˆæ–‡ï¼Œè¿™äº›éƒ½æ˜¯ç”¨æ¥è§£å†³ä¸åŒé—®é¢˜çš„ï¼Œåªè¦æ ¹æ®è‡ªå·±çš„åœºæ™¯é€‰æ‹©åˆé€‚çš„å·¥å…·å°±å¥½äº†æ€»ç»“ç»„ä»¶é—´çš„å…³ç³»åƒå˜ä¸‡åŒ–ï¼Œéƒ½å¯ä»¥ç”¨ä¸Šé¢ä»‹ç»çš„æ–¹æ³•è§£å†³ï¼Œå¯¹äºä¸åŒè§„æ¨¡çš„é¡¹ç›®ï¼Œåº”è¯¥é€‰æ‹©é€‚åˆè‡ªå·±çš„æŠ€æœ¯æ–¹æ¡ˆï¼Œä¸Šé¢ä»‹ç»çš„ä¸åŒæ–¹å¼è§£è€¦çš„ç¨‹åº¦æ˜¯ä¸ä¸€æ ·çš„ï¼Œå…³äºä¸åŒè€¦åˆå…³ç³»çš„å¥½åï¼Œå¯ä»¥çœ‹æˆ‘ä¹‹å‰çš„æ–‡ç« ã€Šå›¾è§£7ç§è€¦åˆå…³ç³»ã€‹æœ¬æ–‡ä½œè€…ï¼š Andyæœ¬æ–‡åœ°å€ï¼š https://andyxw.com/archives/ac71.htmlç‰ˆæƒå£°æ˜ï¼š è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼]]></content>
      <categories>
        <category>React</category>
      </categories>
      <tags>
        <tag>React</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å›¾è§£7ç§è€¦åˆå…³ç³»]]></title>
    <url>%2Farchives%2F7e29.html</url>
    <content type="text"><![CDATA[æ·±å…¥è®²è®²æ¨¡å—ä¹‹é—´çš„è€¦åˆå…³ç³»è¿™ä¸ªäº‹æƒ…ã€‚æœ¬æ–‡å°†ç”¨å›¾æ–‡è¯¦ç»†è®²è§£ä¸ƒç§è€¦åˆçš„ä¸åŒä¹‹å¤„ã€‚é«˜å†…èšä¸ä½è€¦åˆé«˜å†…èšä¸ä½è€¦åˆæ˜¯æ¯ä¸ªè½¯ä»¶å¼€å‘è€…è¿½æ±‚çš„ç›®æ ‡ï¼Œé‚£ä¹ˆå†…èšå’Œè€¦åˆåˆ†åˆ«æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿå†…èšæ˜¯ä»åŠŸèƒ½è§’åº¦æ¥åº¦é‡æ¨¡å—å†…çš„è”ç³»ï¼Œä¸€ä¸ªå¥½çš„å†…èšæ¨¡å—åº”å½“æ°å¥½åšä¸€ä»¶äº‹ã€‚å®ƒæè¿°çš„æ˜¯æ¨¡å—å†…çš„åŠŸèƒ½è”ç³»ã€‚è€¦åˆæ˜¯è½¯ä»¶ç»“æ„ä¸­å„æ¨¡å—ä¹‹é—´ç›¸äº’è¿æ¥çš„ä¸€ç§åº¦é‡ï¼Œè€¦åˆå¼ºå¼±å–å†³äºæ¨¡å—é—´æ¥å£çš„å¤æ‚ç¨‹åº¦ã€è¿›å…¥æˆ–è®¿é—®ä¸€ä¸ªæ¨¡å—çš„ç‚¹ä»¥åŠé€šè¿‡æ¥å£çš„æ•°æ®ã€‚è€¦åˆä¸åŒæ¨¡å—ä¹‹é—´çš„å…³ç³»å°±æ˜¯è€¦åˆï¼Œæ ¹æ®è€¦åˆç¨‹åº¦å¯ä»¥åˆ†ä¸º7ç§ï¼Œè€¦åˆåº¦ä¾æ¬¡å˜ä½ã€‚å†…å®¹è€¦åˆå…¬å…±è€¦åˆå¤–éƒ¨è€¦åˆæ§åˆ¶è€¦åˆæ ‡è®°è€¦åˆæ•°æ®è€¦åˆéç›´æ¥è€¦åˆä¸‹é¢æˆ‘ä»¬æ¥è¯´è¯´æ¯ç§è€¦åˆæ˜¯ä»€ä¹ˆï¼Œå¼€å§‹ä¹‹å‰å…ˆæ¥è¯´ä¸‹è¦å®ç°çš„åŠŸèƒ½ã€‚m1å’Œm2æ˜¯ä¸¤ä¸ªç‹¬ç«‹çš„æ¨¡å—ï¼Œå…¶ä¸­m2ç§ä¼šæ˜¾ç¤ºm1çš„è¾“å…¥ï¼Œm1ä¼šæ˜¾ç¤ºm2çš„è¾“å…¥ã€‚å¾ˆæ˜¾ç„¶ï¼Œm1å’Œm2ä¸¤ä¸ªæ¨¡å—ä¹‹é—´ä¼šæœ‰ä¸€äº›è”ç³»ï¼ˆè€¦åˆï¼‰ï¼Œä½ ä¹Ÿå¯ä»¥æƒ³æƒ³å¦‚ä½•å®ç°è¿™ä¸ªåŠŸèƒ½ï¼Œä¸‹é¢ç”¨7ç§ä¸åŒçš„æ–¹å¼æ¥å®ç°è¿™ä¸ªåŠŸèƒ½ã€‚æ³¨ï¼šé¡¹ç›®çš„ä»£ç æˆ‘æ”¾åˆ°äº†githubï¼Œé¡¹ç›®çš„demoï¼Œå¯ä»¥åœ¨è¿™é‡ŒæŸ¥çœ‹ã€‚å†…å®¹è€¦åˆå†…å®¹è€¦åˆæ˜¯æœ€ç´§çš„è€¦åˆç¨‹åº¦ï¼Œä¸€ä¸ªæ¨¡å—ç›´æ¥è®¿é—®å¦ä¸€æ¨¡å—çš„å†…å®¹ï¼Œåˆ™ç§°è¿™ä¸¤ä¸ªæ¨¡å—ä¸ºå†…å®¹è€¦åˆã€‚ä¸ºäº†å®ç°åŠŸèƒ½ï¼Œæˆ‘ä»¬å°†m1çš„è¾“å…¥æ”¾åˆ°m2.m1inputä¸Šï¼Œå°†m2çš„è¾“å…¥æ”¾åˆ°m1.m2inputä¸Šã€‚// m1.js root.m2.m1input = this.value; m2.update(); // m2.js root.m1.m2input = this.value; m1.update(); PS:ä¸çŸ¥é“è°ä¼šè¿™ä¹ˆå†™ä»£ç ï¼Œé™¤äº†æˆ‘ä¸ºäº†åšæ¼”ç¤ºä¹‹å¤–ã€‚ã€‚ã€‚æŸ¥çœ‹å®Œæ•´ä»£ç å’Œdemoã€‚å…¬å…±è€¦åˆä¸€ç»„æ¨¡å—éƒ½è®¿é—®åŒä¸€ä¸ªå…¨å±€æ•°æ®ç»“æ„ï¼Œåˆ™ç§°ä¹‹ä¸ºå…¬å…±è€¦åˆã€‚åœ¨è¿™ç§caseä¸­ï¼Œm1å’Œm2å°†è‡ªå·±çš„è¾“å…¥æ”¾åˆ°å…¨å±€çš„dataä¸Šã€‚// m1.js root.data.m1input = this.value; m2.update(); // m2.js root.data.m2input = this.value; m1.update(); æŸ¥çœ‹å®Œæ•´ä»£ç å’Œdemoã€‚å¤–éƒ¨è€¦åˆä¸€ç»„æ¨¡å—éƒ½è®¿é—®åŒä¸€å…¨å±€ç®€å•å˜é‡ï¼Œè€Œä¸”ä¸é€šè¿‡å‚æ•°è¡¨ä¼ é€’è¯¥å…¨å±€å˜é‡çš„ä¿¡æ¯ï¼Œåˆ™ç§°ä¹‹ä¸ºå¤–éƒ¨è€¦åˆã€‚å¤–éƒ¨è€¦åˆå’Œå…¬å…±è€¦åˆå¾ˆåƒï¼ŒåŒºåˆ«å°±æ˜¯ä¸€ä¸ªæ˜¯ç®€å•å˜é‡ï¼Œä¸€ä¸ªæ˜¯å¤æ‚æ•°æ®ç»“æ„ã€‚åœ¨è¿™ç§caseä¸­ï¼Œm1å’Œm2éƒ½å°†è‡ªå·±çš„è¾“å…¥æ”¾åˆ°å…¨å±€ä¸Šã€‚// m1.js root.m1input = this.value; m2.update(); // m2.js root.m2input = this.value; m1.update(); æŸ¥çœ‹å®Œæ•´ä»£ç å’Œdemoã€‚æ§åˆ¶è€¦åˆæ¨¡å—ä¹‹é—´ä¼ é€’çš„ä¸æ˜¯æ•°æ®ä¿¡æ¯ï¼Œè€Œæ˜¯æ§åˆ¶ä¿¡æ¯ä¾‹å¦‚æ ‡å¿—ã€å¼€å…³é‡ç­‰ï¼Œä¸€ä¸ªæ¨¡å—æ§åˆ¶äº†å¦ä¸€ä¸ªæ¨¡å—çš„åŠŸèƒ½ã€‚ä»æ§åˆ¶è€¦åˆå¼€å§‹ï¼Œæ¨¡å—çš„æ•°æ®å°±æ”¾åœ¨è‡ªå·±å†…éƒ¨äº†ï¼Œä¸åŒæ¨¡å—ä¹‹é—´é€šè¿‡æ¥å£äº’ç›¸è°ƒç”¨ã€‚åœ¨è¿™ä¸ªcaseä¸­ï¼Œå¾—å¢åŠ ä¸€ä¸ªéœ€æ±‚ï¼Œå°±æ˜¯å½“m1çš„è¾“å…¥ä¸ºç©ºæ—¶ï¼Œéšè—m2çš„æ˜¾ç¤ºä¿¡æ¯ã€‚// m1.js root.m1input = this.value; m2.update(); m2.toggle(!!this.value); // ä¼ é€’flag ä¸Šé¢çš„ä»£ç ä¸­m1ç›´æ¥æ§åˆ¶äº†m2çš„æ˜¾ç¤ºå’Œéšè—ã€‚æŸ¥çœ‹å®Œæ•´ä»£ç å’Œdemoã€‚æ ‡è®°è€¦åˆè°ƒç”¨æ¨¡å—å’Œè¢«è°ƒç”¨æ¨¡å—ä¹‹é—´ä¼ é€’æ•°æ®ç»“æ„è€Œä¸æ˜¯ç®€å•æ•°æ®ï¼ŒåŒæ—¶ä¹Ÿç§°ä½œç‰¹å¾è€¦åˆã€‚åœ¨è¿™ä¸ªcaseä¸­ï¼Œm1ä¼ ç»™m2çš„æ˜¯ä¸€ä¸ªå¯¹è±¡ã€‚// m1.js me.m1input = this.value; m2.update(me); // ä¼ é€’å¼•ç”¨ // m2.js me.m2input = this.value; m1.update(me); æŸ¥çœ‹å®Œæ•´ä»£ç å’Œdemoã€‚æ•°æ®è€¦åˆè°ƒç”¨æ¨¡å—å’Œè¢«è°ƒç”¨æ¨¡å—ä¹‹é—´åªä¼ é€’ç®€å•çš„æ•°æ®é¡¹å‚æ•°ã€‚ç›¸å½“äºé«˜çº§è¯­è¨€ä¸­çš„å€¼ä¼ é€’ã€‚åœ¨è¿™ä¸ªcaseä¸­ï¼Œm1ä¼ ç»™m2çš„æ˜¯ä¸€ä¸ªç®€å•æ•°æ®ç»“æ„ã€‚// m1.js me.m1input = this.value; m2.update(me.m1input); // ä¼ é€’å€¼ // m2.js me.m2input = this.value; m1.update(me.m2input); æŸ¥çœ‹å®Œæ•´ä»£ç å’Œdemoã€‚éç›´æ¥è€¦åˆä¸¤ä¸ªæ¨¡å—ä¹‹é—´æ²¡æœ‰ç›´æ¥å…³ç³»ï¼Œå®ƒä»¬ä¹‹é—´çš„è”ç³»å®Œå…¨æ˜¯é€šè¿‡ä¸»æ¨¡å—çš„æ§åˆ¶å’Œè°ƒç”¨æ¥å®ç°çš„ã€‚è€¦åˆåº¦æœ€å¼±ï¼Œæ¨¡å—ç‹¬ç«‹æ€§æœ€å¼ºã€‚å­æ¨¡å—æ— éœ€çŸ¥é“å¯¹æ–¹çš„å­˜åœ¨ï¼Œå­æ¨¡å—ä¹‹é—´çš„è”ç³»ï¼Œå…¨éƒ¨å˜æˆå­æ¨¡å—å’Œä¸»æ¨¡å—ä¹‹é—´çš„è”ç³»ã€‚åœ¨è¿™ä¸ªcaseç§ï¼Œå¢åŠ ä¸€ä¸ªindex.jsä½œä¸ºä¸»æ¨¡å—ã€‚// index.js var m1 = root.m1; var m2 = root.m2; m1.init(function (str) { m2.update(str); }); m2.init(function (str) { m1.update(str); }); // m1.js me.m1input = this.value; inputcb(me.m1input); // inputcbæ˜¯å›è°ƒå‡½æ•° // m2.js me.m2input = this.value; inputcb(me.m2input); æŸ¥çœ‹å®Œæ•´ä»£ç å’Œdemoã€‚å†…èšå…¶å®å…³äºå†…èšä¹Ÿåˆ†ä¸ºå¾ˆå¤šç§ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼Œå¦‚æœä½ æ„Ÿå…´è¶£å¯ä»¥è‡ªå·±ç ”ç©¶ç ”ç©¶ï¼Œæˆ‘ä»¬ä¸‹æ¬¡å†æ¥åˆ†äº«å†…èšçš„é—®é¢˜ã€‚å¶ç„¶å†…èšé€»è¾‘å†…èšæ—¶é—´å†…èšé€šä¿¡å†…èšé¡ºåºå†…èšåŠŸèƒ½å†…èšæ€»ç»“å¸Œæœ›ä½ çœ‹å®Œä¸Šé¢çš„æ–‡ç« ï¼Œææ‡‚äº†è€¦åˆçš„ç§ç±»ï¼Œä¹Ÿå¸Œæœ›ä½ ä»¥åèƒ½ä½¿ç”¨éç›´æ¥è€¦åˆè¿™ç§æ–¹å¼æ¥å†™ä»£ç ï¼Œç¥å¥½ã€‚æœ¬æ–‡ä½œè€…ï¼š Andyæœ¬æ–‡åœ°å€ï¼š https://andyxw.com/archives/7e29.htmlç‰ˆæƒå£°æ˜ï¼š è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼]]></content>
      <categories>
        <category>æ¨¡å—åŒ–</category>
      </categories>
      <tags>
        <tag>æ¨¡å—åŒ–</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[é¸¡æ±¤]]></title>
    <url>%2Farchives%2F201.html</url>
    <content type="text"><![CDATA[è¿™æ˜¯ç¯‡æœ‰å¯†ç çš„åšå®¢ Incorrect Password! No content to display! U2FsdGVkX1+SM/wUN5o8/EOXjuVmNwSXPEyzcfbjJay+vM2d3CiJsJDzkruiJuAte8W0SD7/+LYzhb7Ezg6klz2yImSqqc34RYMmtMWQSfAZBXjDNOvwDuqr6BDXPItCzMqVd+eoJ3VN3Gzq6GE6s23WaME9gOesUAAp4PSMqJq1XzYjfY+ZYt5+d7QXFmBGY//GdirYIxmGLjEmkD7PstnjIRmqzvqsrTgcfyKWun09omfsq5RZk1wonqOYm927eaE5TitQdh6AfBtjv4m4+/KtAyTAiFDnUWAeoqZIM33hycF1cp3mWzQqWzRL5xK3BwBKxxfwhU/vhSg4tZ3n1tZjQ5SUAp12D0zM+Cl/Yj2l1bN5vXvk8loP0B8HV6MiGEjr05KudAtiYJiy5T9yyXD9vs06lPned18QQKXx6Fnstod29WJKLGfIkd2CGE0N2T6Heu4+Trorz99RlGo9F7FozfD+1uuk41uLapN6AvImq8tMZl+IulzK0d9weQBY7QckA464/zVzvE6XYOs0TqT9c7Tj0h7t2NLUh3/qsfA4UBjsw++17ntfalpshH6DHDtqHTYL9rU+08HNJS1COsQck6TR0Ahw6RoYVgMHHrvRl1BNidOE2gsvykhi1sC1wPHqnkpje9tIXEu5lwIl6Ou0IkhAyEBxbT162XpLZd7Hen7bdNVscA0lp/jKUEcOnzM9GrEa7BVU+/3A6zRD+yPG5VpHCQfYWwA9LPmCA3xUbI1N0jMUjuHLgGZYE0YDRXWWfL1iGazJ6JoVREgIisjPC//9QRpxyzJqojN8d20C8SjGe9+wF1Fj7pqzAL9qoiB63LFZJ8ZZh8EzE4lWebrdRf2t03PkeemTvkNFXvQ11EGtcKld19VYKmOB/sOEL102VgnLggyLWEMBzQFEEfKVu5fRqAYsbQrBmgbJTM5MT8y02JpcYXvi9yRzFj2OigrrqLPmsbYBUuPApcQg2EYFZar8EOXgkFfvul4ahxw4g7zbLSriso+Yksdpx2x83HuK2o1XgSxwrvvAYE18A/yX39eHgCKkHkiS1MentwGkS5WMcyAMjMWSDVnC6ppWZQswQ1hWBx8vjXij82F+Ae3sYE/3jYoEYd40qIg8qbzgo/rVED5zvJDWXCNA/F0Sh7I//cTBwHf7htJ0tA8MQeHTQF70CKtAA3D5jd0LxWw7VBhCTnv8sduKjA9MP4XjqhRAMVXb9f9I5Omqsce66Z4V34BlJU7uDhONfhnt0jCqb/6wwQtETUOqFoqvmwzflEGVuWhBAtIVEzixkelQjZkCltZEzm3YlsKec1eTT6LC9qBnU9tWvJRtfllasOg/HBPrhxhKUtJKkAKJStEDLGKU78xsVVr/vw5Fc6dG0sI5ntHRoks4ZpTZo3i1ZQcvtV+uJ39eYZ6JtJTh2hyvirgeVUJmWmHhLqa8jMoL08RUDRH+jq7cPAVAjVSLRRp0yPSRrsolr+QlJwsqL5OCBJBX0hRPhEK/MwMcoGO6Guot6j4dPmWeFSm9z6wC13qZPFaWXdAW2mvzpPaVUEMnb0LhkRBulOChognkdOCOAQv4bfwnTm/DnJROxu5imvOT632w1x6X5eWBHGGRl3Hw4FvCvdo2phYQKYg11/bX7XGDM8MPmoqtkqrmCvbIg782Dtvm1hoaKAZBC1E9IO7dSy4kA64lJn5D38O7rDUkQDDdmOdmF6KX9Gx6ee+87wjlqluVIaklEdR4eo2XDPuZZSWjDFisEEyRTUg2l5dchReu88sdzV78CDYPI0ckznlJoXVc0fKWT9F8NPOEpRxPKBigOhXf38bsE3CMI00kgj7jVkOLyNPKceAAqdy9nQw6ZcibbJ6lKwy+wZuuskjrIjXjwp/1GOpEpghg3OLUdRCVt6FqS0La+IB++ZxtlQ6d/Ub7ewcf+snlzIaV8DhA9n1TrOGH7RMBgJQXZYu+F+IeE3D9GZsN/VMB2x5t1JkJIzci8IVfDQh+toasncIGW0XyMfX0aRUtzlUy479wtZbTcuUU0IUklfLprB/czXdzXFGphHyCItB9MxKXvdGEhkGHs6f2CqmgTV4aqnIJMCvR9pAb1/KLb+ptZZDo0M3ev/EZu/07nr9an/Ayj6So1YJY4mJk3ZM9gH86TJbNI0ynxTLqogTWidslQ0GWfWfzVF0sdD+cbvh8M47xMWuX7Ogpak9N7zZiLI0CgVDHmMEoxbU+oHJ3ruQAnZ2Gj2SbX7cSDagFh2QL/z5qRIszV0VE1+/jJT0vjfd48Ay+RWFp/FS3OS8jXnRN6V2hwfy3bBHU/FCSeJD/3nI9y7z+icYb7ji8gBzoaSNfpzbXC9IHGJaeq8V5z5Gm1hU80ACSPJbBMV6tK1bUQi7LatKZ3UTbFToHMKSCcjNr55KX/+nCmOL5o7LAGIz+5gSLhRjNSCjolg+328VVNfiFogGkzs3QBQx+gcmOfocn0flYgA247/MdxLL3vW0aa344SYifl2T9OSWY4tMuiUOVXiSTQWrOqhRg1eBd2ClJLQc78+G2AeUoBNwucPPD+B3PLPZDqEHTKSGBqCd2FzqV5j+wSbnga1R9d5HhFEApXzMsGYlU24uPHo0isB11ooHgh7A+ScqxfIuHpyeKJX6Hdn++2RIHwyrNzPfSwueQqSBHMJ5bXLL99l863P2SKndH6gtjUa17GdAfOuE2gKWKb0KVQwB159P5j8Y6LknB6focKLJ6avtwBNiTThOYgLU5ABbcyIHE2MCgPyzCXxPmjHpRFR5q4LhNpzfvRZO8SoGwmLkIy9wdGImUw7+5Ib1sVXgQS212xd7imxIFo1urz+LH7RBQ32Z77DuhWQqVxqKYIEdVA1Ye5WDFMPKsn/QVHPZA+e9zqn9iDQjRC6lLmhS3G80Nhv3VPGOrOTswI8+uXOLZobrTNpRwPnnhMm6wW4lFsKhlcS8CCyI7NvDtEx4AaYq6iMtbygai+w8AEX8c8NXQd+8ZEPGi95Ax0TH+c9FonzEw2WwlzcGMGuYsRR4b0IyQaKu2uzU1uNc3jJ9D+iqsdvb+MgXohZfklB5mJlpqsUun6P11WCmjOnPUW+/XY5vtbJtiErHEeaPjpWXKxYXRBhw7BDiGTsvpwz8d9jQr4MkHUUZsjpAePM1RdZnSR+uAwsTSjqynzvhNHGjc1OE1tq1onYaG9IET1sXButabl7fPYMFomy899SSzrrCqKgM5zAz+eLXyz60T404Eb4ZwaAjFso6VynLy7JxaBlzGnwRjjR0ial3xZPHBtqircw1ylQ9odL0JAOxaPEOjEkUu7sw/zWnO6CwJZmD2NTgcoxNKzCxe4oY5tiMbktVXzBzZXOzLs5c4nJLxDBaNYOZTJGJddfV+s2OeAu+etx2A+6OWLo/BM7NkX3CuYrooYiEkgL8ti9jyvO7SYITZft8gPsCvb1p+oTGwYgf4gCHRDdBgEhoFP+DrKfDWq7X4oDcgEmHKjASy5Lp1/tuyOyLyH093nyd4hk+HPjvxToc/dgN+7LhrEnvS7rmhmugN8qq5WS5nTRL1aObX4lx8pPeQ9q8qM/C6+bLncMtT5+UsQLDpdynYIBYDCc7vGFOGUBXJAekuSDTjU0kofIplCB20T1p583caPJUkm9fnOWY9v5dxTKp0NpcQGQbL17ZNsAHe77MnRkUPd33WISjeAPGo82io4sScupmYZ3Iia7Ztj0QBsllFpf9T5aPFBaaA0QFUwxp3dV3F2bthn0FeQjmw2YyYvEf8rLhNr3NJoxgHGv4XwEAAg1KH8tX+g7fnqRZ0KmbGK809WBxXTQpeuGTR535wEJ7lrLPMRAP+vhnXhai8JIL7v8Sdz8oc4s72qMR5630LYH0Nb6QLLNYwpWfMGULxYufvyjl10spvYQB8bvVniu2jgihGdAXBjZe2LpUqM3NWln189Hmxkj8Dde7pVSDiPUr+5Kh9hYLUsMCJbFArsPkDsx7st4wwAZtWK8xEhd/Og2cBcne/TY7ET/TgtLm3scN1St/d31PgTSRTJbgY7Ctopwv0+vAqfqERYgU67RnggbF0he3dgFnvY4DnSDFnURClb70PVZg7fAX7svbjBIskDj/ndsf2ymkJtYarujxNY2QgNiLnz2enkbSZUk3bA7B+oL6OuUAUsla9oLztPx35gGAOHSGrBGnm97deIyk2oWaJtLoRg8WLUUZma01Zd38A/Sdw2ve2R8p5arQP4GmsE3Z6vsYA4PO2QkmFN5hkM/kQNvneqE5RLeTqzOb+2zyQZAHPDJEFxYQHWO3yS1lNQtbJceDtDbUVxr/qAeCKt4FhZI6RXcrVFF++rVygMcbjVd3NdpGzg+fjAS8vnX+SP/GbrC6Qu8EVcw84IuwcBaebxUYHBOPYwkeBYkxgzuGdaA+pz4uqHzxAa01VpXwYlj0IOU+jl5sfuK3F/W8iIsI8EQueqCs8WkrcFswPV3ctvHM67o0UeizH+UuiMSDwY7OjNqjiHfBpQ+2WRS6r21OGwhsduBKqhV8IvQTDqqpKcqMPxLJ0zGYZubIfS+XouoCrYCK9OulTZen6WDAxAqQIZ9m6qg4nOxALxYNOj39h83NiXszUbpxKNGQecD2ehfk2jh5D5ownKak+DYp38e61HSlNL/ZLTZ1KbYWhvNS0sEWS22+dHtximddQcWqrphhdhmhbWTuwURoUvMzySSb7yXwttpq+Ng/TXuul7UhR5tZRKStyg5zgBt9PUB5MwQkQtRpCjT169rMqwJCB49ci0oHr6ZAeQsySC8eYXtamwzXJDeMHWTB+CueOnAItFqco+2jAPXNg4s4fxUBRwGJKlPqMJ+qn+GwxyfAiuGASKM+H4rM7LD8Nn4rYnvot3rBFg4x6E0G/0XSU9iMdUJUbJKxalNpndBTATjEP+oxVK4XyOmzbvX7aWoB633XyigBGvY76nrBQRpa6oXn34UL4RLfHwS/H4VUFTfdw4iCs1Fv4iLj180dCAxFDQu4otRZ/QNYIaIz8NjLWOzLHRgcSvpAV9/ShhQcTXHVBwZ8aSOUJvKBMefLdn9xyiXmJDtYcsSvi1D3oXGBhqWrpe3Erq0NaHsDFwsetS0tNGQ30VlS+bM7EMi/e8tPYSbw/gTdb90hgO6J6eZtHDfAoo8WGhBKlyLCKL0tvlkH5XoOMF6jAXVps9Z4jvcYJSP3enH75xq9PsPTBQ9hwZhq8GdCe0sTjGcTYEK5jAkvUQ3wttxMrivoPwQNiF0CLuviNEYqvua7Qc0+WZ7H4g8Sjr9KsMd12//+8cznav1ySk+cCUXkJLCKMKXO9pf57BPNBA94twzwT7IGOXtdgB/5FyE+UhmX/2e8i1NkEqqhM2gfcg3fH87blF2uAy8ixlHg2uwIQ01tYryrC2x4wvQEolKYmmO6huZXF3isRfyvRe0OQIdTB/fpoZwtAlRA6HqVkoiwhHLDB4DV7w0O4qb7t2SiJCwUYpwaptdaXbIqfMGkmfKDf0D+pS5SlXfU3n20frVYS7U8YiCQWrxuGnMmBwktQdlQJifzd6oo0YCg9wcBPP1KqVwG0BHCrHTn15Pur1JAwqMGclLDtsOP9P5iOV77gXiCZOK13HBacqe3IYzYgKvZ9kzPJV+Ld4mnVO9kZNialcinIbYKnStL1OySYTcOSdKxZO1dqgMdaUgan5XIq1wklsS7pJJ9THdKDAuiz+V9TvjDR8vgEQBKmUisVMFpyZQ6Gw03Ep0aYV4X5k/JPZKU55bxZ6+KfTqQ4z1suCJg2d9fnlJ85bSNh4fhXiycpDxklGeX/EuTYwU4QZ3vNXQeGxdh3gTROTiFyyMtRq+TDNVLvH5huo7HlY+UIOohBh3IOXTlQfj2P/PlxJsys2P4XGRbYzK6qsZVSRolwPM93ATaNk1l4+dA4ZOiSD9VPytFy1AiC7QeUqEEODfEYRyhvAHiqq/yfGFBY4GQOkFLy8R3iG5nabpBdqrvITNVqflb1xsdwzzF7peq2UomNFAGwEIHg8skZ0E8699Ci15dNjx1BiM8gI/b0b/H5cpni2okrPrjhxGRGz5Inhp5UfwSugFJ0A65H6yUpZCaniplmcZOHvp94pR9XbBmwOf2jNtnOGnvv1MKNZJFccw6IRyPJpqP1Yc90e5o9O1Zz6mrziIiA+NzmDyX1I5mB1SDqickX2DgAA9MX+Qyl8SU47Pxq9L7fanSXsVckU7K2H8cPcRhwH2XAcm3hY5dm4nM17eMlg16ZbmduhGH9LJE2utNeNfBaaeH2I/UnmEhI1rvPRnIfqvU7z1/lD8Sh4u5mTzZco5V5J/zvShx51LJRZ6y2gIQ2GtW1rnYw/SEmnH7fmz5CrtQ2PR+zC9Zi57y1/MZQtKNNKNBfMSD9U4CCuXucOhmgyi+5UdBki+ubijzohYHcKc+8nW9UYjLu0DVL0HtxWgl8RkHe9xbduTuQw9Pl59b1qK84C/XGYi7+3pJSBpldVmS1OuS430KBSNEadIDVgYUCloQFfDTTHdfprm5m5eF0ZKeWGglLs/9X2a0fswKxmWAA2VK35qPaKDZmIG98/wIrocxQM8jDzC5dPAGskvSWAc9clP4iNe0rcv3R8f4UnfjnyP1C/53XYHNVrMQKG9KOG+XUZboBV9F2+B9njnnIYCh5kaTDDoeKKo2xb+NGm5zNHyLBy4jA5ATCJ1uffgAUhsYT5GF96IDzv2WQAdOnPrYkP36Rl1g7S76FyaDsvCg3ZJCFHS5jD76XW1SD6YXy4dIBiGDOD4QniMXPzCxBdS0o0rOfLghquhsTTF5EgeufhD48R+2fkYFIErBnuZ9nVVQjCcuvAXW6UiXKi2GrQciAyIB9tEWSVY/vcwIRyyJ1IuuKyq50fYJgpdrVDTjsvcOYYgPVgF++++V1Etv2EGVpL1e+QdwUYa9omYJc5bbo68fa1gUuaGqURQQKCD1nL4RzVW+faqGnjaHN9P/kDaZt1T0dWYIl0Bi/gleKmO1trc5Eeavp8J1c4k2oyCkFwvr8fngwx1LGER15mC8V6/oio0zqfYZVHU/YODMLJdrXoHsWljyyTG9Djz7gX+QjBQixEU33WicuWWQiNQGBL+ZqIFaKe4TyunHPjg1ULkD8Bjb6cp6WFFl0RUrQVKRcvSP0J5EFDRZEl1xO8KuhTuQ9jmRpyzMfOcA1bZA2t7GZxhQS4J0bGKBQzRXBqv5Q5D+WnDhd7uArBs4pb8uWsjN0cH9/7kAjac3eCdY3Xc37M8ZJikZHGJ1Yk0JljMNnk9RBHgOnNcpQmVbrPzegCdy8Th0ZY2GYe8ShFQde4k1ys0iCw7D6ozE+K2ixzIsI3pAVXvbAT8VozY0iAvDtEaTNKubsrDwKxr1YIj/wKGt5cczilAF2mocNKUf7lTuUw0EK1JKzvplrrAIqBXe3VcZrFHvwXTugRlmakAF7OCpA1qKC3Vkzz8DR1cS1mOlS2knu98AkKDRuuWLS+moh3JArU9Bu56+OHkQ+PX5Qw7kj6D5wwFY/1yLRswiriOxYxK6GidHt4q1veQOtGSMhJ5vsp2N7HiOqoTZsrecTLi6gC3qikpti1xU9uJasleFqRz0Yleu0DfomENaKUvBeDfHS8MCAkDdbbTzn37H6WmzpgsMBEBJu+92rBZCV5XLnKVq2nW7zMf8f0LF0ZBSumERy2fgi6jJwhPfqjjtfvorKXrIOLRFnI4X5ZNYrg4qjiVJipJIFShfw0gwgzXKJIstMorRBRQgC58/ktMmdTGMha0yt4VZ5ctuQGMWpI3eLAZTobeZ1UwMWTypow5zoWz8yG0LA+I3HxCm/DZGK3nuXir7POyiVpPim6ft0Sv0VzpZ6U8lmxDdpsgtcLMs6siCGGzgmdkivR4NutxNlkMpXyag3ISLurmT8qzRtIy3CGY4jMh55onNICyX43PzwMUv1UQTO22xZ3tJhkq4wl+kIcjDVc6GKJ5tJLCpyYISrw7ahQkjIN0VDe31LOi13JoPEkWC1OJ8i8cSIvlI+DvxAYHz4CRrPTOtjAiRX5E7DLbSsoLR885kSvvEfT4z/JByYkBjvSq564thpyNcj758R4/kcrsrFXjT68oH4l6GWHJip/SiulrX8PFgUlSQhpMCtIi+Y3lH2yMGXdTR6+/wlUo9Lg5okSmsDgXq7LXkB0HDupBxo+WPRT5k+RfHw+xyNV2w9xIwbo4qaahmbGXyy30rm+HnPC50gR/QwQuCRRNnJ82IYKQ/VxnyFKXP5f6nxCdahT1Y9c0ZX5RDxvLgQoUugcuvoZbIDBWIjBzm6+BIQ+CMER0QBFf93EP69Ajt4yrEJ3qz3qMdwyd42nWRruXsqNWvdZzFlYgfeRxAr4IBrbNVx3VOvRiMfrIsuwT6Q+Nk7Wm89UiLLWzMqHO/dm72+HPCspD5W9OKO6xLAlzN5RYvXJxI8ugoMR50RYJIlKYRPyL1owpbbZnE2Wov+Uz1P98JmYMyJeccDM0IshqSorZe5MeYy0KUE/E5XsK6+ZgIb8M41wNnCM3MK26R1dRuBZ0lyW2c0sc/xIK/m0S1NVtpwPSbmItAksU5Q67SEMTFN8G1Em1l20XtD5HkoeGZn4hW6LSn9Kl7WF8JS42mTOrKpadLwE+dEEdY2yBY6v0elUYfD/c2Q5XuEAAKamFz3k/otuIOAu5YjE/WGxb62v9Z/vZ1Qkfkdtrrabiou]]></content>
      <categories>
        <category>å…¶ä»–</category>
      </categories>
      <tags>
        <tag>å…¶ä»–</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[React æŠ€æœ¯æ ˆ]]></title>
    <url>%2Farchives%2F4a9b.html</url>
    <content type="text"><![CDATA[React æŠ€æœ¯æ ˆReact æ˜¯ç›®å‰æœ€çƒ­é—¨çš„å‰ç«¯æ¡†æ¶ã€‚Facebook å…¬å¸2013å¹´æ¨å‡ºç°åœ¨æœ€å¥½çš„ç¤¾åŒºæ”¯æŒå’Œç”Ÿæ€åœˆå¤§é‡çš„ç¬¬ä¸‰æ–¹å·¥å…·React çš„ä¼˜ç‚¹ç»„ä»¶æ¨¡å¼ï¼šä»£ç å¤ç”¨å’Œå›¢é˜Ÿåˆ†å·¥è™šæ‹Ÿ DOMï¼šæ€§èƒ½ä¼˜åŠ¿ç§»åŠ¨ç«¯æ”¯æŒï¼šè·¨ç»ˆç«¯React çš„ç¼ºç‚¹å­¦ä¹ æ›²çº¿è¾ƒé™¡å³­å…¨æ–°çš„ä¸€å¥—æ¦‚å¿µï¼Œä¸å…¶ä»–æ‰€æœ‰æ¡†æ¶æˆªç„¶ä¸åŒåªæœ‰é‡‡ç”¨å®ƒçš„æ•´ä¸ªæŠ€æœ¯æ ˆï¼Œæ‰èƒ½å‘æŒ¥æœ€å¤§å¨åŠ›æ€»ç»“ï¼šReact éå¸¸å…ˆè¿›å’Œå¼ºå¤§ï¼Œä½†æ˜¯å­¦ä¹ å’Œå®ç°æˆæœ¬éƒ½ä¸ä½JSX è¯­æ³•React ä½¿ç”¨ JSX è¯­æ³•ï¼ŒJavaScript ä»£ç ä¸­å¯ä»¥å†™ HTML ä»£ç ã€‚1let myTitle = &lt;h1&gt;Hello, world!&lt;/h1&gt;;JSX è¯­æ³•è§£é‡Šï¼ˆ1ï¼‰JSX è¯­æ³•çš„æœ€å¤–å±‚ï¼Œåªèƒ½æœ‰ä¸€ä¸ªèŠ‚ç‚¹ã€‚12// é”™è¯¯let myTitle = &lt;p&gt;Hello&lt;/p&gt;&lt;p&gt;World&lt;/p&gt;;ï¼ˆ2ï¼‰JSX è¯­æ³•ä¸­å¯ä»¥æ’å…¥ JavaScript ä»£ç ï¼Œä½¿ç”¨å¤§æ‹¬å·ã€‚1let myTitle = &lt;p&gt;&#123;'Hello ' + 'World'&#125;&lt;/p&gt;Babel è½¬ç å™¨JavaScript å¼•æ“ï¼ˆåŒ…æ‹¬æµè§ˆå™¨å’Œ Nodeï¼‰éƒ½ä¸è®¤è¯† JSXï¼Œéœ€è¦é¦–å…ˆä½¿ç”¨ Babel è½¬ç ï¼Œç„¶åæ‰èƒ½è¿è¡Œã€‚123456&lt;script src="react.js"&gt;&lt;/script&gt;&lt;script src="react-dom.js"&gt;&lt;/script&gt;&lt;script src="babel.min.js"&gt;&lt;/script&gt;&lt;script type="text/babel"&gt; // ** Our code goes here! **&lt;/script&gt;React éœ€è¦åŠ è½½ä¸¤ä¸ªåº“ï¼šReact å’Œ React-DOMï¼Œå‰è€…æ˜¯ React çš„æ ¸å¿ƒåº“ï¼Œåè€…æ˜¯ React çš„ DOM é€‚é…åº“ã€‚Babel ç”¨æ¥åœ¨æµè§ˆå™¨è½¬æ¢ JSX è¯­æ³•ï¼Œå¦‚æœæœåŠ¡å™¨å·²ç»è½¬å¥½äº†ï¼Œæµè§ˆå™¨å°±ä¸éœ€è¦åŠ è½½è¿™ä¸ªåº“ã€‚è¯¾å ‚ç»ƒä¹ ï¼šJSX è¯­æ³•æµè§ˆå™¨æ‰“å¼€demos/jsx-demo/index.htmlï¼ŒæŒ‰ç…§ã€Šæ“ä½œè¯´æ˜ã€‹ï¼Œå®Œæˆç»ƒä¹ ã€‚1234ReactDOM.render( &lt;span&gt;Hello World!&lt;/span&gt;, document.getElementById('example'));ç¤ºä¾‹ï¼šReact ç»„ä»¶React å…è®¸ç”¨æˆ·å®šä¹‰è‡ªå·±çš„ç»„ä»¶ï¼Œæ’å…¥ç½‘é¡µã€‚æµè§ˆå™¨æ‰“å¼€demos/react-component-demo/index1.htmlï¼ŒæŒ‰ç…§ã€Šæ“ä½œè¯´æ˜ã€‹ï¼Œä»”ç»†æŸ¥çœ‹æºç ã€‚12345678910class MyTitle extends React.Component &#123; render() &#123; return &lt;h1&gt;Hello World&lt;/h1&gt;; &#125;&#125;;ReactDOM.render( &lt;MyTitle/&gt;, document.getElementById('example'));è¯¾å ‚ç»ƒä¹ ï¼šç»„ä»¶çš„å‚æ•°ç»„ä»¶å¯ä»¥ä»å¤–éƒ¨ä¼ å…¥å‚æ•°ï¼Œå†…éƒ¨ä½¿ç”¨this.propsè·å–å‚æ•°ã€‚æ‰“å¼€demos/react-component-demo/index2.htmlï¼ŒæŒ‰ç…§ã€Šæ“ä½œè¯´æ˜ã€‹ï¼Œå®Œæˆç»ƒä¹ ã€‚123456789class MyTitle extends React.Component &#123; render() &#123; return &lt;h1 style=&#123;&#123;color: this.props.color&#125;&#125; &gt;Hello World&lt;/h1&gt;; &#125;&#125;;&lt;MyTitle color="red" /&gt;,ç¤ºä¾‹ï¼šç»„ä»¶çš„çŠ¶æ€ç»„ä»¶å¾€å¾€ä¼šæœ‰å†…éƒ¨çŠ¶æ€ï¼Œä½¿ç”¨this.stateè¡¨ç¤ºã€‚æµè§ˆå™¨æ‰“å¼€demos/react-component-demo/index3.htmlï¼ŒæŒ‰ç…§ã€Šæ“ä½œè¯´æ˜ã€‹ï¼Œä»”ç»†æŸ¥çœ‹æºç ã€‚è¯¾å ‚ç»ƒä¹ ï¼šReact ç»„ä»¶å®æˆ˜æµè§ˆå™¨æ‰“å¼€demos/react-component-demo/index4.htmlï¼ŒæŒ‰ç…§ã€Šæ“ä½œè¯´æ˜ã€‹ï¼Œå®Œæˆç»ƒä¹ ã€‚ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸReact ä¸ºç»„ä»¶çš„ä¸åŒç”Ÿå‘½é˜¶æ®µï¼Œæä¾›äº†è¿‘åä¸ªé’©å­æ–¹æ³•ã€‚componentWillMount()ï¼šç»„ä»¶åŠ è½½å‰è°ƒç”¨componentDidMount()ï¼šç»„ä»¶åŠ è½½åè°ƒç”¨componentWillUpdate(): ç»„ä»¶æ›´æ–°å‰è°ƒç”¨componentDidUpdate(): ç»„ä»¶æ›´æ–°åè°ƒç”¨componentWillUnmount()ï¼šç»„ä»¶å¸è½½å‰è°ƒç”¨componentWillReceiveProps()ï¼šç»„ä»¶æ¥å—æ–°çš„å‚æ•°æ—¶è°ƒç”¨æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™äº›é’©å­ï¼Œè‡ªåŠ¨å®Œæˆä¸€äº›æ“ä½œã€‚è¯¾å ‚ç»ƒä¹ ï¼šç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸç»„ä»¶å¯ä»¥é€šè¿‡ Ajax è¯·æ±‚ï¼Œä»æœåŠ¡å™¨è·å–æ•°æ®ã€‚Ajax è¯·æ±‚ä¸€èˆ¬åœ¨componentDidMountæ–¹æ³•é‡Œé¢å‘å‡ºã€‚123456componentDidMount() &#123; const url = '...'; $.getJSON(url) .done() .fail();&#125;æ‰“å¼€demos/react-lifecycle-demo/index.htmlï¼ŒæŒ‰ç…§ã€Šæ“ä½œè¯´æ˜ã€‹ï¼Œå®Œæˆç»ƒä¹ ã€‚React ç»„ä»¶åº“React çš„ä¸€å¤§ä¼˜åŠ¿ï¼Œå°±æ˜¯ç½‘ä¸Šæœ‰å¾ˆå¤šå·²ç»å†™å¥½çš„ç»„ä»¶åº“ï¼Œå¯ä»¥ä½¿ç”¨ã€‚React-Bootstrapï¼šhttps://react-bootstrap.github.io/ç¤ºä¾‹ï¼šReChartsReCharts æ˜¯ä¸€ä¸ª React å›¾è¡¨ç»„ä»¶åº“ã€‚http://recharts.org/æµè§ˆå™¨æ‰“å¼€demos/recharts-demo/index.htmlï¼ŒæŒ‰ç…§ã€Šæ“ä½œè¯´æ˜ã€‹ï¼Œä»”ç»†æŸ¥çœ‹æºç ï¼Œä½“ä¼š JSX è¯­æ³•å¯¹è¡¨è¾¾å¤æ‚ç»„ä»¶çš„ä¼˜åŠ¿ã€‚1234567&lt;LineChart width=&#123;1000&#125; height=&#123;400&#125; data=&#123;data&#125;&gt; &lt;XAxis dataKey="name"/&gt; &lt;YAxis/&gt; &lt;CartesianGrid stroke="#eee" strokeDasharray="5 5"/&gt; &lt;Line type="monotone" dataKey="uv" stroke="#8884d8" /&gt; &lt;Line type="monotone" dataKey="pv" stroke="#82ca9d" /&gt;&lt;/LineChart&gt;React çš„æ ¸å¿ƒæ€æƒ³View æ˜¯ State çš„è¾“å‡ºã€‚1view = f(state)ä¸Šå¼ä¸­ï¼Œfè¡¨ç¤ºå‡½æ•°å…³ç³»ã€‚åªè¦ State å‘ç”Ÿå˜åŒ–ï¼ŒView ä¹Ÿè¦éšä¹‹å˜åŒ–ã€‚React çš„æœ¬è´¨æ˜¯å°†å›¾å½¢ç•Œé¢ï¼ˆGUIï¼‰å‡½æ•°åŒ–ã€‚12345678const person = &#123; name: "michel", age: 31&#125;const App = (&#123; person &#125;) =&gt; &lt;h1&gt;&#123; person.name &#125;&lt;/h1&gt;ReactDOM.render(&lt;App person=&#123;person&#125; /&gt;, document.body)React æ²¡æœ‰è§£å†³çš„é—®é¢˜React æœ¬èº«åªæ˜¯ä¸€ä¸ª DOM çš„æŠ½è±¡å±‚ï¼Œä½¿ç”¨ç»„ä»¶æ„å»ºè™šæ‹Ÿ DOMã€‚å¦‚æœå¼€å‘å¤§åº”ç”¨ï¼Œè¿˜éœ€è¦è§£å†³ä¸¤ä¸ªé—®é¢˜ã€‚æ¶æ„ï¼šå¤§å‹åº”ç”¨ç¨‹åºåº”è¯¥å¦‚ä½•ç»„ç»‡ä»£ç ï¼Ÿé€šä¿¡ï¼šç»„ä»¶ä¹‹é—´å¦‚ä½•é€šä¿¡ï¼Ÿæ¶æ„é—®é¢˜React åªæ˜¯è§†å›¾å±‚çš„è§£å†³æ–¹æ¡ˆï¼Œå¯ä»¥ç”¨äºä»»ä½•ä¸€ç§æ¶æ„ã€‚MVCMVVMObserverReactiveâ€¦åˆ°åº•å“ªä¸€ç§æ¶æ„æœ€åˆé€‚ React ï¼Ÿé€šä¿¡é—®é¢˜ç»„ä»¶ä¼šå‘ç”Ÿä¸‰ç§é€šä¿¡ã€‚å‘å­ç»„ä»¶å‘æ¶ˆæ¯å‘çˆ¶ç»„ä»¶å‘æ¶ˆæ¯å‘å…¶ä»–ç»„ä»¶å‘æ¶ˆæ¯React åªæä¾›äº†ä¸€ç§é€šä¿¡æ‰‹æ®µï¼šä¼ å‚ã€‚å¯¹äºå¤§åº”ç”¨ï¼Œå¾ˆä¸æ–¹ä¾¿ã€‚çŠ¶æ€çš„åŒæ­¥é€šä¿¡çš„æœ¬è´¨æ˜¯çŠ¶æ€çš„åŒæ­¥ã€‚React åŒæ­¥çŠ¶æ€çš„åŸºæœ¬æ–¹æ³•ï¼šæ‰¾åˆ°é€šä¿¡åŒæ–¹æœ€è¿‘çš„å…±åŒçˆ¶ç»„ä»¶ï¼Œé€šè¿‡å®ƒçš„stateï¼Œä½¿å¾—å­ç»„ä»¶çš„çŠ¶æ€ä¿æŒåŒæ­¥ã€‚Flux æ¶æ„Facebook æå‡º Flux æ¶æ„çš„æ¦‚å¿µï¼Œè¢«è®¤ä¸ºæ˜¯ React åº”ç”¨çš„æ ‡å‡†æ¶æ„ã€‚æœ€å¤§ç‰¹ç‚¹ï¼šæ•°æ®å•å‘æµåŠ¨ã€‚ä¸ MVVM çš„æ•°æ®åŒå‘ç»‘å®šï¼Œå½¢æˆé²œæ˜å¯¹æ¯”ã€‚Flux çš„æ ¸å¿ƒæ€æƒ³ä¸åŒç»„ä»¶çš„stateï¼Œå­˜æ”¾åœ¨ä¸€ä¸ªå¤–éƒ¨çš„ã€å…¬å…±çš„ Store ä¸Šé¢ã€‚ç»„ä»¶è®¢é˜… Store çš„ä¸åŒéƒ¨åˆ†ã€‚ç»„ä»¶å‘é€ï¼ˆdispatchï¼‰åŠ¨ä½œï¼ˆactionï¼‰ï¼Œå¼•å‘ Store çš„æ›´æ–°ã€‚Flux åªæ˜¯ä¸€ä¸ªæ¦‚å¿µï¼Œæœ‰30å¤šç§å®ç°ã€‚ç›®å‰æœ€æµè¡Œçš„ä¸¤ä¸ª React æ¶æ„React æ¶æ„çš„æœ€é‡è¦ä½œç”¨ï¼šç®¡ç† Store ä¸ View ä¹‹é—´çš„å…³ç³»ã€‚MobXï¼šå“åº”å¼ï¼ˆReactiveï¼‰ç®¡ç†ï¼Œstate æ˜¯å¯å˜å¯¹è±¡ï¼Œé€‚åˆä¸­å°å‹é¡¹ç›®Reduxï¼šå‡½æ•°å¼ï¼ˆFunctionalï¼‰ç®¡ç†ï¼Œstate æ˜¯ä¸å¯å˜å¯¹è±¡ï¼Œé€‚åˆå¤§å‹é¡¹ç›®MobX æ¶æ„MobX çš„æ ¸å¿ƒæ˜¯è§‚å¯Ÿè€…æ¨¡å¼ã€‚Store æ˜¯è¢«è§‚å¯Ÿè€…ï¼ˆobservableï¼‰ç»„ä»¶æ˜¯è§‚å¯Ÿè€…ï¼ˆobserverï¼‰ä¸€æ—¦Storeæœ‰å˜åŒ–ï¼Œä¼šç«‹åˆ»è¢«ç»„ä»¶è§‚å¯Ÿåˆ°ï¼Œä»è€Œå¼•å‘é‡æ–°æ¸²æŸ“ã€‚MobX çš„æœ€ç®€å•ä¾‹å­1234567891011const &#123;observable&#125; = mobx;const &#123;observer&#125; = mobxReact;const person = observable(&#123;name: "å¼ ä¸‰", age: 31&#125;);const App = observer( (&#123; person &#125;) =&gt; &lt;h1&gt;&#123; person.name &#125;&lt;/h1&gt;);ReactDOM.render(&lt;App person=&#123;person&#125; /&gt;, document.body);person.name = "æå››";ä»£ç ï¼šdemos/mobx-demo/browser-demoç›®å½•ç¤ºä¾‹ï¼šMobXè¿›å…¥demos/mobx-demoç›®å½•ï¼ŒæŒ‰ç…§ã€Šæ“ä½œè¯´æ˜ã€‹ï¼Œç†è§£ MobX æ¡†æ¶ã€‚UI å±‚æ˜¯è§‚å¯Ÿè€…ï¼ŒStore æ˜¯è¢«è§‚å¯Ÿè€…ã€‚Store æ‰€æœ‰çš„å±æ€§ï¼Œåˆ†æˆä¸¤å¤§ç±»ï¼šç›´æ¥è¢«è§‚å¯Ÿçš„å±æ€§å’Œè‡ªåŠ¨è®¡ç®—å‡ºæ¥çš„å±æ€§ã€‚123456class Store &#123; @observable name = 'Bartek'; @computed get decorated() &#123; return `$&#123;this.name&#125; is awesome!`; &#125;&#125;UI ä¼šè§‚å¯Ÿåˆ° Store çš„å˜åŒ–ï¼Œè‡ªåŠ¨é‡æ–°æ¸²æŸ“ã€‚Redux æ¶æ„Redux çš„æ ¸å¿ƒæ¦‚å¿µæ‰€æœ‰çš„çŠ¶æ€å­˜æ”¾åœ¨Storeã€‚ç»„ä»¶æ¯æ¬¡é‡æ–°æ¸²æŸ“ï¼Œéƒ½å¿…é¡»ç”±çŠ¶æ€å˜åŒ–å¼•èµ·ã€‚ç”¨æˆ·åœ¨ UI ä¸Šå‘å‡ºactionã€‚reducerå‡½æ•°æ¥æ”¶actionï¼Œç„¶åæ ¹æ®å½“å‰çš„stateï¼Œè®¡ç®—å‡ºæ–°çš„stateã€‚Redux åº”ç”¨çš„æ¶æ„Redux å±‚ä¿å­˜æ‰€æœ‰çŠ¶æ€ï¼ŒReact ç»„ä»¶æ‹¿åˆ°çŠ¶æ€ä»¥åï¼Œæ¸²æŸ“å‡º HTML ä»£ç ã€‚ç¤ºä¾‹ï¼šReduxè¿›å…¥demos/redux-demoç›®å½•ï¼ŒæŒ‰ç…§ã€Šæ“ä½œè¯´æ˜ã€‹ï¼Œç†è§£ Redux æ¡†æ¶ã€‚Redux å°†ç»„ä»¶åˆ†æˆ UI ç»„ä»¶å’Œå®¹å™¨ç»„ä»¶ä¸¤ç±»ã€‚UI ç»„ä»¶æ˜¯çº¯ç»„ä»¶ï¼Œä¸åŒ…å« state å’Œç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œä¸æ¶‰åŠç»„ä»¶çš„è¡Œä¸ºï¼Œåªæ¶‰åŠç»„ä»¶çš„å¤–è§‚ã€‚1234567&lt;div className="index"&gt; &lt;p&gt;&#123;this.props.text&#125;&lt;/p&gt; &lt;input defaultValue=&#123;this.props.name&#125; onChange=&#123;this.props.onChange&#125; /&gt;&lt;/div&gt;å®¹å™¨ç»„ä»¶æ­£å¥½ç›¸åã€‚ä¸æ¶‰åŠç»„ä»¶çš„å¤–è§‚ï¼Œåªæ¶‰åŠç»„ä»¶çš„è¡Œä¸ºã€‚è´Ÿè´£è®¢é˜… Storeï¼Œå°† Store çš„æ•°æ®å¤„ç†ä»¥åï¼Œå†é€šè¿‡å‚æ•°ä¼ ç»™ UI ç»„ä»¶ã€‚ç”¨æˆ·ç»™å‡ºé…ç½®ä»¥åï¼Œç”± Redux ç”Ÿæˆã€‚12345// MyComponent æ˜¯çº¯çš„ UI ç»„ä»¶const App = connect( mapStateToProps, mapDispatchToProps)(MyComponent);mapStateToProps: å®šä¹‰ UI ç»„ä»¶å‚æ•°ä¸ State ä¹‹é—´çš„æ˜ å°„mapDispatchToPropsï¼šå®šä¹‰ UI ç»„ä»¶ä¸ Action ä¹‹é—´çš„æ˜ å°„æ‹†åˆ† UI ç»„ä»¶å’Œå®¹å™¨ç»„ä»¶çš„å¥½å¤„UI ç»„ä»¶ä¸åå°æ•°æ®æ— å…³ï¼Œå¯ä»¥ç”±è®¾è®¡å¸ˆè´Ÿè´£å®¹å™¨ç»„ä»¶åªè´Ÿè´£æ•°æ®å’Œè¡Œä¸ºï¼Œä¸€æ—¦ Store çš„æ•°æ®ç»“æ„å˜åŒ–ï¼Œåªè¦è°ƒæ•´å®¹å™¨ç»„ä»¶å³å¯è¡¨ç°å±‚å’ŒåŠŸèƒ½å±‚è„±é’©ï¼Œæœ‰åˆ©äºä»£ç é‡ç”¨ï¼Œä¹Ÿæœ‰åˆ©äºçœ‹æ¸…åº”ç”¨çš„æ•°æ®ç»“æ„å’Œä¸šåŠ¡é€»è¾‘Reducer å‡½æ•°reduceræ˜¯ä¸€ä¸ªçº¯å‡½æ•°ï¼Œç”¨æ¥æ¥æ”¶actionï¼Œç®—å‡ºæ–°çš„stateã€‚123456789101112function reducer(state = &#123; text: 'ä½ å¥½ï¼Œè®¿é—®è€…', name: 'è®¿é—®è€…'&#125;, action) &#123; switch (action.type) &#123; case 'change': return &#123; name: action.payload, text: 'ä½ å¥½ï¼Œ' + action.payload &#125;; &#125;&#125;Storeç”± Redux æä¾›çš„createStoreæ–¹æ³•ç”Ÿæˆï¼Œè¯¥æ–¹æ³•æ¥å—reducerä½œä¸ºå‚æ•°ã€‚ä¸ºäº†æŠŠStoreä¼ å…¥ç»„ä»¶ï¼Œå¿…é¡»ä½¿ç”¨ Redux æä¾›çš„Providerç»„ä»¶åœ¨åº”ç”¨çš„æœ€å¤–é¢ï¼ŒåŒ…è£¹ä¸€å±‚ã€‚12345678const store = createStore(reducer);ReactDOM.render( &lt;Provider store=&#123;store&#125;&gt; &lt;App /&gt; &lt;/Provider&gt;, document.body.appendChild(document.createElement('div')));æœ¬æ–‡ä½œè€…ï¼š Andyæœ¬æ–‡åœ°å€ï¼š https://andyxw.com/archives/4a9b.htmlç‰ˆæƒå£°æ˜ï¼š è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼]]></content>
      <categories>
        <category>React</category>
      </categories>
      <tags>
        <tag>React</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[React è®¾è®¡æ€æƒ³]]></title>
    <url>%2Farchives%2F7615.html</url>
    <content type="text"><![CDATA[React è®¾è®¡æ€æƒ³è¯‘è€…åºï¼šæœ¬æ–‡æ˜¯ React æ ¸å¿ƒå¼€å‘è€…ã€æœ‰ React API ç»ˆç»“è€…ä¹‹ç§°çš„ Sebastian MarkbÃ¥ge æ’°å†™ï¼Œé˜è¿°äº†ä»–è®¾è®¡ React çš„åˆè¡·ã€‚é˜…è¯»æ­¤æ–‡ï¼Œä½ èƒ½ç«™åœ¨æ›´é«˜çš„é«˜åº¦æ€è€ƒ React çš„è¿‡å»ã€ç°åœ¨å’Œæœªæ¥ã€‚åŸæ–‡åœ°å€ï¼šhttps://github.com/reactjs/react-basicæˆ‘å†™æ­¤æ–‡æ˜¯æƒ³æ­£å¼åœ°é˜è¿°æˆ‘å¿ƒä¸­ React çš„å¿ƒæ™ºæ¨¡å‹ã€‚ç›®çš„æ˜¯è§£é‡Šä¸ºä»€ä¹ˆæˆ‘ä»¬ä¼šè¿™æ ·è®¾è®¡ Reactï¼ŒåŒæ—¶ä½ ä¹Ÿå¯ä»¥æ ¹æ®è¿™äº›è®ºç‚¹åæ¨å‡º Reactã€‚ä¸å¯å¦è®¤ï¼Œæ­¤æ–‡ä¸­çš„éƒ¨åˆ†è®ºæ®æˆ–å‰æå°šå­˜äº‰è®®ï¼Œè€Œä¸”éƒ¨åˆ†ç¤ºä¾‹çš„è®¾è®¡å¯èƒ½å­˜åœ¨ bug æˆ–ç–å¿½ã€‚è¿™åªæ˜¯æ­£å¼ç¡®å®šå®ƒçš„æœ€åˆé˜¶æ®µã€‚å¦‚æœä½ æœ‰æ›´å¥½çš„å®Œå–„å®ƒçš„æƒ³æ³•å¯ä»¥éšæ—¶æäº¤ pull requestã€‚æœ¬æ–‡ä¸ä¼šä»‹ç»æ¡†æ¶ç»†èŠ‚ä¸­çš„å¥‡æŠ€æ·«å·§ï¼Œç›¸ä¿¡è¿™æ ·èƒ½æçº²æŒˆé¢†ï¼Œè®©ä½ çœ‹æ¸… React ç”±ç®€å•åˆ°å¤æ‚çš„è®¾è®¡è¿‡ç¨‹ã€‚React.js çš„çœŸå®å®ç°ä¸­å……æ»¡äº†å…·ä½“é—®é¢˜çš„è§£å†³æ–¹æ¡ˆï¼Œæ¸è¿›å¼çš„è§£æ³•ï¼Œç®—æ³•ä¼˜åŒ–ï¼Œå†å²é—ç•™ä»£ç ï¼Œdebug å·¥å…·ä»¥åŠå…¶ä»–ä¸€äº›å¯ä»¥è®©å®ƒçœŸçš„å…·æœ‰é«˜å¯ç”¨æ€§çš„å†…å®¹ã€‚è¿™äº›ä»£ç å¯èƒ½å¹¶ä¸ç¨³å®šï¼Œå› ä¸ºæœªæ¥æµè§ˆå™¨çš„å˜åŒ–å’ŒåŠŸèƒ½æƒé‡çš„å˜åŒ–éšæ—¶é¢ä¸´æ”¹å˜ã€‚æ‰€ä»¥å…·ä½“çš„ä»£ç å¾ˆéš¾å½»åº•è§£é‡Šæ¸…æ¥šã€‚æˆ‘åå‘äºé€‰æ‹©ä¸€ç§æˆ‘èƒ½å®Œå…¨ hold ä½çš„ç®€æ´çš„å¿ƒæ™ºæ¨¡å‹æ¥ä½œä»‹ç»ã€‚å˜æ¢ï¼ˆTransformationï¼‰è®¾è®¡ React çš„æ ¸å¿ƒå‰ææ˜¯è®¤ä¸º UI åªæ˜¯æŠŠæ•°æ®é€šè¿‡æ˜ å°„å…³ç³»å˜æ¢æˆå¦ä¸€ç§å½¢å¼çš„æ•°æ®ã€‚åŒæ ·çš„è¾“å…¥å¿…ä¼šæœ‰åŒæ ·çš„è¾“å‡ºã€‚è¿™æ°å¥½å°±æ˜¯çº¯å‡½æ•°ã€‚123function NameBox(name) &#123; return &#123; fontWeight: 'bold', labelContent: name &#125;;&#125;12&apos;Sebastian MarkbÃ¥ge&apos; -&gt;&#123; fontWeight: &apos;bold&apos;, labelContent: &apos;Sebastian MarkbÃ¥ge&apos; &#125;;æŠ½è±¡ï¼ˆAbstractionï¼‰ä½ ä¸å¯èƒ½ä»…ç”¨ä¸€ä¸ªå‡½æ•°å°±èƒ½å®ç°å¤æ‚çš„ UIã€‚é‡è¦çš„æ˜¯ï¼Œä½ éœ€è¦æŠŠ UI æŠ½è±¡æˆå¤šä¸ªéšè—å†…éƒ¨ç»†èŠ‚ï¼Œåˆå¯å¤ç”¨çš„å‡½æ•°ã€‚é€šè¿‡åœ¨ä¸€ä¸ªå‡½æ•°ä¸­è°ƒç”¨å¦ä¸€ä¸ªå‡½æ•°æ¥å®ç°å¤æ‚çš„ UIï¼Œè¿™å°±æ˜¯æŠ½è±¡ã€‚123456789function FancyUserBox(user) &#123; return &#123; borderStyle: '1px solid blue', childContent: [ 'Name: ', NameBox(user.firstName + ' ' + user.lastName) ] &#125;;&#125;12345678&#123; firstName: &apos;Sebastian&apos;, lastName: &apos;MarkbÃ¥ge&apos; &#125; -&gt;&#123; borderStyle: &apos;1px solid blue&apos;, childContent: [ &apos;Name: &apos;, &#123; fontWeight: &apos;bold&apos;, labelContent: &apos;Sebastian MarkbÃ¥ge&apos; &#125; ]&#125;;ç»„åˆï¼ˆCompositionï¼‰ä¸ºäº†çœŸæ­£è¾¾åˆ°é‡ç”¨çš„ç‰¹æ€§ï¼Œåªé‡ç”¨å¶å­ç„¶åæ¯æ¬¡éƒ½ä¸ºä»–ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„å®¹å™¨æ˜¯ä¸å¤Ÿçš„ã€‚ä½ è¿˜éœ€è¦å¯ä»¥åŒ…å«å…¶ä»–æŠ½è±¡çš„å®¹å™¨å†æ¬¡è¿›è¡Œç»„åˆã€‚æˆ‘ç†è§£çš„â€œç»„åˆâ€å°±æ˜¯å°†ä¸¤ä¸ªæˆ–è€…å¤šä¸ªä¸åŒçš„æŠ½è±¡åˆå¹¶ä¸ºä¸€ä¸ªã€‚12345678910111213function FancyBox(children) &#123; return &#123; borderStyle: '1px solid blue', children: children &#125;;&#125;function UserBox(user) &#123; return FancyBox([ 'Name: ', NameBox(user.firstName + ' ' + user.lastName) ]);&#125;çŠ¶æ€ï¼ˆStateï¼‰UI ä¸å•å•æ˜¯å¯¹æœåŠ¡å™¨ç«¯æˆ–ä¸šåŠ¡é€»è¾‘çŠ¶æ€çš„å¤åˆ¶ã€‚å®é™…ä¸Šè¿˜æœ‰å¾ˆå¤šçŠ¶æ€æ˜¯é’ˆå¯¹å…·ä½“çš„æ¸²æŸ“ç›®æ ‡ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œåœ¨ä¸€ä¸ª text field ä¸­æ‰“å­—ã€‚å®ƒä¸ä¸€å®šè¦å¤åˆ¶åˆ°å…¶ä»–é¡µé¢æˆ–è€…ä½ çš„æ‰‹æœºè®¾å¤‡ã€‚æ»šåŠ¨ä½ç½®è¿™ä¸ªçŠ¶æ€æ˜¯ä¸€ä¸ªå…¸å‹çš„ä½ å‡ ä¹ä¸ä¼šå¤åˆ¶åˆ°å¤šä¸ªæ¸²æŸ“ç›®æ ‡çš„ã€‚æˆ‘ä»¬å€¾å‘äºä½¿ç”¨ä¸å¯å˜çš„æ•°æ®æ¨¡å‹ã€‚æˆ‘ä»¬æŠŠå¯ä»¥æ”¹å˜ state çš„å‡½æ•°ä¸²è”èµ·æ¥ä½œä¸ºåŸç‚¹æ”¾ç½®åœ¨é¡¶å±‚ã€‚1234567891011121314151617181920212223function FancyNameBox(user, likes, onClick) &#123; return FancyBox([ 'Name: ', NameBox(user.firstName + ' ' + user.lastName), 'Likes: ', LikeBox(likes), LikeButton(onClick) ]);&#125;// å®ç°ç»†èŠ‚var likes = 0;function addOneMoreLike() &#123; likes++; rerender();&#125;// åˆå§‹åŒ–FancyNameBox( &#123; firstName: 'Sebastian', lastName: 'MarkbÃ¥ge' &#125;, likes, addOneMoreLike);æ³¨æ„ï¼šæœ¬ä¾‹æ›´æ–°çŠ¶æ€æ—¶ä¼šå¸¦æ¥å‰¯ä½œç”¨ï¼ˆaddOneMoreLike å‡½æ•°ä¸­ï¼‰ã€‚æˆ‘å®é™…çš„æƒ³æ³•æ˜¯å½“ä¸€ä¸ªâ€œupdateâ€ä¼ å…¥æ—¶æˆ‘ä»¬è¿”å›ä¸‹ä¸€ä¸ªç‰ˆæœ¬çš„çŠ¶æ€ï¼Œä½†é‚£æ ·ä¼šæ¯”è¾ƒå¤æ‚ã€‚æ­¤ç¤ºä¾‹å¾…æ›´æ–°Memoizationå¯¹äºçº¯å‡½æ•°ï¼Œä½¿ç”¨ç›¸åŒçš„å‚æ•°ä¸€æ¬¡æ¬¡è°ƒç”¨æœªå…å¤ªæµªè´¹èµ„æºã€‚æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªå‡½æ•°çš„ memorized ç‰ˆæœ¬ï¼Œç”¨æ¥è¿½è¸ªæœ€åä¸€ä¸ªå‚æ•°å’Œç»“æœã€‚è¿™æ ·å¦‚æœæˆ‘ä»¬ç»§ç»­ä½¿ç”¨åŒæ ·çš„å€¼ï¼Œå°±ä¸éœ€è¦åå¤æ‰§è¡Œå®ƒäº†ã€‚1234567891011121314151617181920212223function memoize(fn) &#123; var cachedArg; var cachedResult; return function(arg) &#123; if (cachedArg === arg) &#123; return cachedResult; &#125; cachedArg = arg; cachedResult = fn(arg); return cachedResult; &#125;;&#125;var MemoizedNameBox = memoize(NameBox);function NameAndAgeBox(user, currentTime) &#123; return FancyBox([ 'Name: ', MemoizedNameBox(user.firstName + ' ' + user.lastName), 'Age in milliseconds: ', currentTime - user.dateOfBirth ]);&#125;åˆ—è¡¨ï¼ˆListsï¼‰å¤§éƒ¨åˆ† UI éƒ½æ˜¯å±•ç¤ºåˆ—è¡¨æ•°æ®ä¸­ä¸åŒ item çš„åˆ—è¡¨ç»“æ„ã€‚è¿™æ˜¯ä¸€ä¸ªå¤©ç„¶çš„å±‚çº§ã€‚ä¸ºäº†ç®¡ç†åˆ—è¡¨ä¸­çš„æ¯ä¸€ä¸ª item çš„ state ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›é€ ä¸€ä¸ª Map å®¹çº³å…·ä½“ item çš„ stateã€‚123456789101112131415function UserList(users, likesPerUser, updateUserLikes) &#123; return users.map(user =&gt; FancyNameBox( user, likesPerUser.get(user.id), () =&gt; updateUserLikes(user.id, likesPerUser.get(user.id) + 1) ));&#125;var likesPerUser = new Map();function updateUserLikes(id, likeCount) &#123; likesPerUser.set(id, likeCount); rerender();&#125;UserList(data.users, likesPerUser, updateUserLikes);æ³¨æ„ï¼šç°åœ¨æˆ‘ä»¬å‘ FancyNameBox ä¼ äº†å¤šä¸ªä¸åŒçš„å‚æ•°ã€‚è¿™æ‰“ç ´äº†æˆ‘ä»¬çš„ memoization å› ä¸ºæˆ‘ä»¬æ¯æ¬¡åªèƒ½å­˜å‚¨ä¸€ä¸ªå€¼ã€‚æ›´å¤šç›¸å…³å†…å®¹åœ¨ä¸‹é¢ã€‚è¿ç»­æ€§ï¼ˆContinuationsï¼‰ä¸å¹¸çš„æ˜¯ï¼Œè‡ªä» UI ä¸­æœ‰å¤ªå¤šçš„åˆ—è¡¨ï¼Œæ˜ç¡®çš„ç®¡ç†å°±éœ€è¦å¤§é‡çš„é‡å¤æ€§æ ·æ¿ä»£ç ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡æ¨è¿Ÿä¸€äº›å‡½æ•°çš„æ‰§è¡Œï¼Œè¿›è€ŒæŠŠä¸€äº›æ¨¡æ¿ç§»å‡ºä¸šåŠ¡é€»è¾‘ã€‚æ¯”å¦‚ï¼Œä½¿ç”¨â€œæŸ¯é‡ŒåŒ–â€ï¼ˆJavaScript ä¸­çš„ bindï¼‰ã€‚ç„¶åæˆ‘ä»¬å¯ä»¥ä»æ ¸å¿ƒçš„å‡½æ•°å¤–é¢ä¼ é€’ stateï¼Œè¿™æ ·å°±æ²¡æœ‰æ ·æ¿ä»£ç äº†ã€‚ä¸‹é¢è¿™æ ·å¹¶æ²¡æœ‰å‡å°‘æ ·æ¿ä»£ç ï¼Œä½†è‡³å°‘æŠŠå®ƒä»å…³é”®ä¸šåŠ¡é€»è¾‘ä¸­å‰¥ç¦»ã€‚123456789101112function FancyUserList(users) &#123; return FancyBox( UserList.bind(null, users) );&#125;const box = FancyUserList(data.users);const resolvedChildren = box.children(likesPerUser, updateUserLikes);const resolvedBox = &#123; ...box, children: resolvedChildren&#125;;State Mapä¹‹å‰æˆ‘ä»¬çŸ¥é“å¯ä»¥ä½¿ç”¨ç»„åˆé¿å…é‡å¤æ‰§è¡Œç›¸åŒçš„ä¸œè¥¿è¿™æ ·ä¸€ç§é‡å¤æ¨¡å¼ã€‚æˆ‘ä»¬å¯ä»¥æŠŠæ‰§è¡Œå’Œä¼ é€’ state é€»è¾‘æŒªåŠ¨åˆ°è¢«å¤ç”¨å¾ˆå¤šçš„ä½å±‚çº§çš„å‡½æ•°ä¸­å»ã€‚12345678910111213141516171819202122232425262728function FancyBoxWithState( children, stateMap, updateState) &#123; return FancyBox( children.map(child =&gt; child.continuation( stateMap.get(child.key), updateState )) );&#125;function UserList(users) &#123; return users.map(user =&gt; &#123; continuation: FancyNameBox.bind(null, user), key: user.id &#125;);&#125;function FancyUserList(users) &#123; return FancyBoxWithState.bind(null, UserList(users) );&#125;const continuation = FancyUserList(data.users);continuation(likesPerUser, updateUserLikes);Memoization Mapä¸€æ—¦æˆ‘ä»¬æƒ³åœ¨ä¸€ä¸ª memoization åˆ—è¡¨ä¸­ memoize å¤šä¸ª item å°±ä¼šå˜å¾—å¾ˆå›°éš¾ã€‚å› ä¸ºä½ éœ€è¦åˆ¶å®šå¤æ‚çš„ç¼“å­˜ç®—æ³•æ¥å¹³è¡¡è°ƒç”¨é¢‘ç‡å’Œå†…å­˜å æœ‰ç‡ã€‚è¿˜å¥½ UI åœ¨åŒä¸€ä¸ªä½ç½®ä¼šç›¸å¯¹çš„ç¨³å®šã€‚ç›¸åŒçš„ä½ç½®ä¸€èˆ¬æ¯æ¬¡éƒ½ä¼šæ¥å—ç›¸åŒçš„å‚æ•°ã€‚è¿™æ ·ä»¥æ¥ï¼Œä½¿ç”¨ä¸€ä¸ªé›†åˆæ¥åš memoization æ˜¯ä¸€ä¸ªéå¸¸å¥½ç”¨çš„ç­–ç•¥ã€‚æˆ‘ä»¬å¯ä»¥ç”¨å¯¹å¾… state åŒæ ·çš„æ–¹å¼ï¼Œåœ¨ç»„åˆçš„å‡½æ•°ä¸­ä¼ é€’ä¸€ä¸ª memoization ç¼“å­˜ã€‚12345678910111213141516171819202122232425262728function memoize(fn) &#123; return function(arg, memoizationCache) &#123; if (memoizationCache.arg === arg) &#123; return memoizationCache.result; &#125; const result = fn(arg); memoizationCache.arg = arg; memoizationCache.result = result; return result; &#125;;&#125;function FancyBoxWithState( children, stateMap, updateState, memoizationCache) &#123; return FancyBox( children.map(child =&gt; child.continuation( stateMap.get(child.key), updateState, memoizationCache.get(child.key) )) );&#125;const MemoizedFancyNameBox = memoize(FancyNameBox);ä»£æ•°æ•ˆåº”ï¼ˆAlgebraic Effectsï¼‰å¤šå±‚æŠ½è±¡éœ€è¦å…±äº«çç¢æ•°æ®æ—¶ï¼Œä¸€å±‚å±‚ä¼ é€’æ•°æ®éå¸¸éº»çƒ¦ã€‚å¦‚æœèƒ½æœ‰ä¸€ç§æ–¹å¼å¯ä»¥åœ¨å¤šå±‚æŠ½è±¡ä¸­å¿«æ·åœ°ä¼ é€’æ•°æ®ï¼ŒåŒæ—¶åˆä¸éœ€è¦ç‰µæ¶‰åˆ°ä¸­é—´å±‚çº§ï¼Œé‚£è¯¥æœ‰å¤šå¥½ã€‚React ä¸­æˆ‘ä»¬æŠŠå®ƒå«åšâ€œcontextâ€ã€‚æœ‰æ—¶å€™æ•°æ®ä¾èµ–å¹¶ä¸æ˜¯ä¸¥æ ¼æŒ‰ç…§æŠ½è±¡æ ‘è‡ªä¸Šè€Œä¸‹è¿›è¡Œã€‚ä¸¾ä¸ªä¾‹å­ï¼Œåœ¨å¸ƒå±€ç®—æ³•ä¸­ï¼Œä½ éœ€è¦åœ¨å®ç°ä»–ä»¬çš„ä½ç½®ä¹‹å‰äº†è§£å­èŠ‚ç‚¹çš„å¤§å°ã€‚ç°åœ¨ï¼Œè¿™ä¸ªä¾‹å­æœ‰ä¸€ç‚¹è¶…çº²ã€‚æˆ‘ä¼šä½¿ç”¨ ä»£æ•°æ•ˆåº” è¿™ä¸ªç”±æˆ‘å‘èµ·çš„ ECMAScript æ–°ç‰¹æ€§æè®®ã€‚å¦‚æœä½ å¯¹å‡½æ•°å¼ç¼–ç¨‹å¾ˆç†Ÿæ‚‰ï¼Œå®ƒä»¬ åœ¨é¿å…ç”± monad å¼ºåˆ¶å¼•å…¥çš„ä»ªå¼ä¸€æ ·çš„ç¼–ç ã€‚123456789101112131415161718192021222324function ThemeBorderColorRequest() &#123; &#125;function FancyBox(children) &#123; const color = raise new ThemeBorderColorRequest(); return &#123; borderWidth: '1px', borderColor: color, children: children &#125;;&#125;function BlueTheme(children) &#123; return try &#123; children(); &#125; catch effect ThemeBorderColorRequest -&gt; [, continuation] &#123; continuation('blue'); &#125;&#125;function App(data) &#123; return BlueTheme( FancyUserList.bind(null, data.users) );&#125;æœ¬æ–‡ä½œè€…ï¼š Andyæœ¬æ–‡åœ°å€ï¼š https://andyxw.com/archives/7615.htmlç‰ˆæƒå£°æ˜ï¼š è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼]]></content>
      <categories>
        <category>React</category>
      </categories>
      <tags>
        <tag>React</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Reactä¸­çš„stateå’Œprops]]></title>
    <url>%2Farchives%2F992.html</url>
    <content type="text"><![CDATA[æ•´ç†ä¸€ä¸‹Reactä¸­å…³äºstateå’Œpropsçš„çŸ¥è¯†ç‚¹ã€‚åœ¨ä»»ä½•åº”ç”¨ä¸­ï¼Œæ•°æ®éƒ½æ˜¯å¿…ä¸å¯å°‘çš„ã€‚æˆ‘ä»¬éœ€è¦ç›´æ¥çš„æ”¹å˜é¡µé¢ä¸Šä¸€å—çš„åŒºåŸŸæ¥ä½¿å¾—è§†å›¾çš„åˆ·æ–°ï¼Œæˆ–è€…é—´æ¥åœ°æ”¹å˜å…¶ä»–åœ°æ–¹çš„æ•°æ®ã€‚Reactçš„æ•°æ®æ˜¯è‡ªé¡¶å‘ä¸‹å•å‘æµåŠ¨çš„ï¼Œå³ä»çˆ¶ç»„ä»¶åˆ°å­ç»„ä»¶ä¸­ï¼Œç»„ä»¶çš„æ•°æ®å­˜å‚¨åœ¨propså’Œstateä¸­ï¼Œè¿™ä¸¤ä¸ªå±æ€§æœ‰å•¥å­åŒºåˆ«å‘¢ï¼ŸpropsReactçš„æ ¸å¿ƒæ€æƒ³å°±æ˜¯ç»„ä»¶åŒ–æ€æƒ³ï¼Œé¡µé¢ä¼šè¢«åˆ‡åˆ†æˆä¸€äº›ç‹¬ç«‹çš„ã€å¯å¤ç”¨çš„ç»„ä»¶ã€‚ç»„ä»¶ä»æ¦‚å¿µä¸Šçœ‹å°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå¯ä»¥æ¥å—ä¸€ä¸ªå‚æ•°ä½œä¸ºè¾“å…¥å€¼ï¼Œè¿™ä¸ªå‚æ•°å°±æ˜¯propsï¼Œæ‰€ä»¥å¯ä»¥æŠŠpropsç†è§£ä¸ºä»å¤–éƒ¨ä¼ å…¥ç»„ä»¶å†…éƒ¨çš„æ•°æ®ã€‚ç”±äºReactæ˜¯å•å‘æ•°æ®æµï¼Œæ‰€ä»¥propsåŸºæœ¬ä¸Šä¹Ÿå°±æ˜¯ä»æœçˆ¶çº§ç»„ä»¶å‘å­ç»„ä»¶ä¼ é€’çš„æ•°æ®ã€‚ç”¨æ³•å‡è®¾æˆ‘ä»¬ç°åœ¨éœ€è¦å®ç°ä¸€ä¸ªåˆ—è¡¨ï¼Œæ ¹æ®Reactç»„ä»¶åŒ–æ€æƒ³ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠåˆ—è¡¨ä¸­çš„è¡Œå½“åšä¸€ä¸ªç»„ä»¶ï¼Œä¹Ÿå°±æ˜¯æœ‰è¿™æ ·ä¸¤ä¸ªç»„ä»¶ï¼š&lt;ItemList/&gt;å’Œ&lt;Item/&gt;ã€‚å…ˆçœ‹çœ‹&lt;ItemList/&gt;123456789import Item from &quot;./item&quot;;export default class ItemList extends React.Component&#123; const itemList = data.map(item =&gt; &lt;Item item=item /&gt;); render()&#123; return ( &#123;itemList&#125; ) &#125;&#125;åˆ—è¡¨çš„æ•°æ®æˆ‘ä»¬å°±æš‚æ—¶å…ˆå‡è®¾æ˜¯æ”¾åœ¨ä¸€ä¸ªdataå˜é‡ä¸­ï¼Œç„¶åé€šè¿‡mapå‡½æ•°è¿”å›ä¸€ä¸ªæ¯ä¸€é¡¹éƒ½æ˜¯&lt;Item item=&#39;æ•°æ®&#39;/&gt;çš„æ•°ç»„ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™é‡Œå…¶å®åŒ…å«äº†data.lengthä¸ª&lt;Item/&gt;ç»„ä»¶ï¼Œæ•°æ®é€šè¿‡åœ¨ç»„ä»¶ä¸Šè‡ªå®šä¹‰ä¸€ä¸ªå‚æ•°ä¼ é€’ã€‚å½“ç„¶ï¼Œè¿™é‡Œæƒ³ä¼ é€’å‡ ä¸ªè‡ªå®šä¹‰å‚æ•°éƒ½å¯ä»¥ã€‚åœ¨&lt;Item /&gt;ä¸­æ˜¯è¿™æ ·çš„ï¼š1234567export default class Item extends React.Component&#123; render()&#123; return ( &lt;li&gt;&#123;this.props.item&#125;&lt;/li&gt; ) &#125;&#125;åœ¨renderå‡½æ•°ä¸­å¯ä»¥çœ‹å‡ºï¼Œç»„ä»¶å†…éƒ¨æ˜¯ä½¿ç”¨this.propsæ¥è·å–ä¼ é€’åˆ°è¯¥ç»„ä»¶çš„æ‰€æœ‰æ•°æ®ï¼Œå®ƒæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«äº†æ‰€æœ‰ä½ å¯¹è¿™ä¸ªç»„ä»¶çš„é…ç½®ï¼Œç°åœ¨åªåŒ…å«äº†ä¸€ä¸ªitemå±æ€§ï¼Œæ‰€ä»¥é€šè¿‡this.props.itemæ¥è·å–å³å¯ã€‚åªè¯»æ€§propsç»å¸¸è¢«ç”¨ä½œæ¸²æŸ“ç»„ä»¶å’Œåˆå§‹åŒ–çŠ¶æ€ï¼Œå½“ä¸€ä¸ªç»„ä»¶è¢«å®ä¾‹åŒ–ä¹‹åï¼Œå®ƒçš„propsæ˜¯åªè¯»çš„ï¼Œä¸å¯æ”¹å˜çš„ã€‚å¦‚æœpropsåœ¨æ¸²æŸ“è¿‡ç¨‹ä¸­å¯ä»¥è¢«æ”¹å˜ï¼Œä¼šå¯¼è‡´è¿™ä¸ªç»„ä»¶æ˜¾ç¤ºçš„å½¢æ€å˜å¾—ä¸å¯é¢„æµ‹ã€‚åªæœ‰é€šè¿‡çˆ¶ç»„ä»¶é‡æ–°æ¸²æŸ“çš„æ–¹å¼æ‰å¯ä»¥æŠŠæ–°çš„propsä¼ å…¥ç»„ä»¶ä¸­ã€‚é»˜è®¤å‚æ•°åœ¨ç»„ä»¶ä¸­ï¼Œæˆ‘ä»¬æœ€å¥½ä¸ºpropsä¸­çš„å‚æ•°è®¾ç½®ä¸€ä¸ªdefaultPropsï¼Œå¹¶ä¸”åˆ¶å®šå®ƒçš„ç±»å‹ã€‚æ¯”å¦‚ï¼Œè¿™æ ·ï¼š1234567Item.defaultProps = &#123; item: &apos;Hello Props&apos;,&#125;;Item.propTypes = &#123; item: PropTypes.string,&#125;;å…³äºpropTypesï¼Œå¯ä»¥å£°æ˜ä¸ºä»¥ä¸‹å‡ ç§ç±»å‹ï¼š1234567optionalArray: PropTypes.array,optionalBool: PropTypes.bool,optionalFunc: PropTypes.func,optionalNumber: PropTypes.number,optionalObject: PropTypes.object,optionalString: PropTypes.string,optionalSymbol: PropTypes.symbol,æ³¨æ„ï¼Œboolå’Œfuncæ˜¯ç®€å†™ã€‚è¿™äº›çŸ¥è¯†åŸºç¡€æ•°æ®ç±»å‹ï¼Œè¿˜æœ‰ä¸€äº›å¤æ‚çš„ï¼Œé™„ä¸Šé“¾æ¥ï¼šhttps://facebook.github.io/react/docs/typechecking-with-proptypes.htmlæ€»ç»“propsæ˜¯ä¸€ä¸ªä»å¤–éƒ¨ä¼ è¿›ç»„ä»¶çš„å‚æ•°ï¼Œä¸»è¦ä½œä¸ºå°±æ˜¯ä»çˆ¶ç»„ä»¶å‘å­ç»„ä»¶ä¼ é€’æ•°æ®ï¼Œå®ƒå…·æœ‰å¯è¯»æ€§å’Œä¸å˜æ€§ï¼Œåªèƒ½é€šè¿‡å¤–éƒ¨ç»„ä»¶ä¸»åŠ¨ä¼ å…¥æ–°çš„propsæ¥é‡æ–°æ¸²æŸ“å­ç»„ä»¶ï¼Œå¦åˆ™å­ç»„ä»¶çš„propsä»¥åŠå±•ç°å½¢å¼ä¸ä¼šæ”¹å˜ã€‚statestateæ˜¯ä»€ä¹ˆå‘¢ï¼ŸState is similar to props, but it is private and fully controlled by the component.ä¸€ä¸ªç»„ä»¶çš„æ˜¾ç¤ºå½¢æ€å¯ä»¥ç”±æ•°æ®çŠ¶æ€å’Œå¤–éƒ¨å‚æ•°æ‰€å†³å®šï¼Œå¤–éƒ¨å‚æ•°ä¹Ÿå°±æ˜¯propsï¼Œè€Œæ•°æ®çŠ¶æ€å°±æ˜¯stateã€‚ç”¨æ³•12345678910111213export default class ItemList extends React.Component&#123; constructor()&#123; super(); this.state = &#123; itemList:&apos;ä¸€äº›æ•°æ®&apos;, &#125; &#125; render()&#123; return ( &#123;this.state.itemList&#125; ) &#125;&#125;é¦–å…ˆï¼Œåœ¨ç»„ä»¶åˆå§‹åŒ–çš„æ—¶å€™ï¼Œé€šè¿‡this.stateç»™ç»„ä»¶è®¾å®šä¸€ä¸ªåˆå§‹çš„stateï¼Œåœ¨ç¬¬ä¸€æ¬¡renderçš„æ—¶å€™å°±ä¼šç”¨è¿™ä¸ªæ•°æ®æ¥æ¸²æŸ“ç»„ä»¶ã€‚setStatestateä¸åŒäºpropsçš„ä¸€ç‚¹æ˜¯ï¼Œstateæ˜¯å¯ä»¥è¢«æ”¹å˜çš„ã€‚ä¸è¿‡ï¼Œä¸å¯ä»¥ç›´æ¥é€šè¿‡this.state=çš„æ–¹å¼æ¥ä¿®æ”¹ï¼Œè€Œéœ€è¦é€šè¿‡this.setState()æ–¹æ³•æ¥ä¿®æ”¹stateã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé€šè¿‡å¼‚æ­¥æ“ä½œæ¥è·å–æ•°æ®ï¼Œæˆ‘ä»¬éœ€è¦åœ¨didMounté˜¶æ®µæ¥æ‰§è¡Œå¼‚æ­¥æ“ä½œï¼š1234567componentDidMount()&#123; fetch(&apos;url&apos;) .then(response =&gt; response.json()) .then((data) =&gt; &#123; this.setState(&#123;itemList:item&#125;); &#125;&#125;å½“æ•°æ®è·å–å®Œæˆåï¼Œé€šè¿‡this.setStateæ¥ä¿®æ”¹æ•°æ®çŠ¶æ€ã€‚å½“æˆ‘ä»¬è°ƒç”¨this.setStateæ–¹æ³•æ—¶ï¼ŒReactä¼šæ›´æ–°ç»„ä»¶çš„æ•°æ®çŠ¶æ€stateï¼Œå¹¶ä¸”é‡æ–°è°ƒç”¨renderæ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯ä¼šå¯¹ç»„ä»¶è¿›è¡Œé‡æ–°æ¸²æŸ“ã€‚æ³¨æ„ï¼šé€šè¿‡this.state=æ¥åˆå§‹åŒ–stateï¼Œä½¿ç”¨this.setStateæ¥ä¿®æ”¹stateï¼Œconstructoræ˜¯å”¯ä¸€èƒ½å¤Ÿåˆå§‹åŒ–çš„åœ°æ–¹ã€‚setStateæ¥å—ä¸€ä¸ªå¯¹è±¡æˆ–è€…å‡½æ•°ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ï¼Œåªéœ€è¦ä¼ å…¥éœ€è¦æ›´æ–°çš„éƒ¨åˆ†å³å¯ï¼Œä¸éœ€è¦ä¼ å…¥æ•´ä¸ªå¯¹è±¡ï¼Œæ¯”å¦‚ï¼š123456789101112export default class ItemList extends React.Component&#123; constructor()&#123; super(); this.state = &#123; name:&apos;axuebin&apos;, age:25, &#125; &#125; componentDidMount()&#123; this.setState(&#123;age:18&#125;) &#125;&#125;åœ¨æ‰§è¡Œå®ŒsetStateä¹‹åçš„stateåº”è¯¥æ˜¯{name:&#39;axuebin&#39;,age:18}ã€‚setStateè¿˜å¯ä»¥æ¥å—ç¬¬äºŒä¸ªå‚æ•°ï¼Œå®ƒæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä¼šåœ¨setStateè°ƒç”¨å®Œæˆå¹¶ä¸”ç»„ä»¶å¼€å§‹é‡æ–°æ¸²æŸ“æ—¶è¢«è°ƒç”¨ï¼Œå¯ä»¥ç”¨æ¥ç›‘å¬æ¸²æŸ“æ˜¯å¦å®Œæˆï¼š123this.setState(&#123; name:&apos;xb&apos;&#125;,()=&gt;console.log(&apos;setState finished&apos;))æ€»ç»“stateçš„ä¸»è¦ä½œç”¨æ˜¯ç”¨äºç»„ä»¶ä¿å­˜ã€æ§åˆ¶ä»¥åŠä¿®æ”¹è‡ªå·±çš„çŠ¶æ€ï¼Œå®ƒåªèƒ½åœ¨constructorä¸­åˆå§‹åŒ–ï¼Œå®ƒç®—æ˜¯ç»„ä»¶çš„ç§æœ‰å±æ€§ï¼Œä¸å¯é€šè¿‡å¤–éƒ¨è®¿é—®å’Œä¿®æ”¹ï¼Œåªèƒ½é€šè¿‡ç»„ä»¶å†…éƒ¨çš„this.setStateæ¥ä¿®æ”¹ï¼Œä¿®æ”¹stateå±æ€§ä¼šå¯¼è‡´ç»„ä»¶çš„é‡æ–°æ¸²æŸ“ã€‚åŒºåˆ«stateæ˜¯ç»„ä»¶è‡ªå·±ç®¡ç†æ•°æ®ï¼Œæ§åˆ¶è‡ªå·±çš„çŠ¶æ€ï¼Œå¯å˜ï¼›propsæ˜¯å¤–éƒ¨ä¼ å…¥çš„æ•°æ®å‚æ•°ï¼Œä¸å¯å˜ï¼›æ²¡æœ‰stateçš„å«åšæ— çŠ¶æ€ç»„ä»¶ï¼Œæœ‰stateçš„å«åšæœ‰çŠ¶æ€ç»„ä»¶ï¼›å¤šç”¨propsï¼Œå°‘ç”¨stateã€‚ä¹Ÿå°±æ˜¯å¤šå†™æ— çŠ¶æ€ç»„ä»¶ã€‚æœ¬æ–‡ä½œè€…ï¼š Andyæœ¬æ–‡åœ°å€ï¼š https://andyxw.com/archives/992.htmlç‰ˆæƒå£°æ˜ï¼š è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼]]></content>
      <categories>
        <category>React</category>
      </categories>
      <tags>
        <tag>React</tag>
      </tags>
  </entry>
</search>
